<!DOCTYPE html>
<!-- saved from url=(0103)https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    

    <title>Keras_Tutorial_v2a</title>
    <link rel="shortcut icon" type="image/x-icon" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/static/base/images/favicon.ico?v=97c6417ed01bdc0ae3ef32ae4894fd03">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="./Keras_Tutorial_v2a_files/jquery-ui.min.css" type="text/css">
    <link rel="stylesheet" href="./Keras_Tutorial_v2a_files/jquery.typeahead.min.css" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    


<script type="text/javascript" src="./Keras_Tutorial_v2a_files/MathJax.js.下载" charset="utf-8"></script>

<script type="text/javascript">
// MathJax disabled, set as null to distingish from *missing* MathJax,
// where it will be undefined, and should prompt a dialog later.
window.mathjax_url = "/static/components/MathJax/MathJax.js";
</script>

<link rel="stylesheet" href="./Keras_Tutorial_v2a_files/bootstrap-tour.min.css" type="text/css">
<link rel="stylesheet" href="./Keras_Tutorial_v2a_files/codemirror.css">


    <link rel="stylesheet" href="./Keras_Tutorial_v2a_files/style.min.css" type="text/css">
    

<link rel="stylesheet" href="./Keras_Tutorial_v2a_files/override.css" type="text/css">
<link rel="stylesheet" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb" id="kernel-css" type="text/css">


    <link rel="stylesheet" href="./Keras_Tutorial_v2a_files/custom.css" type="text/css">
    <script src="./Keras_Tutorial_v2a_files/promise.min.js.下载" type="text/javascript" charset="utf-8"></script>
    <script src="./Keras_Tutorial_v2a_files/index.js.下载" type="text/javascript"></script>
    <script src="./Keras_Tutorial_v2a_files/index.js(1).下载" type="text/javascript"></script>
    <script src="./Keras_Tutorial_v2a_files/index.js(2).下载" type="text/javascript"></script>
    <script src="./Keras_Tutorial_v2a_files/require.js.下载" type="text/javascript" charset="utf-8"></script>
    <script>
      require.config({
          
          urlArgs: "v=20200201050731",
          
          baseUrl: '/static/',
          paths: {
            'auth/js/main': 'auth/js/main.min',
            custom : '/custom',
            nbextensions : '/nbextensions',
            kernelspecs : '/kernelspecs',
            underscore : 'components/underscore/underscore-min',
            backbone : 'components/backbone/backbone-min',
            jquery: 'components/jquery/jquery.min',
            bootstrap: 'components/bootstrap/js/bootstrap.min',
            bootstraptour: 'components/bootstrap-tour/build/js/bootstrap-tour.min',
            'jquery-ui': 'components/jquery-ui/ui/minified/jquery-ui.min',
            moment: 'components/moment/moment',
            codemirror: 'components/codemirror',
            termjs: 'components/xterm.js/dist/xterm',
            typeahead: 'components/jquery-typeahead/dist/jquery.typeahead.min',
          },
          map: { // for backward compatibility
              "*": {
                  "jqueryui": "jquery-ui",
              }
          },
          shim: {
            typeahead: {
              deps: ["jquery"],
              exports: "typeahead"
            },
            underscore: {
              exports: '_'
            },
            backbone: {
              deps: ["underscore", "jquery"],
              exports: "Backbone"
            },
            bootstrap: {
              deps: ["jquery"],
              exports: "bootstrap"
            },
            bootstraptour: {
              deps: ["bootstrap"],
              exports: "Tour"
            },
            "jquery-ui": {
              deps: ["jquery"],
              exports: "$"
            }
          },
          waitSeconds: 30,
      });

      require.config({
          map: {
              '*':{
                'contents': 'services/contents',
              }
          }
      });

      // error-catching custom.js shim.
      define("custom", function (require, exports, module) {
          try {
              var custom = require('custom/custom');
              console.debug('loaded custom.js');
              return custom;
          } catch (e) {
              console.error("error loading custom.js", e);
              return {};
          }
      })
    </script>

    
    

<script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/contents" src="./Keras_Tutorial_v2a_files/contents.js.下载"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="custom/custom" src="./Keras_Tutorial_v2a_files/custom.js.下载"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/submit-button/main" src="./Keras_Tutorial_v2a_files/main.js.下载"></script><style type="text/css">div.MathJax_MathML {text-align: center; margin: .75em 0px; display: block!important}
.MathJax_MathML {font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
span.MathJax_MathML {display: inline!important}
.MathJax_mmlExBox {display: block!important; overflow: hidden; height: 1px; width: 60ex; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0}
[class="MJX-tex-oldstyle"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB}
[class="MJX-tex-oldstyle-bold"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB; font-weight: bold}
[class="MJX-tex-caligraphic"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB}
[class="MJX-tex-caligraphic-bold"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB; font-weight: bold}
@font-face /*1*/ {font-family: MathJax_Caligraphic-WEB; src: url('https://wfprgshdbiqgukclmahija.coursera-apps.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf')}
@font-face /*2*/ {font-family: MathJax_Caligraphic-WEB; font-weight: bold; src: url('https://wfprgshdbiqgukclmahija.coursera-apps.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Bold.otf')}
[mathvariant="double-struck"] {font-family: MathJax_AMS, MathJax_AMS-WEB}
[mathvariant="script"] {font-family: MathJax_Script, MathJax_Script-WEB}
[mathvariant="fraktur"] {font-family: MathJax_Fraktur, MathJax_Fraktur-WEB}
[mathvariant="bold-script"] {font-family: MathJax_Script, MathJax_Caligraphic-WEB; font-weight: bold}
[mathvariant="bold-fraktur"] {font-family: MathJax_Fraktur, MathJax_Fraktur-WEB; font-weight: bold}
[mathvariant="monospace"] {font-family: monospace}
[mathvariant="sans-serif"] {font-family: sans-serif}
[mathvariant="bold-sans-serif"] {font-family: sans-serif; font-weight: bold}
[mathvariant="sans-serif-italic"] {font-family: sans-serif; font-style: italic}
[mathvariant="sans-serif-bold-italic"] {font-family: sans-serif; font-style: italic; font-weight: bold}
@font-face /*3*/ {font-family: MathJax_AMS-WEB; src: url('https://wfprgshdbiqgukclmahija.coursera-apps.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf')}
@font-face /*4*/ {font-family: MathJax_Script-WEB; src: url('https://wfprgshdbiqgukclmahija.coursera-apps.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf')}
@font-face /*5*/ {font-family: MathJax_Fraktur-WEB; src: url('https://wfprgshdbiqgukclmahija.coursera-apps.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf')}
@font-face /*6*/ {font-family: MathJax_Fraktur-WEB; font-weight: bold; src: url('https://wfprgshdbiqgukclmahija.coursera-apps.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Bold.otf')}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 0; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/notebook/js/extension" src="./Keras_Tutorial_v2a_files/extension.js.下载"></script><link id="favicon" type="image/x-icon" rel="shortcut icon" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/static/base/images/favicon.ico"></head>

<body class="notebook_app command_mode" data-base-url="/" data-ws-url="" data-notebook-name="Keras_Tutorial_v2a.ipynb" data-notebook-path="week2/KerasTutorial/Keras_Tutorial_v2a.ipynb" dir="ltr" style=""><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

<noscript>
    <div id='noscript'>
      Jupyter Notebook requires JavaScript.<br>
      Please enable it to proceed.
  </div>
</noscript>

<div id="header" style="display: block;">
  <div id="header-container" class="container">
  <div id="ipython_notebook" class="nav navbar-brand pull-left"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/tree" title="dashboard"><img src="./Keras_Tutorial_v2a_files/logo.png" alt="Jupyter Notebook"></a></div>

  
  
  

    <span id="login_widget">
      
    </span>

  

  

  


<span id="save_widget" class="pull-left save_widget">
    <span id="notebook_name" class="filename">Keras_Tutorial_v2a</span>
    <span class="checkpoint_status" title="Wed, Oct 30, 2019 12:56 AM">Last Checkpoint: 10/30/2019</span>
    <span class="autosave_status">(autosaved)</span>
</span>

<span id="kernel_logo_widget">
  
  <img class="current_kernel_logo" src="./Keras_Tutorial_v2a_files/logo-64x64.png" title="Python 3" style="display: inline;">
  
</span>


  </div>
  <div class="header-bar"></div>

  
<div id="menubar-container" class="container">
<div id="menubar">
    <div id="menus" class="navbar navbar-default" role="navigation">
        <div class="container-fluid">
            <button type="button" class="btn btn-default navbar-btn navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <i class="fa fa-bars"></i>
              <span class="navbar-text">Menu</span>
            </button>
            <p id="kernel_indicator" class="navbar-text indicator_area">
              <span class="kernel_indicator_name">Python 3</span>
              <i id="kernel_indicator_icon" class="kernel_disconnected_icon" title="No Connection to Kernel"></i>
            </p>
            <i id="readonly-indicator" class="navbar-text" title="This notebook is read-only" style="display: none;">
                <span class="fa-stack">
                    <i class="fa fa-save fa-stack-1x"></i>
                    <i class="fa fa-ban fa-stack-2x text-danger"></i>
                </span>
            </i>
            <i id="modal_indicator" class="navbar-text modal_indicator" title="Command Mode"></i>
            <span id="notification_area"><div id="notification_kernel" class="notification_widget btn btn-xs navbar-btn undefined warning" style="display: inline-block;"><span>Connecting to kernel</span></div><div id="notification_notebook" class="notification_widget btn btn-xs navbar-btn" style="display: none;"><span></span></div><div id="notification_trusted" class="notification_widget btn btn-xs navbar-btn" style="display: inline-block;"><span>Trusted</span></div></span>
            <div class="navbar-collapse collapse">
              <ul class="nav navbar-nav">
                <li class="dropdown"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">File</a>
                    <ul id="file_menu" class="dropdown-menu">
                        <li id="new_notebook" class="dropdown-submenu">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">New Notebook</a>
                            <ul class="dropdown-menu" id="menu-new-notebook-submenu"><li id="new-notebook-submenu-python3"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Python 3</a></li><li class="divider"></li><li id="new-notebook-submenu-python2"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Python 2</a></li></ul>
                        </li>
                        <li id="open_notebook" title="Opens a new window with the Dashboard view">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Open...</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="copy_notebook" title="Open a copy of this notebook&#39;s contents and start a new kernel">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Make a Copy...</a></li>
                        <li id="rename_notebook"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Rename...</a></li>
                        <li id="save_checkpoint"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Save and Checkpoint</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="restore_checkpoint" class="dropdown-submenu"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Revert to Checkpoint</a>
                          <ul class="dropdown-menu"><li><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Wednesday, October 30, 2019 12:56 AM</a></li></ul>
                        </li>
                        <li class="divider"></li>
                        <li id="print_preview"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Print Preview</a></li>
                        <li class="dropdown-submenu"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Download as</a>
                            <ul id="download_menu" class="dropdown-menu">
                                <li id="download_ipynb"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Notebook (.ipynb)</a></li>
                                <li id="download_script"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Python (.py)</a></li>
                                <li id="download_html"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">HTML (.html)</a></li>
                                <li id="download_markdown"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Markdown (.md)</a></li>
                                <li id="download_rst"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">reST (.rst)</a></li>
                                <li id="download_latex"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">LaTeX (.tex)</a></li>
                                <li id="download_pdf"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">PDF via LaTeX (.pdf)</a></li>
                            </ul>
                        </li>
                        <li class="dropdown-submenu hidden"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Deploy as</a>
                            <ul id="deploy_menu" class="dropdown-menu"></ul>
                        </li>
                        <li class="divider"></li>
                        <li id="trust_notebook" title="Trust the output of this notebook" class="disabled">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Trusted Notebook</a></li>
                        <li class="divider"></li>
                        <li id="kill_and_exit" title="Shutdown this notebook&#39;s kernel, and close this window">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Close and Halt</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Edit</a>
                    <ul id="edit_menu" class="dropdown-menu">
                        <li id="cut_cell"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Cut Cells</a></li>
                        <li id="copy_cell"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Copy Cells</a></li>
                        <li id="paste_cell_above" class="disabled"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Paste Cells Above</a></li>
                        <li id="paste_cell_below" class="disabled"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Paste Cells Below</a></li>
                        <li id="paste_cell_replace" class="disabled"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Paste Cells &amp; Replace</a></li>
                        <li id="delete_cell"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Delete Cells</a></li>
                        <li id="undelete_cell" class="disabled"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Undo Delete Cells</a></li>
                        <li class="divider"></li>
                        <li id="split_cell"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Split Cell</a></li>
                        <li id="merge_cell_above"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Merge Cell Above</a></li>
                        <li id="merge_cell_below"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Merge Cell Below</a></li>
                        <li class="divider"></li>
                        <li id="move_cell_up"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Move Cell Up</a></li>
                        <li id="move_cell_down"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Move Cell Down</a></li>
                        <li class="divider"></li>
                        <li id="edit_nb_metadata"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Edit Notebook Metadata</a></li>
                        <li class="divider"></li>
                        <li id="find_and_replace"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#"> Find and Replace </a></li>
                        <li class="divider"></li>
                        <li id="cut_cell_attachments"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Cut Cell Attachments</a></li>
                        <li id="copy_cell_attachments"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Copy Cell Attachments</a></li>
                        <li id="paste_cell_attachments" class="disabled"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Paste Cell Attachments</a></li>
                        <li class="divider"></li>
                        <li id="insert_image" class="disabled"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#"> Insert Image </a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#" class="dropdown-toggle" data-toggle="dropdown">View</a>
                    <ul id="view_menu" class="dropdown-menu">
                        <li id="toggle_header" title="Show/Hide the logo and notebook title (above menu bar)">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Toggle Header</a>
                        </li>
                        <li id="toggle_toolbar" title="Show/Hide the action icons (below menu bar)">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Toggle Toolbar</a>
                        </li>
                        <li id="toggle_line_numbers" title="Show/Hide line numbers in cells">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Toggle Line Numbers</a>
                        </li>
                        <li id="menu-cell-toolbar" class="dropdown-submenu">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Cell Toolbar</a>
                            <ul class="dropdown-menu" id="menu-cell-toolbar-submenu"><li data-name="None"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">None</a></li><li data-name="Edit%20Metadata"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Edit Metadata</a></li><li data-name="Raw%20Cell%20Format"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Raw Cell Format</a></li><li data-name="Slideshow"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Slideshow</a></li><li data-name="Attachments"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Attachments</a></li><li data-name="Tags"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Tags</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Insert</a>
                    <ul id="insert_menu" class="dropdown-menu">
                        <li id="insert_cell_above" title="Insert an empty Code cell above the currently active cell">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Insert Cell Above</a></li>
                        <li id="insert_cell_below" title="Insert an empty Code cell below the currently active cell">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Insert Cell Below</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Cell</a>
                    <ul id="cell_menu" class="dropdown-menu">
                        <li id="run_cell" title="Run this cell, and move cursor to the next one">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Run Cells</a></li>
                        <li id="run_cell_select_below" title="Run this cell, select below">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Run Cells and Select Below</a></li>
                        <li id="run_cell_insert_below" title="Run this cell, insert below">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Run Cells and Insert Below</a></li>
                        <li id="run_all_cells" title="Run all cells in the notebook">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Run All</a></li>
                        <li id="run_all_cells_above" title="Run all cells above (but not including) this cell">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Run All Above</a></li>
                        <li id="run_all_cells_below" title="Run this cell and all cells below it">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Run All Below</a></li>
                        <li class="divider"></li>
                        <li id="change_cell_type" class="dropdown-submenu" title="All cells in the notebook have a cell type. By default, new cells are created as &#39;Code&#39; cells">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Cell Type</a>
                            <ul class="dropdown-menu">
                              <li id="to_code" title="Contents will be sent to the kernel for execution, and output will display in the footer of cell">
                                  <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Code</a></li>
                              <li id="to_markdown" title="Contents will be rendered as HTML and serve as explanatory text">
                                  <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Markdown</a></li>
                              <li id="to_raw" title="Contents will pass through nbconvert unmodified">
                                  <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Raw NBConvert</a></li>
                            </ul>
                        </li>
                        <li class="divider"></li>
                        <li id="current_outputs" class="dropdown-submenu"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Current Outputs</a>
                            <ul class="dropdown-menu">
                                <li id="toggle_current_output" title="Hide/Show the output of the current cell">
                                    <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Toggle</a>
                                </li>
                                <li id="toggle_current_output_scroll" title="Scroll the output of the current cell">
                                    <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_current_output" title="Clear the output of the current cell">
                                    <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Clear</a>
                                </li>
                            </ul>
                        </li>
                        <li id="all_outputs" class="dropdown-submenu"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">All Output</a>
                            <ul class="dropdown-menu">
                                <li id="toggle_all_output" title="Hide/Show the output of all cells">
                                    <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Toggle</a>
                                </li>
                                <li id="toggle_all_output_scroll" title="Scroll the output of all cells">
                                    <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_all_output" title="Clear the output of all cells">
                                    <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Clear</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Kernel</a>
                    <ul id="kernel_menu" class="dropdown-menu">
                        <li id="int_kernel" title="Send KeyboardInterrupt (CTRL-C) to the Kernel">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Interrupt</a>
                        </li>
                        <li id="restart_kernel" title="Restart the Kernel">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Restart</a>
                        </li>
                        <li id="restart_clear_output" title="Restart the Kernel and clear all output">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Restart &amp; Clear Output</a>
                        </li>
                        <li id="restart_run_all" title="Restart the Kernel and re-run the notebook">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Restart &amp; Run All</a>
                        </li>
                        <li id="reconnect_kernel" title="Reconnect to the Kernel">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Reconnect</a>
                        </li>
                        <li id="shutdown_kernel" title="Shutdown the Kernel">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Shutdown</a>
                        </li>
                        <li class="divider"></li>
                        <li id="menu-change-kernel" class="dropdown-submenu">
                            <a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Change kernel</a>
                            <ul class="dropdown-menu" id="menu-change-kernel-submenu"><li id="kernel-submenu-python2"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Python 2</a></li><li id="kernel-submenu-python3"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Python 3</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Help</a>
                    <ul id="help_menu" class="dropdown-menu">
                        
                        <li id="notebook_tour" title="A quick tour of the notebook user interface"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">User Interface Tour</a></li>
                        <li id="keyboard_shortcuts" title="Opens a dialog which shows all keyboard shortcuts"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Keyboard Shortcuts</a></li>
                        <li id="edit_keyboard_shortcuts" title="Opens a dialog allowing you to edit Keyboard shortcuts"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">Edit Keyboard Shortcuts</a></li>
                        <li class="divider"></li>
                        

                        
                            
                                <li><a rel="noreferrer" href="http://nbviewer.ipython.org/github/ipython/ipython/blob/3.x/examples/Notebook/Index.ipynb" target="_blank" title="Opens in a new window">
                                
                                    <i class="fa fa-external-link menu-icon pull-right"></i>
                                

                                Notebook Help
                                </a></li>
                            
                                <li><a rel="noreferrer" href="https://help.github.com/articles/markdown-basics/" target="_blank" title="Opens in a new window">
                                
                                    <i class="fa fa-external-link menu-icon pull-right"></i>
                                

                                Markdown
                                </a></li>
                            
                            
                        
                        <li id="kernel-help-links" class="divider"></li><li><a target="_blank" title="Opens in a new window" href="http://docs.python.org/3.6?v=20200201050731"><i class="fa fa-external-link menu-icon pull-right"></i><span>Python</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://ipython.org/documentation.html?v=20200201050731"><i class="fa fa-external-link menu-icon pull-right"></i><span>IPython</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.scipy.org/doc/numpy/reference/?v=20200201050731"><i class="fa fa-external-link menu-icon pull-right"></i><span>NumPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.scipy.org/doc/scipy/reference/?v=20200201050731"><i class="fa fa-external-link menu-icon pull-right"></i><span>SciPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://matplotlib.org/contents.html?v=20200201050731"><i class="fa fa-external-link menu-icon pull-right"></i><span>Matplotlib</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.sympy.org/latest/index.html?v=20200201050731"><i class="fa fa-external-link menu-icon pull-right"></i><span>SymPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://pandas.pydata.org/pandas-docs/stable/?v=20200201050731"><i class="fa fa-external-link menu-icon pull-right"></i><span>pandas</span></a></li><li class="divider"></li>
                        <li title="About Jupyter Notebook"><a id="notebook_about" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#">About</a></li>
                        
                    </ul>
                </li>
              </ul>
            </div>
        </div>
    </div>
</div>

<div id="maintoolbar" class="navbar">
  <div class="toolbar-inner navbar-inner navbar-nobg">
    <div id="maintoolbar-container" class="container toolbar"><div class="btn-group" id="save-notbook"><button class="btn btn-default" title="Save and Checkpoint" data-jupyter-action="jupyter-notebook:save-notebook"><i class="fa-save fa"></i></button></div><div class="btn-group" id="insert_above_below"><button class="btn btn-default" title="insert cell below" data-jupyter-action="jupyter-notebook:insert-cell-below"><i class="fa-plus fa"></i></button></div><div class="btn-group" id="cut_copy_paste"><button class="btn btn-default" title="cut selected cells" data-jupyter-action="jupyter-notebook:cut-cell"><i class="fa-cut fa"></i></button><button class="btn btn-default" title="copy selected cells" data-jupyter-action="jupyter-notebook:copy-cell"><i class="fa-copy fa"></i></button><button class="btn btn-default" title="paste cells below" data-jupyter-action="jupyter-notebook:paste-cell-below"><i class="fa-paste fa"></i></button></div><div class="btn-group" id="move_up_down"><button class="btn btn-default" title="move selected cells up" data-jupyter-action="jupyter-notebook:move-cell-up"><i class="fa-arrow-up fa"></i></button><button class="btn btn-default" title="move selected cells down" data-jupyter-action="jupyter-notebook:move-cell-down"><i class="fa-arrow-down fa"></i></button></div><div class="btn-group" id="run_int"><button class="btn btn-default" title="run cell, select below" data-jupyter-action="jupyter-notebook:run-cell-and-select-next"><i class="fa-step-forward fa"></i></button><button class="btn btn-default" title="interrupt kernel" data-jupyter-action="jupyter-notebook:interrupt-kernel"><i class="fa-stop fa"></i></button><button class="btn btn-default" title="restart the kernel (with dialog)" data-jupyter-action="jupyter-notebook:confirm-restart-kernel"><i class="fa-repeat fa"></i></button></div><select id="cell_type" class="form-control select-xs"><option value="code">Code</option><option value="markdown">Markdown</option><option value="raw">Raw NBConvert</option><option value="heading">Heading</option><option value="multiselect" disabled="disabled" style="display: none;">-</option></select><div class="btn-group"><button class="btn btn-default" title="open the command palette" data-jupyter-action="jupyter-notebook:show-command-palette"><i class="fa-keyboard-o fa"></i></button></div></div>
  </div>
</div>
</div>

<div class="lower-header-bar"></div>

</div>

<div id="site" style="height: 496px; display: block;">


<div id="ipython-main-app">
    <div id="notebook_panel">
        <div id="notebook" tabindex="-1"><div class="container" id="notebook-container"><div class="cell text_cell rendered selected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 265px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 20px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-1"># Keras tutorial - Emotion Detection in Images of Faces</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Welcome to the first assignment of week 2. In this assignment, you will:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">1. Learn to use Keras, a high-level neural networks API (programming framework), written in Python and capable of running on top of several lower-level frameworks including TensorFlow and CNTK. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">2. See how you can in a couple of hours build a deep learning algorithm.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Why are we using Keras? </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Keras was developed to enable deep learning engineers to build and experiment with different models very quickly. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Just as TensorFlow is a higher-level framework than Python, Keras is an even higher-level framework and provides additional abstractions. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Being able to go from idea to result with the least possible delay is key to finding good models. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* However, Keras is more restrictive than the lower-level frameworks, so there are some very complex models that you would still implement in TensorFlow rather than in Keras. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* That being said, Keras will work fine for many common models. </span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 265px;"></div><div class="CodeMirror-gutters" style="display: none; height: 278px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 id="Keras-tutorial---Emotion-Detection-in-Images-of-Faces">Keras tutorial - Emotion Detection in Images of Faces<a class="anchor-link" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#Keras-tutorial---Emotion-Detection-in-Images-of-Faces">¶</a></h1>
<p>Welcome to the first assignment of week 2. In this assignment, you will:</p>
<ol>
<li>Learn to use Keras, a high-level neural networks API (programming framework), written in Python and capable of running on top of several lower-level frameworks including TensorFlow and CNTK. </li>
<li>See how you can in a couple of hours build a deep learning algorithm.</li>
</ol>
<h4 id="Why-are-we-using-Keras?">Why are we using Keras?<a class="anchor-link" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#Why-are-we-using-Keras?">¶</a></h4>
<ul>
<li>Keras was developed to enable deep learning engineers to build and experiment with different models very quickly. </li>
<li>Just as TensorFlow is a higher-level framework than Python, Keras is an even higher-level framework and provides additional abstractions. </li>
<li>Being able to go from idea to result with the least possible delay is key to finding good models. </li>
<li>However, Keras is more restrictive than the lower-level frameworks, so there are some very complex models that you would still implement in TensorFlow rather than in Keras. </li>
<li>That being said, Keras will work fine for many common models. </li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 248px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## </span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'darkblue'</span><span class="cm-tag cm-bracket">&gt;</span>Updates<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">font</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### If you were working on the notebook before this update...</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The current notebook is version "v2a".</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* You can find your original work saved in the notebook with the previous version name ("v2").</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* To view the file directory, go to the menu "File-&gt;Open", and this will open a new tab that shows the file directory.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### List of updates</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Changed back-story of model to "emotion detection" from "happy house."</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Cleaned/organized wording of instructions and commentary.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Added instructions on how to set </span><span class="cm-comment cm-variable-2">`input_shape`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Added explanation of "objects as functions" syntax.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Clarified explanation of variable naming convention.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Added hints for steps 1,2,3,4</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 248px;"></div><div class="CodeMirror-gutters" style="display: none; height: 261px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Updates"><font color="darkblue">Updates</font><a class="anchor-link" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#Updates">¶</a></h2>
<h4 id="If-you-were-working-on-the-notebook-before-this-update...">If you were working on the notebook before this update...<a class="anchor-link" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#If-you-were-working-on-the-notebook-before-this-update...">¶</a></h4>
<ul>
<li>The current notebook is version "v2a".</li>
<li>You can find your original work saved in the notebook with the previous version name ("v2").</li>
<li>To view the file directory, go to the menu "File-&gt;Open", and this will open a new tab that shows the file directory.</li>
</ul>
<h4 id="List-of-updates">List of updates<a class="anchor-link" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#List-of-updates">¶</a></h4>
<ul>
<li>Changed back-story of model to "emotion detection" from "happy house."</li>
<li>Cleaned/organized wording of instructions and commentary.</li>
<li>Added instructions on how to set <code>input_shape</code></li>
<li>Added explanation of "objects as functions" syntax.</li>
<li>Clarified explanation of variable naming convention.</li>
<li>Added hints for steps 1,2,3,4</li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 63px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Load packages</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* In this exercise, you'll work on the "Emotion detection" model, which we'll explain below. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Let's load the required packages.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 63px;"></div><div class="CodeMirror-gutters" style="display: none; height: 76px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Load-packages">Load packages<a class="anchor-link" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#Load-packages">¶</a></h2>
<ul>
<li>In this exercise, you'll work on the "Emotion detection" model, which we'll explain below. </li>
<li>Let's load the required packages.</li>
</ul>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[1]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 797px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 797.26px; margin-bottom: -19px; border-right-width: 11px; min-height: 353px; padding-right: 0px; padding-bottom: 19px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span> <span class="cm-keyword">import</span> <span class="cm-variable">layers</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">layers</span> <span class="cm-keyword">import</span> <span class="cm-variable">Input</span>, <span class="cm-variable">Dense</span>, <span class="cm-variable">Activation</span>, <span class="cm-variable">ZeroPadding2D</span>, <span class="cm-variable">BatchNormalization</span>, <span class="cm-variable">Flatten</span>, <span class="cm-variable">Conv2D</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">layers</span> <span class="cm-keyword">import</span> <span class="cm-variable">AveragePooling2D</span>, <span class="cm-variable">MaxPooling2D</span>, <span class="cm-variable">Dropout</span>, <span class="cm-variable">GlobalMaxPooling2D</span>, <span class="cm-variable">GlobalAveragePooling2D</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">models</span> <span class="cm-keyword">import</span> <span class="cm-variable">Model</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">preprocessing</span> <span class="cm-keyword">import</span> <span class="cm-variable">image</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">utils</span> <span class="cm-keyword">import</span> <span class="cm-variable">layer_utils</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">utils</span>.<span class="cm-property">data_utils</span> <span class="cm-keyword">import</span> <span class="cm-variable">get_file</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">applications</span>.<span class="cm-property">imagenet_utils</span> <span class="cm-keyword">import</span> <span class="cm-variable">preprocess_input</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">pydot</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">IPython</span>.<span class="cm-property">display</span> <span class="cm-keyword">import</span> <span class="cm-variable">SVG</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">utils</span>.<span class="cm-property">vis_utils</span> <span class="cm-keyword">import</span> <span class="cm-variable">model_to_dot</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">utils</span> <span class="cm-keyword">import</span> <span class="cm-variable">plot_model</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">kt_utils</span> <span class="cm-keyword">import</span> <span class="cm-operator">*</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">keras</span>.<span class="cm-property">backend</span> <span class="cm-keyword">as</span> <span class="cm-variable">K</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">K</span>.<span class="cm-property">set_image_data_format</span>(<span class="cm-string">'channels_last'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">matplotlib</span>.<span class="cm-property">pyplot</span> <span class="cm-keyword">as</span> <span class="cm-variable">plt</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">matplotlib</span>.<span class="cm-property">pyplot</span> <span class="cm-keyword">import</span> <span class="cm-variable">imshow</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">matplotlib</span> <span class="cm-variable">inline</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 19px solid transparent; top: 353px;"></div><div class="CodeMirror-gutters" style="display: none; height: 383px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stderr"><pre>Using TensorFlow backend.
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 78px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6666px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Note**</span>: As you can see, we've imported a lot of functions from Keras. You can use them by calling them directly in your code. Ex: <span class="cm-comment">`X = Input(...)`</span> or <span class="cm-comment">`X = ZeroPadding2D(...)`</span>. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">In other words, unlike TensorFlow, you don't have to create the graph and then make a separate <span class="cm-comment">`sess.run()`</span> call to evaluate those variables.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 78px;"></div><div class="CodeMirror-gutters" style="display: none; height: 91px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Note</strong>: As you can see, we've imported a lot of functions from Keras. You can use them by calling them directly in your code. Ex: <code>X = Input(...)</code> or <code>X = ZeroPadding2D(...)</code>. </p>
<p>In other words, unlike TensorFlow, you don't have to create the graph and then make a separate <code>sess.run()</code> call to evaluate those variables.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 213px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 1 - Emotion Tracking</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* A nearby community health clinic is helping the local residents monitor their mental health.</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* As part of their study, they are asking volunteers to record their emotions throughout the day.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* To help the participants more easily track their emotions, you are asked to create an app that will classify their emotions based on some pictures that the volunteers will take of their facial expressions.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* As a proof-of-concept, you first train your model to detect if someone's emotion is classified as "happy" or "not happy."</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">To build and train this model, you have gathered pictures of some volunteers in a nearby neighborhood. The dataset is labeled.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/face_images.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:550px;height:250px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Run the following code to normalize the dataset and learn about its shapes.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 213px;"></div><div class="CodeMirror-gutters" style="display: none; height: 226px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="1---Emotion-Tracking">1 - Emotion Tracking<a class="anchor-link" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#1---Emotion-Tracking">¶</a></h2>
<ul>
<li>A nearby community health clinic is helping the local residents monitor their mental health.  </li>
<li>As part of their study, they are asking volunteers to record their emotions throughout the day.</li>
<li>To help the participants more easily track their emotions, you are asked to create an app that will classify their emotions based on some pictures that the volunteers will take of their facial expressions.</li>
<li>As a proof-of-concept, you first train your model to detect if someone's emotion is classified as "happy" or "not happy."</li>
</ul>
<p>To build and train this model, you have gathered pictures of some volunteers in a nearby neighborhood. The dataset is labeled.
<img src="./Keras_Tutorial_v2a_files/face_images.png" style="width: 550px ; height: 250px"></p>
<p>Run the following code to normalize the dataset and learn about its shapes.</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[2]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 495.781px; margin-bottom: -19px; border-right-width: 11px; min-height: 272px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">X_train_orig</span>, <span class="cm-variable">Y_train_orig</span>, <span class="cm-variable">X_test_orig</span>, <span class="cm-variable">Y_test_orig</span>, <span class="cm-variable">classes</span> = <span class="cm-variable">load_dataset</span>()</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># Normalize image vectors</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">X_train</span> = <span class="cm-variable">X_train_orig</span><span class="cm-operator">/</span><span class="cm-number">255.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">X_test</span> = <span class="cm-variable">X_test_orig</span><span class="cm-operator">/</span><span class="cm-number">255.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># Reshape</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">Y_train</span> = <span class="cm-variable">Y_train_orig</span>.<span class="cm-property">T</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">Y_test</span> = <span class="cm-variable">Y_test_orig</span>.<span class="cm-property">T</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span> (<span class="cm-string">"number of training examples = "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">X_train</span>.<span class="cm-property">shape</span>[<span class="cm-number">0</span>]))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span> (<span class="cm-string">"number of test examples = "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">X_test</span>.<span class="cm-property">shape</span>[<span class="cm-number">0</span>]))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span> (<span class="cm-string">"X_train shape: "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">X_train</span>.<span class="cm-property">shape</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span> (<span class="cm-string">"Y_train shape: "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">Y_train</span>.<span class="cm-property">shape</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span> (<span class="cm-string">"X_test shape: "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">X_test</span>.<span class="cm-property">shape</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span> (<span class="cm-string">"Y_test shape: "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">Y_test</span>.<span class="cm-property">shape</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 272px;"></div><div class="CodeMirror-gutters" style="display: none; height: 283px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>number of training examples = 600
number of test examples = 150
X_train shape: (600, 64, 64, 3)
Y_train shape: (600, 1)
X_test shape: (150, 64, 64, 3)
Y_test shape: (150, 1)
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 78px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Details of the "Face" dataset**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Images are of shape (64,64,3)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Training: 600 pictures</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Test: 150 pictures</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 78px;"></div><div class="CodeMirror-gutters" style="display: none; height: 91px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Details of the "Face" dataset</strong>:</p>
<ul>
<li>Images are of shape (64,64,3)</li>
<li>Training: 600 pictures</li>
<li>Test: 150 pictures</li>
</ul>
</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 663px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 2 - Building a model in Keras</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Keras is very good for rapid prototyping. In just a short time you will be able to build a model that achieves outstanding results.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Here is an example of a model in Keras:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```python</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">model</span>(<span class="cm-variable">input_shape</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string">input_shape: The height, width and channels as a tuple. &nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">Note that this does not include the 'batch' as a dimension.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">If you have a batch like 'X_train', </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">then you can provide the input_shape using</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">X_train.shape[1:]</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># Define the input placeholder as a tensor with shape input_shape. Think of this as your input image!</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">X_input</span> = <span class="cm-variable">Input</span>(<span class="cm-variable">input_shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># Zero-Padding: pads the border of X_input with zeroes</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">X</span> = <span class="cm-variable">ZeroPadding2D</span>((<span class="cm-number">3</span>, <span class="cm-number">3</span>))(<span class="cm-variable">X_input</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># CONV -&gt; BN -&gt; RELU Block applied to X</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">X</span> = <span class="cm-variable">Conv2D</span>(<span class="cm-number">32</span>, (<span class="cm-number">7</span>, <span class="cm-number">7</span>), <span class="cm-variable">strides</span> = (<span class="cm-number">1</span>, <span class="cm-number">1</span>), <span class="cm-variable">name</span> = <span class="cm-string">'conv0'</span>)(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">X</span> = <span class="cm-variable">BatchNormalization</span>(<span class="cm-variable">axis</span> = <span class="cm-number">3</span>, <span class="cm-variable">name</span> = <span class="cm-string">'bn0'</span>)(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">X</span> = <span class="cm-variable">Activation</span>(<span class="cm-string">'relu'</span>)(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># MAXPOOL</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">X</span> = <span class="cm-variable">MaxPooling2D</span>((<span class="cm-number">2</span>, <span class="cm-number">2</span>), <span class="cm-variable">name</span>=<span class="cm-string">'max_pool'</span>)(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># FLATTEN X (means convert it to a vector) + FULLYCONNECTED</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">X</span> = <span class="cm-variable">Flatten</span>()(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">X</span> = <span class="cm-variable">Dense</span>(<span class="cm-number">1</span>, <span class="cm-variable">activation</span>=<span class="cm-string">'sigmoid'</span>, <span class="cm-variable">name</span>=<span class="cm-string">'fc'</span>)(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># Create model. This creates your Keras model instance, you'll use this instance to train/test the model.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">model</span> = <span class="cm-variable">Model</span>(<span class="cm-variable">inputs</span> = <span class="cm-variable">X_input</span>, <span class="cm-variable">outputs</span> = <span class="cm-variable">X</span>, <span class="cm-variable">name</span>=<span class="cm-string">'HappyModel'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">model</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 663px;"></div><div class="CodeMirror-gutters" style="display: none; height: 676px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="2---Building-a-model-in-Keras">2 - Building a model in Keras<a class="anchor-link" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#2---Building-a-model-in-Keras">¶</a></h2>
<p>Keras is very good for rapid prototyping. In just a short time you will be able to build a model that achieves outstanding results.</p>
<p>Here is an example of a model in Keras:</p>
<pre><code class="cm-s-ipython language-python"><span class="cm-keyword">def</span> <span class="cm-def">model</span>(<span class="cm-variable">input_shape</span>):
    <span class="cm-string">"""</span>
<span class="cm-string">    input_shape: The height, width and channels as a tuple.  </span>
<span class="cm-string">        Note that this does not include the 'batch' as a dimension.</span>
<span class="cm-string">        If you have a batch like 'X_train', </span>
<span class="cm-string">        then you can provide the input_shape using</span>
<span class="cm-string">        X_train.shape[1:]</span>
<span class="cm-string">    """</span>

    <span class="cm-comment"># Define the input placeholder as a tensor with shape input_shape. Think of this as your input image!</span>
    <span class="cm-variable">X_input</span> = <span class="cm-variable">Input</span>(<span class="cm-variable">input_shape</span>)

    <span class="cm-comment"># Zero-Padding: pads the border of X_input with zeroes</span>
    <span class="cm-variable">X</span> = <span class="cm-variable">ZeroPadding2D</span>((<span class="cm-number">3</span>, <span class="cm-number">3</span>))(<span class="cm-variable">X_input</span>)

    <span class="cm-comment"># CONV -&gt; BN -&gt; RELU Block applied to X</span>
    <span class="cm-variable">X</span> = <span class="cm-variable">Conv2D</span>(<span class="cm-number">32</span>, (<span class="cm-number">7</span>, <span class="cm-number">7</span>), <span class="cm-variable">strides</span> = (<span class="cm-number">1</span>, <span class="cm-number">1</span>), <span class="cm-variable">name</span> = <span class="cm-string">'conv0'</span>)(<span class="cm-variable">X</span>)
    <span class="cm-variable">X</span> = <span class="cm-variable">BatchNormalization</span>(<span class="cm-variable">axis</span> = <span class="cm-number">3</span>, <span class="cm-variable">name</span> = <span class="cm-string">'bn0'</span>)(<span class="cm-variable">X</span>)
    <span class="cm-variable">X</span> = <span class="cm-variable">Activation</span>(<span class="cm-string">'relu'</span>)(<span class="cm-variable">X</span>)

    <span class="cm-comment"># MAXPOOL</span>
    <span class="cm-variable">X</span> = <span class="cm-variable">MaxPooling2D</span>((<span class="cm-number">2</span>, <span class="cm-number">2</span>), <span class="cm-variable">name</span>=<span class="cm-string">'max_pool'</span>)(<span class="cm-variable">X</span>)

    <span class="cm-comment"># FLATTEN X (means convert it to a vector) + FULLYCONNECTED</span>
    <span class="cm-variable">X</span> = <span class="cm-variable">Flatten</span>()(<span class="cm-variable">X</span>)
    <span class="cm-variable">X</span> = <span class="cm-variable">Dense</span>(<span class="cm-number">1</span>, <span class="cm-variable">activation</span>=<span class="cm-string">'sigmoid'</span>, <span class="cm-variable">name</span>=<span class="cm-string">'fc'</span>)(<span class="cm-variable">X</span>)

    <span class="cm-comment"># Create model. This creates your Keras model instance, you'll use this instance to train/test the model.</span>
    <span class="cm-variable">model</span> = <span class="cm-variable">Model</span>(<span class="cm-variable">inputs</span> = <span class="cm-variable">X_input</span>, <span class="cm-variable">outputs</span> = <span class="cm-variable">X</span>, <span class="cm-variable">name</span>=<span class="cm-string">'HappyModel'</span>)

    <span class="cm-keyword">return</span> <span class="cm-variable">model</span>
</code></pre>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 279px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.3333px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Variable naming convention</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Note that Keras uses a different convention with variable names than we've previously used with numpy and TensorFlow. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Instead of creating unique variable names for each step and each layer, such as </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">X = ...</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">Z1 = ...</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">A1 = ...</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Keras re-uses and overwrites the same variable at each step:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">X = ...</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">X = ...</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">X = ...</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The exception is </span><span class="cm-comment cm-variable-2">`X_input`</span><span class="cm-variable-2">, which we kept separate since it's needed later.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 279px;"></div><div class="CodeMirror-gutters" style="display: none; height: 292px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="Variable-naming-convention">Variable naming convention<a class="anchor-link" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#Variable-naming-convention">¶</a></h4>
<ul>
<li>Note that Keras uses a different convention with variable names than we've previously used with numpy and TensorFlow. </li>
<li>Instead of creating unique variable names for each step and each layer, such as <pre><code>X = ...
Z1 = ...
A1 = ...
</code></pre></li>
<li>Keras re-uses and overwrites the same variable at each step:<pre><code>X = ...
X = ...
X = ...
</code></pre></li>
<li>The exception is <code>X_input</code>, which we kept separate since it's needed later.</li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 229px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.3333px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Objects as functions</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Notice how there are two pairs of parentheses in each statement.  For example:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">X = ZeroPadding2D((3, 3))(X_input)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The first is a constructor call which creates an object (ZeroPadding2D).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* In Python, objects can be called as functions. Search for 'python object as function and you can read this blog post </span><span class="cm-link cm-variable-2">[Python Pandemonium]</span><span class="cm-string cm-url cm-variable-2">(https://medium.com/python-pandemonium/function-as-objects-in-python-d5215e6d1b0d)</span><span class="cm-variable-2">.  See the section titled "Objects as functions."</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The single line is equivalent to this:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">ZP = ZeroPadding2D((3, 3)) # ZP is an object that can be called as a function</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">X = ZP(X_input) </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 229px;"></div><div class="CodeMirror-gutters" style="display: none; height: 242px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="Objects-as-functions">Objects as functions<a class="anchor-link" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#Objects-as-functions">¶</a></h4>
<ul>
<li>Notice how there are two pairs of parentheses in each statement.  For example:<pre><code>X = ZeroPadding2D((3, 3))(X_input)
</code></pre></li>
<li>The first is a constructor call which creates an object (ZeroPadding2D).</li>
<li>In Python, objects can be called as functions. Search for 'python object as function and you can read this blog post <a href="https://medium.com/python-pandemonium/function-as-objects-in-python-d5215e6d1b0d" target="_blank">Python Pandemonium</a>.  See the section titled "Objects as functions."</li>
<li>The single line is equivalent to this:<pre><code>ZP = ZeroPadding2D((3, 3)) # ZP is an object that can be called as a function
X = ZP(X_input)
</code></pre></li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 161px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Exercise**</span>: Implement a <span class="cm-comment">`HappyModel()`</span>.<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* This assignment is more open-ended than most. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Start by implementing a model using the architecture we suggest, and run through the rest of this assignment using that as your initial model. * Later, come back and try out other model architectures. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* For example, you might take inspiration from the model above, but then vary the network architecture and hyperparameters however you wish. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* You can also use other functions such as </span><span class="cm-comment cm-variable-2">`AveragePooling2D()`</span><span class="cm-variable-2">, </span><span class="cm-comment cm-variable-2">`GlobalMaxPooling2D()`</span><span class="cm-variable-2">, </span><span class="cm-comment cm-variable-2">`Dropout()`</span><span class="cm-variable-2">. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Note**</span>: Be careful with your data's shapes. Use what you've learned in the videos to make sure your convolutional, pooling and fully-connected layers are adapted to the volumes you're applying it to.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 161px;"></div><div class="CodeMirror-gutters" style="display: none; height: 174px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Exercise</strong>: Implement a <code>HappyModel()</code>.  </p>
<ul>
<li>This assignment is more open-ended than most. </li>
<li>Start by implementing a model using the architecture we suggest, and run through the rest of this assignment using that as your initial model. * Later, come back and try out other model architectures. </li>
<li>For example, you might take inspiration from the model above, but then vary the network architecture and hyperparameters however you wish. </li>
<li>You can also use other functions such as <code>AveragePooling2D()</code>, <code>GlobalMaxPooling2D()</code>, <code>Dropout()</code>. </li>
</ul>
<p><strong>Note</strong>: Be careful with your data's shapes. Use what you've learned in the videos to make sure your convolutional, pooling and fully-connected layers are adapted to the volumes you're applying it to.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[6]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 690.035px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 711.889px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 711.889px; margin-bottom: -19px; border-right-width: 11px; min-height: 761px; padding-right: 0px; padding-bottom: 19px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 0px; top: 684.444px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># GRADED FUNCTION: HappyModel</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">HappyModel</span>(<span class="cm-variable">input_shape</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Implementation of the HappyModel.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    input_shape -- shape of the images of the dataset</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">        (height, width, channels) as a tuple.  </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">        Note that this does not include the 'batch' as a dimension.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">        If you have a batch like 'X_train', </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">        then you can provide the input_shape using</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">        X_train.shape[1:]</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    model -- a Model() instance in Keras</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Feel free to use the suggested outline in the text above to get started, and run through the whole</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># exercise (including the later portions of this notebook) once. The come back also try out other</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># network architectures as well. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Define the input placeholder as a tensor with shape input_shape. Think of this as your input image!</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">X_input</span> = <span class="cm-variable">Input</span>(<span class="cm-variable">input_shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Zero-Padding: pads the border of X_input with zeroes</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">X</span> = <span class="cm-variable">ZeroPadding2D</span>((<span class="cm-number">3</span>, <span class="cm-number">3</span>))(<span class="cm-variable">X_input</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># CONV -&gt; BN -&gt; RELU Block applied to X</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">X</span> = <span class="cm-variable">Conv2D</span>(<span class="cm-number">32</span>, (<span class="cm-number">7</span>, <span class="cm-number">7</span>), <span class="cm-variable">strides</span> = (<span class="cm-number">1</span>, <span class="cm-number">1</span>), <span class="cm-variable">name</span> = <span class="cm-string">'conv0'</span>)(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">X</span> = <span class="cm-variable">BatchNormalization</span>(<span class="cm-variable">axis</span> = <span class="cm-number">3</span>, <span class="cm-variable">name</span> = <span class="cm-string">'bn0'</span>)(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">X</span> = <span class="cm-variable">Activation</span>(<span class="cm-string">'relu'</span>)(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># MAXPOOL</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">X</span> = <span class="cm-variable">MaxPooling2D</span>((<span class="cm-number">2</span>, <span class="cm-number">2</span>), <span class="cm-variable">name</span>=<span class="cm-string">'max_pool'</span>)(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># FLATTEN X (means convert it to a vector) + FULLYCONNECTED</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">X</span> = <span class="cm-variable">Flatten</span>()(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">X</span> = <span class="cm-variable">Dense</span>(<span class="cm-number">1</span>, <span class="cm-variable">activation</span>=<span class="cm-string">'sigmoid'</span>, <span class="cm-variable">name</span>=<span class="cm-string">'fc'</span>)(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Create model. This creates your Keras model instance, you'll use this instance to train/test the model.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">model</span> = <span class="cm-variable">Model</span>(<span class="cm-variable">inputs</span> = <span class="cm-variable">X_input</span>, <span class="cm-variable">outputs</span> = <span class="cm-variable">X</span>, <span class="cm-variable">name</span>=<span class="cm-string">'HappyModel'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">model</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 19px solid transparent; top: 761px;"></div><div class="CodeMirror-gutters" style="display: none; height: 791px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 195px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">You have now built a function to describe your model. To train and test this model, there are four steps in Keras:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">1. Create the model by calling the function above</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">2. Compile the model by calling </span><span class="cm-comment cm-variable-2">`model.compile(optimizer = "...", loss = "...", metrics = ["accuracy"])`</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">3. Train the model on train data by calling </span><span class="cm-comment cm-variable-2">`model.fit(x = ..., y = ..., epochs = ..., batch_size = ...)`</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">4. Test the model on test data by calling </span><span class="cm-comment cm-variable-2">`model.evaluate(x = ..., y = ...)`</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">If you want to know more about <span class="cm-comment">`model.compile()`</span>, <span class="cm-comment">`model.fit()`</span>, <span class="cm-comment">`model.evaluate()`</span> and their arguments, refer to the official <span class="cm-link">[Keras documentation]</span><span class="cm-string cm-url">(https://keras.io/models/model/)</span>.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 195px;"></div><div class="CodeMirror-gutters" style="display: none; height: 208px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>You have now built a function to describe your model. To train and test this model, there are four steps in Keras:</p>
<ol>
<li><p>Create the model by calling the function above  </p>
</li>
<li><p>Compile the model by calling <code>model.compile(optimizer = "...", loss = "...", metrics = ["accuracy"])</code>  </p>
</li>
<li><p>Train the model on train data by calling <code>model.fit(x = ..., y = ..., epochs = ..., batch_size = ...)</code>  </p>
</li>
<li><p>Test the model on test data by calling <code>model.evaluate(x = ..., y = ...)</code>  </p>
</li>
</ol>
<p>If you want to know more about <code>model.compile()</code>, <code>model.fit()</code>, <code>model.evaluate()</code> and their arguments, refer to the official <a href="https://keras.io/models/model/" target="_blank">Keras documentation</a>.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 79px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.3333px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Step 1: create the model.</span><span class="cm-header cm-header-4 cm-trailing-space-a"> </span><span class="cm-header cm-header-4 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Hint**</span>:<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The <span class="cm-comment">`input_shape`</span> parameter is a tuple (height, width, channels).  It excludes the batch number.<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Try <span class="cm-comment">`X_train.shape[1:]`</span> as the <span class="cm-comment">`input_shape`</span>.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 79px;"></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="Step-1:-create-the-model.">Step 1: create the model.<a class="anchor-link" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#Step-1:-create-the-model.">¶</a></h4>
<p><strong>Hint</strong>:<br>The <code>input_shape</code> parameter is a tuple (height, width, channels).  It excludes the batch number.<br>Try <code>X_train.shape[1:]</code> as the <code>input_shape</code>.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[9]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 21.8866px; left: 234.352px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 309.435px; margin-bottom: -19px; border-right-width: 11px; min-height: 60px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 228.762px; top: 16.2963px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">### START CODE HERE ### (1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">happyModel</span> = <span class="cm-variable">HappyModel</span>(<span class="cm-variable">X_train</span>[<span class="cm-number">0</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">### END CODE HERE ###</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 60px;"></div><div class="CodeMirror-gutters" style="display: none; height: 71px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 129px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.3333px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Step 2: compile the model</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Hint**</span>:<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Optimizers you can try include <span class="cm-comment">`'adam'`</span>, <span class="cm-comment">`'sgd'`</span> or others.  See the documentation for <span class="cm-link">[optimizers]</span><span class="cm-string cm-url">(https://keras.io/optimizers/)</span><span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The "happiness detection" is a binary classification problem.  The loss function that you can use is <span class="cm-comment">`'binary_cross_entropy'`</span>.  Note that <span class="cm-comment">`'categorical_cross_entropy'`</span> won't work with your data set as its formatted, because the data is an array of 0 or 1 rather than two arrays (one for each category).  Documentation for <span class="cm-link">[losses]</span><span class="cm-string cm-url">(https://keras.io/losses/)</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 129px;"></div><div class="CodeMirror-gutters" style="display: none; height: 142px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="Step-2:-compile-the-model">Step 2: compile the model<a class="anchor-link" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#Step-2:-compile-the-model">¶</a></h4>
<p><strong>Hint</strong>:<br>Optimizers you can try include <code>'adam'</code>, <code>'sgd'</code> or others.  See the documentation for <a href="https://keras.io/optimizers/" target="_blank">optimizers</a><br>The "happiness detection" is a binary classification problem.  The loss function that you can use is <code>'binary_cross_entropy'</code>.  Note that <code>'categorical_cross_entropy'</code> won't work with your data set as its formatted, because the data is an array of 0 or 1 rather than two arrays (one for each category).  Documentation for <a href="https://keras.io/losses/" target="_blank">losses</a></p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[11]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 21.8866px; left: 532px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 634px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 634.042px; margin-bottom: -19px; border-right-width: 11px; min-height: 60px; padding-right: 0px; padding-bottom: 19px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 631.042px; top: 16.2963px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">### START CODE HERE ### (1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">happyModel</span>.<span class="cm-property">compile</span>(<span class="cm-variable">optimizer</span> = <span class="cm-string">'adam'</span>, <span class="cm-variable">loss</span> = <span class="cm-string">"binary_crossentropy"</span>, <span class="cm-variable">metrics</span> = [<span class="cm-string">"accuracy"</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">### END CODE HERE ###</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 19px solid transparent; top: 60px;"></div><div class="CodeMirror-gutters" style="display: none; height: 90px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 112px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.3333px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Step 3: train the model</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Hint**</span>:<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Use the <span class="cm-comment">`'X_train'`</span>, <span class="cm-comment">`'Y_train'`</span> variables.  Use integers for the epochs and batch_size</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Note**</span>: If you run <span class="cm-comment">`fit()`</span> again, the <span class="cm-comment">`model`</span> will continue to train with the parameters it has already learned instead of reinitializing them.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 112px;"></div><div class="CodeMirror-gutters" style="display: none; height: 125px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="Step-3:-train-the-model">Step 3: train the model<a class="anchor-link" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#Step-3:-train-the-model">¶</a></h4>
<p><strong>Hint</strong>:<br>Use the <code>'X_train'</code>, <code>'Y_train'</code> variables.  Use integers for the epochs and batch_size</p>
<p><strong>Note</strong>: If you run <code>fit()</code> again, the <code>model</code> will continue to train with the parameters it has already learned instead of reinitializing them.</p>
</div></div></div><div class="cell code_cell rendered running unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[*]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 21.8866px; left: 461.262px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 458.671px; margin-bottom: -19px; border-right-width: 11px; min-height: 60px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 455.671px; top: 16.2963px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">### START CODE HERE ### (1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">happyModel</span>.<span class="cm-property">fit</span>(<span class="cm-variable">x</span> = <span class="cm-variable">X_train</span>, <span class="cm-variable">y</span> = <span class="cm-variable">Y_train</span>, <span class="cm-variable">epochs</span> = <span class="cm-number">5</span>, <span class="cm-variable">batch_size</span> = <span class="cm-number">16</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">### END CODE HERE ###</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 60px;"></div><div class="CodeMirror-gutters" style="display: none; height: 71px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Epoch 1/5
600/600 [==============================] - 12s - loss: 1.2748 - acc: 0.6817    
Epoch 2/5
600/600 [==============================] - 12s - loss: 0.2131 - acc: 0.9067    
Epoch 3/5
600/600 [==============================] - 12s - loss: 0.1451 - acc: 0.9533    
Epoch 4/5
600/600 [==============================] - 12s - loss: 0.1239 - acc: 0.9533    
Epoch 5/5
600/600 [==============================] - 12s - loss: 0.1649 - acc: 0.9350    
</pre></div></div><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[12]:</div><div class="output_subarea output_text output_result"><pre>&lt;keras.callbacks.History at 0x7fcc97117fd0&gt;</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 62px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.3333px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Step 4: evaluate model</span><span class="cm-header cm-header-4 cm-trailing-space-a"> </span><span class="cm-header cm-header-4 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Hint**</span>:<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Use the <span class="cm-comment">`'X_test'`</span> and <span class="cm-comment">`'Y_test'`</span> variables to evaluate the model's performance.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 62px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="Step-4:-evaluate-model">Step 4: evaluate model<a class="anchor-link" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#Step-4:-evaluate-model">¶</a></h4>
<p><strong>Hint</strong>:<br>Use the <code>'X_test'</code> and <code>'Y_test'</code> variables to evaluate the model's performance.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[13]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 87.0717px; left: 264.757px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 352.19px; margin-bottom: -19px; border-right-width: 11px; min-height: 109px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 259.167px; top: 81.4815px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">### START CODE HERE ### (1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">preds</span> = <span class="cm-variable">happyModel</span>.<span class="cm-property">evaluate</span>(<span class="cm-variable">x</span> = <span class="cm-variable">X_test</span>, <span class="cm-variable">y</span> = <span class="cm-variable">Y_test</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>()</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span> (<span class="cm-string">"Loss = "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">preds</span>[<span class="cm-number">0</span>]))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span> (<span class="cm-string">"Test Accuracy = "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">preds</span>[<span class="cm-number">1</span>]))</span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 109px;"></div><div class="CodeMirror-gutters" style="display: none; height: 120px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>150/150 [==============================] - 1s     

Loss = 0.26378854394
Test Accuracy = 0.94666667064
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 95px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.3333px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Expected performance</span><span class="cm-header cm-header-4 cm-trailing-space-a"> </span><span class="cm-header cm-header-4 cm-trailing-space-b">&nbsp;</span><span class="cm-header cm-header-4 cm-trailing-space-new-line"> </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">If your <span class="cm-comment">`happyModel()`</span> function worked, its accuracy should be better than random guessing (50% accuracy).</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">To give you a point of comparison, our model gets around <span class="cm-strong">**95% test accuracy in 40 epochs**</span> (and 99% train accuracy) with a mini batch size of 16 and "adam" optimizer.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 95px;"></div><div class="CodeMirror-gutters" style="display: none; height: 108px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="Expected-performance">Expected performance<a class="anchor-link" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#Expected-performance">¶</a></h4>
<p>If your <code>happyModel()</code> function worked, its accuracy should be better than random guessing (50% accuracy).</p>
<p>To give you a point of comparison, our model gets around <strong>95% test accuracy in 40 epochs</strong> (and 99% train accuracy) with a mini batch size of 16 and "adam" optimizer.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 345px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.3333px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Tips for improving your model</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">If you have not yet achieved a very good accuracy (&gt;= 80%), here are some things tips:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Use blocks of CONV-&gt;BATCHNORM-&gt;RELU such as:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```python</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">X</span> = <span class="cm-variable">Conv2D</span>(<span class="cm-number">32</span>, (<span class="cm-number">3</span>, <span class="cm-number">3</span>), <span class="cm-variable">strides</span> = (<span class="cm-number">1</span>, <span class="cm-number">1</span>), <span class="cm-variable">name</span> = <span class="cm-string">'conv0'</span>)(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">X</span> = <span class="cm-variable">BatchNormalization</span>(<span class="cm-variable">axis</span> = <span class="cm-number">3</span>, <span class="cm-variable">name</span> = <span class="cm-string">'bn0'</span>)(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">X</span> = <span class="cm-variable">Activation</span>(<span class="cm-string">'relu'</span>)(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">until your height and width dimensions are quite low and your number of channels quite large (≈32 for example).<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">You can then flatten the volume and use a fully-connected layer.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Use MAXPOOL after such blocks.  It will help you lower the dimension in height and width.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Change your optimizer. We find 'adam' works well. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- If you get memory issues, lower your batch_size (e.g. 12 )</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Run more epochs until you see the train accuracy no longer improves. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Note**</span>: If you perform hyperparameter tuning on your model, the test set actually becomes a dev set, and your model might end up overfitting to the test (dev) set. Normally, you'll want separate dev and test sets.  The dev set is used for parameter tuning, and the test set is used once to estimate the model's performance in production.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 345px;"></div><div class="CodeMirror-gutters" style="display: none; height: 358px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="Tips-for-improving-your-model">Tips for improving your model<a class="anchor-link" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#Tips-for-improving-your-model">¶</a></h4>
<p>If you have not yet achieved a very good accuracy (&gt;= 80%), here are some things tips:</p>
<ul>
<li>Use blocks of CONV-&gt;BATCHNORM-&gt;RELU such as:<pre><code class="cm-s-ipython language-python"><span class="cm-variable">X</span> = <span class="cm-variable">Conv2D</span>(<span class="cm-number">32</span>, (<span class="cm-number">3</span>, <span class="cm-number">3</span>), <span class="cm-variable">strides</span> = (<span class="cm-number">1</span>, <span class="cm-number">1</span>), <span class="cm-variable">name</span> = <span class="cm-string">'conv0'</span>)(<span class="cm-variable">X</span>)
<span class="cm-variable">X</span> = <span class="cm-variable">BatchNormalization</span>(<span class="cm-variable">axis</span> = <span class="cm-number">3</span>, <span class="cm-variable">name</span> = <span class="cm-string">'bn0'</span>)(<span class="cm-variable">X</span>)
<span class="cm-variable">X</span> = <span class="cm-variable">Activation</span>(<span class="cm-string">'relu'</span>)(<span class="cm-variable">X</span>)
</code></pre>
until your height and width dimensions are quite low and your number of channels quite large (≈32 for example).<br>You can then flatten the volume and use a fully-connected layer.</li>
<li>Use MAXPOOL after such blocks.  It will help you lower the dimension in height and width.</li>
<li>Change your optimizer. We find 'adam' works well. </li>
<li>If you get memory issues, lower your batch_size (e.g. 12 )</li>
<li>Run more epochs until you see the train accuracy no longer improves. </li>
</ul>
<p><strong>Note</strong>: If you perform hyperparameter tuning on your model, the test set actually becomes a dev set, and your model might end up overfitting to the test (dev) set. Normally, you'll want separate dev and test sets.  The dev set is used for parameter tuning, and the test set is used once to estimate the model's performance in production.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 63px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 3 - Conclusion</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Congratulations, you have created a proof of concept for "happiness detection"!</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 63px;"></div><div class="CodeMirror-gutters" style="display: none; height: 76px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="3---Conclusion">3 - Conclusion<a class="anchor-link" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#3---Conclusion">¶</a></h2>
<p>Congratulations, you have created a proof of concept for "happiness detection"!</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 163px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Key Points to remember</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Keras is a tool we recommend for rapid prototyping. It allows you to quickly try out different model architectures.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Remember The four steps in Keras: </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">1. Create</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">2. Compile</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">3. Fit/Train</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">4. Evaluate/Test</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line">&nbsp;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 163px;"></div><div class="CodeMirror-gutters" style="display: none; height: 176px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Key-Points-to-remember">Key Points to remember<a class="anchor-link" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#Key-Points-to-remember">¶</a></h2>
<ul>
<li>Keras is a tool we recommend for rapid prototyping. It allows you to quickly try out different model architectures.</li>
<li>Remember The four steps in Keras: </li>
</ul>
<ol>
<li>Create  </li>
<li>Compile  </li>
<li>Fit/Train  </li>
<li>Evaluate/Test  </li>
</ol>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 247px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 4 - Test with your own image (Optional)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Congratulations on finishing this assignment. You can now take a picture of your face and see if it can classify whether your expression is "happy" or "not happy". To do that:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">1. Click on "File" in the upper bar of this notebook, then click "Open" to go on your Coursera Hub.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">2. Add your image to this Jupyter Notebook's directory, in the "images" folder</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">3. Write your image's name in the following code</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">4. Run the code and check if the algorithm is right (0 is not happy, 1 is happy)!</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The training/test sets were quite similar; for example, all the pictures were taken against the same background (since a front door camera is always mounted in the same position). This makes the problem easier, but a model trained on this data may or may not work on your own data. But feel free to give it a try! </span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 247px;"></div><div class="CodeMirror-gutters" style="display: none; height: 260px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="4---Test-with-your-own-image-(Optional)">4 - Test with your own image (Optional)<a class="anchor-link" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#4---Test-with-your-own-image-(Optional)">¶</a></h2>
<p>Congratulations on finishing this assignment. You can now take a picture of your face and see if it can classify whether your expression is "happy" or "not happy". To do that:</p>
<ol>
<li>Click on "File" in the upper bar of this notebook, then click "Open" to go on your Coursera Hub.</li>
<li>Add your image to this Jupyter Notebook's directory, in the "images" folder</li>
<li>Write your image's name in the following code</li>
<li>Run the code and check if the algorithm is right (0 is not happy, 1 is happy)!</li>
</ol>
<p>The training/test sets were quite similar; for example, all the pictures were taken against the same background (since a front door camera is always mounted in the same position). This makes the problem easier, but a model trained on this data may or may not work on your own data. But feel free to give it a try! </p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[14]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 103.368px; left: 197.35px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 364.852px; margin-bottom: -19px; border-right-width: 11px; min-height: 190px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 191.759px; top: 97.7778px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">### START CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">img_path</span> = <span class="cm-string">'images/my_image.jpg'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">img</span> = <span class="cm-variable">image</span>.<span class="cm-property">load_img</span>(<span class="cm-variable">img_path</span>, <span class="cm-variable">target_size</span>=(<span class="cm-number">64</span>, <span class="cm-number">64</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">imshow</span>(<span class="cm-variable">img</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">x</span> = <span class="cm-variable">image</span>.<span class="cm-property">img_to_array</span>(<span class="cm-variable">img</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">x</span> = <span class="cm-variable">np</span>.<span class="cm-property">expand_dims</span>(<span class="cm-variable">x</span>, <span class="cm-variable">axis</span>=<span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">x</span> = <span class="cm-variable">preprocess_input</span>(<span class="cm-variable">x</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">happyModel</span>.<span class="cm-property">predict</span>(<span class="cm-variable">x</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 190px;"></div><div class="CodeMirror-gutters" style="display: none; height: 201px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>[[  2.02867959e-05]]
</pre></div></div><div class="output_area"><div class="prompt"></div><div class="output_subarea output_png"><img src="data:image/png;base64,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%0AF7+GRori/wOMhrX8XuEH+AAAAABJRU5ErkJggg=="></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 147px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 5 - Other useful functions in Keras (Optional)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Two other basic features of Keras that you'll find useful are:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-comment cm-variable-2">`model.summary()`</span><span class="cm-variable-2">: prints the details of your layers in a table with the sizes of its inputs/outputs</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-comment cm-variable-2">`plot_model()`</span><span class="cm-variable-2">: plots your graph in a nice layout. You can even save it as ".png" using SVG() if you'd like to share it on social media ;). It is saved in "File" then "Open..." in the upper bar of the notebook.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Run the following code.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 147px;"></div><div class="CodeMirror-gutters" style="display: none; height: 160px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="5---Other-useful-functions-in-Keras-(Optional)">5 - Other useful functions in Keras (Optional)<a class="anchor-link" href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#5---Other-useful-functions-in-Keras-(Optional)">¶</a></h2>
<p>Two other basic features of Keras that you'll find useful are:</p>
<ul>
<li><code>model.summary()</code>: prints the details of your layers in a table with the sizes of its inputs/outputs</li>
<li><code>plot_model()</code>: plots your graph in a nice layout. You can even save it as ".png" using SVG() if you'd like to share it on social media ;). It is saved in "File" then "Open..." in the upper bar of the notebook.</li>
</ul>
<p>Run the following code.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[15]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59027px; left: 164.942px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 162.352px; margin-bottom: -19px; border-right-width: 11px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 159.352px; top: 0px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">happyModel</span>.<span class="cm-property">summary</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 38px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 64, 64, 3)         0         
_________________________________________________________________
zero_padding2d_2 (ZeroPaddin (None, 70, 70, 3)         0         
_________________________________________________________________
conv0 (Conv2D)               (None, 64, 64, 32)        4736      
_________________________________________________________________
bn0 (BatchNormalization)     (None, 64, 64, 32)        128       
_________________________________________________________________
activation_2 (Activation)    (None, 64, 64, 32)        0         
_________________________________________________________________
max_pool (MaxPooling2D)      (None, 32, 32, 32)        0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 32768)             0         
_________________________________________________________________
fc (Dense)                   (None, 1)                 32769     
=================================================================
Total params: 37,633
Trainable params: 37,569
Non-trainable params: 64
_________________________________________________________________
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[16]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 21.8866px; left: 373.31px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 446.472px; margin-bottom: -19px; border-right-width: 11px; min-height: 44px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 367.72px; top: 16.2963px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">plot_model</span>(<span class="cm-variable">happyModel</span>, <span class="cm-variable">to_file</span>=<span class="cm-string">'HappyModel.png'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">SVG</span>(<span class="cm-variable">model_to_dot</span>(<span class="cm-variable">happyModel</span>).<span class="cm-property">create</span>(<span class="cm-variable">prog</span>=<span class="cm-string">'dot'</span>, <span class="cm-builtin">format</span>=<span class="cm-string">'svg'</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 55px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[16]:</div><div class="output_subarea output_svg output_result"><div style="width: 219pt; height: 556pt;"><svg height="556pt" viewBox="0.00 0.00 219.00 556.00" width="219pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="width: 100%; height: 100%;">
<g class="graph" id="graph0" transform="scale(1 1) rotate(0) translate(4 552)">
<title>G</title>
<polygon fill="white" points="-4,4 -4,-552 215,-552 215,4 -4,4" stroke="none"></polygon>
<!-- 140516683423528 -->
<g class="node" id="node1"><title>140516683423528</title>
<polygon fill="none" points="43,-511.5 43,-547.5 168,-547.5 168,-511.5 43,-511.5" stroke="black"></polygon>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="105.5" y="-525.8">input_2: InputLayer</text>
</g>
<!-- 140516683524472 -->
<g class="node" id="node2"><title>140516683524472</title>
<polygon fill="none" points="0,-438.5 0,-474.5 211,-474.5 211,-438.5 0,-438.5" stroke="black"></polygon>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="105.5" y="-452.8">zero_padding2d_2: ZeroPadding2D</text>
</g>
<!-- 140516683423528&#45;&gt;140516683524472 -->
<g class="edge" id="edge1"><title>140516683423528-&gt;140516683524472</title>
<path d="M105.5,-511.313C105.5,-503.289 105.5,-493.547 105.5,-484.569" fill="none" stroke="black"></path>
<polygon fill="black" points="109,-484.529 105.5,-474.529 102,-484.529 109,-484.529" stroke="black"></polygon>
</g>
<!-- 140516683523688 -->
<g class="node" id="node3"><title>140516683523688</title>
<polygon fill="none" points="54,-365.5 54,-401.5 157,-401.5 157,-365.5 54,-365.5" stroke="black"></polygon>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="105.5" y="-379.8">conv0: Conv2D</text>
</g>
<!-- 140516683524472&#45;&gt;140516683523688 -->
<g class="edge" id="edge2"><title>140516683524472-&gt;140516683523688</title>
<path d="M105.5,-438.313C105.5,-430.289 105.5,-420.547 105.5,-411.569" fill="none" stroke="black"></path>
<polygon fill="black" points="109,-411.529 105.5,-401.529 102,-411.529 109,-411.529" stroke="black"></polygon>
</g>
<!-- 140516683524696 -->
<g class="node" id="node4"><title>140516683524696</title>
<polygon fill="none" points="28,-292.5 28,-328.5 183,-328.5 183,-292.5 28,-292.5" stroke="black"></polygon>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="105.5" y="-306.8">bn0: BatchNormalization</text>
</g>
<!-- 140516683523688&#45;&gt;140516683524696 -->
<g class="edge" id="edge3"><title>140516683523688-&gt;140516683524696</title>
<path d="M105.5,-365.313C105.5,-357.289 105.5,-347.547 105.5,-338.569" fill="none" stroke="black"></path>
<polygon fill="black" points="109,-338.529 105.5,-328.529 102,-338.529 109,-338.529" stroke="black"></polygon>
</g>
<!-- 140516683525760 -->
<g class="node" id="node5"><title>140516683525760</title>
<polygon fill="none" points="31.5,-219.5 31.5,-255.5 179.5,-255.5 179.5,-219.5 31.5,-219.5" stroke="black"></polygon>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="105.5" y="-233.8">activation_2: Activation</text>
</g>
<!-- 140516683524696&#45;&gt;140516683525760 -->
<g class="edge" id="edge4"><title>140516683524696-&gt;140516683525760</title>
<path d="M105.5,-292.313C105.5,-284.289 105.5,-274.547 105.5,-265.569" fill="none" stroke="black"></path>
<polygon fill="black" points="109,-265.529 105.5,-255.529 102,-265.529 109,-265.529" stroke="black"></polygon>
</g>
<!-- 140516683171880 -->
<g class="node" id="node6"><title>140516683171880</title>
<polygon fill="none" points="24,-146.5 24,-182.5 187,-182.5 187,-146.5 24,-146.5" stroke="black"></polygon>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="105.5" y="-160.8">max_pool: MaxPooling2D</text>
</g>
<!-- 140516683525760&#45;&gt;140516683171880 -->
<g class="edge" id="edge5"><title>140516683525760-&gt;140516683171880</title>
<path d="M105.5,-219.313C105.5,-211.289 105.5,-201.547 105.5,-192.569" fill="none" stroke="black"></path>
<polygon fill="black" points="109,-192.529 105.5,-182.529 102,-192.529 109,-192.529" stroke="black"></polygon>
</g>
<!-- 140516683253632 -->
<g class="node" id="node7"><title>140516683253632</title>
<polygon fill="none" points="50.5,-73.5 50.5,-109.5 160.5,-109.5 160.5,-73.5 50.5,-73.5" stroke="black"></polygon>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="105.5" y="-87.8">flatten_2: Flatten</text>
</g>
<!-- 140516683171880&#45;&gt;140516683253632 -->
<g class="edge" id="edge6"><title>140516683171880-&gt;140516683253632</title>
<path d="M105.5,-146.313C105.5,-138.289 105.5,-128.547 105.5,-119.569" fill="none" stroke="black"></path>
<polygon fill="black" points="109,-119.529 105.5,-109.529 102,-119.529 109,-119.529" stroke="black"></polygon>
</g>
<!-- 140516683255536 -->
<g class="node" id="node8"><title>140516683255536</title>
<polygon fill="none" points="71.5,-0.5 71.5,-36.5 139.5,-36.5 139.5,-0.5 71.5,-0.5" stroke="black"></polygon>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="105.5" y="-14.8">fc: Dense</text>
</g>
<!-- 140516683253632&#45;&gt;140516683255536 -->
<g class="edge" id="edge7"><title>140516683253632-&gt;140516683255536</title>
<path d="M105.5,-73.3129C105.5,-65.2895 105.5,-55.5475 105.5,-46.5691" fill="none" stroke="black"></path>
<polygon fill="black" points="109,-46.5288 105.5,-36.5288 102,-46.5289 109,-46.5288" stroke="black"></polygon>
</g>
</g>
</svg></div></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div></div><div class="end_space"></div></div>
        <div id="tooltip" class="ipython_tooltip" style="display:none"><div class="tooltipbuttons"><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#" role="button" class="ui-button"><span class="ui-icon ui-icon-close">Close</span></a><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#" class="ui-corner-all" role="button" id="expanbutton" title="Grow the tooltip vertically (press shift-tab twice)"><span class="ui-icon ui-icon-plus">Expand</span></a><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#" role="button" class="ui-button" title="show the current docstring in pager (press shift-tab 4 times)"><span class="ui-icon ui-icon-arrowstop-l-n">Open in Pager</span></a><a href="https://wfprgshdbiqgukclmahija.coursera-apps.org/notebooks/week2/KerasTutorial/Keras_Tutorial_v2a.ipynb#" role="button" class="ui-button" title="Tooltip will linger for 10 seconds while you type" style="display: none;"><span class="ui-icon ui-icon-clock">Close</span></a></div><div class="pretooltiparrow"></div><div class="tooltiptext smalltooltip"></div></div>
    </div>
</div>



</div>



<div id="pager" class="ui-resizable">
    <div id="pager-contents">
        <div id="pager-container" class="container"></div>
    </div>
    <div id="pager-button-area"><a role="button" title="Open the pager in an external window" class="ui-button"><span class="ui-icon ui-icon-extlink"></span></a><a role="button" title="Close the pager" class="ui-button"><span class="ui-icon ui-icon-close"></span></a></div>
<div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div></div>






<script type="text/javascript">
    sys_info = {"notebook_version": "5.0.0", "notebook_path": "/opt/conda/lib/python3.6/site-packages/notebook", "commit_source": "", "commit_hash": "", "sys_version": "3.6.0 |Anaconda 4.3.1 (64-bit)| (default, Dec 23 2016, 12:22:00) \n[GCC 4.4.7 20120313 (Red Hat 4.4.7-1)]", "sys_executable": "/opt/conda/bin/python", "sys_platform": "linux", "platform": "Linux-4.14.70-67.55.amzn1.x86_64-x86_64-with-debian-8.4", "os_name": "posix", "default_encoding": "UTF-8"};
</script>

<script src="./Keras_Tutorial_v2a_files/encoding.js.下载" charset="utf-8"></script>

<script src="./Keras_Tutorial_v2a_files/main.min.js.下载" type="text/javascript" charset="utf-8"></script>



<script type="text/javascript">
  function _remove_token_from_url() {
    if (window.location.search.length <= 1) {
      return;
    }
    var search_parameters = window.location.search.slice(1).split('&');
    for (var i = 0; i < search_parameters.length; i++) {
      if (search_parameters[i].split('=')[0] === 'token') {
        // remote token from search parameters
        search_parameters.splice(i, 1);
        var new_search = '';
        if (search_parameters.length) {
          new_search = '?' + search_parameters.join('&');
        }
        var new_url = window.location.origin + 
                      window.location.pathname + 
                      new_search + 
                      window.location.hash;
        window.history.replaceState({}, "", new_url);
        return;
      }
    }
  }
  _remove_token_from_url();
</script>


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal;"></div></div></body></html>