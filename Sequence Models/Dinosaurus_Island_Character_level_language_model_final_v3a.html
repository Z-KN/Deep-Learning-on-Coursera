<!DOCTYPE html>
<!-- saved from url=(0195)https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20-%2D%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb# -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    

    <title>Dinosaurus_Island_Character_level_language_model_final_v3a</title>
    <link rel="shortcut icon" type="image/x-icon" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/static/base/images/favicon.ico?v=97c6417ed01bdc0ae3ef32ae4894fd03">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/jquery-ui.min.css" type="text/css">
    <link rel="stylesheet" href="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/jquery.typeahead.min.css" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    


<script type="text/javascript" src="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/MathJax.js.下载" charset="utf-8"></script>

<script type="text/javascript">
// MathJax disabled, set as null to distingish from *missing* MathJax,
// where it will be undefined, and should prompt a dialog later.
window.mathjax_url = "/static/components/MathJax/MathJax.js";
</script>

<link rel="stylesheet" href="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/bootstrap-tour.min.css" type="text/css">
<link rel="stylesheet" href="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/codemirror.css">


    <link rel="stylesheet" href="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/style.min.css" type="text/css">
    

<link rel="stylesheet" href="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/override.css" type="text/css">
<link rel="stylesheet" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb" id="kernel-css" type="text/css">


    <link rel="stylesheet" href="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/custom.css" type="text/css">
    <script src="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/promise.min.js.下载" type="text/javascript" charset="utf-8"></script>
    <script src="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/index.js.下载" type="text/javascript"></script>
    <script src="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/index.js(1).下载" type="text/javascript"></script>
    <script src="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/index.js(2).下载" type="text/javascript"></script>
    <script src="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/require.js.下载" type="text/javascript" charset="utf-8"></script>
    <script>
      require.config({
          
          urlArgs: "v=20200130025741",
          
          baseUrl: '/static/',
          paths: {
            'auth/js/main': 'auth/js/main.min',
            custom : '/custom',
            nbextensions : '/nbextensions',
            kernelspecs : '/kernelspecs',
            underscore : 'components/underscore/underscore-min',
            backbone : 'components/backbone/backbone-min',
            jquery: 'components/jquery/jquery.min',
            bootstrap: 'components/bootstrap/js/bootstrap.min',
            bootstraptour: 'components/bootstrap-tour/build/js/bootstrap-tour.min',
            'jquery-ui': 'components/jquery-ui/ui/minified/jquery-ui.min',
            moment: 'components/moment/moment',
            codemirror: 'components/codemirror',
            termjs: 'components/xterm.js/dist/xterm',
            typeahead: 'components/jquery-typeahead/dist/jquery.typeahead.min',
          },
          map: { // for backward compatibility
              "*": {
                  "jqueryui": "jquery-ui",
              }
          },
          shim: {
            typeahead: {
              deps: ["jquery"],
              exports: "typeahead"
            },
            underscore: {
              exports: '_'
            },
            backbone: {
              deps: ["underscore", "jquery"],
              exports: "Backbone"
            },
            bootstrap: {
              deps: ["jquery"],
              exports: "bootstrap"
            },
            bootstraptour: {
              deps: ["bootstrap"],
              exports: "Tour"
            },
            "jquery-ui": {
              deps: ["jquery"],
              exports: "$"
            }
          },
          waitSeconds: 30,
      });

      require.config({
          map: {
              '*':{
                'contents': 'services/contents',
              }
          }
      });

      // error-catching custom.js shim.
      define("custom", function (require, exports, module) {
          try {
              var custom = require('custom/custom');
              console.debug('loaded custom.js');
              return custom;
          } catch (e) {
              console.error("error loading custom.js", e);
              return {};
          }
      })
    </script>

    
    

<script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/contents" src="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/contents.js.下载"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="custom/custom" src="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/custom.js.下载"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/submit-button/main" src="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/main.js.下载"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">div.MathJax_MathML {text-align: center; margin: .75em 0px; display: block!important}
.MathJax_MathML {font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
span.MathJax_MathML {display: inline!important}
.MathJax_mmlExBox {display: block!important; overflow: hidden; height: 1px; width: 60ex; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0}
[class="MJX-tex-oldstyle"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB}
[class="MJX-tex-oldstyle-bold"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB; font-weight: bold}
[class="MJX-tex-caligraphic"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB}
[class="MJX-tex-caligraphic-bold"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB; font-weight: bold}
@font-face /*1*/ {font-family: MathJax_Caligraphic-WEB; src: url('https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf')}
@font-face /*2*/ {font-family: MathJax_Caligraphic-WEB; font-weight: bold; src: url('https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Bold.otf')}
[mathvariant="double-struck"] {font-family: MathJax_AMS, MathJax_AMS-WEB}
[mathvariant="script"] {font-family: MathJax_Script, MathJax_Script-WEB}
[mathvariant="fraktur"] {font-family: MathJax_Fraktur, MathJax_Fraktur-WEB}
[mathvariant="bold-script"] {font-family: MathJax_Script, MathJax_Caligraphic-WEB; font-weight: bold}
[mathvariant="bold-fraktur"] {font-family: MathJax_Fraktur, MathJax_Fraktur-WEB; font-weight: bold}
[mathvariant="monospace"] {font-family: monospace}
[mathvariant="sans-serif"] {font-family: sans-serif}
[mathvariant="bold-sans-serif"] {font-family: sans-serif; font-weight: bold}
[mathvariant="sans-serif-italic"] {font-family: sans-serif; font-style: italic}
[mathvariant="sans-serif-bold-italic"] {font-family: sans-serif; font-style: italic; font-weight: bold}
@font-face /*3*/ {font-family: MathJax_AMS-WEB; src: url('https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf')}
@font-face /*4*/ {font-family: MathJax_Script-WEB; src: url('https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf')}
@font-face /*5*/ {font-family: MathJax_Fraktur-WEB; src: url('https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf')}
@font-face /*6*/ {font-family: MathJax_Fraktur-WEB; font-weight: bold; src: url('https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Bold.otf')}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 0; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: STIXMathJax_Main-bold; src: url('https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/static/components/MathJax/fonts/HTML-CSS/STIX-Web/woff/STIXMathJax_Main-Bold.woff?rev=2.6.0') format('woff'), url('https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/static/components/MathJax/fonts/HTML-CSS/STIX-Web/otf/STIXMathJax_Main-Bold.otf?rev=2.6.0') format('opentype')}
</style><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/notebook/js/extension" src="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/extension.js.下载"></script><link id="favicon" type="image/x-icon" rel="shortcut icon" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/static/base/images/favicon.ico"></head>

<body class="notebook_app command_mode" data-base-url="/" data-ws-url="" data-notebook-name="Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb" data-notebook-path="Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb" dir="ltr" style=""><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

<noscript>
    <div id='noscript'>
      Jupyter Notebook requires JavaScript.<br>
      Please enable it to proceed.
  </div>
</noscript>

<div id="header" style="display: block;">
  <div id="header-container" class="container">
  <div id="ipython_notebook" class="nav navbar-brand pull-left"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/tree" title="dashboard"><img src="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/logo.png" alt="Jupyter Notebook"></a></div>

  
  
  

    <span id="login_widget">
      
    </span>

  

  

  


<span id="save_widget" class="pull-left save_widget">
    <span id="notebook_name" class="filename">Dinosaurus_Island_Character_level_language_model_final_v3a</span>
    <span class="checkpoint_status" title="Thu, Jan 30, 2020 12:03 PM">Last Checkpoint: a few seconds ago</span>
    <span class="autosave_status">(autosaved)</span>
</span>

<span id="kernel_logo_widget">
  
  <img class="current_kernel_logo" src="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/logo-64x64.png" title="Python 3" style="display: inline;">
  
</span>


  </div>
  <div class="header-bar"></div>

  
<div id="menubar-container" class="container">
<div id="menubar">
    <div id="menus" class="navbar navbar-default" role="navigation">
        <div class="container-fluid">
            <button type="button" class="btn btn-default navbar-btn navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <i class="fa fa-bars"></i>
              <span class="navbar-text">Menu</span>
            </button>
            <p id="kernel_indicator" class="navbar-text indicator_area">
              <span class="kernel_indicator_name">Python 3</span>
              <i id="kernel_indicator_icon" class="kernel_idle_icon" title="Kernel Idle"></i>
            </p>
            <i id="readonly-indicator" class="navbar-text" title="This notebook is read-only" style="display: none;">
                <span class="fa-stack">
                    <i class="fa fa-save fa-stack-1x"></i>
                    <i class="fa fa-ban fa-stack-2x text-danger"></i>
                </span>
            </i>
            <i id="modal_indicator" class="navbar-text modal_indicator" title="Command Mode"></i>
            <span id="notification_area"><div id="notification_kernel" class="notification_widget btn btn-xs navbar-btn undefined info" style="display: none;"><span></span></div><div id="notification_notebook" class="notification_widget btn btn-xs navbar-btn" style="display: none;"><span></span></div><div id="notification_trusted" class="notification_widget btn btn-xs navbar-btn" style="display: inline-block;"><span>Not Trusted</span></div></span>
            <div class="navbar-collapse collapse">
              <ul class="nav navbar-nav">
                <li class="dropdown"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">File</a>
                    <ul id="file_menu" class="dropdown-menu">
                        <li id="new_notebook" class="dropdown-submenu">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">New Notebook</a>
                            <ul class="dropdown-menu" id="menu-new-notebook-submenu"><li id="new-notebook-submenu-python3"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Python 3</a></li><li class="divider"></li><li id="new-notebook-submenu-python2"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Python 2</a></li></ul>
                        </li>
                        <li id="open_notebook" title="Opens a new window with the Dashboard view">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Open...</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="copy_notebook" title="Open a copy of this notebook&#39;s contents and start a new kernel">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Make a Copy...</a></li>
                        <li id="rename_notebook"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Rename...</a></li>
                        <li id="save_checkpoint"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Save and Checkpoint</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="restore_checkpoint" class="dropdown-submenu"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Revert to Checkpoint</a>
                          <ul class="dropdown-menu"><li><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Thursday, January 30, 2020 12:03 PM</a></li></ul>
                        </li>
                        <li class="divider"></li>
                        <li id="print_preview"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Print Preview</a></li>
                        <li class="dropdown-submenu"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Download as</a>
                            <ul id="download_menu" class="dropdown-menu">
                                <li id="download_ipynb"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Notebook (.ipynb)</a></li>
                                <li id="download_script"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Python (.py)</a></li>
                                <li id="download_html"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">HTML (.html)</a></li>
                                <li id="download_markdown"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Markdown (.md)</a></li>
                                <li id="download_rst"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">reST (.rst)</a></li>
                                <li id="download_latex"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">LaTeX (.tex)</a></li>
                                <li id="download_pdf"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">PDF via LaTeX (.pdf)</a></li>
                            </ul>
                        </li>
                        <li class="dropdown-submenu hidden"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Deploy as</a>
                            <ul id="deploy_menu" class="dropdown-menu"></ul>
                        </li>
                        <li class="divider"></li>
                        <li id="trust_notebook" title="Trust the output of this notebook">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Trust Notebook</a></li>
                        <li class="divider"></li>
                        <li id="kill_and_exit" title="Shutdown this notebook&#39;s kernel, and close this window">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Close and Halt</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Edit</a>
                    <ul id="edit_menu" class="dropdown-menu">
                        <li id="cut_cell"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Cut Cells</a></li>
                        <li id="copy_cell"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Copy Cells</a></li>
                        <li id="paste_cell_above" class="disabled"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Paste Cells Above</a></li>
                        <li id="paste_cell_below" class="disabled"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Paste Cells Below</a></li>
                        <li id="paste_cell_replace" class="disabled"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Paste Cells &amp; Replace</a></li>
                        <li id="delete_cell"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Delete Cells</a></li>
                        <li id="undelete_cell" class="disabled"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Undo Delete Cells</a></li>
                        <li class="divider"></li>
                        <li id="split_cell"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Split Cell</a></li>
                        <li id="merge_cell_above"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Merge Cell Above</a></li>
                        <li id="merge_cell_below"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Merge Cell Below</a></li>
                        <li class="divider"></li>
                        <li id="move_cell_up"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Move Cell Up</a></li>
                        <li id="move_cell_down"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Move Cell Down</a></li>
                        <li class="divider"></li>
                        <li id="edit_nb_metadata"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Edit Notebook Metadata</a></li>
                        <li class="divider"></li>
                        <li id="find_and_replace"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#"> Find and Replace </a></li>
                        <li class="divider"></li>
                        <li id="cut_cell_attachments"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Cut Cell Attachments</a></li>
                        <li id="copy_cell_attachments"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Copy Cell Attachments</a></li>
                        <li id="paste_cell_attachments" class="disabled"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Paste Cell Attachments</a></li>
                        <li class="divider"></li>
                        <li id="insert_image" class="disabled"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#"> Insert Image </a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#" class="dropdown-toggle" data-toggle="dropdown">View</a>
                    <ul id="view_menu" class="dropdown-menu">
                        <li id="toggle_header" title="Show/Hide the logo and notebook title (above menu bar)">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Toggle Header</a>
                        </li>
                        <li id="toggle_toolbar" title="Show/Hide the action icons (below menu bar)">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Toggle Toolbar</a>
                        </li>
                        <li id="toggle_line_numbers" title="Show/Hide line numbers in cells">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Toggle Line Numbers</a>
                        </li>
                        <li id="menu-cell-toolbar" class="dropdown-submenu">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Cell Toolbar</a>
                            <ul class="dropdown-menu" id="menu-cell-toolbar-submenu"><li data-name="None"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">None</a></li><li data-name="Edit%20Metadata"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Edit Metadata</a></li><li data-name="Raw%20Cell%20Format"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Raw Cell Format</a></li><li data-name="Slideshow"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Slideshow</a></li><li data-name="Attachments"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Attachments</a></li><li data-name="Tags"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Tags</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Insert</a>
                    <ul id="insert_menu" class="dropdown-menu">
                        <li id="insert_cell_above" title="Insert an empty Code cell above the currently active cell">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Insert Cell Above</a></li>
                        <li id="insert_cell_below" title="Insert an empty Code cell below the currently active cell">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Insert Cell Below</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Cell</a>
                    <ul id="cell_menu" class="dropdown-menu">
                        <li id="run_cell" title="Run this cell, and move cursor to the next one">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Run Cells</a></li>
                        <li id="run_cell_select_below" title="Run this cell, select below">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Run Cells and Select Below</a></li>
                        <li id="run_cell_insert_below" title="Run this cell, insert below">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Run Cells and Insert Below</a></li>
                        <li id="run_all_cells" title="Run all cells in the notebook">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Run All</a></li>
                        <li id="run_all_cells_above" title="Run all cells above (but not including) this cell">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Run All Above</a></li>
                        <li id="run_all_cells_below" title="Run this cell and all cells below it">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Run All Below</a></li>
                        <li class="divider"></li>
                        <li id="change_cell_type" class="dropdown-submenu" title="All cells in the notebook have a cell type. By default, new cells are created as &#39;Code&#39; cells">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Cell Type</a>
                            <ul class="dropdown-menu">
                              <li id="to_code" title="Contents will be sent to the kernel for execution, and output will display in the footer of cell">
                                  <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Code</a></li>
                              <li id="to_markdown" title="Contents will be rendered as HTML and serve as explanatory text">
                                  <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Markdown</a></li>
                              <li id="to_raw" title="Contents will pass through nbconvert unmodified">
                                  <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Raw NBConvert</a></li>
                            </ul>
                        </li>
                        <li class="divider"></li>
                        <li id="current_outputs" class="dropdown-submenu"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Current Outputs</a>
                            <ul class="dropdown-menu">
                                <li id="toggle_current_output" title="Hide/Show the output of the current cell">
                                    <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Toggle</a>
                                </li>
                                <li id="toggle_current_output_scroll" title="Scroll the output of the current cell">
                                    <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_current_output" title="Clear the output of the current cell">
                                    <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Clear</a>
                                </li>
                            </ul>
                        </li>
                        <li id="all_outputs" class="dropdown-submenu"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">All Output</a>
                            <ul class="dropdown-menu">
                                <li id="toggle_all_output" title="Hide/Show the output of all cells">
                                    <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Toggle</a>
                                </li>
                                <li id="toggle_all_output_scroll" title="Scroll the output of all cells">
                                    <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_all_output" title="Clear the output of all cells">
                                    <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Clear</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Kernel</a>
                    <ul id="kernel_menu" class="dropdown-menu">
                        <li id="int_kernel" title="Send KeyboardInterrupt (CTRL-C) to the Kernel">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Interrupt</a>
                        </li>
                        <li id="restart_kernel" title="Restart the Kernel">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Restart</a>
                        </li>
                        <li id="restart_clear_output" title="Restart the Kernel and clear all output">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Restart &amp; Clear Output</a>
                        </li>
                        <li id="restart_run_all" title="Restart the Kernel and re-run the notebook">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Restart &amp; Run All</a>
                        </li>
                        <li id="reconnect_kernel" title="Reconnect to the Kernel">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Reconnect</a>
                        </li>
                        <li id="shutdown_kernel" title="Shutdown the Kernel">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Shutdown</a>
                        </li>
                        <li class="divider"></li>
                        <li id="menu-change-kernel" class="dropdown-submenu">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Change kernel</a>
                            <ul class="dropdown-menu" id="menu-change-kernel-submenu"><li id="kernel-submenu-python2"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Python 2</a></li><li id="kernel-submenu-python3"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Python 3</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Help</a>
                    <ul id="help_menu" class="dropdown-menu">
                        
                        <li id="notebook_tour" title="A quick tour of the notebook user interface"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">User Interface Tour</a></li>
                        <li id="keyboard_shortcuts" title="Opens a dialog which shows all keyboard shortcuts"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Keyboard Shortcuts</a></li>
                        <li id="edit_keyboard_shortcuts" title="Opens a dialog allowing you to edit Keyboard shortcuts"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">Edit Keyboard Shortcuts</a></li>
                        <li class="divider"></li>
                        

                        
                            
                                <li><a rel="noreferrer" href="http://nbviewer.ipython.org/github/ipython/ipython/blob/3.x/examples/Notebook/Index.ipynb" target="_blank" title="Opens in a new window">
                                
                                    <i class="fa fa-external-link menu-icon pull-right"></i>
                                

                                Notebook Help
                                </a></li>
                            
                                <li><a rel="noreferrer" href="https://help.github.com/articles/markdown-basics/" target="_blank" title="Opens in a new window">
                                
                                    <i class="fa fa-external-link menu-icon pull-right"></i>
                                

                                Markdown
                                </a></li>
                            
                            
                        
                        <li id="kernel-help-links" class="divider"></li><li><a target="_blank" title="Opens in a new window" href="http://docs.python.org/3.6?v=20200130025741"><i class="fa fa-external-link menu-icon pull-right"></i><span>Python</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://ipython.org/documentation.html?v=20200130025741"><i class="fa fa-external-link menu-icon pull-right"></i><span>IPython</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.scipy.org/doc/numpy/reference/?v=20200130025741"><i class="fa fa-external-link menu-icon pull-right"></i><span>NumPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.scipy.org/doc/scipy/reference/?v=20200130025741"><i class="fa fa-external-link menu-icon pull-right"></i><span>SciPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://matplotlib.org/contents.html?v=20200130025741"><i class="fa fa-external-link menu-icon pull-right"></i><span>Matplotlib</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.sympy.org/latest/index.html?v=20200130025741"><i class="fa fa-external-link menu-icon pull-right"></i><span>SymPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://pandas.pydata.org/pandas-docs/stable/?v=20200130025741"><i class="fa fa-external-link menu-icon pull-right"></i><span>pandas</span></a></li><li class="divider"></li>
                        <li title="About Jupyter Notebook"><a id="notebook_about" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#">About</a></li>
                        
                    </ul>
                </li>
              </ul>
            </div>
        </div>
    </div>
</div>

<div id="maintoolbar" class="navbar">
  <div class="toolbar-inner navbar-inner navbar-nobg">
    <div id="maintoolbar-container" class="container toolbar"><div class="btn-group" id="save-notbook"><button class="btn btn-default" title="Save and Checkpoint" data-jupyter-action="jupyter-notebook:save-notebook"><i class="fa-save fa"></i></button></div><div class="btn-group" id="insert_above_below"><button class="btn btn-default" title="insert cell below" data-jupyter-action="jupyter-notebook:insert-cell-below"><i class="fa-plus fa"></i></button></div><div class="btn-group" id="cut_copy_paste"><button class="btn btn-default" title="cut selected cells" data-jupyter-action="jupyter-notebook:cut-cell"><i class="fa-cut fa"></i></button><button class="btn btn-default" title="copy selected cells" data-jupyter-action="jupyter-notebook:copy-cell"><i class="fa-copy fa"></i></button><button class="btn btn-default" title="paste cells below" data-jupyter-action="jupyter-notebook:paste-cell-below"><i class="fa-paste fa"></i></button></div><div class="btn-group" id="move_up_down"><button class="btn btn-default" title="move selected cells up" data-jupyter-action="jupyter-notebook:move-cell-up"><i class="fa-arrow-up fa"></i></button><button class="btn btn-default" title="move selected cells down" data-jupyter-action="jupyter-notebook:move-cell-down"><i class="fa-arrow-down fa"></i></button></div><div class="btn-group" id="run_int"><button class="btn btn-default" title="run cell, select below" data-jupyter-action="jupyter-notebook:run-cell-and-select-next"><i class="fa-step-forward fa"></i></button><button class="btn btn-default" title="interrupt kernel" data-jupyter-action="jupyter-notebook:interrupt-kernel"><i class="fa-stop fa"></i></button><button class="btn btn-default" title="restart the kernel (with dialog)" data-jupyter-action="jupyter-notebook:confirm-restart-kernel"><i class="fa-repeat fa"></i></button></div><select id="cell_type" class="form-control select-xs"><option value="code">Code</option><option value="markdown">Markdown</option><option value="raw">Raw NBConvert</option><option value="heading">Heading</option><option value="multiselect" disabled="disabled" style="display: none;">-</option></select><div class="btn-group"><button class="btn btn-default" title="open the command palette" data-jupyter-action="jupyter-notebook:show-command-palette"><i class="fa-keyboard-o fa"></i></button></div><div class="btn-group" id="submit-notebook-button-group" style="float:right"><button class="btn btn-default" title="Submit this notebook for grading." id="submit-notebook-button" style="background-color:rgb(42, 115, 204); color:white; padding:4px 8px">Submit Assignment</button></div></div>
  </div>
</div>
</div>

<div class="lower-header-bar"></div>

</div>

<div id="site" style="height: 503px; display: block;">


<div id="ipython-main-app">
    <div id="notebook_panel">
        <div id="notebook" tabindex="-1"><div class="container" id="notebook-container"><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59027px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -19px; border-right-width: 11px; min-height: 638px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21.4815px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-1"># Character level language model - Dinosaurus Island</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Welcome to Dinosaurus Island! 65 million years ago, dinosaurs existed, and in this assignment they are back. You are in charge of a special task. Leading biology researchers are creating new breeds of dinosaurs and bringing them to life on earth, and your job is to give names to these dinosaurs. If a dinosaur does not like its name, it might go berserk, so choose wisely! </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/dino.jpg"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:250;height:300px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Luckily you have learned some deep learning and you will use it to save the day. Your assistant has collected a list of all the dinosaur names they could find, and compiled them into this <span class="cm-link">[dataset]</span><span class="cm-string cm-url">(dinos.txt)</span>. (Feel free to take a look by clicking the previous link.) To create new dinosaur names, you will build a character level language model to generate new names. Your algorithm will learn the different name patterns, and randomly generate new names. Hopefully this algorithm will keep you and your team safe from the dinosaurs' wrath! </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">By completing this assignment you will learn:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- How to store text data for processing using an RNN </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- How to synthesize data, by sampling predictions at each time step and passing it to the next RNN-cell unit</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- How to build a character-level text generation recurrent neural network</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Why clipping the gradients is important</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">We will begin by loading in some functions that we have provided for you in <span class="cm-comment">`rnn_utils`</span>. Specifically, you have access to functions such as <span class="cm-comment">`rnn_forward`</span> and <span class="cm-comment">`rnn_backward`</span> which are equivalent to those you've implemented in the previous assignment. </span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 638px;"></div><div class="CodeMirror-gutters" style="display: none; height: 649px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 id="Character-level-language-model---Dinosaurus-Island">Character level language model - Dinosaurus Island<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#Character-level-language-model---Dinosaurus-Island">¶</a></h1>
<p>Welcome to Dinosaurus Island! 65 million years ago, dinosaurs existed, and in this assignment they are back. You are in charge of a special task. Leading biology researchers are creating new breeds of dinosaurs and bringing them to life on earth, and your job is to give names to these dinosaurs. If a dinosaur does not like its name, it might go berserk, so choose wisely! </p>
<table>
<tbody><tr><td>
<img src="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/dino.jpg" style="width: 250 ; height: 300px">

</td>

</tr></tbody></table>

<p>Luckily you have learned some deep learning and you will use it to save the day. Your assistant has collected a list of all the dinosaur names they could find, and compiled them into this <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/dinos.txt" target="_blank">dataset</a>. (Feel free to take a look by clicking the previous link.) To create new dinosaur names, you will build a character level language model to generate new names. Your algorithm will learn the different name patterns, and randomly generate new names. Hopefully this algorithm will keep you and your team safe from the dinosaurs' wrath! </p>
<p>By completing this assignment you will learn:</p>
<ul>
<li>How to store text data for processing using an RNN </li>
<li>How to synthesize data, by sampling predictions at each time step and passing it to the next RNN-cell unit</li>
<li>How to build a character-level text generation recurrent neural network</li>
<li>Why clipping the gradients is important</li>
</ul>
<p>We will begin by loading in some functions that we have provided for you in <code>rnn_utils</code>. Specifically, you have access to functions such as <code>rnn_forward</code> and <code>rnn_backward</code> which are equivalent to those you've implemented in the previous assignment. </p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59021px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 453px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.5185px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## </span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'darkblue'</span><span class="cm-tag cm-bracket">&gt;</span>Updates<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">font</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### If you were working on the notebook before this update...</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The current notebook is version "3a".</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* You can find your original work saved in the notebook with the previous version name ("v3") </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* To view the file directory, go to the menu "File-&gt;Open", and this will open a new tab that shows the file directory.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### List of updates</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Sort and print </span><span class="cm-comment cm-variable-2">`chars`</span><span class="cm-variable-2"> list of characters.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Import and use pretty print</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`clip`</span><span class="cm-variable-2">: </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Additional details on why we need to use the "out" parameter.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Modified for loop to have students fill in the correct items to loop through.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Added a test case to check for hard-coding error.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`sample`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- additional hints added to steps 1,2,3,4.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- "Using 2D arrays instead of 1D arrays".</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- explanation of numpy.ravel().</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- fixed expected output.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- clarified comments in the code.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* "training the model"</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Replaced the sample code with explanations for how to set the index, X and Y (for a better learning experience).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Spelling, grammar and wording corrections.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 453px;"></div><div class="CodeMirror-gutters" style="display: none; height: 465px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Updates"><font color="darkblue">Updates</font><a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#Updates">¶</a></h2>
<h4 id="If-you-were-working-on-the-notebook-before-this-update...">If you were working on the notebook before this update...<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#If-you-were-working-on-the-notebook-before-this-update...">¶</a></h4>
<ul>
<li>The current notebook is version "3a".</li>
<li>You can find your original work saved in the notebook with the previous version name ("v3") </li>
<li>To view the file directory, go to the menu "File-&gt;Open", and this will open a new tab that shows the file directory.</li>
</ul>
<h4 id="List-of-updates">List of updates<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#List-of-updates">¶</a></h4>
<ul>
<li>Sort and print <code>chars</code> list of characters.</li>
<li>Import and use pretty print</li>
<li><code>clip</code>: <ul>
<li>Additional details on why we need to use the "out" parameter.</li>
<li>Modified for loop to have students fill in the correct items to loop through.</li>
<li>Added a test case to check for hard-coding error.</li>
</ul>
</li>
<li><code>sample</code><ul>
<li>additional hints added to steps 1,2,3,4.</li>
<li>"Using 2D arrays instead of 1D arrays".</li>
<li>explanation of numpy.ravel().</li>
<li>fixed expected output.</li>
<li>clarified comments in the code.</li>
</ul>
</li>
<li>"training the model"<ul>
<li>Replaced the sample code with explanations for how to set the index, X and Y (for a better learning experience).</li>
</ul>
</li>
<li>Spelling, grammar and wording corrections.</li>
</ul>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[3]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 38.1824px; left: 110.521px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 132.699px; margin-bottom: -19px; border-right-width: 11px; min-height: 76px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 104.931px; top: 32.5926px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">utils</span> <span class="cm-keyword">import</span> <span class="cm-operator">*</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">random</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">pprint</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 76px;"></div><div class="CodeMirror-gutters" style="display: none; height: 87px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 128px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.5185px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 1 - Problem Statement</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### 1.1 - Dataset and Preprocessing</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Run the following cell to read the dataset of dinosaur names, create a list of unique characters (such as a-z), and compute the dataset and vocabulary size. </span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 128px;"></div><div class="CodeMirror-gutters" style="display: none; height: 140px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="1---Problem-Statement">1 - Problem Statement<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#1---Problem-Statement">¶</a></h2>
<h3 id="1.1---Dataset-and-Preprocessing">1.1 - Dataset and Preprocessing<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#1.1---Dataset-and-Preprocessing">¶</a></h3>
<p>Run the following cell to read the dataset of dinosaur names, create a list of unique characters (such as a-z), and compute the dataset and vocabulary size. </p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[4]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 70.775px; left: 245.88px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 683.972px; margin-bottom: -19px; border-right-width: 11px; min-height: 93px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 240.289px; top: 65.1852px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">data</span> = <span class="cm-builtin">open</span>(<span class="cm-string">'dinos.txt'</span>, <span class="cm-string">'r'</span>).<span class="cm-property">read</span>()</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">data</span>= <span class="cm-variable">data</span>.<span class="cm-property">lower</span>()</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">chars</span> = <span class="cm-builtin">list</span>(<span class="cm-builtin">set</span>(<span class="cm-variable">data</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">data_size</span>, <span class="cm-variable">vocab_size</span> = <span class="cm-builtin">len</span>(<span class="cm-variable">data</span>), <span class="cm-builtin">len</span>(<span class="cm-variable">chars</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'There are %d total characters and %d unique characters in your data.'</span> <span class="cm-operator">%</span> (<span class="cm-variable">data_size</span>, <span class="cm-variable">vocab_size</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 93px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>There are 19909 total characters and 27 unique characters in your data.
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 207px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The characters are a-z (26 characters) plus the "\n" (or newline character).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* In this assignment, the newline character "\n" plays a role similar to the </span><span class="cm-comment cm-variable-2">`&lt;EOS&gt;`</span><span class="cm-variable-2"> (or "End of sentence") token we had discussed in lecture.</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Here, "\n" indicates the end of the dinosaur name rather than the end of a sentence. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`char_to_ix`</span><span class="cm-variable-2">: In the cell below, we create a python dictionary (i.e., a hash table) to map each character to an index from 0-26.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`ix_to_char`</span><span class="cm-variable-2">: We also create a second python dictionary that maps each index back to the corresponding character. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">-  This will help you figure out what index corresponds to what character in the probability distribution output of the softmax layer. </span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 207px;"></div><div class="CodeMirror-gutters" style="display: none; height: 219px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><ul>
<li>The characters are a-z (26 characters) plus the "\n" (or newline character).</li>
<li>In this assignment, the newline character "\n" plays a role similar to the <code>&lt;EOS&gt;</code> (or "End of sentence") token we had discussed in lecture.  <ul>
<li>Here, "\n" indicates the end of the dinosaur name rather than the end of a sentence. </li>
</ul>
</li>
<li><code>char_to_ix</code>: In the cell below, we create a python dictionary (i.e., a hash table) to map each character to an index from 0-26.</li>
<li><code>ix_to_char</code>: We also create a second python dictionary that maps each index back to the corresponding character. <ul>
<li>This will help you figure out what index corresponds to what character in the probability distribution output of the softmax layer. </li>
</ul>
</li>
</ul>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[5]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 21.8861px; left: 81.9792px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 144.238px; margin-bottom: -19px; border-right-width: 11px; min-height: 44px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 76.3889px; top: 16.2963px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">chars</span> = <span class="cm-builtin">sorted</span>(<span class="cm-variable">chars</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">chars</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 55px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>['\n', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z']
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[6]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 54.4807px; left: 143.16px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 318.567px; margin-bottom: -19px; border-right-width: 11px; min-height: 76px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 137.569px; top: 48.8889px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">char_to_ix</span> = { <span class="cm-variable">ch</span>:<span class="cm-variable">i</span> <span class="cm-keyword">for</span> <span class="cm-variable">i</span>,<span class="cm-variable">ch</span> <span class="cm-keyword">in</span> <span class="cm-builtin">enumerate</span>(<span class="cm-variable">chars</span>) }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">ix_to_char</span> = { <span class="cm-variable">i</span>:<span class="cm-variable">ch</span> <span class="cm-keyword">for</span> <span class="cm-variable">i</span>,<span class="cm-variable">ch</span> <span class="cm-keyword">in</span> <span class="cm-builtin">enumerate</span>(<span class="cm-variable">chars</span>) }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">pp</span> = <span class="cm-variable">pprint</span>.<span class="cm-property">PrettyPrinter</span>(<span class="cm-variable">indent</span>=<span class="cm-number">4</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">pp</span>.<span class="cm-property">pprint</span>(<span class="cm-variable">ix_to_char</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 76px;"></div><div class="CodeMirror-gutters" style="display: none; height: 87px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>{   0: '\n',
    1: 'a',
    2: 'b',
    3: 'c',
    4: 'd',
    5: 'e',
    6: 'f',
    7: 'g',
    8: 'h',
    9: 'i',
    10: 'j',
    11: 'k',
    12: 'l',
    13: 'm',
    14: 'n',
    15: 'o',
    16: 'p',
    17: 'q',
    18: 'r',
    19: 's',
    20: 't',
    21: 'u',
    22: 'v',
    23: 'w',
    24: 'x',
    25: 'y',
    26: 'z'}
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 468px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.037px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### 1.2 - Overview of the model</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Your model will have the following structure: </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Initialize parameters </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Run the optimization loop</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Forward propagation to compute the loss function</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Backward propagation to compute the gradients with respect to the loss function</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Clip the gradients to avoid exploding gradients</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Using the gradients, update your parameters with the gradient descent update rule.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Return the learned parameters </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/rnn.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:450;height:300px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> **Figure 1**: Recurrent Neural Network, similar to what you had built in the previous notebook "Building a Recurrent Neural Network - Step by Step". &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* At each time-step, the RNN tries to predict what is the next character given the previous characters. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The dataset </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>X<span class="cm-bracket">}</span> = (x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> <span class="cm-atom">1</span> <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>, x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> <span class="cm-atom">2</span> <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>, ..., x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> T_x <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> is a list of characters in the training set.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>Y<span class="cm-bracket">}</span> = (y^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> <span class="cm-atom">1</span> <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>, y^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> <span class="cm-atom">2</span> <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>, ..., y^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> T_x <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> is the same list of characters but shifted one character forward. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* At every time-step </span><span class="cm-delimit cm-delimit-open">$</span>t<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">, </span><span class="cm-delimit cm-delimit-open">$</span>y^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> = x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t+1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.  The prediction at time </span><span class="cm-delimit cm-delimit-open">$</span>t<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> is the same as the input at time </span><span class="cm-delimit cm-delimit-open">$</span>t + 1<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 468px;"></div><div class="CodeMirror-gutters" style="display: none; height: 480px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="1.2---Overview-of-the-model">1.2 - Overview of the model<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#1.2---Overview-of-the-model">¶</a></h3>
<p>Your model will have the following structure: </p>
<ul>
<li>Initialize parameters </li>
<li>Run the optimization loop<ul>
<li>Forward propagation to compute the loss function</li>
<li>Backward propagation to compute the gradients with respect to the loss function</li>
<li>Clip the gradients to avoid exploding gradients</li>
<li>Using the gradients, update your parameters with the gradient descent update rule.</li>
</ul>
</li>
<li>Return the learned parameters </li>
</ul>
<p><img src="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/rnn.png" style="width: 450 ; height: 300px"></p>
<center> <strong>Figure 1</strong>: Recurrent Neural Network, similar to what you had built in the previous notebook "Building a Recurrent Neural Network - Step by Step".  </center>

<ul>
<li>At each time-step, the RNN tries to predict what is the next character given the previous characters. </li>
<li>The dataset <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" role="math" style="width: 12.086em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.063em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1010em, 2.979em, -999.997em); top: -2.616em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2"><span class="texatom" id="MathJax-Span-3"><span class="mrow" id="MathJax-Span-4"><span class="mi" id="MathJax-Span-5" style="font-family: STIXMathJax_Main-bold; font-weight: bold;">X</span></span></span><span class="mo" id="MathJax-Span-6" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mo" id="MathJax-Span-7" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">(</span><span class="msubsup" id="MathJax-Span-8"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-9" style="font-family: STIXMathJax_Main; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-10"><span class="mrow" id="MathJax-Span-11"><span class="mo" id="MathJax-Span-12" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mn" id="MathJax-Span-13" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-14" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-15" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-16" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-17" style="font-family: STIXMathJax_Main; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-18"><span class="mrow" id="MathJax-Span-19"><span class="mo" id="MathJax-Span-20" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mn" id="MathJax-Span-21" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span class="mo" id="MathJax-Span-22" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-23" style="font-family: STIXMathJax_Main;">,</span><span class="mo" id="MathJax-Span-24" style="font-family: STIXMathJax_Main; padding-left: 0.182em;">.</span><span class="mo" id="MathJax-Span-25" style="font-family: STIXMathJax_Main; padding-left: 0.182em;">.</span><span class="mo" id="MathJax-Span-26" style="font-family: STIXMathJax_Main; padding-left: 0.182em;">.</span><span class="mo" id="MathJax-Span-27" style="font-family: STIXMathJax_Main; padding-left: 0.182em;">,</span><span class="msubsup" id="MathJax-Span-28" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-29" style="font-family: STIXMathJax_Main; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-30"><span class="mrow" id="MathJax-Span-31"><span class="mo" id="MathJax-Span-32" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="msubsup" id="MathJax-Span-33"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-34" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.866em; left: 0.42em;"><span class="mi" id="MathJax-Span-35" style="font-size: 50%; font-family: STIXMathJax_Main; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-36" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-37" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.622em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">X</mi></mrow><mo>=</mo><mo stretchy="false">(</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>,</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mn>2</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><msub><mi>T</mi><mi>x</mi></msub><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1">\mathbf{X} = (x^{\langle 1 \rangle}, x^{\langle 2 \rangle}, ..., x^{\langle T_x \rangle})</script> is a list of characters in the training set.</li>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-38" role="math" style="width: 11.908em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.884em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1009.82em, 2.979em, -999.997em); top: -2.616em; left: 0.003em;"><span class="mrow" id="MathJax-Span-39"><span class="texatom" id="MathJax-Span-40"><span class="mrow" id="MathJax-Span-41"><span class="mi" id="MathJax-Span-42" style="font-family: STIXMathJax_Main-bold; font-weight: bold;">Y</span></span></span><span class="mo" id="MathJax-Span-43" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mo" id="MathJax-Span-44" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">(</span><span class="msubsup" id="MathJax-Span-45"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-46" style="font-family: STIXMathJax_Main; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-47"><span class="mrow" id="MathJax-Span-48"><span class="mo" id="MathJax-Span-49" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mn" id="MathJax-Span-50" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-51" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-52" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-53" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-54" style="font-family: STIXMathJax_Main; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-55"><span class="mrow" id="MathJax-Span-56"><span class="mo" id="MathJax-Span-57" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mn" id="MathJax-Span-58" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span class="mo" id="MathJax-Span-59" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-60" style="font-family: STIXMathJax_Main;">,</span><span class="mo" id="MathJax-Span-61" style="font-family: STIXMathJax_Main; padding-left: 0.182em;">.</span><span class="mo" id="MathJax-Span-62" style="font-family: STIXMathJax_Main; padding-left: 0.182em;">.</span><span class="mo" id="MathJax-Span-63" style="font-family: STIXMathJax_Main; padding-left: 0.182em;">.</span><span class="mo" id="MathJax-Span-64" style="font-family: STIXMathJax_Main; padding-left: 0.182em;">,</span><span class="msubsup" id="MathJax-Span-65" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.729em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-66" style="font-family: STIXMathJax_Main; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-67"><span class="mrow" id="MathJax-Span-68"><span class="mo" id="MathJax-Span-69" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="msubsup" id="MathJax-Span-70"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-71" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.866em; left: 0.42em;"><span class="mi" id="MathJax-Span-72" style="font-size: 50%; font-family: STIXMathJax_Main; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-73" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-74" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.622em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Y</mi></mrow><mo>=</mo><mo stretchy="false">(</mo><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>,</mo><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mn>2</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><msub><mi>T</mi><mi>x</mi></msub><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-2">\mathbf{Y} = (y^{\langle 1 \rangle}, y^{\langle 2 \rangle}, ..., y^{\langle T_x \rangle})</script> is the same list of characters but shifted one character forward. </li>
<li>At every time-step <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-75" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.42em, 2.503em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-76"><span class="mi" id="MathJax-Span-77" style="font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">t</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-78" role="math" style="width: 5.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.824em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1004.82em, 2.682em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-79"><span class="msubsup" id="MathJax-Span-80"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-81" style="font-family: STIXMathJax_Main; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-82"><span class="mrow" id="MathJax-Span-83"><span class="mo" id="MathJax-Span-84" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-85" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-86" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-87" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-88" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-89" style="font-family: STIXMathJax_Main; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-90"><span class="mrow" id="MathJax-Span-91"><span class="mo" id="MathJax-Span-92" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-93" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-94" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span><span class="mn" id="MathJax-Span-95" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-96" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>=</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-4">y^{\langle t \rangle} = x^{\langle t+1 \rangle}</script>.  The prediction at time <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-97" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.42em, 2.503em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-98"><span class="mi" id="MathJax-Span-99" style="font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">t</script> is the same as the input at time <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-100" role="math" style="width: 2.682em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em, 1002.09em, 2.562em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-101"><span class="mi" id="MathJax-Span-102" style="font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-103" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="mn" id="MathJax-Span-104" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.139em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-6">t + 1</script>.</li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59009px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 127px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.5185px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 2 - Building blocks of the model</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">In this part, you will build two important blocks of the overall model:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Gradient clipping: to avoid exploding gradients</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Sampling: a technique used to generate characters</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">You will then apply these two functions to build the model.</span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 127px;"></div><div class="CodeMirror-gutters" style="display: none; height: 139px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="2---Building-blocks-of-the-model">2 - Building blocks of the model<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#2---Building-blocks-of-the-model">¶</a></h2>
<p>In this part, you will build two important blocks of the overall model:</p>
<ul>
<li>Gradient clipping: to avoid exploding gradients</li>
<li>Sampling: a technique used to generate characters</li>
</ul>
<p>You will then apply these two functions to build the model.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59009px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 843px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.037px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### 2.1 - Clipping the gradients in the optimization loop</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">In this section you will implement the <span class="cm-comment">`clip`</span> function that you will call inside of your optimization loop. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Exploding gradients</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* When gradients are very large, they're called "exploding gradients."</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Exploding gradients make the training process more difficult, because the updates may be so large that they "overshoot" the optimal values during back propagation.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Recall that your overall loop structure usually consists of:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* forward pass, </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* cost computation, </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* backward pass, </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* parameter update. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Before updating the parameters, you will perform gradient clipping to make sure that your gradients are not "exploding."</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### gradient clipping</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">In the exercise below, you will implement a function <span class="cm-comment">`clip`</span> that takes in a dictionary of gradients and returns a clipped version of gradients if needed. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* There are different ways to clip gradients.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* We will use a simple element-wise clipping procedure, in which every element of the gradient vector is clipped to lie between some range [-N, N]. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* For example, if the N=10</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- The range is [-10, 10]</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- If any component of the gradient vector is greater than 10, it is set to 10.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- If any component of the gradient vector is less than -10, it is set to -10. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- If any components are between -10 and 10, they keep their original values.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/clip.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:400;height:150px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> **Figure 2**: Visualization of gradient descent with and without gradient clipping, in a case where the network is running into "exploding gradient" problems. <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Exercise**</span>: </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Implement the function below to return the clipped gradients of your dictionary <span class="cm-comment">`gradients`</span>. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Your function takes in a maximum threshold and returns the clipped versions of the gradients. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* You can check out </span><span class="cm-link cm-variable-2">[numpy.clip]</span><span class="cm-string cm-url cm-variable-2">(https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.clip.html)</span><span class="cm-variable-2">. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- You will need to use the argument "</span><span class="cm-comment cm-variable-3">`out = ...`</span><span class="cm-variable-3">".</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Using the "</span><span class="cm-comment cm-variable-3">`out`</span><span class="cm-variable-3">" parameter allows you to update a variable "in-place".</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- If you don't use "</span><span class="cm-comment cm-variable-3">`out`</span><span class="cm-variable-3">" argument, the clipped variable is stored in the variable "gradient" but does not update the gradient variables </span><span class="cm-comment cm-variable-3">`dWax`</span><span class="cm-variable-3">, </span><span class="cm-comment cm-variable-3">`dWaa`</span><span class="cm-variable-3">, </span><span class="cm-comment cm-variable-3">`dWya`</span><span class="cm-variable-3">, </span><span class="cm-comment cm-variable-3">`db`</span><span class="cm-variable-3">, </span><span class="cm-comment cm-variable-3">`dby`</span><span class="cm-variable-3">.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 843px;"></div><div class="CodeMirror-gutters" style="display: none; height: 855px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="2.1---Clipping-the-gradients-in-the-optimization-loop">2.1 - Clipping the gradients in the optimization loop<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#2.1---Clipping-the-gradients-in-the-optimization-loop">¶</a></h3>
<p>In this section you will implement the <code>clip</code> function that you will call inside of your optimization loop. </p>
<h4 id="Exploding-gradients">Exploding gradients<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#Exploding-gradients">¶</a></h4>
<ul>
<li>When gradients are very large, they're called "exploding gradients."  </li>
<li>Exploding gradients make the training process more difficult, because the updates may be so large that they "overshoot" the optimal values during back propagation.</li>
</ul>
<p>Recall that your overall loop structure usually consists of:</p>
<ul>
<li>forward pass, </li>
<li>cost computation, </li>
<li>backward pass, </li>
<li>parameter update. </li>
</ul>
<p>Before updating the parameters, you will perform gradient clipping to make sure that your gradients are not "exploding."</p>
<h4 id="gradient-clipping">gradient clipping<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#gradient-clipping">¶</a></h4>
<p>In the exercise below, you will implement a function <code>clip</code> that takes in a dictionary of gradients and returns a clipped version of gradients if needed. </p>
<ul>
<li>There are different ways to clip gradients.</li>
<li>We will use a simple element-wise clipping procedure, in which every element of the gradient vector is clipped to lie between some range [-N, N]. </li>
<li>For example, if the N=10<ul>
<li>The range is [-10, 10]</li>
<li>If any component of the gradient vector is greater than 10, it is set to 10.</li>
<li>If any component of the gradient vector is less than -10, it is set to -10. </li>
<li>If any components are between -10 and 10, they keep their original values.</li>
</ul>
</li>
</ul>
<p><img src="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/clip.png" style="width: 400 ; height: 150px"></p>
<center> <strong>Figure 2</strong>: Visualization of gradient descent with and without gradient clipping, in a case where the network is running into "exploding gradient" problems. </center>

<p><strong>Exercise</strong>: 
Implement the function below to return the clipped gradients of your dictionary <code>gradients</code>. </p>
<ul>
<li>Your function takes in a maximum threshold and returns the clipped versions of the gradients. </li>
<li>You can check out <a href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.clip.html" target="_blank">numpy.clip</a>. <ul>
<li>You will need to use the argument "<code>out = ...</code>".</li>
<li>Using the "<code>out</code>" parameter allows you to update a variable "in-place".</li>
<li>If you don't use "<code>out</code>" argument, the clipped variable is stored in the variable "gradient" but does not update the gradient variables <code>dWax</code>, <code>dWaa</code>, <code>dWya</code>, <code>db</code>, <code>dby</code>.</li>
</ul>
</li>
</ul>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[7]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 282.627px; left: 268.206px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 18px; width: 18px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="false"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 826.31px; margin-bottom: -19px; border-right-width: 11px; min-height: 419px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 262.616px; top: 277.037px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">### GRADED FUNCTION: clip</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">clip</span>(<span class="cm-variable">gradients</span>, <span class="cm-variable">maxValue</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">'''</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Clips the gradients' values between minimum and maximum.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    gradients -- a dictionary containing the gradients "dWaa", "dWax", "dWya", "db", "dby"</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    maxValue -- everything above this number is set to this number, and everything less than -maxValue is set to -maxValue</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Returns: </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    gradients -- a dictionary with the clipped gradients.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    '''</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dWaa</span>, <span class="cm-variable">dWax</span>, <span class="cm-variable">dWya</span>, <span class="cm-variable">db</span>, <span class="cm-variable">dby</span> = <span class="cm-variable">gradients</span>[<span class="cm-string">'dWaa'</span>], <span class="cm-variable">gradients</span>[<span class="cm-string">'dWax'</span>], <span class="cm-variable">gradients</span>[<span class="cm-string">'dWya'</span>], <span class="cm-variable">gradients</span>[<span class="cm-string">'db'</span>], <span class="cm-variable">gradients</span>[<span class="cm-string">'dby'</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">   </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-null cm-error">    </span><span class="cm-comment">### START CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># clip to mitigate exploding gradients, loop over [dWax, dWaa, dWya, db, dby]. (≈2 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">for</span> <span class="cm-variable">gradient</span> <span class="cm-keyword">in</span> [<span class="cm-variable">dWax</span>, <span class="cm-variable">dWaa</span>, <span class="cm-variable">dWya</span>, <span class="cm-variable">db</span>, <span class="cm-variable">dby</span>]:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">np</span>.<span class="cm-property">clip</span>(<span class="cm-variable">gradient</span>,<span class="cm-operator">-</span><span class="cm-variable">maxValue</span>,<span class="cm-variable">maxValue</span>,<span class="cm-variable">out</span>=<span class="cm-variable">gradient</span>)<span class="cm-comment">#note out</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">gradients</span> = {<span class="cm-string">"dWaa"</span>: <span class="cm-variable">dWaa</span>, <span class="cm-string">"dWax"</span>: <span class="cm-variable">dWax</span>, <span class="cm-string">"dWya"</span>: <span class="cm-variable">dWya</span>, <span class="cm-string">"db"</span>: <span class="cm-variable">db</span>, <span class="cm-string">"dby"</span>: <span class="cm-variable">dby</span>}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">gradients</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 419px;"></div><div class="CodeMirror-gutters" style="display: none; height: 430px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[8]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 38.1834px; left: 131.447px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 18px; width: 18px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 538.938px; margin-bottom: -19px; border-right-width: 11px; min-height: 256px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 125.857px; top: 32.5926px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># Test with a maxvalue of 10</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">maxValue</span> = <span class="cm-number">10</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">seed</span>(<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">dWax</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">10</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">dWaa</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">5</span>)<span class="cm-operator">*</span><span class="cm-number">10</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">dWya</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">2</span>,<span class="cm-number">5</span>)<span class="cm-operator">*</span><span class="cm-number">10</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">db</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">1</span>)<span class="cm-operator">*</span><span class="cm-number">10</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">dby</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">2</span>,<span class="cm-number">1</span>)<span class="cm-operator">*</span><span class="cm-number">10</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients</span> = {<span class="cm-string">"dWax"</span>: <span class="cm-variable">dWax</span>, <span class="cm-string">"dWaa"</span>: <span class="cm-variable">dWaa</span>, <span class="cm-string">"dWya"</span>: <span class="cm-variable">dWya</span>, <span class="cm-string">"db"</span>: <span class="cm-variable">db</span>, <span class="cm-string">"dby"</span>: <span class="cm-variable">dby</span>}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients</span> = <span class="cm-variable">clip</span>(<span class="cm-variable">gradients</span>, <span class="cm-variable">maxValue</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWaa\"][1][2] ="</span>, <span class="cm-variable">gradients</span>[<span class="cm-string">"dWaa"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWax\"][3][1] ="</span>, <span class="cm-variable">gradients</span>[<span class="cm-string">"dWax"</span>][<span class="cm-number">3</span>][<span class="cm-number">1</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWya\"][1][2] ="</span>, <span class="cm-variable">gradients</span>[<span class="cm-string">"dWya"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"db\"][4] ="</span>, <span class="cm-variable">gradients</span>[<span class="cm-string">"db"</span>][<span class="cm-number">4</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dby\"][1] ="</span>, <span class="cm-variable">gradients</span>[<span class="cm-string">"dby"</span>][<span class="cm-number">1</span>])</span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 256px;"></div><div class="CodeMirror-gutters" style="display: none; height: 267px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>gradients["dWaa"][1][2] = 10.0
gradients["dWax"][3][1] = -10.0
gradients["dWya"][1][2] = 0.29713815361
gradients["db"][4] = [ 10.]
gradients["dby"][1] = [ 8.45833407]
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 39px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Type <em>Markdown</em> and LaTeX: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-105" role="math" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em, 1000.96em, 2.384em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-106"><span class="msubsup" id="MathJax-Span-107"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-108" style="font-family: STIXMathJax_Main; font-style: italic;">α</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.539em;"><span class="mn" id="MathJax-Span-109" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>α</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-7">\alpha^2</script></p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 158px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">** Expected output:**</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```Python</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients</span>[<span class="cm-string">"dWaa"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>] = <span class="cm-number">10.0</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients</span>[<span class="cm-string">"dWax"</span>][<span class="cm-number">3</span>][<span class="cm-number">1</span>] = <span class="cm-operator">-</span><span class="cm-number">10.0</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients</span>[<span class="cm-string">"dWya"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>] = <span class="cm-number">0.29713815361</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients</span>[<span class="cm-string">"db"</span>][<span class="cm-number">4</span>] = [ <span class="cm-number">10.</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients</span>[<span class="cm-string">"dby"</span>][<span class="cm-number">1</span>] = [ <span class="cm-number">8.45833407</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 158px;"></div><div class="CodeMirror-gutters" style="display: none; height: 170px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong> Expected output:</strong></p>
<pre><code class="cm-s-ipython language-Python"><span class="cm-variable">gradients</span>[<span class="cm-string">"dWaa"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>] = <span class="cm-number">10.0</span>
<span class="cm-variable">gradients</span>[<span class="cm-string">"dWax"</span>][<span class="cm-number">3</span>][<span class="cm-number">1</span>] = <span class="cm-operator">-</span><span class="cm-number">10.0</span>
<span class="cm-variable">gradients</span>[<span class="cm-string">"dWya"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>] = <span class="cm-number">0.29713815361</span>
<span class="cm-variable">gradients</span>[<span class="cm-string">"db"</span>][<span class="cm-number">4</span>] = [ <span class="cm-number">10.</span>]
<span class="cm-variable">gradients</span>[<span class="cm-string">"dby"</span>][<span class="cm-number">1</span>] = [ <span class="cm-number">8.45833407</span>]
</code></pre>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[9]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 233.739px; left: 314.329px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 18px; width: 18px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 538.938px; margin-bottom: -19px; border-right-width: 11px; min-height: 256px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 308.738px; top: 228.148px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># Test with a maxValue of 5</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">maxValue</span> = <span class="cm-number">5</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">seed</span>(<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">dWax</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">10</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">dWaa</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">5</span>)<span class="cm-operator">*</span><span class="cm-number">10</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">dWya</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">2</span>,<span class="cm-number">5</span>)<span class="cm-operator">*</span><span class="cm-number">10</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">db</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">1</span>)<span class="cm-operator">*</span><span class="cm-number">10</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">dby</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">2</span>,<span class="cm-number">1</span>)<span class="cm-operator">*</span><span class="cm-number">10</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients</span> = {<span class="cm-string">"dWax"</span>: <span class="cm-variable">dWax</span>, <span class="cm-string">"dWaa"</span>: <span class="cm-variable">dWaa</span>, <span class="cm-string">"dWya"</span>: <span class="cm-variable">dWya</span>, <span class="cm-string">"db"</span>: <span class="cm-variable">db</span>, <span class="cm-string">"dby"</span>: <span class="cm-variable">dby</span>}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients</span> = <span class="cm-variable">clip</span>(<span class="cm-variable">gradients</span>, <span class="cm-variable">maxValue</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWaa\"][1][2] ="</span>, <span class="cm-variable">gradients</span>[<span class="cm-string">"dWaa"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWax\"][3][1] ="</span>, <span class="cm-variable">gradients</span>[<span class="cm-string">"dWax"</span>][<span class="cm-number">3</span>][<span class="cm-number">1</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWya\"][1][2] ="</span>, <span class="cm-variable">gradients</span>[<span class="cm-string">"dWya"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"db\"][4] ="</span>, <span class="cm-variable">gradients</span>[<span class="cm-string">"db"</span>][<span class="cm-number">4</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dby\"][1] ="</span>, <span class="cm-variable">gradients</span>[<span class="cm-string">"dby"</span>][<span class="cm-number">1</span>])</span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 256px;"></div><div class="CodeMirror-gutters" style="display: none; height: 267px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>gradients["dWaa"][1][2] = 5.0
gradients["dWax"][3][1] = -5.0
gradients["dWya"][1][2] = 0.29713815361
gradients["db"][4] = [ 5.]
gradients["dby"][1] = [ 5.]
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 141px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">** Expected Output: **</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```Python</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients</span>[<span class="cm-string">"dWaa"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>] = <span class="cm-number">5.0</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients</span>[<span class="cm-string">"dWax"</span>][<span class="cm-number">3</span>][<span class="cm-number">1</span>] = <span class="cm-operator">-</span><span class="cm-number">5.0</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients</span>[<span class="cm-string">"dWya"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>] = <span class="cm-number">0.29713815361</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients</span>[<span class="cm-string">"db"</span>][<span class="cm-number">4</span>] = [ <span class="cm-number">5.</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients</span>[<span class="cm-string">"dby"</span>][<span class="cm-number">1</span>] = [ <span class="cm-number">5.</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 141px;"></div><div class="CodeMirror-gutters" style="display: none; height: 153px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong> Expected Output: </strong></p>
<pre><code class="cm-s-ipython language-Python"><span class="cm-variable">gradients</span>[<span class="cm-string">"dWaa"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>] = <span class="cm-number">5.0</span>
<span class="cm-variable">gradients</span>[<span class="cm-string">"dWax"</span>][<span class="cm-number">3</span>][<span class="cm-number">1</span>] = <span class="cm-operator">-</span><span class="cm-number">5.0</span>
<span class="cm-variable">gradients</span>[<span class="cm-string">"dWya"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>] = <span class="cm-number">0.29713815361</span>
<span class="cm-variable">gradients</span>[<span class="cm-string">"db"</span>][<span class="cm-number">4</span>] = [ <span class="cm-number">5.</span>]
<span class="cm-variable">gradients</span>[<span class="cm-string">"dby"</span>][<span class="cm-number">1</span>] = [ <span class="cm-number">5.</span>]
</code></pre>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 191px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.037px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### 2.2 - Sampling</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Now assume that your model is trained. You would like to generate new text (characters). The process of generation is explained in the picture below:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/dinos3.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:500;height:300px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> **Figure 3**: In this picture, we assume the model is already trained. We pass in <span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> <span class="cm-atom">1</span><span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> = <span class="cm-tag">\vec</span><span class="cm-bracket">{</span><span class="cm-atom">0</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> at the first time step, and have the network sample one character at a time. <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 191px;"></div><div class="CodeMirror-gutters" style="display: none; height: 203px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="2.2---Sampling">2.2 - Sampling<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#2.2---Sampling">¶</a></h3>
<p>Now assume that your model is trained. You would like to generate new text (characters). The process of generation is explained in the picture below:</p>
<p><img src="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/dinos3.png" style="width: 500 ; height: 300px"></p>
<center> <strong>Figure 3</strong>: In this picture, we assume the model is already trained. We pass in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-110" role="math" style="width: 4.051em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1003.34em, 2.503em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-111"><span class="msubsup" id="MathJax-Span-112"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-113" style="font-family: STIXMathJax_Main; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-114"><span class="mrow" id="MathJax-Span-115"><span class="mo" id="MathJax-Span-116" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mn" id="MathJax-Span-117" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-118" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-119" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="texatom" id="MathJax-Span-120" style="padding-left: 0.301em;"><span class="mrow" id="MathJax-Span-121"><span class="munderover" id="MathJax-Span-122"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mn" id="MathJax-Span-123" style="font-family: STIXMathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.479em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-124" style="font-family: STIXMathJax_Main;">⃗&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.89em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">→</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-8">x^{\langle 1\rangle} = \vec{0}</script> at the first time step, and have the network sample one character at a time. </center></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 125px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 15.9255px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Exercise**</span>: Implement the <span class="cm-comment">`sample`</span> function below to sample characters. You need to carry out 4 steps:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-strong cm-variable-2">**Step 1**</span><span class="cm-variable-2">: Input the "dummy" vector of zeros </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> <span class="cm-atom">1</span> <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> = <span class="cm-tag">\vec</span><span class="cm-bracket">{</span><span class="cm-atom">0</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- This is the default input before we've generated any characters. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">We also set </span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> <span class="cm-atom">0</span> <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> = <span class="cm-tag">\vec</span><span class="cm-bracket">{</span><span class="cm-atom">0</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 125px;"></div><div class="CodeMirror-gutters" style="display: none; height: 137px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Exercise</strong>: Implement the <code>sample</code> function below to sample characters. You need to carry out 4 steps:</p>
<ul>
<li><strong>Step 1</strong>: Input the "dummy" vector of zeros <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-125" role="math" style="width: 4.051em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1003.34em, 2.503em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-126"><span class="msubsup" id="MathJax-Span-127"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-128" style="font-family: STIXMathJax_Main; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-129"><span class="mrow" id="MathJax-Span-130"><span class="mo" id="MathJax-Span-131" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mn" id="MathJax-Span-132" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-133" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-134" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="texatom" id="MathJax-Span-135" style="padding-left: 0.301em;"><span class="mrow" id="MathJax-Span-136"><span class="munderover" id="MathJax-Span-137"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mn" id="MathJax-Span-138" style="font-family: STIXMathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.479em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-139" style="font-family: STIXMathJax_Main;">⃗&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.89em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">→</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-9">x^{\langle 1 \rangle} = \vec{0}</script>. <ul>
<li>This is the default input before we've generated any characters. 
We also set <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-140" role="math" style="width: 4.051em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1003.34em, 2.503em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-141"><span class="msubsup" id="MathJax-Span-142"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-143" style="font-family: STIXMathJax_Main; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-144"><span class="mrow" id="MathJax-Span-145"><span class="mo" id="MathJax-Span-146" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mn" id="MathJax-Span-147" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span><span class="mo" id="MathJax-Span-148" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-149" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="texatom" id="MathJax-Span-150" style="padding-left: 0.301em;"><span class="mrow" id="MathJax-Span-151"><span class="munderover" id="MathJax-Span-152"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mn" id="MathJax-Span-153" style="font-family: STIXMathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.479em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-154" style="font-family: STIXMathJax_Main;">⃗&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.89em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mn>0</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">→</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-10">a^{\langle 0 \rangle} = \vec{0}</script></li>
</ul>
</li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 353px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 15.9255px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-strong cm-variable-2">**Step 2**</span><span class="cm-variable-2">: Run one step of forward propagation to get </span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> <span class="cm-atom">1</span> <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> and </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> <span class="cm-atom">1</span> <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">. Here are the equations:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">hidden state:<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$$</span> a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t+1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> = <span class="cm-tag">\tanh</span>(W_<span class="cm-bracket">{</span>ax<span class="cm-bracket">}</span>  x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t+1 <span class="cm-tag">\rangle</span> <span class="cm-bracket">}</span> + W_<span class="cm-bracket">{</span>aa<span class="cm-bracket">}</span> a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span> <span class="cm-bracket">}</span> + b)<span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">1</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">activation:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$$</span> z^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t + 1 <span class="cm-tag">\rangle</span> <span class="cm-bracket">}</span> = W_<span class="cm-bracket">{</span>ya<span class="cm-bracket">}</span>  a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t + 1 <span class="cm-tag">\rangle</span> <span class="cm-bracket">}</span> + b_y <span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">2</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">prediction:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$$</span> <span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t+1 <span class="cm-tag">\rangle</span> <span class="cm-bracket">}</span> = softmax(z^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t + 1 <span class="cm-tag">\rangle</span> <span class="cm-bracket">}</span>)<span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">3</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Details about </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t+1 <span class="cm-tag">\rangle</span> <span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable-3">- Note that </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t+1 <span class="cm-tag">\rangle</span> <span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3"> is a (softmax) probability vector (its entries are between 0 and 1 and sum to 1). </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable-3">- </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t+1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>_i<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3"> represents the probability that the character indexed by "i" is the next character.</span><span class="cm-variable-3 cm-trailing-space-a"> </span><span class="cm-variable-3 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable-3">- We have provided a </span><span class="cm-comment cm-variable-3">`softmax()`</span><span class="cm-variable-3"> function that you can use.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 353px;"></div><div class="CodeMirror-gutters" style="display: none; height: 365px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><ul>
<li><strong>Step 2</strong>: Run one step of forward propagation to get <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-155" role="math" style="width: 1.789em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1001.49em, 2.384em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-156"><span class="msubsup" id="MathJax-Span-157"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-158" style="font-family: STIXMathJax_Main; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-159"><span class="mrow" id="MathJax-Span-160"><span class="mo" id="MathJax-Span-161" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mn" id="MathJax-Span-162" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-163" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-11">a^{\langle 1 \rangle}</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-164" role="math" style="width: 1.729em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.015em, 1001.43em, 2.562em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-165"><span class="msubsup" id="MathJax-Span-166"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-167"><span class="mrow" id="MathJax-Span-168"><span class="munderover" id="MathJax-Span-169"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-170" style="font-family: STIXMathJax_Main; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-171" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-172"><span class="mrow" id="MathJax-Span-173"><span class="mo" id="MathJax-Span-174" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mn" id="MathJax-Span-175" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-176" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-12">\hat{y}^{\langle 1 \rangle}</script>. Here are the equations:</li>
</ul>
<p>hidden state:<br><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="width: 100%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-1&quot;&gt;&lt;mtext&gt;(1)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;tanh&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-177" role="math" style="width: 100%; display: inline-block; min-width: 19.586em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 19.586em;"><span style="position: absolute; clip: rect(2.979em, 1015.36em, 4.467em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-178"><span class="mtable" id="MathJax-Span-179" style="min-width: 19.586em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 19.586em;"><span style="display: inline-block; position: absolute; width: 15.42em; height: 0px; clip: rect(-1.009em, 1015.36em, 0.479em, -999.997em); top: 0.003em; left: 50%; margin-left: -7.735em;"><span style="position: absolute; clip: rect(2.979em, 1015.36em, 4.467em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 15.42em; height: 0px;"><span style="position: absolute; clip: rect(2.92em, 1015.36em, 4.348em, -999.997em); top: -3.866em; left: 50%; margin-left: -7.735em;"><span class="mtd" id="MathJax-Span-183"><span class="mrow" id="MathJax-Span-184"><span class="msubsup" id="MathJax-Span-185"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-186" style="font-family: STIXMathJax_Main; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-187"><span class="mrow" id="MathJax-Span-188"><span class="mo" id="MathJax-Span-189" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-190" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-191" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span><span class="mn" id="MathJax-Span-192" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-193" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-194" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-195" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">tanh</span><span class="mo" id="MathJax-Span-196"></span><span class="mo" id="MathJax-Span-197" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-198"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-199" style="font-family: STIXMathJax_Main; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-200"><span class="mrow" id="MathJax-Span-201"><span class="mi" id="MathJax-Span-202" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">a</span><span class="mi" id="MathJax-Span-203" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-204"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-205" style="font-family: STIXMathJax_Main; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-206"><span class="mrow" id="MathJax-Span-207"><span class="mo" id="MathJax-Span-208" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-209" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-210" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span><span class="mn" id="MathJax-Span-211" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-212" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-213" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-214" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-215" style="font-family: STIXMathJax_Main; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-216"><span class="mrow" id="MathJax-Span-217"><span class="mi" id="MathJax-Span-218" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">a</span><span class="mi" id="MathJax-Span-219" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-220"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-221" style="font-family: STIXMathJax_Main; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-222"><span class="mrow" id="MathJax-Span-223"><span class="mo" id="MathJax-Span-224" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-225" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-226" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-227" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="mi" id="MathJax-Span-228" style="font-family: STIXMathJax_Main; font-style: italic; padding-left: 0.241em;">b</span><span class="mo" id="MathJax-Span-229" style="font-family: STIXMathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.193em; height: 0px; clip: rect(-0.771em, 1001.13em, 0.479em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.13em, 4.348em, -999.997em); top: -3.866em; right: 0.003em;"><span class="mtd" id="mjx-eqn-1"><span class="mrow" id="MathJax-Span-181"><span class="mtext" id="MathJax-Span-182" style="font-family: STIXMathJax_Main;">(1)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-1"><mtext>(1)</mtext></mtd><mtd><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>=</mo><mi>tanh</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>x</mi></mrow></msub><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>a</mi></mrow></msub><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-13"> a^{\langle t+1 \rangle} = \tanh(W_{ax}  x^{\langle t+1 \rangle } + W_{aa} a^{\langle t \rangle } + b)\tag{1}</script></p>
<p>activation:
<span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="width: 100%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-2&quot;&gt;&lt;mtext&gt;(2)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-230" role="math" style="width: 100%; display: inline-block; min-width: 13.336em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 13.336em;"><span style="position: absolute; clip: rect(2.979em, 1009.17em, 4.527em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-231"><span class="mtable" id="MathJax-Span-232" style="min-width: 13.336em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 13.336em;"><span style="display: inline-block; position: absolute; width: 9.17em; height: 0px; clip: rect(-1.009em, 1009.17em, 0.539em, -999.997em); top: 0.003em; left: 50%; margin-left: -4.58em;"><span style="position: absolute; clip: rect(2.979em, 1009.17em, 4.527em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 9.17em; height: 0px;"><span style="position: absolute; clip: rect(2.92em, 1009.17em, 4.467em, -999.997em); top: -3.926em; left: 50%; margin-left: -4.58em;"><span class="mtd" id="MathJax-Span-236"><span class="mrow" id="MathJax-Span-237"><span class="msubsup" id="MathJax-Span-238"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.36em, 4.229em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-239" style="font-family: STIXMathJax_Main; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.42em;"><span class="texatom" id="MathJax-Span-240"><span class="mrow" id="MathJax-Span-241"><span class="mo" id="MathJax-Span-242" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-243" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-244" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span><span class="mn" id="MathJax-Span-245" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-246" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-247" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-248" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.551em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-249" style="font-family: STIXMathJax_Main; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-250"><span class="mrow" id="MathJax-Span-251"><span class="mi" id="MathJax-Span-252" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">y</span><span class="mi" id="MathJax-Span-253" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-254"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-255" style="font-family: STIXMathJax_Main; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-256"><span class="mrow" id="MathJax-Span-257"><span class="mo" id="MathJax-Span-258" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-259" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-260" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span><span class="mn" id="MathJax-Span-261" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-262" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-263" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-264" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-265" style="font-family: STIXMathJax_Main; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-266" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.193em; height: 0px; clip: rect(-0.771em, 1001.13em, 0.42em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.13em, 4.348em, -999.997em); top: -3.926em; right: 0.003em;"><span class="mtd" id="mjx-eqn-2"><span class="mrow" id="MathJax-Span-234"><span class="mtext" id="MathJax-Span-235" style="font-family: STIXMathJax_Main;">(2)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.496em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-2"><mtext>(2)</mtext></mtd><mtd><msup><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>=</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>a</mi></mrow></msub><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msub><mi>b</mi><mi>y</mi></msub></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-14"> z^{\langle t + 1 \rangle } = W_{ya}  a^{\langle t + 1 \rangle } + b_y \tag{2}</script></p>
<p>prediction:
<span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="width: 100%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-3&quot;&gt;&lt;mtext&gt;(3)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-267" role="math" style="width: 100%; display: inline-block; min-width: 13.574em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 13.574em;"><span style="position: absolute; clip: rect(2.979em, 1009.41em, 4.527em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-268"><span class="mtable" id="MathJax-Span-269" style="min-width: 13.574em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 13.574em;"><span style="display: inline-block; position: absolute; width: 9.467em; height: 0px; clip: rect(-1.009em, 1009.41em, 0.539em, -999.997em); top: 0.003em; left: 50%; margin-left: -4.699em;"><span style="position: absolute; clip: rect(2.979em, 1009.41em, 4.527em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 9.467em; height: 0px;"><span style="position: absolute; clip: rect(2.801em, 1009.41em, 4.348em, -999.997em); top: -3.866em; left: 50%; margin-left: -4.699em;"><span class="mtd" id="MathJax-Span-273"><span class="mrow" id="MathJax-Span-274"><span class="msubsup" id="MathJax-Span-275"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-276"><span class="mrow" id="MathJax-Span-277"><span class="munderover" id="MathJax-Span-278"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-279" style="font-family: STIXMathJax_Main; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-280" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-281"><span class="mrow" id="MathJax-Span-282"><span class="mo" id="MathJax-Span-283" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-284" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-285" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span><span class="mn" id="MathJax-Span-286" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-287" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-288" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-289" style="font-family: STIXMathJax_Main; font-style: italic; padding-left: 0.301em;">s</span><span class="mi" id="MathJax-Span-290" style="font-family: STIXMathJax_Main; font-style: italic;">o</span><span class="mi" id="MathJax-Span-291" style="font-family: STIXMathJax_Main; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span class="mi" id="MathJax-Span-292" style="font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-293" style="font-family: STIXMathJax_Main; font-style: italic;">m</span><span class="mi" id="MathJax-Span-294" style="font-family: STIXMathJax_Main; font-style: italic;">a</span><span class="mi" id="MathJax-Span-295" style="font-family: STIXMathJax_Main; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-296" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-297"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.36em, 4.229em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-298" style="font-family: STIXMathJax_Main; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.42em;"><span class="texatom" id="MathJax-Span-299"><span class="mrow" id="MathJax-Span-300"><span class="mo" id="MathJax-Span-301" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-302" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-303" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span><span class="mn" id="MathJax-Span-304" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-305" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-306" style="font-family: STIXMathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.193em; height: 0px; clip: rect(-0.711em, 1001.13em, 0.479em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.13em, 4.348em, -999.997em); top: -3.866em; right: 0.003em;"><span class="mtd" id="mjx-eqn-3"><span class="mrow" id="MathJax-Span-271"><span class="mtext" id="MathJax-Span-272" style="font-family: STIXMathJax_Main;">(3)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.496em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-3"><mtext>(3)</mtext></mtd><mtd><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>=</mo><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><msup><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo stretchy="false">)</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-15"> \hat{y}^{\langle t+1 \rangle } = softmax(z^{\langle t + 1 \rangle })\tag{3}</script></p>
<ul>
<li>Details about <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-307" role="math" style="width: 2.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.015em, 1002.15em, 2.562em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-308"><span class="msubsup" id="MathJax-Span-309"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-310"><span class="mrow" id="MathJax-Span-311"><span class="munderover" id="MathJax-Span-312"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-313" style="font-family: STIXMathJax_Main; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-314" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-315"><span class="mrow" id="MathJax-Span-316"><span class="mo" id="MathJax-Span-317" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-318" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-319" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span><span class="mn" id="MathJax-Span-320" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-321" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-16">\hat{y}^{\langle t+1 \rangle }</script>:<ul>
<li>Note that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-322" role="math" style="width: 2.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.015em, 1002.15em, 2.562em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-323"><span class="msubsup" id="MathJax-Span-324"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-325"><span class="mrow" id="MathJax-Span-326"><span class="munderover" id="MathJax-Span-327"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-328" style="font-family: STIXMathJax_Main; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-329" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-330"><span class="mrow" id="MathJax-Span-331"><span class="mo" id="MathJax-Span-332" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-333" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-334" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span><span class="mn" id="MathJax-Span-335" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-336" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-17">\hat{y}^{\langle t+1 \rangle }</script> is a (softmax) probability vector (its entries are between 0 and 1 and sum to 1). </li>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-337" role="math" style="width: 2.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.015em, 1002.15em, 2.682em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-338"><span class="msubsup" id="MathJax-Span-339"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-340"><span class="mrow" id="MathJax-Span-341"><span class="munderover" id="MathJax-Span-342"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-343" style="font-family: STIXMathJax_Main; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-344" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1001.67em, 4.348em, -999.997em); top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-345"><span class="mrow" id="MathJax-Span-346"><span class="mo" id="MathJax-Span-347" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-348" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-349" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span><span class="mn" id="MathJax-Span-350" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-351" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.42em;"><span class="mi" id="MathJax-Span-352" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-18">\hat{y}^{\langle t+1 \rangle}_i</script> represents the probability that the character indexed by "i" is the next character.  </li>
<li>We have provided a <code>softmax()</code> function that you can use.</li>
</ul>
</li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 256px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Additional Hints</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> <span class="cm-atom">1</span> <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> is </span><span class="cm-comment cm-variable-2">`x`</span><span class="cm-variable-2"> in the code. When creating the one-hot vector, make a numpy array of zeros, with the number of rows equal to the number of unique characters, and the number of columns equal to one.  It's a 2D and not a 1D array.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> <span class="cm-atom">0</span> <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> is </span><span class="cm-comment cm-variable-2">`a_prev`</span><span class="cm-variable-2"> in the code.  It is a numpy array of zeros, where the number of rows is </span><span class="cm-delimit cm-delimit-open">$</span>n_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">, and number of columns is 1.  It is a 2D array as well.</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line">&nbsp;</span><span class="cm-delimit cm-delimit-open">$</span>n_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2 cm-trailing-space-new-line"> is retrieved by getting the number of columns in </span><span class="cm-delimit cm-delimit-open">$</span>W_<span class="cm-bracket">{</span>aa<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2 cm-trailing-space-new-line"> (the numbers need to match in order for the matrix multiplication </span><span class="cm-delimit cm-delimit-open">$</span>W_<span class="cm-bracket">{</span>aa<span class="cm-bracket">}</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2 cm-trailing-space-new-line"> to work.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-link cm-variable-2">[numpy.dot]</span><span class="cm-string cm-url cm-variable-2">(https://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-link cm-variable-2">[numpy.tanh]</span><span class="cm-string cm-url cm-variable-2">(https://docs.scipy.org/doc/numpy/reference/generated/numpy.tanh.html)</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 256px;"></div><div class="CodeMirror-gutters" style="display: none; height: 268px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="Additional-Hints">Additional Hints<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#Additional-Hints">¶</a></h4>
<ul>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-353" role="math" style="width: 1.789em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1001.49em, 2.384em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-354"><span class="msubsup" id="MathJax-Span-355"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-356" style="font-family: STIXMathJax_Main; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-357"><span class="mrow" id="MathJax-Span-358"><span class="mo" id="MathJax-Span-359" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mn" id="MathJax-Span-360" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-361" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-19">x^{\langle 1 \rangle}</script> is <code>x</code> in the code. When creating the one-hot vector, make a numpy array of zeros, with the number of rows equal to the number of unique characters, and the number of columns equal to one.  It's a 2D and not a 1D array.</li>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-362" role="math" style="width: 1.789em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1001.49em, 2.384em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-363"><span class="msubsup" id="MathJax-Span-364"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-365" style="font-family: STIXMathJax_Main; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-366"><span class="mrow" id="MathJax-Span-367"><span class="mo" id="MathJax-Span-368" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mn" id="MathJax-Span-369" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span><span class="mo" id="MathJax-Span-370" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mn>0</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-20">a^{\langle 0 \rangle}</script> is <code>a_prev</code> in the code.  It is a numpy array of zeros, where the number of rows is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-371" role="math" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.96em, 2.562em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-372"><span class="msubsup" id="MathJax-Span-373"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-374" style="font-family: STIXMathJax_Main; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-375"><span class="mrow" id="MathJax-Span-376"><span class="mi" id="MathJax-Span-377" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-21">n_{a}</script>, and number of columns is 1.  It is a 2D array as well.  <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-378" role="math" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em, 1000.96em, 2.562em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-379"><span class="msubsup" id="MathJax-Span-380"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-381" style="font-family: STIXMathJax_Main; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-382"><span class="mrow" id="MathJax-Span-383"><span class="mi" id="MathJax-Span-384" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-22">n_{a}</script> is retrieved by getting the number of columns in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-385" role="math" style="width: 1.967em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.372em, 1001.61em, 2.562em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-386"><span class="msubsup" id="MathJax-Span-387"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-388" style="font-family: STIXMathJax_Main; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-389"><span class="mrow" id="MathJax-Span-390"><span class="mi" id="MathJax-Span-391" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">a</span><span class="mi" id="MathJax-Span-392" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>a</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-23">W_{aa}</script> (the numbers need to match in order for the matrix multiplication <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-393" role="math" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.979em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1002.98em, 2.562em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-394"><span class="msubsup" id="MathJax-Span-395"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-396" style="font-family: STIXMathJax_Main; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-397"><span class="mrow" id="MathJax-Span-398"><span class="mi" id="MathJax-Span-399" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">a</span><span class="mi" id="MathJax-Span-400" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-401"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-402" style="font-family: STIXMathJax_Main; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-403"><span class="mrow" id="MathJax-Span-404"><span class="mo" id="MathJax-Span-405" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-406" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-407" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>a</mi></mrow></msub><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-24">W_{aa}a^{\langle t \rangle}</script> to work.</li>
<li><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html" target="_blank">numpy.dot</a></li>
<li><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.tanh.html" target="_blank">numpy.tanh</a></li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 190px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Using 2D arrays instead of 1D arrays</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* You may be wondering why we emphasize that </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> <span class="cm-atom">1</span> <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> and </span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> <span class="cm-atom">0</span> <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> are 2D arrays and not 1D vectors.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* For matrix multiplication in numpy, if we multiply a 2D matrix with a 1D vector, we end up with with a 1D array.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* This becomes a problem when we add two arrays where we expected them to have the same shape.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* When two arrays with  a different number of dimensions are added together, Python "broadcasts" one across the other.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Here is some sample code that shows the difference between using a 1D and 2D array.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 190px;"></div><div class="CodeMirror-gutters" style="display: none; height: 202px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="Using-2D-arrays-instead-of-1D-arrays">Using 2D arrays instead of 1D arrays<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#Using-2D-arrays-instead-of-1D-arrays">¶</a></h4>
<ul>
<li>You may be wondering why we emphasize that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-408" role="math" style="width: 1.789em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1001.49em, 2.384em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-409"><span class="msubsup" id="MathJax-Span-410"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-411" style="font-family: STIXMathJax_Main; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-412"><span class="mrow" id="MathJax-Span-413"><span class="mo" id="MathJax-Span-414" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mn" id="MathJax-Span-415" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-416" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-25">x^{\langle 1 \rangle}</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-417" role="math" style="width: 1.789em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1001.49em, 2.384em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-418"><span class="msubsup" id="MathJax-Span-419"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-420" style="font-family: STIXMathJax_Main; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-421"><span class="mrow" id="MathJax-Span-422"><span class="mo" id="MathJax-Span-423" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mn" id="MathJax-Span-424" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span><span class="mo" id="MathJax-Span-425" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mn>0</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-26">a^{\langle 0 \rangle}</script> are 2D arrays and not 1D vectors.</li>
<li>For matrix multiplication in numpy, if we multiply a 2D matrix with a 1D vector, we end up with with a 1D array.</li>
<li>This becomes a problem when we add two arrays where we expected them to have the same shape.</li>
<li>When two arrays with  a different number of dimensions are added together, Python "broadcasts" one across the other.</li>
<li>Here is some sample code that shows the difference between using a 1D and 2D array.</li>
</ul>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[10]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59082px; left: 145.417px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 142.826px; margin-bottom: -19px; border-right-width: 11px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 139.826px; top: 0px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 38px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[11]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 54.4797px; left: 242.928px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 285.824px; margin-bottom: -19px; border-right-width: 11px; min-height: 141px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 237.338px; top: 48.8889px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">matrix1</span> = <span class="cm-variable">np</span>.<span class="cm-property">array</span>([[<span class="cm-number">1</span>,<span class="cm-number">1</span>],[<span class="cm-number">2</span>,<span class="cm-number">2</span>],[<span class="cm-number">3</span>,<span class="cm-number">3</span>]]) <span class="cm-comment"># (3,2)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">matrix2</span> = <span class="cm-variable">np</span>.<span class="cm-property">array</span>([[<span class="cm-number">0</span>],[<span class="cm-number">0</span>],[<span class="cm-number">0</span>]]) <span class="cm-comment"># (3,1) </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">vector1D</span> = <span class="cm-variable">np</span>.<span class="cm-property">array</span>([<span class="cm-number">1</span>,<span class="cm-number">1</span>]) <span class="cm-comment"># (2,) </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">vector2D</span> = <span class="cm-variable">np</span>.<span class="cm-property">array</span>([[<span class="cm-number">1</span>],[<span class="cm-number">1</span>]]) <span class="cm-comment"># (2,1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"matrix1 \n"</span>, <span class="cm-variable">matrix1</span>,<span class="cm-string">"\n"</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"matrix2 \n"</span>, <span class="cm-variable">matrix2</span>,<span class="cm-string">"\n"</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"vector1D \n"</span>, <span class="cm-variable">vector1D</span>,<span class="cm-string">"\n"</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"vector2D \n"</span>, <span class="cm-variable">vector2D</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 141px;"></div><div class="CodeMirror-gutters" style="display: none; height: 152px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>matrix1 
 [[1 1]
 [2 2]
 [3 3]] 

matrix2 
 [[0]
 [0]
 [0]] 

vector1D 
 [1 1] 

vector2D 
 [[1]
 [1]]
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[12]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 21.8871px; left: 202.917px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 380.072px; margin-bottom: -19px; border-right-width: 11px; min-height: 76px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 197.326px; top: 16.2963px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"Multiply 2D and 1D arrays: result is a 1D array\n"</span>, </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">matrix1</span>,<span class="cm-variable">vector1D</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"Multiply 2D and 2D arrays: result is a 2D array\n"</span>, </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">matrix1</span>,<span class="cm-variable">vector2D</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 76px;"></div><div class="CodeMirror-gutters" style="display: none; height: 87px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Multiply 2D and 1D arrays: result is a 1D array
 [2 4 6]
Multiply 2D and 2D arrays: result is a 2D array
 [[2]
 [4]
 [6]]
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[13]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 21.8871px; left: 174.34px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 448.405px; margin-bottom: -19px; border-right-width: 11px; min-height: 60px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 168.75px; top: 16.2963px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"Adding (3 x 1) vector to a (3 x 1) vector is a (3 x 1) vector\n"</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-string">"This is what we want here!\n"</span>, </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">matrix1</span>,<span class="cm-variable">vector2D</span>) <span class="cm-operator">+</span> <span class="cm-variable">matrix2</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 60px;"></div><div class="CodeMirror-gutters" style="display: none; height: 71px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Adding (3 x 1) vector to a (3 x 1) vector is a (3 x 1) vector
 This is what we want here!
 [[2]
 [4]
 [6]]
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[14]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 38.1824px; left: 179.34px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 415.5px; margin-bottom: -19px; border-right-width: 11px; min-height: 93px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 173.75px; top: 32.5926px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"Adding a (3,) vector to a (3 x 1) vector\n"</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-string">"broadcasts the 1D array across the second dimension\n"</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-string">"Not what we want here!\n"</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">matrix1</span>,<span class="cm-variable">vector1D</span>) <span class="cm-operator">+</span> <span class="cm-variable">matrix2</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">     )</span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 93px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Adding a (3,) vector to a (3 x 1) vector
 broadcasts the 1D array across the second dimension
 Not what we want here!
 [[2 4 6]
 [2 4 6]
 [2 4 6]]
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 516px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-strong cm-variable-2">**Step 3**</span><span class="cm-variable-2">: Sampling: </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Now that we have </span><span class="cm-delimit cm-delimit-open">$</span>y^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t+1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">, we want to select the next letter in the dinosaur name. If we select the most probable, the model will always generate the same result given a starting letter. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">- To make the results more interesting, we will use np.random.choice to select a next letter that is likely, but not always the same.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Sampling is the selection of a value from a group of values, where each value has a probability of being picked.</span><span class="cm-variable-3 cm-trailing-space-a"> </span><span class="cm-variable-3 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Sampling allows us to generate random sequences of values.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Pick the next character's index according to the probability distribution specified by </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t+1 <span class="cm-tag">\rangle</span> <span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- This means that if </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t+1 <span class="cm-tag">\rangle</span> <span class="cm-bracket">}</span>_i = 0.16<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">, you will pick the index "i" with 16% probability. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- You can use </span><span class="cm-link cm-variable-3">[np.random.choice]</span><span class="cm-string cm-url cm-variable-3">(https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.random.choice.html)</span><span class="cm-variable-3">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">Example of how to use </span><span class="cm-comment cm-variable-3">`np.random.choice()`</span><span class="cm-variable-3">:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment cm-variable-3">```python</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">seed</span>(<span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">probs</span> = <span class="cm-variable">np</span>.<span class="cm-property">array</span>([<span class="cm-number">0.1</span>, <span class="cm-number">0.0</span>, <span class="cm-number">0.7</span>, <span class="cm-number">0.2</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">idx</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">choice</span>([<span class="cm-number">0</span>, <span class="cm-number">1</span>, <span class="cm-number">2</span>, <span class="cm-number">3</span>] <span class="cm-variable">p</span> = <span class="cm-variable">probs</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment cm-variable-3">```</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- This means that you will pick the index (</span><span class="cm-comment cm-variable-3">`idx`</span><span class="cm-variable-3">) according to the distribution: </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-delimit cm-delimit-open">$</span>P(index = 0) = 0.1, P(index = 1) = 0.0, P(index = 2) = 0.7, P(index = 3) = 0.2<span class="cm-delimit cm-delimit-close">$</span>.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">- Note that the value that's set to `p` should be set to a 1D vector.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">- Also notice that </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t+1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-comment">, which is `y` in the code, is a 2D array.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 516px;"></div><div class="CodeMirror-gutters" style="display: none; height: 528px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><ul>
<li><p><strong>Step 3</strong>: Sampling: </p>
<ul>
<li>Now that we have <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-426" role="math" style="width: 2.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1002.15em, 2.562em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-427"><span class="msubsup" id="MathJax-Span-428"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-429" style="font-family: STIXMathJax_Main; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-430"><span class="mrow" id="MathJax-Span-431"><span class="mo" id="MathJax-Span-432" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-433" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-434" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span><span class="mn" id="MathJax-Span-435" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-436" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-27">y^{\langle t+1 \rangle}</script>, we want to select the next letter in the dinosaur name. If we select the most probable, the model will always generate the same result given a starting letter. <ul>
<li>To make the results more interesting, we will use np.random.choice to select a next letter that is likely, but not always the same.</li>
</ul>
</li>
<li>Sampling is the selection of a value from a group of values, where each value has a probability of being picked.  </li>
<li>Sampling allows us to generate random sequences of values.</li>
<li>Pick the next character's index according to the probability distribution specified by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-437" role="math" style="width: 2.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.015em, 1002.15em, 2.562em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-438"><span class="msubsup" id="MathJax-Span-439"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-440"><span class="mrow" id="MathJax-Span-441"><span class="munderover" id="MathJax-Span-442"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-443" style="font-family: STIXMathJax_Main; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-444" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-445"><span class="mrow" id="MathJax-Span-446"><span class="mo" id="MathJax-Span-447" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-448" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-449" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span><span class="mn" id="MathJax-Span-450" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-451" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-28">\hat{y}^{\langle t+1 \rangle }</script>. </li>
<li>This means that if <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.16&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-452" role="math" style="width: 6.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1005.42em, 2.801em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-453"><span class="msubsup" id="MathJax-Span-454"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-455"><span class="mrow" id="MathJax-Span-456"><span class="munderover" id="MathJax-Span-457"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-458" style="font-family: STIXMathJax_Main; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-459" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1001.67em, 4.348em, -999.997em); top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-460"><span class="mrow" id="MathJax-Span-461"><span class="mo" id="MathJax-Span-462" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-463" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-464" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span><span class="mn" id="MathJax-Span-465" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-466" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.42em;"><span class="mi" id="MathJax-Span-467" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-468" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-469" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">0.16</span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>=</mo><mn>0.16</mn></math></span></span><script type="math/tex" id="MathJax-Element-29">\hat{y}^{\langle t+1 \rangle }_i = 0.16</script>, you will pick the index "i" with 16% probability. </li>
<li><p>You can use <a href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.random.choice.html" target="_blank">np.random.choice</a>.</p>
<p>Example of how to use <code>np.random.choice()</code>:</p>
<pre><code class="cm-s-ipython language-python"><span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">seed</span>(<span class="cm-number">0</span>)
<span class="cm-variable">probs</span> = <span class="cm-variable">np</span>.<span class="cm-property">array</span>([<span class="cm-number">0.1</span>, <span class="cm-number">0.0</span>, <span class="cm-number">0.7</span>, <span class="cm-number">0.2</span>])
<span class="cm-variable">idx</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">choice</span>([<span class="cm-number">0</span>, <span class="cm-number">1</span>, <span class="cm-number">2</span>, <span class="cm-number">3</span>] <span class="cm-variable">p</span> = <span class="cm-variable">probs</span>)
</code></pre>
</li>
<li><p>This means that you will pick the index (<code>idx</code>) according to the distribution: </p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.7&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-470" role="math" style="width: 29.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.527em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.158em, 1024.47em, 5.717em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-471"><span style="display: inline-block; position: relative; width: 24.527em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1024.47em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-472" style="font-family: STIXMathJax_Main; font-style: italic;">P</span><span class="mo" id="MathJax-Span-473" style="font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-474" style="font-family: STIXMathJax_Main; font-style: italic;">i</span><span class="mi" id="MathJax-Span-475" style="font-family: STIXMathJax_Main; font-style: italic;">n</span><span class="mi" id="MathJax-Span-476" style="font-family: STIXMathJax_Main; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-477" style="font-family: STIXMathJax_Main; font-style: italic;">e</span><span class="mi" id="MathJax-Span-478" style="font-family: STIXMathJax_Main; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-479" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-480" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">0</span><span class="mo" id="MathJax-Span-481" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-482" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-483" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">0.1</span><span class="mo" id="MathJax-Span-484" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-485" style="font-family: STIXMathJax_Main; font-style: italic; padding-left: 0.182em;">P</span><span class="mo" id="MathJax-Span-486" style="font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-487" style="font-family: STIXMathJax_Main; font-style: italic;">i</span><span class="mi" id="MathJax-Span-488" style="font-family: STIXMathJax_Main; font-style: italic;">n</span><span class="mi" id="MathJax-Span-489" style="font-family: STIXMathJax_Main; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-490" style="font-family: STIXMathJax_Main; font-style: italic;">e</span><span class="mi" id="MathJax-Span-491" style="font-family: STIXMathJax_Main; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-492" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-493" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">1</span><span class="mo" id="MathJax-Span-494" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-495" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-496" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">0.0</span><span class="mo" id="MathJax-Span-497" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-498" style="font-family: STIXMathJax_Main; font-style: italic; padding-left: 0.182em;">P</span><span class="mo" id="MathJax-Span-499" style="font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-500" style="font-family: STIXMathJax_Main; font-style: italic;">i</span><span class="mi" id="MathJax-Span-501" style="font-family: STIXMathJax_Main; font-style: italic;">n</span><span class="mi" id="MathJax-Span-502" style="font-family: STIXMathJax_Main; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-503" style="font-family: STIXMathJax_Main; font-style: italic;">e</span><span class="mi" id="MathJax-Span-504" style="font-family: STIXMathJax_Main; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-505" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-506" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">2</span><span class="mo" id="MathJax-Span-507" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-508" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-509" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">0.7</span><span class="mo" id="MathJax-Span-510" style="font-family: STIXMathJax_Main;">,</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em, 1007.98em, 4.348em, -999.997em); top: -2.616em; left: 0.003em;"><span class="mi" id="MathJax-Span-511" style="font-family: STIXMathJax_Main; font-style: italic; padding-left: 0.182em;">P</span><span class="mo" id="MathJax-Span-512" style="font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-513" style="font-family: STIXMathJax_Main; font-style: italic;">i</span><span class="mi" id="MathJax-Span-514" style="font-family: STIXMathJax_Main; font-style: italic;">n</span><span class="mi" id="MathJax-Span-515" style="font-family: STIXMathJax_Main; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-516" style="font-family: STIXMathJax_Main; font-style: italic;">e</span><span class="mi" id="MathJax-Span-517" style="font-family: STIXMathJax_Main; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-518" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-519" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">3</span><span class="mo" id="MathJax-Span-520" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-521" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-522" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">0.2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.925em; border-left: 0px solid; width: 0px; height: 2.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>x</mi><mo>=</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0.1</mn><mo>,</mo><mi>P</mi><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>x</mi><mo>=</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0.0</mn><mo>,</mo><mi>P</mi><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>x</mi><mo>=</mo><mn>2</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0.7</mn><mo>,</mo><mi>P</mi><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>x</mi><mo>=</mo><mn>3</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0.2</mn></math></span></span><script type="math/tex" id="MathJax-Element-30">P(index = 0) = 0.1, P(index = 1) = 0.0, P(index = 2) = 0.7, P(index = 3) = 0.2</script>.</p>
</li>
<li><p>Note that the value that's set to <code>p</code> should be set to a 1D vector.</p>
</li>
<li>Also notice that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-523" role="math" style="width: 2.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.015em, 1002.15em, 2.562em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-524"><span class="msubsup" id="MathJax-Span-525"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-526"><span class="mrow" id="MathJax-Span-527"><span class="munderover" id="MathJax-Span-528"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-529" style="font-family: STIXMathJax_Main; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-530" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-531"><span class="mrow" id="MathJax-Span-532"><span class="mo" id="MathJax-Span-533" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-534" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-535" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span><span class="mn" id="MathJax-Span-536" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-537" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-31">\hat{y}^{\langle t+1 \rangle}</script>, which is <code>y</code> in the code, is a 2D array.</li>
</ul>
</li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 468px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.037px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Additional Hints</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-link cm-variable-2">[range]</span><span class="cm-string cm-url cm-variable-2">(https://docs.python.org/3/library/functions.html#func-range)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-link cm-variable-2">[numpy.ravel]</span><span class="cm-string cm-url cm-variable-2">(https://docs.scipy.org/doc/numpy/reference/generated/numpy.ravel.html)</span><span class="cm-variable-2"> takes a multi-dimensional array and returns its contents inside of a 1D vector.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```Python</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">arr</span> = <span class="cm-variable">np</span>.<span class="cm-property">array</span>([[<span class="cm-number">1</span>,<span class="cm-number">2</span>],[<span class="cm-number">3</span>,<span class="cm-number">4</span>]])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"arr"</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">arr</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"arr.ravel()"</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">arr</span>.<span class="cm-property">ravel</span>())</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Output:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```Python</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">arr</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">[[<span class="cm-number">1</span> <span class="cm-number">2</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> [<span class="cm-number">3</span> <span class="cm-number">4</span>]]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">arr</span>.<span class="cm-property">ravel</span>()</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">[<span class="cm-number">1</span> <span class="cm-number">2</span> <span class="cm-number">3</span> <span class="cm-number">4</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Note that </span><span class="cm-comment cm-variable-2">`append`</span><span class="cm-variable-2"> is an "in-place" operation.  In other words, don't do this:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```Python</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">fun_hobbies</span> = <span class="cm-variable">fun_hobbies</span>.<span class="cm-property">append</span>(<span class="cm-string">'learning'</span>) &nbsp;<span class="cm-comment">## Doesn't give you what you want</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 468px;"></div><div class="CodeMirror-gutters" style="display: none; height: 480px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h5 id="Additional-Hints">Additional Hints<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#Additional-Hints">¶</a></h5>
<ul>
<li><a href="https://docs.python.org/3/library/functions.html#func-range" target="_blank">range</a></li>
<li><p><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ravel.html" target="_blank">numpy.ravel</a> takes a multi-dimensional array and returns its contents inside of a 1D vector.</p>
<pre><code class="cm-s-ipython language-Python"><span class="cm-variable">arr</span> = <span class="cm-variable">np</span>.<span class="cm-property">array</span>([[<span class="cm-number">1</span>,<span class="cm-number">2</span>],[<span class="cm-number">3</span>,<span class="cm-number">4</span>]])
<span class="cm-builtin">print</span>(<span class="cm-string">"arr"</span>)
<span class="cm-builtin">print</span>(<span class="cm-variable">arr</span>)
<span class="cm-builtin">print</span>(<span class="cm-string">"arr.ravel()"</span>)
<span class="cm-builtin">print</span>(<span class="cm-variable">arr</span>.<span class="cm-property">ravel</span>())
</code></pre>
<p>Output:</p>
<pre><code class="cm-s-ipython language-Python"><span class="cm-variable">arr</span>
[[<span class="cm-number">1</span> <span class="cm-number">2</span>]
[<span class="cm-number">3</span> <span class="cm-number">4</span>]]
<span class="cm-variable">arr</span>.<span class="cm-property">ravel</span>()
[<span class="cm-number">1</span> <span class="cm-number">2</span> <span class="cm-number">3</span> <span class="cm-number">4</span>]
</code></pre>
</li>
<li><p>Note that <code>append</code> is an "in-place" operation.  In other words, don't do this:</p>
<pre><code class="cm-s-ipython language-Python"><span class="cm-variable">fun_hobbies</span> = <span class="cm-variable">fun_hobbies</span>.<span class="cm-property">append</span>(<span class="cm-string">'learning'</span>)  <span class="cm-comment">## Doesn't give you what you want</span>
</code></pre>
</li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 174px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-strong cm-variable-2">**Step 4**</span><span class="cm-variable-2">: Update to </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span> <span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- The last step to implement in </span><span class="cm-comment cm-variable-3">`sample()`</span><span class="cm-variable-3"> is to update the variable </span><span class="cm-comment cm-variable-3">`x`</span><span class="cm-variable-3">, which currently stores </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span> <span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">, with the value of </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t + 1 <span class="cm-tag">\rangle</span> <span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- You will represent </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t + 1 <span class="cm-tag">\rangle</span> <span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3"> by creating a one-hot vector corresponding to the character that you have chosen as your prediction. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- You will then forward propagate </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t + 1 <span class="cm-tag">\rangle</span> <span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3"> in Step 1 and keep repeating the process until you get a "\n" character, indicating that you have reached the end of the dinosaur name. </span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 174px;"></div><div class="CodeMirror-gutters" style="display: none; height: 186px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><ul>
<li><strong>Step 4</strong>: Update to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-538" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1001.37em, 2.384em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-539"><span class="msubsup" id="MathJax-Span-540"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-541" style="font-family: STIXMathJax_Main; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-542"><span class="mrow" id="MathJax-Span-543"><span class="mo" id="MathJax-Span-544" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-545" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-546" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-32">x^{\langle t \rangle }</script> <ul>
<li>The last step to implement in <code>sample()</code> is to update the variable <code>x</code>, which currently stores <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-547" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1001.37em, 2.384em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-548"><span class="msubsup" id="MathJax-Span-549"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-550" style="font-family: STIXMathJax_Main; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-551"><span class="mrow" id="MathJax-Span-552"><span class="mo" id="MathJax-Span-553" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-554" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-555" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-33">x^{\langle t \rangle }</script>, with the value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-556" role="math" style="width: 2.682em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1002.21em, 2.384em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-557"><span class="msubsup" id="MathJax-Span-558"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-559" style="font-family: STIXMathJax_Main; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-560"><span class="mrow" id="MathJax-Span-561"><span class="mo" id="MathJax-Span-562" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-563" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-564" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span><span class="mn" id="MathJax-Span-565" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-566" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-34">x^{\langle t + 1 \rangle }</script>. </li>
<li>You will represent <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-567" role="math" style="width: 2.682em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1002.21em, 2.384em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-568"><span class="msubsup" id="MathJax-Span-569"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-570" style="font-family: STIXMathJax_Main; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-571"><span class="mrow" id="MathJax-Span-572"><span class="mo" id="MathJax-Span-573" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-574" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-575" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span><span class="mn" id="MathJax-Span-576" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-577" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-35">x^{\langle t + 1 \rangle }</script> by creating a one-hot vector corresponding to the character that you have chosen as your prediction. </li>
<li>You will then forward propagate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-578" role="math" style="width: 2.682em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1002.21em, 2.384em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-579"><span class="msubsup" id="MathJax-Span-580"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-581" style="font-family: STIXMathJax_Main; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-582"><span class="mrow" id="MathJax-Span-583"><span class="mo" id="MathJax-Span-584" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-585" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-586" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span><span class="mn" id="MathJax-Span-587" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-588" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-36">x^{\langle t + 1 \rangle }</script> in Step 1 and keep repeating the process until you get a "\n" character, indicating that you have reached the end of the dinosaur name. </li>
</ul>
</li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 142px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.037px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Additional Hints</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- In order to reset </span><span class="cm-comment cm-variable-2">`x`</span><span class="cm-variable-2"> before setting it to the new one-hot vector, you'll want to set all the values to zero.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- You can either create a new numpy array: </span><span class="cm-link cm-variable-3">[numpy.zeros]</span><span class="cm-string cm-url cm-variable-3">(https://docs.scipy.org/doc/numpy/reference/generated/numpy.zeros.html)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Or fill all values with a single number: </span><span class="cm-link cm-variable-3">[numpy.ndarray.fill]</span><span class="cm-string cm-url cm-variable-3">(https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.fill.html)</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 142px;"></div><div class="CodeMirror-gutters" style="display: none; height: 154px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h5 id="Additional-Hints">Additional Hints<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#Additional-Hints">¶</a></h5>
<ul>
<li>In order to reset <code>x</code> before setting it to the new one-hot vector, you'll want to set all the values to zero.<ul>
<li>You can either create a new numpy array: <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.zeros.html" target="_blank">numpy.zeros</a></li>
<li>Or fill all values with a single number: <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.fill.html" target="_blank">numpy.ndarray.fill</a></li>
</ul>
</li>
</ul>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[16]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 1276.7px; left: 116.69px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 18px; width: 18px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 830.06px; margin-bottom: -19px; border-right-width: 11px; min-height: 1299px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 111.1px; top: 1271.11px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># GRADED FUNCTION: sample</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">sample</span>(<span class="cm-variable">parameters</span>, <span class="cm-variable">char_to_ix</span>, <span class="cm-variable">seed</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Sample a sequence of characters according to a sequence of probability distributions output of the RNN</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    parameters -- python dictionary containing the parameters Waa, Wax, Wya, by, and b. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    char_to_ix -- python dictionary mapping each character to an index.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    seed -- used for grading purposes. Do not worry about it.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    indices -- a list of length n containing the indices of the sampled characters.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Retrieve parameters and relevant shapes from "parameters" dictionary</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">Waa</span>, <span class="cm-variable">Wax</span>, <span class="cm-variable">Wya</span>, <span class="cm-variable">by</span>, <span class="cm-variable">b</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">'Waa'</span>], <span class="cm-variable">parameters</span>[<span class="cm-string">'Wax'</span>], <span class="cm-variable">parameters</span>[<span class="cm-string">'Wya'</span>], <span class="cm-variable">parameters</span>[<span class="cm-string">'by'</span>], <span class="cm-variable">parameters</span>[<span class="cm-string">'b'</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">vocab_size</span> = <span class="cm-variable">by</span>.<span class="cm-property">shape</span>[<span class="cm-number">0</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">n_a</span> = <span class="cm-variable">Waa</span>.<span class="cm-property">shape</span>[<span class="cm-number">1</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Step 1: Create the a zero vector x that can be used as the one-hot vector </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># representing the first character (initializing the sequence generation). (≈1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">x</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">vocab_size</span>,<span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Step 1': Initialize a_prev as zeros (≈1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">a_prev</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_a</span>,<span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Create an empty list of indices, this is the list which will contain the list of indices of the characters to generate (≈1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">indices</span> = []</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># idx is the index of the one-hot vector x that is set to 1</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># All other positions in x are zero.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># We will initialize idx to -1</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">idx</span> = <span class="cm-operator">-</span><span class="cm-number">1</span> </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Loop over time-steps t. At each time-step:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># sample a character from a probability distribution </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># and append its index (`idx`) to the list "indices". </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># We'll stop if we reach 50 characters </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># (which should be very unlikely with a well trained model).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Setting the maximum number of characters helps with debugging and prevents infinite loops. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">counter</span> = <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">newline_character</span> = <span class="cm-variable">char_to_ix</span>[<span class="cm-string">'\n'</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">while</span> (<span class="cm-variable">idx</span> <span class="cm-operator">!</span>= <span class="cm-variable">newline_character</span> <span class="cm-keyword">and</span> <span class="cm-variable">counter</span> <span class="cm-operator">!</span>= <span class="cm-number">50</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Step 2: Forward propagate x using the equations (1), (2) and (3)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">a</span> = <span class="cm-variable">np</span>.<span class="cm-property">tanh</span>(<span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">Wax</span>,<span class="cm-variable">x</span>)<span class="cm-operator">+</span><span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">Waa</span>,<span class="cm-variable">a_prev</span>)<span class="cm-operator">+</span><span class="cm-variable">b</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">z</span> = <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">Wya</span>,<span class="cm-variable">a</span>)<span class="cm-operator">+</span><span class="cm-variable">by</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">y</span> = <span class="cm-variable">softmax</span>(<span class="cm-variable">z</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># for grading purposes</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">seed</span>(<span class="cm-variable">counter</span><span class="cm-operator">+</span><span class="cm-variable">seed</span>) </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Step 3: Sample the index of a character within the vocabulary from the probability distribution y</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># (see additional hints above)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">idx</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">choice</span>(<span class="cm-builtin">list</span>(<span class="cm-builtin">range</span>(<span class="cm-variable">vocab_size</span>)),<span class="cm-variable">p</span>=<span class="cm-variable">y</span>.<span class="cm-property">ravel</span>())<span class="cm-comment">#y must be raveled</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Append the index to "indices"</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">indices</span>.<span class="cm-property">append</span>(<span class="cm-variable">idx</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Step 4: Overwrite the input x with one that corresponds to the sampled index `idx`.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># (see additional hints above)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">x</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">vocab_size</span>,<span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">x</span>[<span class="cm-variable">idx</span>] = <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Update "a_prev" to be "a"</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">a_prev</span> = <span class="cm-variable">a</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># for grading purposes</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">seed</span> += <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">counter</span> +=<span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">if</span> (<span class="cm-variable">counter</span> == <span class="cm-number">50</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">indices</span>.<span class="cm-property">append</span>(<span class="cm-variable">char_to_ix</span>[<span class="cm-string">'\n'</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">indices</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 1299px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1310px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[17]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 119.664px; left: 293.183px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="false"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 772.306px; margin-bottom: -19px; border-right-width: 11px; min-height: 190px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 287.593px; top: 114.074px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">seed</span>(<span class="cm-number">2</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">_</span>, <span class="cm-variable">n_a</span> = <span class="cm-number">20</span>, <span class="cm-number">100</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">Wax</span>, <span class="cm-variable">Waa</span>, <span class="cm-variable">Wya</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-variable">n_a</span>, <span class="cm-variable">vocab_size</span>), <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-variable">n_a</span>, <span class="cm-variable">n_a</span>), <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-variable">vocab_size</span>, <span class="cm-variable">n_a</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">b</span>, <span class="cm-variable">by</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-variable">n_a</span>, <span class="cm-number">1</span>), <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-variable">vocab_size</span>, <span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters</span> = {<span class="cm-string">"Wax"</span>: <span class="cm-variable">Wax</span>, <span class="cm-string">"Waa"</span>: <span class="cm-variable">Waa</span>, <span class="cm-string">"Wya"</span>: <span class="cm-variable">Wya</span>, <span class="cm-string">"b"</span>: <span class="cm-variable">b</span>, <span class="cm-string">"by"</span>: <span class="cm-variable">by</span>}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">indices</span> = <span class="cm-variable">sample</span>(<span class="cm-variable">parameters</span>, <span class="cm-variable">char_to_ix</span>, <span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"Sampling:"</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"list of sampled indices:\n"</span>, <span class="cm-variable">indices</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"list of sampled characters:\n"</span>, [<span class="cm-variable">ix_to_char</span>[<span class="cm-variable">i</span>] <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-variable">indices</span>])</span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 190px;"></div><div class="CodeMirror-gutters" style="display: none; height: 201px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Sampling:
list of sampled indices:
 [12, 17, 24, 14, 13, 9, 10, 22, 24, 6, 13, 11, 12, 6, 21, 15, 21, 14, 3, 2, 1, 21, 18, 24, 7, 25, 6, 25, 18, 10, 16, 2, 3, 8, 15, 12, 11, 7, 1, 12, 10, 2, 7, 7, 11, 17, 24, 12, 13, 24, 0]
list of sampled characters:
 ['l', 'q', 'x', 'n', 'm', 'i', 'j', 'v', 'x', 'f', 'm', 'k', 'l', 'f', 'u', 'o', 'u', 'n', 'c', 'b', 'a', 'u', 'r', 'x', 'g', 'y', 'f', 'y', 'r', 'j', 'p', 'b', 'c', 'h', 'o', 'l', 'k', 'g', 'a', 'l', 'j', 'b', 'g', 'g', 'k', 'q', 'x', 'l', 'm', 'x', '\n']
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59082px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 353px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">** Expected output:**</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```Python</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">Sampling</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">list</span> <span class="cm-variable">of</span> <span class="cm-variable">sampled</span> <span class="cm-variable">indices</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> [<span class="cm-number">12</span>, <span class="cm-number">17</span>, <span class="cm-number">24</span>, <span class="cm-number">14</span>, <span class="cm-number">13</span>, <span class="cm-number">9</span>, <span class="cm-number">10</span>, <span class="cm-number">22</span>, <span class="cm-number">24</span>, <span class="cm-number">6</span>, <span class="cm-number">13</span>, <span class="cm-number">11</span>, <span class="cm-number">12</span>, <span class="cm-number">6</span>, <span class="cm-number">21</span>, <span class="cm-number">15</span>, <span class="cm-number">21</span>, <span class="cm-number">14</span>, <span class="cm-number">3</span>, <span class="cm-number">2</span>, <span class="cm-number">1</span>, <span class="cm-number">21</span>, <span class="cm-number">18</span>, <span class="cm-number">24</span>, <span class="cm-number">7</span>, <span class="cm-number">25</span>, <span class="cm-number">6</span>, <span class="cm-number">25</span>, <span class="cm-number">18</span>, <span class="cm-number">10</span>, <span class="cm-number">16</span>, <span class="cm-number">2</span>, <span class="cm-number">3</span>, <span class="cm-number">8</span>, <span class="cm-number">15</span>, <span class="cm-number">12</span>, <span class="cm-number">11</span>, <span class="cm-number">7</span>, <span class="cm-number">1</span>, <span class="cm-number">12</span>, <span class="cm-number">10</span>, <span class="cm-number">2</span>, <span class="cm-number">7</span>, <span class="cm-number">7</span>, <span class="cm-number">11</span>, <span class="cm-number">17</span>, <span class="cm-number">24</span>, <span class="cm-number">12</span>, <span class="cm-number">13</span>, <span class="cm-number">24</span>, <span class="cm-number">0</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">list</span> <span class="cm-variable">of</span> <span class="cm-variable">sampled</span> <span class="cm-variable">characters</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> [<span class="cm-string">'l'</span>, <span class="cm-string">'q'</span>, <span class="cm-string">'x'</span>, <span class="cm-string">'n'</span>, <span class="cm-string">'m'</span>, <span class="cm-string">'i'</span>, <span class="cm-string">'j'</span>, <span class="cm-string">'v'</span>, <span class="cm-string">'x'</span>, <span class="cm-string">'f'</span>, <span class="cm-string">'m'</span>, <span class="cm-string">'k'</span>, <span class="cm-string">'l'</span>, <span class="cm-string">'f'</span>, <span class="cm-string">'u'</span>, <span class="cm-string">'o'</span>, <span class="cm-string">'u'</span>, <span class="cm-string">'n'</span>, <span class="cm-string">'c'</span>, <span class="cm-string">'b'</span>, <span class="cm-string">'a'</span>, <span class="cm-string">'u'</span>, <span class="cm-string">'r'</span>, <span class="cm-string">'x'</span>, <span class="cm-string">'g'</span>, <span class="cm-string">'y'</span>, <span class="cm-string">'f'</span>, <span class="cm-string">'y'</span>, <span class="cm-string">'r'</span>, <span class="cm-string">'j'</span>, <span class="cm-string">'p'</span>, <span class="cm-string">'b'</span>, <span class="cm-string">'c'</span>, <span class="cm-string">'h'</span>, <span class="cm-string">'o'</span>, <span class="cm-string">'l'</span>, <span class="cm-string">'k'</span>, <span class="cm-string">'g'</span>, <span class="cm-string">'a'</span>, <span class="cm-string">'l'</span>, <span class="cm-string">'j'</span>, <span class="cm-string">'b'</span>, <span class="cm-string">'g'</span>, <span class="cm-string">'g'</span>, <span class="cm-string">'k'</span>, <span class="cm-string">'q'</span>, <span class="cm-string">'x'</span>, <span class="cm-string">'l'</span>, <span class="cm-string">'m'</span>, <span class="cm-string">'x'</span>, <span class="cm-string">'\n'</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Please note that over time, if there are updates to the back-end of the Coursera platform (that may update the version of numpy), the actual list of sampled indices and sampled characters may change. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* If you follow the instructions given above and get an output without errors, it's possible the routine is correct even if your output doesn't match the expected output.  Submit your assignment to the grader to verify its correctness.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 353px;"></div><div class="CodeMirror-gutters" style="display: none; height: 365px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong> Expected output:</strong></p>
<pre><code class="cm-s-ipython language-Python"><span class="cm-variable">Sampling</span>:
<span class="cm-builtin">list</span> <span class="cm-variable">of</span> <span class="cm-variable">sampled</span> <span class="cm-variable">indices</span>:
 <span class="cm-null cm-error">[</span><span class="cm-number">12</span>, <span class="cm-number">17</span>, <span class="cm-number">24</span>, <span class="cm-number">14</span>, <span class="cm-number">13</span>, <span class="cm-number">9</span>, <span class="cm-number">10</span>, <span class="cm-number">22</span>, <span class="cm-number">24</span>, <span class="cm-number">6</span>, <span class="cm-number">13</span>, <span class="cm-number">11</span>, <span class="cm-number">12</span>, <span class="cm-number">6</span>, <span class="cm-number">21</span>, <span class="cm-number">15</span>, <span class="cm-number">21</span>, <span class="cm-number">14</span>, <span class="cm-number">3</span>, <span class="cm-number">2</span>, <span class="cm-number">1</span>, <span class="cm-number">21</span>, <span class="cm-number">18</span>, <span class="cm-number">24</span>, <span class="cm-number">7</span>, <span class="cm-number">25</span>, <span class="cm-number">6</span>, <span class="cm-number">25</span>, <span class="cm-number">18</span>, <span class="cm-number">10</span>, <span class="cm-number">16</span>, <span class="cm-number">2</span>, <span class="cm-number">3</span>, <span class="cm-number">8</span>, <span class="cm-number">15</span>, <span class="cm-number">12</span>, <span class="cm-number">11</span>, <span class="cm-number">7</span>, <span class="cm-number">1</span>, <span class="cm-number">12</span>, <span class="cm-number">10</span>, <span class="cm-number">2</span>, <span class="cm-number">7</span>, <span class="cm-number">7</span>, <span class="cm-number">11</span>, <span class="cm-number">17</span>, <span class="cm-number">24</span>, <span class="cm-number">12</span>, <span class="cm-number">13</span>, <span class="cm-number">24</span>, <span class="cm-number">0</span>]
<span class="cm-builtin">list</span> <span class="cm-variable">of</span> <span class="cm-variable">sampled</span> <span class="cm-variable">characters</span>:
 <span class="cm-null cm-error">[</span><span class="cm-string">'l'</span>, <span class="cm-string">'q'</span>, <span class="cm-string">'x'</span>, <span class="cm-string">'n'</span>, <span class="cm-string">'m'</span>, <span class="cm-string">'i'</span>, <span class="cm-string">'j'</span>, <span class="cm-string">'v'</span>, <span class="cm-string">'x'</span>, <span class="cm-string">'f'</span>, <span class="cm-string">'m'</span>, <span class="cm-string">'k'</span>, <span class="cm-string">'l'</span>, <span class="cm-string">'f'</span>, <span class="cm-string">'u'</span>, <span class="cm-string">'o'</span>, <span class="cm-string">'u'</span>, <span class="cm-string">'n'</span>, <span class="cm-string">'c'</span>, <span class="cm-string">'b'</span>, <span class="cm-string">'a'</span>, <span class="cm-string">'u'</span>, <span class="cm-string">'r'</span>, <span class="cm-string">'x'</span>, <span class="cm-string">'g'</span>, <span class="cm-string">'y'</span>, <span class="cm-string">'f'</span>, <span class="cm-string">'y'</span>, <span class="cm-string">'r'</span>, <span class="cm-string">'j'</span>, <span class="cm-string">'p'</span>, <span class="cm-string">'b'</span>, <span class="cm-string">'c'</span>, <span class="cm-string">'h'</span>, <span class="cm-string">'o'</span>, <span class="cm-string">'l'</span>, <span class="cm-string">'k'</span>, <span class="cm-string">'g'</span>, <span class="cm-string">'a'</span>, <span class="cm-string">'l'</span>, <span class="cm-string">'j'</span>, <span class="cm-string">'b'</span>, <span class="cm-string">'g'</span>, <span class="cm-string">'g'</span>, <span class="cm-string">'k'</span>, <span class="cm-string">'q'</span>, <span class="cm-string">'x'</span>, <span class="cm-string">'l'</span>, <span class="cm-string">'m'</span>, <span class="cm-string">'x'</span>, <span class="cm-string">'\n'</span>]
</code></pre>
<ul>
<li>Please note that over time, if there are updates to the back-end of the Coursera platform (that may update the version of numpy), the actual list of sampled indices and sampled characters may change. </li>
<li>If you follow the instructions given above and get an output without errors, it's possible the routine is correct even if your output doesn't match the expected output.  Submit your assignment to the grader to verify its correctness.</li>
</ul>
</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 927px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.5185px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 3 - Building the language model </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">It is time to build the character-level language model for text generation. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### 3.1 - Gradient descent </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* In this section you will implement a function performing one step of stochastic gradient descent (with clipped gradients). </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* You will go through the training examples one at a time, so the optimization algorithm will be stochastic gradient descent. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">As a reminder, here are the steps of a common optimization loop for an RNN:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Forward propagate through the RNN to compute the loss</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Backward propagate through time to compute the gradients of the loss with respect to the parameters</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Clip the gradients</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Update the parameters using gradient descent </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Exercise**</span>: Implement the optimization process (one step of stochastic gradient descent). </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The following functions are provided:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```python</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">rnn_forward</span>(<span class="cm-variable">X</span>, <span class="cm-variable">Y</span>, <span class="cm-variable">a_prev</span>, <span class="cm-variable">parameters</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string">""" Performs the forward propagation through the RNN and computes the cross-entropy loss.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string">It returns the loss' value as well as a "cache" storing values to be used in backpropagation."""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  ....</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">return</span> <span class="cm-variable">loss</span>, <span class="cm-variable">cache</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">rnn_backward</span>(<span class="cm-variable">X</span>, <span class="cm-variable">Y</span>, <span class="cm-variable">parameters</span>, <span class="cm-variable">cache</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string">""" Performs the backward propagation through time to compute the gradients of the loss with respect</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string">to the parameters. It returns also all the hidden states."""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  ...</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">return</span> <span class="cm-variable">gradients</span>, <span class="cm-variable">a</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">update_parameters</span>(<span class="cm-variable">parameters</span>, <span class="cm-variable">gradients</span>, <span class="cm-variable">learning_rate</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string">""" Updates parameters using the Gradient Descent Update Rule."""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  ...</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">return</span> <span class="cm-variable">parameters</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Recall that you previously implemented the <span class="cm-comment">`clip`</span> function:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```Python</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">clip</span>(<span class="cm-variable">gradients</span>, <span class="cm-variable">maxValue</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string">"""Clips the gradients' values between minimum and maximum."""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  ...</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">return</span> <span class="cm-variable">gradients</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 927px;"></div><div class="CodeMirror-gutters" style="display: none; height: 939px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="3---Building-the-language-model">3 - Building the language model<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#3---Building-the-language-model">¶</a></h2>
<p>It is time to build the character-level language model for text generation. </p>
<h3 id="3.1---Gradient-descent">3.1 - Gradient descent<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#3.1---Gradient-descent">¶</a></h3>
<ul>
<li>In this section you will implement a function performing one step of stochastic gradient descent (with clipped gradients). </li>
<li>You will go through the training examples one at a time, so the optimization algorithm will be stochastic gradient descent. </li>
</ul>
<p>As a reminder, here are the steps of a common optimization loop for an RNN:</p>
<ul>
<li>Forward propagate through the RNN to compute the loss</li>
<li>Backward propagate through time to compute the gradients of the loss with respect to the parameters</li>
<li>Clip the gradients</li>
<li>Update the parameters using gradient descent </li>
</ul>
<p><strong>Exercise</strong>: Implement the optimization process (one step of stochastic gradient descent). </p>
<p>The following functions are provided:</p>
<pre><code class="cm-s-ipython language-python"><span class="cm-keyword">def</span> <span class="cm-def">rnn_forward</span>(<span class="cm-variable">X</span>, <span class="cm-variable">Y</span>, <span class="cm-variable">a_prev</span>, <span class="cm-variable">parameters</span>):
    <span class="cm-string">""" Performs the forward propagation through the RNN and computes the cross-entropy loss.</span>
<span class="cm-string">    It returns the loss' value as well as a "cache" storing values to be used in backpropagation."""</span>
    ....
    <span class="cm-property">return</span> <span class="cm-variable">loss</span>, <span class="cm-variable">cache</span>

<span class="cm-keyword">def</span> <span class="cm-def">rnn_backward</span>(<span class="cm-variable">X</span>, <span class="cm-variable">Y</span>, <span class="cm-variable">parameters</span>, <span class="cm-variable">cache</span>):
    <span class="cm-string">""" Performs the backward propagation through time to compute the gradients of the loss with respect</span>
<span class="cm-string">    to the parameters. It returns also all the hidden states."""</span>
    ...
    <span class="cm-property">return</span> <span class="cm-variable">gradients</span>, <span class="cm-variable">a</span>

<span class="cm-keyword">def</span> <span class="cm-def">update_parameters</span>(<span class="cm-variable">parameters</span>, <span class="cm-variable">gradients</span>, <span class="cm-variable">learning_rate</span>):
    <span class="cm-string">""" Updates parameters using the Gradient Descent Update Rule."""</span>
    ...
    <span class="cm-property">return</span> <span class="cm-variable">parameters</span>
</code></pre>
<p>Recall that you previously implemented the <code>clip</code> function:</p>
<pre><code class="cm-s-ipython language-Python"><span class="cm-keyword">def</span> <span class="cm-def">clip</span>(<span class="cm-variable">gradients</span>, <span class="cm-variable">maxValue</span>)
    <span class="cm-string">"""Clips the gradients' values between minimum and maximum."""</span>
    ...
    <span class="cm-property">return</span> <span class="cm-variable">gradients</span>
</code></pre>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 207px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### parameters</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Note that the weights and biases inside the </span><span class="cm-comment cm-variable-2">`parameters`</span><span class="cm-variable-2"> dictionary are being updated by the optimization, even though </span><span class="cm-comment cm-variable-2">`parameters`</span><span class="cm-variable-2"> is not one of the returned values of the </span><span class="cm-comment cm-variable-2">`optimize`</span><span class="cm-variable-2"> function. The </span><span class="cm-comment cm-variable-2">`parameters`</span><span class="cm-variable-2"> dictionary is passed by reference into the function, so changes to this dictionary are making changes to the </span><span class="cm-comment cm-variable-2">`parameters`</span><span class="cm-variable-2"> dictionary even when accessed outside of the function.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Python dictionaries and lists are "pass by reference", which means that if you pass a dictionary into a function and modify the dictionary within the function, this changes that same dictionary (it's not a copy of the dictionary).</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 207px;"></div><div class="CodeMirror-gutters" style="display: none; height: 219px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="parameters">parameters<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#parameters">¶</a></h4>
<ul>
<li>Note that the weights and biases inside the <code>parameters</code> dictionary are being updated by the optimization, even though <code>parameters</code> is not one of the returned values of the <code>optimize</code> function. The <code>parameters</code> dictionary is passed by reference into the function, so changes to this dictionary are making changes to the <code>parameters</code> dictionary even when accessed outside of the function.</li>
<li>Python dictionaries and lists are "pass by reference", which means that if you pass a dictionary into a function and modify the dictionary within the function, this changes that same dictionary (it's not a copy of the dictionary).</li>
</ul>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[18]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 738.924px; left: 243.877px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 18px; width: 18px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="false"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 731.414px; margin-bottom: -19px; border-right-width: 11px; min-height: 761px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 238.287px; top: 733.333px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># GRADED FUNCTION: optimize</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">optimize</span>(<span class="cm-variable">X</span>, <span class="cm-variable">Y</span>, <span class="cm-variable">a_prev</span>, <span class="cm-variable">parameters</span>, <span class="cm-variable">learning_rate</span> = <span class="cm-number">0.01</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Execute one step of the optimization to train the model.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    X -- list of integers, where each integer is a number that maps to a character in the vocabulary.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Y -- list of integers, exactly the same as X but shifted one index to the left.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    a_prev -- previous hidden state.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    parameters -- python dictionary containing:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        Wax -- Weight matrix multiplying the input, numpy array of shape (n_a, n_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        Waa -- Weight matrix multiplying the hidden state, numpy array of shape (n_a, n_a)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        Wya -- Weight matrix relating the hidden-state to the output, numpy array of shape (n_y, n_a)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        b --  Bias, numpy array of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        by -- Bias relating the hidden-state to the output, numpy array of shape (n_y, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    learning_rate -- learning rate for the model.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    loss -- value of the loss function (cross-entropy)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    gradients -- python dictionary containing:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dWax -- Gradients of input-to-hidden weights, of shape (n_a, n_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dWaa -- Gradients of hidden-to-hidden weights, of shape (n_a, n_a)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dWya -- Gradients of hidden-to-output weights, of shape (n_y, n_a)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        db -- Gradients of bias vector, of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dby -- Gradients of output bias vector, of shape (n_y, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    a[len(X)-1] -- the last hidden state, of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Forward propagate through time (≈1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">loss</span>, <span class="cm-variable">cache</span> = <span class="cm-variable">rnn_forward</span>(<span class="cm-variable">X</span>, <span class="cm-variable">Y</span>, <span class="cm-variable">a_prev</span>, <span class="cm-variable">parameters</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Backpropagate through time (≈1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">gradients</span>, <span class="cm-variable">a</span> = <span class="cm-variable">rnn_backward</span>(<span class="cm-variable">X</span>, <span class="cm-variable">Y</span>, <span class="cm-variable">parameters</span>, <span class="cm-variable">cache</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Clip your gradients between -5 (min) and 5 (max) (≈1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">gradients</span> = <span class="cm-variable">clip</span>(<span class="cm-variable">gradients</span>, <span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Update parameters (≈1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">parameters</span> = <span class="cm-variable">update_parameters</span>(<span class="cm-variable">parameters</span>, <span class="cm-variable">gradients</span>, <span class="cm-variable">learning_rate</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">loss</span>, <span class="cm-variable">gradients</span>, <span class="cm-variable">a</span>[<span class="cm-builtin">len</span>(<span class="cm-variable">X</span>)<span class="cm-operator">-</span><span class="cm-number">1</span>]</span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 761px;"></div><div class="CodeMirror-gutters" style="display: none; height: 772px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[19]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 54.4792px; left: 301.806px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 18px; width: 18px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="false"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 772.306px; margin-bottom: -19px; border-right-width: 11px; min-height: 288px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 296.215px; top: 48.8889px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">seed</span>(<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">vocab_size</span>, <span class="cm-variable">n_a</span> = <span class="cm-number">27</span>, <span class="cm-number">100</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a_prev</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-variable">n_a</span>, <span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">Wax</span>, <span class="cm-variable">Waa</span>, <span class="cm-variable">Wya</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-variable">n_a</span>, <span class="cm-variable">vocab_size</span>), <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-variable">n_a</span>, <span class="cm-variable">n_a</span>), <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-variable">vocab_size</span>, <span class="cm-variable">n_a</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">b</span>, <span class="cm-variable">by</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-variable">n_a</span>, <span class="cm-number">1</span>), <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-variable">vocab_size</span>, <span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters</span> = {<span class="cm-string">"Wax"</span>: <span class="cm-variable">Wax</span>, <span class="cm-string">"Waa"</span>: <span class="cm-variable">Waa</span>, <span class="cm-string">"Wya"</span>: <span class="cm-variable">Wya</span>, <span class="cm-string">"b"</span>: <span class="cm-variable">b</span>, <span class="cm-string">"by"</span>: <span class="cm-variable">by</span>}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">X</span> = [<span class="cm-number">12</span>,<span class="cm-number">3</span>,<span class="cm-number">5</span>,<span class="cm-number">11</span>,<span class="cm-number">22</span>,<span class="cm-number">3</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">Y</span> = [<span class="cm-number">4</span>,<span class="cm-number">14</span>,<span class="cm-number">11</span>,<span class="cm-number">22</span>,<span class="cm-number">25</span>, <span class="cm-number">26</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">loss</span>, <span class="cm-variable">gradients</span>, <span class="cm-variable">a_last</span> = <span class="cm-variable">optimize</span>(<span class="cm-variable">X</span>, <span class="cm-variable">Y</span>, <span class="cm-variable">a_prev</span>, <span class="cm-variable">parameters</span>, <span class="cm-variable">learning_rate</span> = <span class="cm-number">0.01</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"Loss ="</span>, <span class="cm-variable">loss</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWaa\"][1][2] ="</span>, <span class="cm-variable">gradients</span>[<span class="cm-string">"dWaa"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"np.argmax(gradients[\"dWax\"]) ="</span>, <span class="cm-variable">np</span>.<span class="cm-property">argmax</span>(<span class="cm-variable">gradients</span>[<span class="cm-string">"dWax"</span>]))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWya\"][1][2] ="</span>, <span class="cm-variable">gradients</span>[<span class="cm-string">"dWya"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"db\"][4] ="</span>, <span class="cm-variable">gradients</span>[<span class="cm-string">"db"</span>][<span class="cm-number">4</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dby\"][1] ="</span>, <span class="cm-variable">gradients</span>[<span class="cm-string">"dby"</span>][<span class="cm-number">1</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"a_last[4] ="</span>, <span class="cm-variable">a_last</span>[<span class="cm-number">4</span>])</span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 288px;"></div><div class="CodeMirror-gutters" style="display: none; height: 299px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Loss = 126.503975722
gradients["dWaa"][1][2] = 0.194709315347
np.argmax(gradients["dWax"]) = 93
gradients["dWya"][1][2] = -0.007773876032
gradients["db"][4] = [-0.06809825]
gradients["dby"][1] = [ 0.01538192]
a_last[4] = [-1.]
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 190px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">** Expected output:**</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```Python</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">Loss</span> = <span class="cm-number">126.503975722</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients</span>[<span class="cm-string">"dWaa"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>] = <span class="cm-number">0.194709315347</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">np</span>.<span class="cm-property">argmax</span>(<span class="cm-variable">gradients</span>[<span class="cm-string">"dWax"</span>]) = <span class="cm-number">93</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients</span>[<span class="cm-string">"dWya"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>] = <span class="cm-operator">-</span><span class="cm-number">0.007773876032</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients</span>[<span class="cm-string">"db"</span>][<span class="cm-number">4</span>] = [<span class="cm-operator">-</span><span class="cm-number">0.06809825</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients</span>[<span class="cm-string">"dby"</span>][<span class="cm-number">1</span>] = [ <span class="cm-number">0.01538192</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a_last</span>[<span class="cm-number">4</span>] = [<span class="cm-operator">-</span><span class="cm-number">1.</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 190px;"></div><div class="CodeMirror-gutters" style="display: none; height: 202px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong> Expected output:</strong></p>
<pre><code class="cm-s-ipython language-Python"><span class="cm-variable">Loss</span> = <span class="cm-number">126.503975722</span>
<span class="cm-variable">gradients</span>[<span class="cm-string">"dWaa"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>] = <span class="cm-number">0.194709315347</span>
<span class="cm-variable">np</span>.<span class="cm-property">argmax</span>(<span class="cm-variable">gradients</span>[<span class="cm-string">"dWax"</span>]) = <span class="cm-number">93</span>
<span class="cm-variable">gradients</span>[<span class="cm-string">"dWya"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>] = <span class="cm-operator">-</span><span class="cm-number">0.007773876032</span>
<span class="cm-variable">gradients</span>[<span class="cm-string">"db"</span>][<span class="cm-number">4</span>] = [<span class="cm-operator">-</span><span class="cm-number">0.06809825</span>]
<span class="cm-variable">gradients</span>[<span class="cm-string">"dby"</span>][<span class="cm-number">1</span>] = [ <span class="cm-number">0.01538192</span>]
<span class="cm-variable">a_last</span>[<span class="cm-number">4</span>] = [<span class="cm-operator">-</span><span class="cm-number">1.</span>]
</code></pre>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 28px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.037px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### 3.2 - Training the model </span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 40px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="3.2---Training-the-model">3.2 - Training the model<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#3.2---Training-the-model">¶</a></h3>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 387px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 15.9263px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Given the dataset of dinosaur names, we use each line of the dataset (one name) as one training example. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Every 100 steps of stochastic gradient descent, you will sample 10 randomly chosen names to see how the algorithm is doing. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Remember to shuffle the dataset, so that stochastic gradient descent visits the examples in random order. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Exercise**</span>: Follow the instructions and implement <span class="cm-comment">`model()`</span>. When <span class="cm-comment">`examples[index]`</span> contains one dinosaur name (string), to create an example (X, Y), you can use this:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Set the index </span><span class="cm-comment cm-header cm-header-5">`idx`</span><span class="cm-header cm-header-5"> into the list of examples</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Using the for-loop, walk through the shuffled list of dinosaur names in the list "examples".</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* If there are 100 examples, and the for-loop increments the index to 100 onwards, think of how you would make the index cycle back to 0, so that we can continue feeding the examples into the model when j is 100, 101, etc.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Hint: 101 divided by 100 is zero with a remainder of 1.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`%`</span><span class="cm-variable-2"> is the modulus operator in python.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Extract a single example from the list of examples</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`single_example`</span><span class="cm-variable-2">: use the </span><span class="cm-comment cm-variable-2">`idx`</span><span class="cm-variable-2"> index that you set previously to get one word from the list of examples.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 387px;"></div><div class="CodeMirror-gutters" style="display: none; height: 399px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><ul>
<li>Given the dataset of dinosaur names, we use each line of the dataset (one name) as one training example. </li>
<li>Every 100 steps of stochastic gradient descent, you will sample 10 randomly chosen names to see how the algorithm is doing. </li>
<li>Remember to shuffle the dataset, so that stochastic gradient descent visits the examples in random order. </li>
</ul>
<p><strong>Exercise</strong>: Follow the instructions and implement <code>model()</code>. When <code>examples[index]</code> contains one dinosaur name (string), to create an example (X, Y), you can use this:</p>
<h5 id="Set-the-index-idx-into-the-list-of-examples">Set the index <code>idx</code> into the list of examples<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#Set-the-index-idx-into-the-list-of-examples">¶</a></h5>
<ul>
<li>Using the for-loop, walk through the shuffled list of dinosaur names in the list "examples".</li>
<li>If there are 100 examples, and the for-loop increments the index to 100 onwards, think of how you would make the index cycle back to 0, so that we can continue feeding the examples into the model when j is 100, 101, etc.</li>
<li>Hint: 101 divided by 100 is zero with a remainder of 1.</li>
<li><code>%</code> is the modulus operator in python.</li>
</ul>
<h5 id="Extract-a-single-example-from-the-list-of-examples">Extract a single example from the list of examples<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#Extract-a-single-example-from-the-list-of-examples">¶</a></h5>
<ul>
<li><code>single_example</code>: use the <code>idx</code> index that you set previously to get one word from the list of examples.</li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59082px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 224px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.037px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Convert a string into a list of characters: </span><span class="cm-comment cm-header cm-header-5">`single_example_chars`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`single_example_chars`</span><span class="cm-variable-2">: A string is a list of characters.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* You can use a list comprehension (recommended over for-loops) to generate a list of characters.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```Python</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">str</span> = <span class="cm-string">'I love learning'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">list_of_chars</span> = [<span class="cm-variable">c</span> <span class="cm-keyword">for</span> <span class="cm-variable">c</span> <span class="cm-keyword">in</span> <span class="cm-builtin">str</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">list_of_chars</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">['I', ' ', 'l', 'o', 'v', 'e', ' ', 'l', 'e', 'a', 'r', 'n', 'i', 'n', 'g']</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 224px;"></div><div class="CodeMirror-gutters" style="display: none; height: 236px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h5 id="Convert-a-string-into-a-list-of-characters:-single_example_chars">Convert a string into a list of characters: <code>single_example_chars</code><a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#Convert-a-string-into-a-list-of-characters:-single_example_chars">¶</a></h5>
<ul>
<li><code>single_example_chars</code>: A string is a list of characters.</li>
<li>You can use a list comprehension (recommended over for-loops) to generate a list of characters.<pre><code class="cm-s-ipython language-Python"><span class="cm-builtin">str</span> = <span class="cm-string">'I love learning'</span>
<span class="cm-variable">list_of_chars</span> = [<span class="cm-variable">c</span> <span class="cm-keyword">for</span> <span class="cm-variable">c</span> <span class="cm-keyword">in</span> <span class="cm-builtin">str</span>]
<span class="cm-builtin">print</span>(<span class="cm-variable">list_of_chars</span>)
</code></pre>
</li>
</ul>
<pre><code>['I', ' ', 'l', 'o', 'v', 'e', ' ', 'l', 'e', 'a', 'r', 'n', 'i', 'n', 'g']
</code></pre></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 142px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.037px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Convert list of characters to a list of integers: </span><span class="cm-comment cm-header cm-header-5">`single_example_ix`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Create a list that contains the index numbers associated with each character.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Use the dictionary </span><span class="cm-comment cm-variable-2">`char_to_ix`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* You can combine this with the list comprehension that is used to get a list of characters from a string.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* This is a separate line of code below, to help learners clarify each step in the function.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 142px;"></div><div class="CodeMirror-gutters" style="display: none; height: 154px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h5 id="Convert-list-of-characters-to-a-list-of-integers:-single_example_ix">Convert list of characters to a list of integers: <code>single_example_ix</code><a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#Convert-list-of-characters-to-a-list-of-integers:-single_example_ix">¶</a></h5>
<ul>
<li>Create a list that contains the index numbers associated with each character.</li>
<li>Use the dictionary <code>char_to_ix</code></li>
<li>You can combine this with the list comprehension that is used to get a list of characters from a string.</li>
<li>This is a separate line of code below, to help learners clarify each step in the function.</li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 110px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.037px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Create the list of input characters: </span><span class="cm-comment cm-header cm-header-5">`X`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`rnn_forward`</span><span class="cm-variable-2"> uses the </span><span class="cm-comment cm-variable-2">`None`</span><span class="cm-variable-2"> value as a flag to set the input vector as a zero-vector.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Prepend the </span><span class="cm-comment cm-variable-2">`None`</span><span class="cm-variable-2"> value in front of the list of input characters.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* There is more than one way to prepend a value to a list.  One way is to add two lists together: </span><span class="cm-comment cm-variable-2">`['a'] + ['b']`</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 110px;"></div><div class="CodeMirror-gutters" style="display: none; height: 122px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h5 id="Create-the-list-of-input-characters:-X">Create the list of input characters: <code>X</code><a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#Create-the-list-of-input-characters:-X">¶</a></h5>
<ul>
<li><code>rnn_forward</code> uses the <code>None</code> value as a flag to set the input vector as a zero-vector.</li>
<li>Prepend the <code>None</code> value in front of the list of input characters.</li>
<li>There is more than one way to prepend a value to a list.  One way is to add two lists together: <code>['a'] + ['b']</code></li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59082px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 77px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.037px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Get the integer representation of the newline character </span><span class="cm-comment cm-header cm-header-5">`ix_newline`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`ix_newline`</span><span class="cm-variable-2">: The newline character signals the end of the dinosaur name.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- get the integer representation of the newline character </span><span class="cm-comment cm-variable-3">`'\n'`</span><span class="cm-variable-3">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Use </span><span class="cm-comment cm-variable-3">`char_to_ix`</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 77px;"></div><div class="CodeMirror-gutters" style="display: none; height: 89px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h5 id="Get-the-integer-representation-of-the-newline-character-ix_newline">Get the integer representation of the newline character <code>ix_newline</code><a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#Get-the-integer-representation-of-the-newline-character-ix_newline">¶</a></h5>
<ul>
<li><code>ix_newline</code>: The newline character signals the end of the dinosaur name.<ul>
<li>get the integer representation of the newline character <code>'\n'</code>.</li>
<li>Use <code>char_to_ix</code></li>
</ul>
</li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59082px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 191px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.037px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Set the list of labels (integer representation of the characters): </span><span class="cm-comment cm-header cm-header-5">`Y`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The goal is to train the RNN to predict the next letter in the name, so the labels are the list of characters that are one time step ahead of the characters in the input </span><span class="cm-comment cm-variable-2">`X`</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- For example, </span><span class="cm-comment cm-variable-3">`Y[0]`</span><span class="cm-variable-3"> contains the same value as </span><span class="cm-comment cm-variable-3">`X[1]`</span><span class="cm-variable-3 cm-trailing-space-a"> </span><span class="cm-variable-3 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The RNN should predict a newline at the last letter so add ix_newline to the end of the labels. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Append the integer representation of the newline character to the end of </span><span class="cm-comment cm-variable-3">`Y`</span><span class="cm-variable-3">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Note that </span><span class="cm-comment cm-variable-3">`append`</span><span class="cm-variable-3"> is an in-place operation.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- It might be easier for you to add two lists together.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 191px;"></div><div class="CodeMirror-gutters" style="display: none; height: 203px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h5 id="Set-the-list-of-labels-(integer-representation-of-the-characters):-Y">Set the list of labels (integer representation of the characters): <code>Y</code><a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#Set-the-list-of-labels-(integer-representation-of-the-characters):-Y">¶</a></h5>
<ul>
<li>The goal is to train the RNN to predict the next letter in the name, so the labels are the list of characters that are one time step ahead of the characters in the input <code>X</code>.<ul>
<li>For example, <code>Y[0]</code> contains the same value as <code>X[1]</code>  </li>
</ul>
</li>
<li>The RNN should predict a newline at the last letter so add ix_newline to the end of the labels. <ul>
<li>Append the integer representation of the newline character to the end of <code>Y</code>.</li>
<li>Note that <code>append</code> is an in-place operation.</li>
<li>It might be easier for you to add two lists together.</li>
</ul>
</li>
</ul>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[20]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 1374.48px; left: 146.007px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 18px; width: 18px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="false"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 755.407px; margin-bottom: -19px; border-right-width: 11px; min-height: 1396px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 140.417px; top: 1368.89px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># GRADED FUNCTION: model</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">model</span>(<span class="cm-variable">data</span>, <span class="cm-variable">ix_to_char</span>, <span class="cm-variable">char_to_ix</span>, <span class="cm-variable">num_iterations</span> = <span class="cm-number">35000</span>, <span class="cm-variable">n_a</span> = <span class="cm-number">50</span>, <span class="cm-variable">dino_names</span> = <span class="cm-number">7</span>, <span class="cm-variable">vocab_size</span> = <span class="cm-number">27</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Trains the model and generates dinosaur names. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    data -- text corpus</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    ix_to_char -- dictionary that maps the index to a character</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    char_to_ix -- dictionary that maps a character to an index</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    num_iterations -- number of iterations to train the model for</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    n_a -- number of units of the RNN cell</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    dino_names -- number of dinosaur names you want to sample at each iteration. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    vocab_size -- number of unique characters found in the text (size of the vocabulary)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    parameters -- learned parameters</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Retrieve n_x and n_y from vocab_size</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">n_x</span>, <span class="cm-variable">n_y</span> = <span class="cm-variable">vocab_size</span>, <span class="cm-variable">vocab_size</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Initialize parameters</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">parameters</span> = <span class="cm-variable">initialize_parameters</span>(<span class="cm-variable">n_a</span>, <span class="cm-variable">n_x</span>, <span class="cm-variable">n_y</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Initialize loss (this is required because we want to smooth our loss)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">loss</span> = <span class="cm-variable">get_initial_loss</span>(<span class="cm-variable">vocab_size</span>, <span class="cm-variable">dino_names</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Build list of all dinosaur names (training examples).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">with</span> <span class="cm-builtin">open</span>(<span class="cm-string">"dinos.txt"</span>) <span class="cm-keyword">as</span> <span class="cm-variable">f</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">examples</span> = <span class="cm-variable">f</span>.<span class="cm-property">readlines</span>()</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">examples</span> = [<span class="cm-variable">x</span>.<span class="cm-property">lower</span>().<span class="cm-property">strip</span>() <span class="cm-keyword">for</span> <span class="cm-variable">x</span> <span class="cm-keyword">in</span> <span class="cm-variable">examples</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Shuffle list of all dinosaur names</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">seed</span>(<span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">shuffle</span>(<span class="cm-variable">examples</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Initialize the hidden state of your LSTM</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">a_prev</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_a</span>, <span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Optimization loop</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">for</span> <span class="cm-variable">j</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">num_iterations</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment">### START CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Set the index `idx` (see instructions above)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">idx</span> = <span class="cm-variable">j</span><span class="cm-operator">%</span><span class="cm-builtin">len</span>(<span class="cm-variable">examples</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Set the input X (see instructions above)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">single_example</span> = <span class="cm-variable">examples</span>[<span class="cm-variable">idx</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">single_example_chars</span> = [<span class="cm-variable">c</span> <span class="cm-keyword">for</span> <span class="cm-variable">c</span> <span class="cm-keyword">in</span> <span class="cm-variable">single_example</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">single_example_ix</span> = [<span class="cm-variable">char_to_ix</span>[<span class="cm-variable">ix</span>] <span class="cm-keyword">for</span> <span class="cm-variable">ix</span> <span class="cm-keyword">in</span> <span class="cm-variable">single_example_chars</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">X</span> = [<span class="cm-keyword">None</span>]<span class="cm-operator">+</span><span class="cm-variable">single_example_ix</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Set the labels Y (see instructions above)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">ix_newline</span> = <span class="cm-variable">char_to_ix</span>[<span class="cm-string">'\n'</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">Y</span> = <span class="cm-variable">X</span>[<span class="cm-number">1</span>:]<span class="cm-operator">+</span>[<span class="cm-variable">ix_newline</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Perform one optimization step: Forward-prop -&gt; Backward-prop -&gt; Clip -&gt; Update parameters</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Choose a learning rate of 0.01</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">curr_loss</span>, <span class="cm-variable">gradients</span>, <span class="cm-variable">a_prev</span> = <span class="cm-variable">optimize</span>(<span class="cm-variable">X</span>, <span class="cm-variable">Y</span>, <span class="cm-variable">a_prev</span>, <span class="cm-variable">parameters</span>, <span class="cm-number">0.01</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Use a latency trick to keep the loss smooth. It happens here to accelerate the training.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">loss</span> = <span class="cm-variable">smooth</span>(<span class="cm-variable">loss</span>, <span class="cm-variable">curr_loss</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Every 2000 Iteration, generate "n" characters thanks to sample() to check if the model is learning properly</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-variable">j</span> <span class="cm-operator">%</span> <span class="cm-number">2000</span> == <span class="cm-number">0</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-builtin">print</span>(<span class="cm-string">'Iteration: %d, Loss: %f'</span> <span class="cm-operator">%</span> (<span class="cm-variable">j</span>, <span class="cm-variable">loss</span>) <span class="cm-operator">+</span> <span class="cm-string">'\n'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-comment"># The number of dinosaur names to print</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-variable">seed</span> = <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-keyword">for</span> <span class="cm-variable">name</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">dino_names</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                <span class="cm-comment"># Sample indices and print them</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                <span class="cm-variable">sampled_indices</span> = <span class="cm-variable">sample</span>(<span class="cm-variable">parameters</span>, <span class="cm-variable">char_to_ix</span>, <span class="cm-variable">seed</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                <span class="cm-variable">print_sample</span>(<span class="cm-variable">sampled_indices</span>, <span class="cm-variable">ix_to_char</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                <span class="cm-variable">seed</span> += <span class="cm-number">1</span>  <span class="cm-comment"># To get the same result (for grading purposes), increment the seed by one. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-null cm-error">            </span><span class="cm-builtin">print</span>(<span class="cm-string">'\n'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">parameters</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 1396px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1407px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59082px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 60px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 15.9258px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Run the following cell, you should observe your model outputting random-looking characters at the first iteration. After a few thousand iterations, your model should learn to generate reasonable-looking names. </span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 60px;"></div><div class="CodeMirror-gutters" style="display: none; height: 72px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Run the following cell, you should observe your model outputting random-looking characters at the first iteration. After a few thousand iterations, your model should learn to generate reasonable-looking names. </p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[21]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 228.97px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="false"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 326.449px; margin-bottom: -19px; border-right-width: 11px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 223.38px; top: 0px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters</span> = <span class="cm-variable">model</span>(<span class="cm-variable">data</span>, <span class="cm-variable">ix_to_char</span>, <span class="cm-variable">char_to_ix</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 38px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to unscroll output; double click to hide" style=""></div><div class="output output_scroll" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Iteration: 0, Loss: 23.087336

Nkzxwtdmfqoeyhsqwasjkjvu
Kneb
Kzxwtdmfqoeyhsqwasjkjvu
Neb
Zxwtdmfqoeyhsqwasjkjvu
Eb
Xwtdmfqoeyhsqwasjkjvu


Iteration: 2000, Loss: 27.884160

Liusskeomnolxeros
Hmdaairus
Hytroligoraurus
Lecalosapaus
Xusicikoraurus
Abalpsamantisaurus
Tpraneronxeros


Iteration: 4000, Loss: 25.901815

Mivrosaurus
Inee
Ivtroplisaurus
Mbaaisaurus
Wusichisaurus
Cabaselachus
Toraperlethosdarenitochusthiamamumamaon


Iteration: 6000, Loss: 24.608779

Onwusceomosaurus
Lieeaerosaurus
Lxussaurus
Oma
Xusteonosaurus
Eeahosaurus
Toreonosaurus


Iteration: 8000, Loss: 24.070350

Onxusichepriuon
Kilabersaurus
Lutrodon
Omaaerosaurus
Xutrcheps
Edaksoje
Trodiktonus


Iteration: 10000, Loss: 23.844446

Onyusaurus
Klecalosaurus
Lustodon
Ola
Xusodonia
Eeaeosaurus
Troceosaurus


Iteration: 12000, Loss: 23.291971

Onyxosaurus
Kica
Lustrepiosaurus
Olaagrraiansaurus
Yuspangosaurus
Eealosaurus
Trognesaurus


Iteration: 14000, Loss: 23.382338

Meutromodromurus
Inda
Iutroinatorsaurus
Maca
Yusteratoptititan
Ca
Troclosaurus


Iteration: 16000, Loss: 23.255630

Meustolkanolus
Indabestacarospceryradwalosaurus
Justolopinaveraterasauracoptelalenyden
Maca
Yusocles
Daahosaurus
Trodon


Iteration: 18000, Loss: 22.905483

Phytronn
Meicanstolanthus
Mustrisaurus
Pegalosaurus
Yuskercis
Egalosaurus
Tromelosaurus


Iteration: 20000, Loss: 22.873854

Nlyushanerohyisaurus
Loga
Lustrhigosaurus
Nedalosaurus
Yuslangosaurus
Elagosaurus
Trrangosaurus


Iteration: 22000, Loss: 22.710545

Onyxromicoraurospareiosatrus
Liga
Mustoffankeugoptardoros
Ola
Yusodogongterosaurus
Ehaerona
Trododongxernochenhus


Iteration: 24000, Loss: 22.604827

Meustognathiterhucoplithaloptha
Jigaadosaurus
Kurrodon
Mecaistheansaurus
Yuromelosaurus
Eiaeropeeton
Troenathiteritaus


Iteration: 26000, Loss: 22.714486

Nhyxosaurus
Kola
Lvrosaurus
Necalosaurus
Yurolonlus
Ejakosaurus
Troindronykus


Iteration: 28000, Loss: 22.647640

Onyxosaurus
Loceahosaurus
Lustleonlonx
Olabasicachudrakhurgawamosaurus
Ytrojianiisaurus
Eladon
Tromacimathoshargicitan


Iteration: 30000, Loss: 22.598485

Oryuton
Locaaesaurus
Lustoendosaurus
Olaahus
Yusaurus
Ehadopldarshuellus
Troia


Iteration: 32000, Loss: 22.211861

Meutronlapsaurus
Kracallthcaps
Lustrathus
Macairugeanosaurus
Yusidoneraverataus
Eialosaurus
Troimaniathonsaurus


Iteration: 34000, Loss: 22.447230

Onyxipaledisons
Kiabaeropa
Lussiamang
Pacaeptabalsaurus
Xosalong
Eiacoteg
Troia


</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 272px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">** Expected Output**</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The output of your model may look different, but it will look something like this:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```Python</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">Iteration</span>: <span class="cm-number">34000</span>, <span class="cm-variable">Loss</span>: <span class="cm-number">22.447230</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">Onyxipaledisons</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">Kiabaeropa</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">Lussiamang</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">Pacaeptabalsaurus</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">Xosalong</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">Eiacoteg</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">Troia</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 272px;"></div><div class="CodeMirror-gutters" style="display: none; height: 284px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong> Expected Output</strong></p>
<p>The output of your model may look different, but it will look something like this:</p>
<pre><code class="cm-s-ipython language-Python"><span class="cm-variable">Iteration</span>: <span class="cm-number">34000</span>, <span class="cm-variable">Loss</span>: <span class="cm-number">22.447230</span>

<span class="cm-variable">Onyxipaledisons</span>
<span class="cm-variable">Kiabaeropa</span>
<span class="cm-variable">Lussiamang</span>
<span class="cm-variable">Pacaeptabalsaurus</span>
<span class="cm-variable">Xosalong</span>
<span class="cm-variable">Eiacoteg</span>
<span class="cm-variable">Troia</span>
</code></pre>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 421px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.5185px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Conclusion</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">You can see that your algorithm has started to generate plausible dinosaur names towards the end of the training. At first, it was generating random characters, but towards the end you could see dinosaur names with cool endings. Feel free to run the algorithm even longer and play with hyperparameters to see if you can get even better results. Our implementation generated some really cool names like <span class="cm-comment">`maconucon`</span>, <span class="cm-comment">`marloralus`</span> and <span class="cm-comment">`macingsersaurus`</span>. Your model hopefully also learned that dinosaur names tend to end in <span class="cm-comment">`saurus`</span>, <span class="cm-comment">`don`</span>, <span class="cm-comment">`aura`</span>, <span class="cm-comment">`tor`</span>, etc.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">If your model generates some non-cool names, don't blame the model entirely--not all actual dinosaur names sound cool. (For example, <span class="cm-comment">`dromaeosauroides`</span> is an actual dinosaur name and is in the training set.) But this model should give you a set of candidates from which you can pick the coolest! </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">This assignment had used a relatively small dataset, so that you could train an RNN quickly on a CPU. Training a model of the english language requires a much bigger dataset, and usually needs much more computation, and could run for many hours on GPUs. We ran our dinosaur name for quite some time, and so far our favorite name is the great, undefeatable, and fierce: Mangosaurus!</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/mangosaurus.jpeg"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:250;height:300px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 421px;"></div><div class="CodeMirror-gutters" style="display: none; height: 433px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Conclusion">Conclusion<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#Conclusion">¶</a></h2>
<p>You can see that your algorithm has started to generate plausible dinosaur names towards the end of the training. At first, it was generating random characters, but towards the end you could see dinosaur names with cool endings. Feel free to run the algorithm even longer and play with hyperparameters to see if you can get even better results. Our implementation generated some really cool names like <code>maconucon</code>, <code>marloralus</code> and <code>macingsersaurus</code>. Your model hopefully also learned that dinosaur names tend to end in <code>saurus</code>, <code>don</code>, <code>aura</code>, <code>tor</code>, etc.</p>
<p>If your model generates some non-cool names, don't blame the model entirely--not all actual dinosaur names sound cool. (For example, <code>dromaeosauroides</code> is an actual dinosaur name and is in the training set.) But this model should give you a set of candidates from which you can pick the coolest! </p>
<p>This assignment had used a relatively small dataset, so that you could train an RNN quickly on a CPU. Training a model of the english language requires a much bigger dataset, and usually needs much more computation, and could run for many hours on GPUs. We ran our dinosaur name for quite some time, and so far our favorite name is the great, undefeatable, and fierce: Mangosaurus!</p>
<p><img src="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/mangosaurus.jpeg" style="width: 250 ; height: 300px"></p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59082px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 356px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.5185px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 4 - Writing like Shakespeare</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The rest of this notebook is optional and is not graded, but we hope you'll do it anyway since it's quite fun and informative. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">A similar (but more complicated) task is to generate Shakespeare poems. Instead of learning from a dataset of Dinosaur names you can use a collection of Shakespearian poems. Using LSTM cells, you can learn longer term dependencies that span many characters in the text--e.g., where a character appearing somewhere a sequence can influence what should be a different character much much later in the sequence. These long term dependencies were less important with dinosaur names, since the names were quite short. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/shakespeare.jpg"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:500;height:400px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> Let's become poets! <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">We have implemented a Shakespeare poem generator with Keras. Run the following cell to load the required packages and models. This may take a few minutes. </span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 356px;"></div><div class="CodeMirror-gutters" style="display: none; height: 368px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="4---Writing-like-Shakespeare">4 - Writing like Shakespeare<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#4---Writing-like-Shakespeare">¶</a></h2>
<p>The rest of this notebook is optional and is not graded, but we hope you'll do it anyway since it's quite fun and informative. </p>
<p>A similar (but more complicated) task is to generate Shakespeare poems. Instead of learning from a dataset of Dinosaur names you can use a collection of Shakespearian poems. Using LSTM cells, you can learn longer term dependencies that span many characters in the text--e.g., where a character appearing somewhere a sequence can influence what should be a different character much much later in the sequence. These long term dependencies were less important with dinosaur names, since the names were quite short. </p>
<p><img src="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/shakespeare.jpg" style="width: 500 ; height: 400px"></p>
<center> Let's become poets! </center>

<p>We have implemented a Shakespeare poem generator with Keras. Run the following cell to load the required packages and models. This may take a few minutes. </p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[22]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 103.368px; left: 326.296px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 463.151px; margin-bottom: -19px; border-right-width: 11px; min-height: 174px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 320.706px; top: 97.7778px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">__future__</span> <span class="cm-keyword">import</span> <span class="cm-variable">print_function</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">callbacks</span> <span class="cm-keyword">import</span> <span class="cm-variable">LambdaCallback</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">models</span> <span class="cm-keyword">import</span> <span class="cm-variable">Model</span>, <span class="cm-variable">load_model</span>, <span class="cm-variable">Sequential</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">layers</span> <span class="cm-keyword">import</span> <span class="cm-variable">Dense</span>, <span class="cm-variable">Activation</span>, <span class="cm-variable">Dropout</span>, <span class="cm-variable">Input</span>, <span class="cm-variable">Masking</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">layers</span> <span class="cm-keyword">import</span> <span class="cm-variable">LSTM</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">utils</span>.<span class="cm-property">data_utils</span> <span class="cm-keyword">import</span> <span class="cm-variable">get_file</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">preprocessing</span>.<span class="cm-property">sequence</span> <span class="cm-keyword">import</span> <span class="cm-variable">pad_sequences</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">shakespeare_utils</span> <span class="cm-keyword">import</span> <span class="cm-operator">*</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">sys</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">io</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 174px;"></div><div class="CodeMirror-gutters" style="display: none; height: 185px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stderr"><pre>Using TensorFlow backend.
</pre></div></div><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Loading text data...
Creating training set...
number of training examples: 31412
Vectorizing training set...
Loading model...
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 60px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 15.9258px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">To save you some time, we have already trained a model for ~1000 epochs on a collection of Shakespearian poems called <span class="cm-link">[</span><span class="cm-em cm-link">*"The Sonnets"*</span><span class="cm-link">]</span><span class="cm-string cm-url">(shakespeare.txt)</span>. </span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 60px;"></div><div class="CodeMirror-gutters" style="display: none; height: 72px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>To save you some time, we have already trained a model for ~1000 epochs on a collection of Shakespearian poems called <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/shakespeare.txt" target="_blank"><em>"The Sonnets"</em></a>. </p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.5918px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 158px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 15.9258px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Let's train the model for one more epoch. When it finishes training for an epoch---this will also take a few minutes---you can run <span class="cm-comment">`generate_output`</span>, which will prompt asking you for an input (<span class="cm-comment">`&lt;`</span>40 characters). The poem will start with your sentence, and our RNN-Shakespeare will complete the rest of the poem for you! For example, try "Forsooth this maketh no sense " (don't enter the quotation marks). Depending on whether you include the space at the end, your results might also differ--try it both ways, and try other inputs as well. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 158px;"></div><div class="CodeMirror-gutters" style="display: none; height: 170px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Let's train the model for one more epoch. When it finishes training for an epoch---this will also take a few minutes---you can run <code>generate_output</code>, which will prompt asking you for an input (<code>&lt;</code>40 characters). The poem will start with your sentence, and our RNN-Shakespeare will complete the rest of the poem for you! For example, try "Forsooth this maketh no sense " (don't enter the quotation marks). Depending on whether you include the space at the end, your results might also differ--try it both ways, and try other inputs as well. </p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[23]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 21.8866px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 458.336px; margin-bottom: -19px; border-right-width: 11px; min-height: 60px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 0px; top: 16.2963px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">print_callback</span> = <span class="cm-variable">LambdaCallback</span>(<span class="cm-variable">on_epoch_end</span>=<span class="cm-variable">on_epoch_end</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">model</span>.<span class="cm-property">fit</span>(<span class="cm-variable">x</span>, <span class="cm-variable">y</span>, <span class="cm-variable">batch_size</span>=<span class="cm-number">128</span>, <span class="cm-variable">epochs</span>=<span class="cm-number">1</span>, <span class="cm-variable">callbacks</span>=[<span class="cm-variable">print_callback</span>])</span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 60px;"></div><div class="CodeMirror-gutters" style="display: none; height: 71px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Epoch 1/1
31412/31412 [==============================] - 260s - loss: 2.5558   
</pre></div></div><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[23]:</div><div class="output_subarea output_text output_result"><pre>&lt;keras.callbacks.History at 0x7f57899f0128&gt;</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[24]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 21.8866px; left: 126.4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 531.345px; margin-bottom: -19px; border-right-width: 11px; min-height: 44px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 120.81px; top: 16.2963px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># Run this cell to try with different inputs without having to re-train the model </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">generate_output</span><span class=" CodeMirror-matchingbracket">(</span><span class=" CodeMirror-matchingbracket">)</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 55px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Write the beginning of your poem, the Shakespeare machine will complete it. Your input is: Zhejiang University goes big.


Here is your poem: 

Zhejiang University goes big.
ters of feates and
the selven this brrigh saves weam gives fretry,
on me fuill libeds, her other ther entise.
or me the sey vusse'f infihel cofe cons live.
hing rretwitione is cinders ang event,
lay be own doth stid amade and wout beiled,
that's hast  yet kext beay as muse'd mien,
belore thas to nother, had thee of devern,
that hawe the mann to be storl she dreve,
sweemend as my canctormong ame t</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered selected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 190px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 15.9258px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The RNN-Shakespeare model is very similar to the one you have built for dinosaur names. The only major differences are:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- LSTMs instead of the basic RNN to capture longer-range dependencies</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- The model is a deeper, stacked LSTM model (2 layer)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Using Keras instead of python to simplify the code </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">If you want to learn more, you can also check out the Keras Team's text generation implementation on GitHub: <span class="cm-link">https://github.com/keras-team/keras/blob/master/examples/lstm_text_generation.py</span>.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Congratulations on finishing this notebook! </span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 190px;"></div><div class="CodeMirror-gutters" style="display: none; height: 202px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>The RNN-Shakespeare model is very similar to the one you have built for dinosaur names. The only major differences are:</p>
<ul>
<li>LSTMs instead of the basic RNN to capture longer-range dependencies</li>
<li>The model is a deeper, stacked LSTM model (2 layer)</li>
<li>Using Keras instead of python to simplify the code </li>
</ul>
<p>If you want to learn more, you can also check out the Keras Team's text generation implementation on GitHub: <a href="https://github.com/keras-team/keras/blob/master/examples/lstm_text_generation.py" target="_blank">https://github.com/keras-team/keras/blob/master/examples/lstm_text_generation.py</a>.</p>
<p>Congratulations on finishing this notebook! </p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.5918px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -18px; border-right-width: 12px; min-height: 158px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**References**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- This exercise took inspiration from Andrej Karpathy's implementation: </span><span class="cm-variable-2 cm-link">https://gist.github.com/karpathy/d4dee566867f8291f086</span><span class="cm-variable-2">. To learn more about text generation, also check out Karpathy's </span><span class="cm-link cm-variable-2">[blog post]</span><span class="cm-string cm-url cm-variable-2">(http://karpathy.github.io/2015/05/21/rnn-effectiveness/)</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- For the Shakespearian poem generator, our implementation was based on the implementation of an LSTM text generator by the Keras team: </span><span class="cm-variable-2 cm-link">https://github.com/keras-team/keras/blob/master/examples/lstm_text_generation.py</span><span class="cm-variable-2"> </span></span></pre></div></div></div></div></div><div style="position: absolute; height: 12px; width: 1px; border-bottom: 0px solid transparent; top: 158px;"></div><div class="CodeMirror-gutters" style="display: none; height: 170px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>References</strong>:</p>
<ul>
<li>This exercise took inspiration from Andrej Karpathy's implementation: <a href="https://gist.github.com/karpathy/d4dee566867f8291f086" target="_blank">https://gist.github.com/karpathy/d4dee566867f8291f086</a>. To learn more about text generation, also check out Karpathy's <a href="http://karpathy.github.io/2015/05/21/rnn-effectiveness/" target="_blank">blog post</a>.</li>
<li>For the Shakespearian poem generator, our implementation was based on the implementation of an LSTM text generator by the Keras team: <a href="https://github.com/keras-team/keras/blob/master/examples/lstm_text_generation.py" target="_blank">https://github.com/keras-team/keras/blob/master/examples/lstm_text_generation.py</a> </li>
</ul>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59027px; left: 5.59027px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 3px; margin-bottom: -19px; border-right-width: 11px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.2963px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 11px; width: 1px; border-bottom: 0px solid transparent; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 38px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div></div><div class="end_space"></div></div>
        <div id="tooltip" class="ipython_tooltip" style="display:none"><div class="tooltipbuttons"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#" role="button" class="ui-button"><span class="ui-icon ui-icon-close">Close</span></a><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#" class="ui-corner-all" role="button" id="expanbutton" title="Grow the tooltip vertically (press shift-tab twice)"><span class="ui-icon ui-icon-plus">Expand</span></a><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#" role="button" class="ui-button" title="show the current docstring in pager (press shift-tab 4 times)"><span class="ui-icon ui-icon-arrowstop-l-n">Open in Pager</span></a><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Dinosaur%20Island%20--%20Character-level%20language%20model/Dinosaurus_Island_Character_level_language_model_final_v3a.ipynb#" role="button" class="ui-button" title="Tooltip will linger for 10 seconds while you type" style="display: none;"><span class="ui-icon ui-icon-clock">Close</span></a></div><div class="pretooltiparrow"></div><div class="tooltiptext smalltooltip"></div></div>
    </div>
</div>



</div>



<div id="pager" class="ui-resizable">
    <div id="pager-contents">
        <div id="pager-container" class="container"></div>
    </div>
    <div id="pager-button-area"><a role="button" title="Open the pager in an external window" class="ui-button"><span class="ui-icon ui-icon-extlink"></span></a><a role="button" title="Close the pager" class="ui-button"><span class="ui-icon ui-icon-close"></span></a></div>
<div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div></div>






<script type="text/javascript">
    sys_info = {"notebook_version": "5.0.0", "notebook_path": "/opt/conda/lib/python3.6/site-packages/notebook", "commit_source": "", "commit_hash": "", "sys_version": "3.6.0 |Anaconda 4.3.1 (64-bit)| (default, Dec 23 2016, 12:22:00) \n[GCC 4.4.7 20120313 (Red Hat 4.4.7-1)]", "sys_executable": "/opt/conda/bin/python", "sys_platform": "linux", "platform": "Linux-4.14.70-67.55.amzn1.x86_64-x86_64-with-debian-8.4", "os_name": "posix", "default_encoding": "UTF-8"};
</script>

<script src="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/encoding.js.下载" charset="utf-8"></script>

<script src="./Dinosaurus_Island_Character_level_language_model_final_v3a_files/main.min.js.下载" type="text/javascript" charset="utf-8"></script>



<script type="text/javascript">
  function _remove_token_from_url() {
    if (window.location.search.length <= 1) {
      return;
    }
    var search_parameters = window.location.search.slice(1).split('&');
    for (var i = 0; i < search_parameters.length; i++) {
      if (search_parameters[i].split('=')[0] === 'token') {
        // remote token from search parameters
        search_parameters.splice(i, 1);
        var new_search = '';
        if (search_parameters.length) {
          new_search = '?' + search_parameters.join('&');
        }
        var new_url = window.location.origin + 
                      window.location.pathname + 
                      new_search + 
                      window.location.hash;
        window.history.replaceState({}, "", new_url);
        return;
      }
    }
  }
  _remove_token_from_url();
</script>


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXMathJax_Main-bold, Times;"></div></div></body></html>