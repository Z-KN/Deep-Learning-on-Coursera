<!DOCTYPE html>
<!-- saved from url=(0194)https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb# -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    

    <title>Building_a_Recurrent_Neural_Network_Step_by_Step_v3a</title>
    <link rel="shortcut icon" type="image/x-icon" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/static/base/images/favicon.ico?v=97c6417ed01bdc0ae3ef32ae4894fd03">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/jquery-ui.min.css" type="text/css">
    <link rel="stylesheet" href="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/jquery.typeahead.min.css" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    


<script type="text/javascript" src="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/MathJax.js.下载" charset="utf-8"></script>

<script type="text/javascript">
// MathJax disabled, set as null to distingish from *missing* MathJax,
// where it will be undefined, and should prompt a dialog later.
window.mathjax_url = "/static/components/MathJax/MathJax.js";
</script>

<link rel="stylesheet" href="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/bootstrap-tour.min.css" type="text/css">
<link rel="stylesheet" href="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/codemirror.css">


    <link rel="stylesheet" href="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/style.min.css" type="text/css">
    

<link rel="stylesheet" href="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/override.css" type="text/css">
<link rel="stylesheet" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb" id="kernel-css" type="text/css">


    <link rel="stylesheet" href="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/custom.css" type="text/css">
    <script src="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/promise.min.js.下载" type="text/javascript" charset="utf-8"></script>
    <script src="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/index.js.下载" type="text/javascript"></script>
    <script src="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/index.js(1).下载" type="text/javascript"></script>
    <script src="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/index.js(2).下载" type="text/javascript"></script>
    <script src="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/require.js.下载" type="text/javascript" charset="utf-8"></script>
    <script>
      require.config({
          
          urlArgs: "v=20200129141120",
          
          baseUrl: '/static/',
          paths: {
            'auth/js/main': 'auth/js/main.min',
            custom : '/custom',
            nbextensions : '/nbextensions',
            kernelspecs : '/kernelspecs',
            underscore : 'components/underscore/underscore-min',
            backbone : 'components/backbone/backbone-min',
            jquery: 'components/jquery/jquery.min',
            bootstrap: 'components/bootstrap/js/bootstrap.min',
            bootstraptour: 'components/bootstrap-tour/build/js/bootstrap-tour.min',
            'jquery-ui': 'components/jquery-ui/ui/minified/jquery-ui.min',
            moment: 'components/moment/moment',
            codemirror: 'components/codemirror',
            termjs: 'components/xterm.js/dist/xterm',
            typeahead: 'components/jquery-typeahead/dist/jquery.typeahead.min',
          },
          map: { // for backward compatibility
              "*": {
                  "jqueryui": "jquery-ui",
              }
          },
          shim: {
            typeahead: {
              deps: ["jquery"],
              exports: "typeahead"
            },
            underscore: {
              exports: '_'
            },
            backbone: {
              deps: ["underscore", "jquery"],
              exports: "Backbone"
            },
            bootstrap: {
              deps: ["jquery"],
              exports: "bootstrap"
            },
            bootstraptour: {
              deps: ["bootstrap"],
              exports: "Tour"
            },
            "jquery-ui": {
              deps: ["jquery"],
              exports: "$"
            }
          },
          waitSeconds: 30,
      });

      require.config({
          map: {
              '*':{
                'contents': 'services/contents',
              }
          }
      });

      // error-catching custom.js shim.
      define("custom", function (require, exports, module) {
          try {
              var custom = require('custom/custom');
              console.debug('loaded custom.js');
              return custom;
          } catch (e) {
              console.error("error loading custom.js", e);
              return {};
          }
      })
    </script>

    
    

<script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/contents" src="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/contents.js.下载"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="custom/custom" src="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/custom.js.下载"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">div.MathJax_MathML {text-align: center; margin: .75em 0px; display: block!important}
.MathJax_MathML {font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
span.MathJax_MathML {display: inline!important}
.MathJax_mmlExBox {display: block!important; overflow: hidden; height: 1px; width: 60ex; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0}
[class="MJX-tex-oldstyle"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB}
[class="MJX-tex-oldstyle-bold"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB; font-weight: bold}
[class="MJX-tex-caligraphic"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB}
[class="MJX-tex-caligraphic-bold"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB; font-weight: bold}
@font-face /*1*/ {font-family: MathJax_Caligraphic-WEB; src: url('https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf')}
@font-face /*2*/ {font-family: MathJax_Caligraphic-WEB; font-weight: bold; src: url('https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Bold.otf')}
[mathvariant="double-struck"] {font-family: MathJax_AMS, MathJax_AMS-WEB}
[mathvariant="script"] {font-family: MathJax_Script, MathJax_Script-WEB}
[mathvariant="fraktur"] {font-family: MathJax_Fraktur, MathJax_Fraktur-WEB}
[mathvariant="bold-script"] {font-family: MathJax_Script, MathJax_Caligraphic-WEB; font-weight: bold}
[mathvariant="bold-fraktur"] {font-family: MathJax_Fraktur, MathJax_Fraktur-WEB; font-weight: bold}
[mathvariant="monospace"] {font-family: monospace}
[mathvariant="sans-serif"] {font-family: sans-serif}
[mathvariant="bold-sans-serif"] {font-family: sans-serif; font-weight: bold}
[mathvariant="sans-serif-italic"] {font-family: sans-serif; font-style: italic}
[mathvariant="sans-serif-bold-italic"] {font-family: sans-serif; font-style: italic; font-weight: bold}
@font-face /*3*/ {font-family: MathJax_AMS-WEB; src: url('https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf')}
@font-face /*4*/ {font-family: MathJax_Script-WEB; src: url('https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf')}
@font-face /*5*/ {font-family: MathJax_Fraktur-WEB; src: url('https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf')}
@font-face /*6*/ {font-family: MathJax_Fraktur-WEB; font-weight: bold; src: url('https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Bold.otf')}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/submit-button/main" src="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/main.js.下载"></script><style type="text/css">.MathJax_Display {text-align: center; margin: 0; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: STIXMathJax_Main-italic; src: url('https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/static/components/MathJax/fonts/HTML-CSS/STIX-Web/woff/STIXMathJax_Main-Italic.woff?rev=2.6.0') format('woff'), url('https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/static/components/MathJax/fonts/HTML-CSS/STIX-Web/otf/STIXMathJax_Main-Italic.otf?rev=2.6.0') format('opentype')}
</style><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/notebook/js/extension" src="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/extension.js.下载"></script><link id="favicon" type="image/x-icon" rel="shortcut icon" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/static/base/images/favicon.ico"></head>

<body class="notebook_app command_mode" data-base-url="/" data-ws-url="" data-notebook-name="Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb" data-notebook-path="Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb" dir="ltr" style=""><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"><br></div></div><div id="MathJax_Message" style="display: none;"></div>

<noscript>
    <div id='noscript'>
      Jupyter Notebook requires JavaScript.<br>
      Please enable it to proceed.
  </div>
</noscript>

<div id="header" style="display: block;">
  <div id="header-container" class="container">
  <div id="ipython_notebook" class="nav navbar-brand pull-left"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/tree" title="dashboard"><img src="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/logo.png" alt="Jupyter Notebook"></a></div>

  
  
  

    <span id="login_widget">
      
    </span>

  

  

  


<span id="save_widget" class="pull-left save_widget">
    <span id="notebook_name" class="filename">Building_a_Recurrent_Neural_Network_Step_by_Step_v3a</span>
    <span class="checkpoint_status" title="Wed, Jan 29, 2020 11:03 PM">Last Checkpoint: 2 minutes ago</span>
    <span class="autosave_status">(autosaved)</span>
</span>

<span id="kernel_logo_widget">
  
  <img class="current_kernel_logo" src="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/logo-64x64.png" title="Python 3" style="display: inline;">
  
</span>


  </div>
  <div class="header-bar"></div>

  
<div id="menubar-container" class="container">
<div id="menubar">
    <div id="menus" class="navbar navbar-default" role="navigation">
        <div class="container-fluid">
            <button type="button" class="btn btn-default navbar-btn navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <i class="fa fa-bars"></i>
              <span class="navbar-text">Menu</span>
            </button>
            <p id="kernel_indicator" class="navbar-text indicator_area">
              <span class="kernel_indicator_name">Python 3</span>
              <i id="kernel_indicator_icon" class="kernel_idle_icon" title="Kernel Idle"></i>
            </p>
            <i id="readonly-indicator" class="navbar-text" title="This notebook is read-only" style="display: none;">
                <span class="fa-stack">
                    <i class="fa fa-save fa-stack-1x"></i>
                    <i class="fa fa-ban fa-stack-2x text-danger"></i>
                </span>
            </i>
            <i id="modal_indicator" class="navbar-text modal_indicator" title="Command Mode"></i>
            <span id="notification_area"><div id="notification_kernel" class="notification_widget btn btn-xs navbar-btn undefined info" style="display: none;"><span></span></div><div id="notification_notebook" class="notification_widget btn btn-xs navbar-btn" style="display: none;"><span></span></div><div id="notification_trusted" class="notification_widget btn btn-xs navbar-btn" style="display: inline-block;"><span>Trusted</span></div></span>
            <div class="navbar-collapse collapse">
              <ul class="nav navbar-nav">
                <li class="dropdown"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#" class="dropdown-toggle" data-toggle="dropdown">File</a>
                    <ul id="file_menu" class="dropdown-menu">
                        <li id="new_notebook" class="dropdown-submenu">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">New Notebook</a>
                            <ul class="dropdown-menu" id="menu-new-notebook-submenu"><li id="new-notebook-submenu-python3"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Python 3</a></li><li class="divider"></li><li id="new-notebook-submenu-python2"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Python 2</a></li></ul>
                        </li>
                        <li id="open_notebook" title="Opens a new window with the Dashboard view">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Open...</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="copy_notebook" title="Open a copy of this notebook&#39;s contents and start a new kernel">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Make a Copy...</a></li>
                        <li id="rename_notebook"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Rename...</a></li>
                        <li id="save_checkpoint"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Save and Checkpoint</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="restore_checkpoint" class="dropdown-submenu"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Revert to Checkpoint</a>
                          <ul class="dropdown-menu"><li><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Wednesday, January 29, 2020 11:03 PM</a></li></ul>
                        </li>
                        <li class="divider"></li>
                        <li id="print_preview"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Print Preview</a></li>
                        <li class="dropdown-submenu"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Download as</a>
                            <ul id="download_menu" class="dropdown-menu">
                                <li id="download_ipynb"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Notebook (.ipynb)</a></li>
                                <li id="download_script"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Python (.py)</a></li>
                                <li id="download_html"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">HTML (.html)</a></li>
                                <li id="download_markdown"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Markdown (.md)</a></li>
                                <li id="download_rst"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">reST (.rst)</a></li>
                                <li id="download_latex"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">LaTeX (.tex)</a></li>
                                <li id="download_pdf"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">PDF via LaTeX (.pdf)</a></li>
                            </ul>
                        </li>
                        <li class="dropdown-submenu hidden"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Deploy as</a>
                            <ul id="deploy_menu" class="dropdown-menu"></ul>
                        </li>
                        <li class="divider"></li>
                        <li id="trust_notebook" title="Trust the output of this notebook" class="disabled">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Trusted Notebook</a></li>
                        <li class="divider"></li>
                        <li id="kill_and_exit" title="Shutdown this notebook&#39;s kernel, and close this window">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Close and Halt</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Edit</a>
                    <ul id="edit_menu" class="dropdown-menu">
                        <li id="cut_cell"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Cut Cells</a></li>
                        <li id="copy_cell"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Copy Cells</a></li>
                        <li id="paste_cell_above" class="disabled"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Paste Cells Above</a></li>
                        <li id="paste_cell_below" class="disabled"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Paste Cells Below</a></li>
                        <li id="paste_cell_replace" class="disabled"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Paste Cells &amp; Replace</a></li>
                        <li id="delete_cell"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Delete Cells</a></li>
                        <li id="undelete_cell" class="disabled"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Undo Delete Cells</a></li>
                        <li class="divider"></li>
                        <li id="split_cell"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Split Cell</a></li>
                        <li id="merge_cell_above"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Merge Cell Above</a></li>
                        <li id="merge_cell_below"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Merge Cell Below</a></li>
                        <li class="divider"></li>
                        <li id="move_cell_up"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Move Cell Up</a></li>
                        <li id="move_cell_down"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Move Cell Down</a></li>
                        <li class="divider"></li>
                        <li id="edit_nb_metadata"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Edit Notebook Metadata</a></li>
                        <li class="divider"></li>
                        <li id="find_and_replace"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#"> Find and Replace </a></li>
                        <li class="divider"></li>
                        <li id="cut_cell_attachments"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Cut Cell Attachments</a></li>
                        <li id="copy_cell_attachments"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Copy Cell Attachments</a></li>
                        <li id="paste_cell_attachments" class="disabled"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Paste Cell Attachments</a></li>
                        <li class="divider"></li>
                        <li id="insert_image" class="disabled"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#"> Insert Image </a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#" class="dropdown-toggle" data-toggle="dropdown">View</a>
                    <ul id="view_menu" class="dropdown-menu">
                        <li id="toggle_header" title="Show/Hide the logo and notebook title (above menu bar)">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Toggle Header</a>
                        </li>
                        <li id="toggle_toolbar" title="Show/Hide the action icons (below menu bar)">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Toggle Toolbar</a>
                        </li>
                        <li id="toggle_line_numbers" title="Show/Hide line numbers in cells">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Toggle Line Numbers</a>
                        </li>
                        <li id="menu-cell-toolbar" class="dropdown-submenu">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Cell Toolbar</a>
                            <ul class="dropdown-menu" id="menu-cell-toolbar-submenu"><li data-name="None"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">None</a></li><li data-name="Edit%20Metadata"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Edit Metadata</a></li><li data-name="Raw%20Cell%20Format"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Raw Cell Format</a></li><li data-name="Slideshow"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Slideshow</a></li><li data-name="Attachments"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Attachments</a></li><li data-name="Tags"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Tags</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Insert</a>
                    <ul id="insert_menu" class="dropdown-menu">
                        <li id="insert_cell_above" title="Insert an empty Code cell above the currently active cell">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Insert Cell Above</a></li>
                        <li id="insert_cell_below" title="Insert an empty Code cell below the currently active cell">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Insert Cell Below</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Cell</a>
                    <ul id="cell_menu" class="dropdown-menu">
                        <li id="run_cell" title="Run this cell, and move cursor to the next one">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Run Cells</a></li>
                        <li id="run_cell_select_below" title="Run this cell, select below">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Run Cells and Select Below</a></li>
                        <li id="run_cell_insert_below" title="Run this cell, insert below">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Run Cells and Insert Below</a></li>
                        <li id="run_all_cells" title="Run all cells in the notebook">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Run All</a></li>
                        <li id="run_all_cells_above" title="Run all cells above (but not including) this cell">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Run All Above</a></li>
                        <li id="run_all_cells_below" title="Run this cell and all cells below it">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Run All Below</a></li>
                        <li class="divider"></li>
                        <li id="change_cell_type" class="dropdown-submenu" title="All cells in the notebook have a cell type. By default, new cells are created as &#39;Code&#39; cells">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Cell Type</a>
                            <ul class="dropdown-menu">
                              <li id="to_code" title="Contents will be sent to the kernel for execution, and output will display in the footer of cell">
                                  <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Code</a></li>
                              <li id="to_markdown" title="Contents will be rendered as HTML and serve as explanatory text">
                                  <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Markdown</a></li>
                              <li id="to_raw" title="Contents will pass through nbconvert unmodified">
                                  <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Raw NBConvert</a></li>
                            </ul>
                        </li>
                        <li class="divider"></li>
                        <li id="current_outputs" class="dropdown-submenu"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Current Outputs</a>
                            <ul class="dropdown-menu">
                                <li id="toggle_current_output" title="Hide/Show the output of the current cell">
                                    <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Toggle</a>
                                </li>
                                <li id="toggle_current_output_scroll" title="Scroll the output of the current cell">
                                    <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_current_output" title="Clear the output of the current cell">
                                    <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Clear</a>
                                </li>
                            </ul>
                        </li>
                        <li id="all_outputs" class="dropdown-submenu"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">All Output</a>
                            <ul class="dropdown-menu">
                                <li id="toggle_all_output" title="Hide/Show the output of all cells">
                                    <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Toggle</a>
                                </li>
                                <li id="toggle_all_output_scroll" title="Scroll the output of all cells">
                                    <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_all_output" title="Clear the output of all cells">
                                    <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Clear</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Kernel</a>
                    <ul id="kernel_menu" class="dropdown-menu">
                        <li id="int_kernel" title="Send KeyboardInterrupt (CTRL-C) to the Kernel">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Interrupt</a>
                        </li>
                        <li id="restart_kernel" title="Restart the Kernel">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Restart</a>
                        </li>
                        <li id="restart_clear_output" title="Restart the Kernel and clear all output">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Restart &amp; Clear Output</a>
                        </li>
                        <li id="restart_run_all" title="Restart the Kernel and re-run the notebook">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Restart &amp; Run All</a>
                        </li>
                        <li id="reconnect_kernel" title="Reconnect to the Kernel">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Reconnect</a>
                        </li>
                        <li id="shutdown_kernel" title="Shutdown the Kernel">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Shutdown</a>
                        </li>
                        <li class="divider"></li>
                        <li id="menu-change-kernel" class="dropdown-submenu">
                            <a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Change kernel</a>
                            <ul class="dropdown-menu" id="menu-change-kernel-submenu"><li id="kernel-submenu-python2"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Python 2</a></li><li id="kernel-submenu-python3"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Python 3</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Help</a>
                    <ul id="help_menu" class="dropdown-menu">
                        
                        <li id="notebook_tour" title="A quick tour of the notebook user interface"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">User Interface Tour</a></li>
                        <li id="keyboard_shortcuts" title="Opens a dialog which shows all keyboard shortcuts"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Keyboard Shortcuts</a></li>
                        <li id="edit_keyboard_shortcuts" title="Opens a dialog allowing you to edit Keyboard shortcuts"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">Edit Keyboard Shortcuts</a></li>
                        <li class="divider"></li>
                        

                        
                            
                                <li><a rel="noreferrer" href="http://nbviewer.ipython.org/github/ipython/ipython/blob/3.x/examples/Notebook/Index.ipynb" target="_blank" title="Opens in a new window">
                                
                                    <i class="fa fa-external-link menu-icon pull-right"></i>
                                

                                Notebook Help
                                </a></li>
                            
                                <li><a rel="noreferrer" href="https://help.github.com/articles/markdown-basics/" target="_blank" title="Opens in a new window">
                                
                                    <i class="fa fa-external-link menu-icon pull-right"></i>
                                

                                Markdown
                                </a></li>
                            
                            
                        
                        <li id="kernel-help-links" class="divider"></li><li><a target="_blank" title="Opens in a new window" href="http://docs.python.org/3.6?v=20200129141120"><i class="fa fa-external-link menu-icon pull-right"></i><span>Python</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://ipython.org/documentation.html?v=20200129141120"><i class="fa fa-external-link menu-icon pull-right"></i><span>IPython</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.scipy.org/doc/numpy/reference/?v=20200129141120"><i class="fa fa-external-link menu-icon pull-right"></i><span>NumPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.scipy.org/doc/scipy/reference/?v=20200129141120"><i class="fa fa-external-link menu-icon pull-right"></i><span>SciPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://matplotlib.org/contents.html?v=20200129141120"><i class="fa fa-external-link menu-icon pull-right"></i><span>Matplotlib</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.sympy.org/latest/index.html?v=20200129141120"><i class="fa fa-external-link menu-icon pull-right"></i><span>SymPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://pandas.pydata.org/pandas-docs/stable/?v=20200129141120"><i class="fa fa-external-link menu-icon pull-right"></i><span>pandas</span></a></li><li class="divider"></li>
                        <li title="About Jupyter Notebook"><a id="notebook_about" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#">About</a></li>
                        
                    </ul>
                </li>
              </ul>
            </div>
        </div>
    </div>
</div>

<div id="maintoolbar" class="navbar">
  <div class="toolbar-inner navbar-inner navbar-nobg">
    <div id="maintoolbar-container" class="container toolbar"><div class="btn-group" id="save-notbook"><button class="btn btn-default" title="Save and Checkpoint" data-jupyter-action="jupyter-notebook:save-notebook"><i class="fa-save fa"></i></button></div><div class="btn-group" id="insert_above_below"><button class="btn btn-default" title="insert cell below" data-jupyter-action="jupyter-notebook:insert-cell-below"><i class="fa-plus fa"></i></button></div><div class="btn-group" id="cut_copy_paste"><button class="btn btn-default" title="cut selected cells" data-jupyter-action="jupyter-notebook:cut-cell"><i class="fa-cut fa"></i></button><button class="btn btn-default" title="copy selected cells" data-jupyter-action="jupyter-notebook:copy-cell"><i class="fa-copy fa"></i></button><button class="btn btn-default" title="paste cells below" data-jupyter-action="jupyter-notebook:paste-cell-below"><i class="fa-paste fa"></i></button></div><div class="btn-group" id="move_up_down"><button class="btn btn-default" title="move selected cells up" data-jupyter-action="jupyter-notebook:move-cell-up"><i class="fa-arrow-up fa"></i></button><button class="btn btn-default" title="move selected cells down" data-jupyter-action="jupyter-notebook:move-cell-down"><i class="fa-arrow-down fa"></i></button></div><div class="btn-group" id="run_int"><button class="btn btn-default" title="run cell, select below" data-jupyter-action="jupyter-notebook:run-cell-and-select-next"><i class="fa-step-forward fa"></i></button><button class="btn btn-default" title="interrupt kernel" data-jupyter-action="jupyter-notebook:interrupt-kernel"><i class="fa-stop fa"></i></button><button class="btn btn-default" title="restart the kernel (with dialog)" data-jupyter-action="jupyter-notebook:confirm-restart-kernel"><i class="fa-repeat fa"></i></button></div><select id="cell_type" class="form-control select-xs"><option value="code">Code</option><option value="markdown">Markdown</option><option value="raw">Raw NBConvert</option><option value="heading">Heading</option><option value="multiselect" disabled="disabled" style="display: none;">-</option></select><div class="btn-group"><button class="btn btn-default" title="open the command palette" data-jupyter-action="jupyter-notebook:show-command-palette"><i class="fa-keyboard-o fa"></i></button></div><div class="btn-group" id="submit-notebook-button-group" style="float:right"><button class="btn btn-default" title="Submit this notebook for grading." id="submit-notebook-button" style="background-color:rgb(42, 115, 204); color:white; padding:4px 8px">Submit Assignment</button></div></div>
  </div>
</div>
</div>

<div class="lower-header-bar"></div>

</div>

<div id="site" style="height: 581px; display: block;">


<div id="ipython-main-app">
    <div id="notebook_panel">
        <div id="notebook" tabindex="-1"><div class="container" id="notebook-container"><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59895px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 767px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.1667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-1"># Building your Recurrent Neural Network - Step by Step</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Welcome to Course 5's first assignment! In this assignment, you will implement key components of a Recurrent Neural Network in numpy.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Recurrent Neural Networks (RNN) are very effective for Natural Language Processing and other sequence tasks because they have "memory". They can read inputs <span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> (such as words) one at a time, and remember some information/context through the hidden layer activations that get passed from one time-step to the next. This allows a unidirectional RNN to take information from the past to process later inputs. A bidirectional RNN can take context from both the past and the future. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Notation**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Superscript </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-bracket">[</span>l<span class="cm-bracket">]</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> denotes an object associated with the </span><span class="cm-delimit cm-delimit-open">$</span>l^<span class="cm-bracket">{</span>th<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> layer. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Superscript </span><span class="cm-delimit cm-delimit-open">$</span>(i)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> denotes an object associated with the </span><span class="cm-delimit cm-delimit-open">$</span>i^<span class="cm-bracket">{</span>th<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> example. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Superscript </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> denotes an object at the </span><span class="cm-delimit cm-delimit-open">$</span>t^<span class="cm-bracket">{</span>th<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> time-step. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-strong cm-variable-2">**Sub**</span><span class="cm-variable-2">script </span><span class="cm-delimit cm-delimit-open">$</span>i<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> denotes the </span><span class="cm-delimit cm-delimit-open">$</span>i^<span class="cm-bracket">{</span>th<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> entry of a vector.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Example:<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">- </span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span>(2)<span class="cm-bracket">[</span><span class="cm-atom">3</span><span class="cm-bracket">]</span>&lt;4&gt;<span class="cm-bracket">}</span>_5<span class="cm-delimit cm-delimit-close">$</span><span class="cm-header cm-header-2"> denotes the activation of the 2nd training example (2), 3rd layer [3], 4th time step </span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">4</span><span class="cm-tag cm-bracket">&gt;</span>, and 5th entry in the vector.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">#### Pre-requisites</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">* We assume that you are already familiar with `numpy`. &nbsp;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">* To refresh your knowledge of numpy, you can review course 1 of this specialization "Neural Networks and Deep Learning". &nbsp;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  * Specifically, review the week 2 assignment ["Python Basics with numpy (optional)"](https://www.coursera.org/learn/neural-networks-deep-learning/item/Zh0CU).</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">#### Be careful when modifying the starter code</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">* When working on graded functions, please remember to only modify the code that is between the</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">```Python</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">#### START CODE HERE</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">```</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">and</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">```Python</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">#### END CODE HERE</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">```</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">* In particular, Be careful to not modify the first line of graded routines. These start with:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">```Python</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"># GRADED FUNCTION: routine_name</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">```</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">* The automatic grader (autograder) needs these to locate the function.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">* Even a change in spacing will cause issues with the autograder. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">* It will return 'failed' if these are modified or missing."</span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 767px;"></div><div class="CodeMirror-gutters" style="display: none; height: 776px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 id="Building-your-Recurrent-Neural-Network---Step-by-Step">Building your Recurrent Neural Network - Step by Step<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Building-your-Recurrent-Neural-Network---Step-by-Step">¶</a></h1>
<p>Welcome to Course 5's first assignment! In this assignment, you will implement key components of a Recurrent Neural Network in numpy.</p>
<p>Recurrent Neural Networks (RNN) are very effective for Natural Language Processing and other sequence tasks because they have "memory". They can read inputs <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-279-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4535" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-4536"><span class="msubsup" id="MathJax-Span-4537"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4538" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-4539"><span class="mrow" id="MathJax-Span-4540"><span class="mo" id="MathJax-Span-4541" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4542" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4543" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-279">x^{\langle t \rangle}</script> (such as words) one at a time, and remember some information/context through the hidden layer activations that get passed from one time-step to the next. This allows a unidirectional RNN to take information from the past to process later inputs. A bidirectional RNN can take context from both the past and the future. </p>
<p><strong>Notation</strong>:</p>
<ul>
<li><p>Superscript <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-280-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4544" role="math" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1000.9em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-4545"><span class="mo" id="MathJax-Span-4546" style="font-family: STIXMathJax_Main;">[</span><span class="mi" id="MathJax-Span-4547" style="font-family: STIXMathJax_Main-italic; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4548" style="font-family: STIXMathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-280">[l]</script> denotes an object associated with the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-281-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4549" role="math" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1000.96em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-4550"><span class="msubsup" id="MathJax-Span-4551"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.3em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4552" style="font-family: STIXMathJax_Main-italic; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.36em;"><span class="texatom" id="MathJax-Span-4553"><span class="mrow" id="MathJax-Span-4554"><span class="mi" id="MathJax-Span-4555" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4556" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>h</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-281">l^{th}</script> layer. </p>
</li>
<li><p>Superscript <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-282-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4557" role="math" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1000.9em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-4558"><span class="mo" id="MathJax-Span-4559" style="font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-4560" style="font-family: STIXMathJax_Main-italic; font-style: italic;">i</span><span class="mo" id="MathJax-Span-4561" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-282">(i)</script> denotes an object associated with the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-283-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4562" role="math" style="width: 1.074em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1000.9em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-4563"><span class="msubsup" id="MathJax-Span-4564"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.24em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4565" style="font-family: STIXMathJax_Main-italic; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.301em;"><span class="texatom" id="MathJax-Span-4566"><span class="mrow" id="MathJax-Span-4567"><span class="mi" id="MathJax-Span-4568" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4569" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>h</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-283">i^{th}</script> example. </p>
</li>
<li><p>Superscript <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-284-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4570" role="math" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em, 1000.96em, 2.801em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-4571"><span class="mo" id="MathJax-Span-4572" style="font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4573" style="font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4574" style="font-family: STIXMathJax_Main;">⟩</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></math></span></span><script type="math/tex" id="MathJax-Element-284">\langle t \rangle</script> denotes an object at the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-285-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4575" role="math" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1001.01em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-4576"><span class="msubsup" id="MathJax-Span-4577"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.277em, 1000.3em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4578" style="font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.36em;"><span class="texatom" id="MathJax-Span-4579"><span class="mrow" id="MathJax-Span-4580"><span class="mi" id="MathJax-Span-4581" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4582" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>h</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-285">t^{th}</script> time-step. </p>
</li>
<li><p><strong>Sub</strong>script <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-286-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4583" role="math" style="width: 0.36em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.301em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1000.3em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-4584"><span class="mi" id="MathJax-Span-4585" style="font-family: STIXMathJax_Main-italic; font-style: italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-286">i</script> denotes the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-287-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4586" role="math" style="width: 1.074em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1000.9em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-4587"><span class="msubsup" id="MathJax-Span-4588"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.24em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4589" style="font-family: STIXMathJax_Main-italic; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.301em;"><span class="texatom" id="MathJax-Span-4590"><span class="mrow" id="MathJax-Span-4591"><span class="mi" id="MathJax-Span-4592" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4593" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>h</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-287">i^{th}</script> entry of a vector.</p>
</li>
</ul>
<p>Example:  </p>
<ul>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-288-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4594" role="math" style="width: 4.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.574em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.015em, 1003.57em, 2.682em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-4595"><span class="msubsup" id="MathJax-Span-4596"><span style="display: inline-block; position: relative; width: 3.574em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4597" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1003.04em, 4.289em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-4598"><span class="mrow" id="MathJax-Span-4599"><span class="mo" id="MathJax-Span-4600" style="font-size: 70.7%; font-family: STIXMathJax_Main;">(</span><span class="mn" id="MathJax-Span-4601" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span class="mo" id="MathJax-Span-4602" style="font-size: 70.7%; font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-4603" style="font-size: 70.7%; font-family: STIXMathJax_Main;">[</span><span class="mn" id="MathJax-Span-4604" style="font-size: 70.7%; font-family: STIXMathJax_Main;">3</span><span class="mo" id="MathJax-Span-4605" style="font-size: 70.7%; font-family: STIXMathJax_Main;">]</span><span class="mo" id="MathJax-Span-4606" style="font-size: 70.7%; font-family: STIXMathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-4607" style="font-size: 70.7%; font-family: STIXMathJax_Main;">4</span><span class="mo" id="MathJax-Span-4608" style="font-size: 70.7%; font-family: STIXMathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.688em; left: 0.479em;"><span class="mn" id="MathJax-Span-4609" style="font-size: 70.7%; font-family: STIXMathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.496em; border-left: 0px solid; width: 0px; height: 1.646em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>a</mi><mn>5</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo><mo stretchy="false">[</mo><mn>3</mn><mo stretchy="false">]</mo><mo>&lt;</mo><mn>4</mn><mo>&gt;</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-288">a^{(2)[3]<4>}_5</script> denotes the activation of the 2nd training example (2), 3rd layer [3], 4th time step , and 5th entry in the vector.</li>
</ul>
<h4 id="Pre-requisites">Pre-requisites<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Pre-requisites">¶</a></h4>
<ul>
<li>We assume that you are already familiar with <code>numpy</code>.  </li>
<li>To refresh your knowledge of numpy, you can review course 1 of this specialization "Neural Networks and Deep Learning".  <ul>
<li>Specifically, review the week 2 assignment <a href="https://www.coursera.org/learn/neural-networks-deep-learning/item/Zh0CU" target="_blank">"Python Basics with numpy (optional)"</a>.</li>
</ul>
</li>
</ul>
<h4 id="Be-careful-when-modifying-the-starter-code">Be careful when modifying the starter code<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Be-careful-when-modifying-the-starter-code">¶</a></h4>
<ul>
<li>When working on graded functions, please remember to only modify the code that is between the<pre><code class="cm-s-ipython language-Python"><span class="cm-comment">#### START CODE HERE</span>
</code></pre>
and<pre><code class="cm-s-ipython language-Python"><span class="cm-comment">#### END CODE HERE</span>
</code></pre>
</li>
<li>In particular, Be careful to not modify the first line of graded routines. These start with:<pre><code class="cm-s-ipython language-Python"><span class="cm-comment"># GRADED FUNCTION: routine_name</span>
</code></pre>
</li>
<li>The automatic grader (autograder) needs these to locate the function.</li>
<li>Even a change in spacing will cause issues with the autograder. </li>
<li>It will return 'failed' if these are modified or missing."</li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59897px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 947px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.3333px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## </span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'darkblue'</span><span class="cm-tag cm-bracket">&gt;</span>Updates for 3a<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">font</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### If you were working on the notebook before this update...</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The current notebook is version "3a".</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* You can find your original work saved in the notebook with the previous version name ("v3") </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* To view the file directory, go to the menu "File-&gt;Open", and this will open a new tab that shows the file directory.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### List of updates</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* "Forward propagation for the basic RNN", added sections to clarify variable names and shapes:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- "Dimensions of </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">"</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- "Hidden State </span><span class="cm-delimit cm-delimit-open">$</span>a<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">", </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- "Dimensions of hidden state </span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">"</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- "Dimensions of prediction </span><span class="cm-delimit cm-delimit-open">$</span>y^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">"</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`rnn_cell_forward`</span><span class="cm-variable-2">: </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">* Added additional hints.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">* Updated figure 2.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`rnn_forward`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Set </span><span class="cm-comment cm-variable-3">`xt`</span><span class="cm-variable-3"> in a separate line of code to clarify what code is expected; added additional hints.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Clarifies instructions to specify dimensions (2D or 3D), and clarifies variable names.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Additional Hints</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Clarifies when the basic RNN works well.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Updated figure 3.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* "About the gates" replaced with "overview of gates and states":</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Updated to include conceptual description of each gate's purpose, and an explanation of each equation.</span><span class="cm-variable-3 cm-trailing-space-a"> </span><span class="cm-variable-3 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Added sections about the cell state, hidden state, and prediction.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Lists variable names that are used in the code, and notes when they differ from the variables used in the equations.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Lists shapes of the variables.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Updated figure 4.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`lstm_forward`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Added instructions, noting the shapes of the variables.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Added hints about </span><span class="cm-comment cm-variable-3">`c`</span><span class="cm-variable-3"> and </span><span class="cm-comment cm-variable-3">`c_next`</span><span class="cm-variable-3"> to help students avoid copy-by-reference mistakes.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Set </span><span class="cm-comment cm-variable-3">`xt`</span><span class="cm-variable-3"> in a separate line to make this step explicit.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`dimension`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- clarified use of </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span>(i)<span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3"> in dimension description</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`Backward description`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Updated figure 6 and 7</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`rnn_cell_backward`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- changed 'dtanh' to 'dz' to avoid confusion with the output of the tanh</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- fixed naming of 'b' in test section, changed to 'ba', updated results</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`rnn_backward`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- modified instructions in comments to sum da and gradients from previous timesteps</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`lstm_cell_backward`</span><span class="cm-variable-2"> </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- updated equations and description to fix errors.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Added Figure 8</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- modified equations to use the term dlower_case_gamma vs dGamma - the previous naming confused the location of the gate derivative.</span><span class="cm-variable-3 cm-trailing-space-a"> </span><span class="cm-variable-3 cm-trailing-space-b">&nbsp;</span><span class="cm-variable-3 cm-trailing-space-a"> </span><span class="cm-variable-3 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- removed redundant lines for equations 7-10, changed equation numbers to match new equation numbers</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`lstm_backward`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- removed comment listing dc as argument.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- added da_prevt and dc_prevt to for loop and recalculated results</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- in test, added "Wy" and "by" zero fill as it is required for lstm_forward. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Renamed global variables so that they do not conflict with local variables within the function.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Spelling, grammar and wording corrections.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* For unit tests, updated print statements and "expected output" for easier comparisons.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Many thanks to mentors and students for suggested improvements and fixes in the assignments for course 5!</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 947px;"></div><div class="CodeMirror-gutters" style="display: none; height: 956px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Updates-for-3a"><font color="darkblue">Updates for 3a</font><a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Updates-for-3a">¶</a></h2>
<h4 id="If-you-were-working-on-the-notebook-before-this-update...">If you were working on the notebook before this update...<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#If-you-were-working-on-the-notebook-before-this-update...">¶</a></h4>
<ul>
<li>The current notebook is version "3a".</li>
<li>You can find your original work saved in the notebook with the previous version name ("v3") </li>
<li>To view the file directory, go to the menu "File-&gt;Open", and this will open a new tab that shows the file directory.</li>
</ul>
<h4 id="List-of-updates">List of updates<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#List-of-updates">¶</a></h4>
<ul>
<li>"Forward propagation for the basic RNN", added sections to clarify variable names and shapes:<ul>
<li>"Dimensions of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-7"><span class="msubsup" id="MathJax-Span-8"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-9" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-10"><span class="mrow" id="MathJax-Span-11"><span class="mo" id="MathJax-Span-12" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-13" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-14" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-2">x^{\langle t \rangle}</script>"</li>
<li>"Hidden State <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-15" role="math" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.48em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-16"><span class="mi" id="MathJax-Span-17" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">a</script>", </li>
<li>"Dimensions of hidden state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-18" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-19"><span class="msubsup" id="MathJax-Span-20"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-21" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-22"><span class="mrow" id="MathJax-Span-23"><span class="mo" id="MathJax-Span-24" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-25" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-26" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-4">a^{\langle t \rangle}</script>"</li>
<li>"Dimensions of prediction <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-27" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.31em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-28"><span class="msubsup" id="MathJax-Span-29"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-30" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-31"><span class="mrow" id="MathJax-Span-32"><span class="mo" id="MathJax-Span-33" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-34" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-35" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-5">y^{\langle t \rangle}</script>"</li>
</ul>
</li>
<li><code>rnn_cell_forward</code>: <ul>
<li>Added additional hints.</li>
<li>Updated figure 2.</li>
</ul>
</li>
<li><code>rnn_forward</code><ul>
<li>Set <code>xt</code> in a separate line of code to clarify what code is expected; added additional hints.</li>
<li>Clarifies instructions to specify dimensions (2D or 3D), and clarifies variable names.</li>
<li>Additional Hints</li>
<li>Clarifies when the basic RNN works well.</li>
<li>Updated figure 3.</li>
</ul>
</li>
<li>"About the gates" replaced with "overview of gates and states":<ul>
<li>Updated to include conceptual description of each gate's purpose, and an explanation of each equation.  </li>
<li>Added sections about the cell state, hidden state, and prediction.</li>
<li>Lists variable names that are used in the code, and notes when they differ from the variables used in the equations.</li>
<li>Lists shapes of the variables.</li>
<li>Updated figure 4.</li>
</ul>
</li>
<li><code>lstm_forward</code><ul>
<li>Added instructions, noting the shapes of the variables.</li>
<li>Added hints about <code>c</code> and <code>c_next</code> to help students avoid copy-by-reference mistakes.</li>
<li>Set <code>xt</code> in a separate line to make this step explicit.</li>
</ul>
</li>
<li><code>dimension</code><ul>
<li>clarified use of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-36" role="math" style="width: 2.443em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.027em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1002.03em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-37"><span class="msubsup" id="MathJax-Span-38"><span style="display: inline-block; position: relative; width: 2.027em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-39" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-40"><span class="mrow" id="MathJax-Span-41"><span class="mo" id="MathJax-Span-42" style="font-size: 70.7%; font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-43" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">i</span><span class="mo" id="MathJax-Span-44" style="font-size: 70.7%; font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-45" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-46" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-47" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-6">x^{(i)\langle t \rangle}</script> in dimension description</li>
</ul>
</li>
<li><code>Backward description</code><ul>
<li>Updated figure 6 and 7</li>
</ul>
</li>
<li><code>rnn_cell_backward</code><ul>
<li>changed 'dtanh' to 'dz' to avoid confusion with the output of the tanh</li>
<li>fixed naming of 'b' in test section, changed to 'ba', updated results</li>
</ul>
</li>
<li><code>rnn_backward</code><ul>
<li>modified instructions in comments to sum da and gradients from previous timesteps</li>
</ul>
</li>
<li><code>lstm_cell_backward</code> <ul>
<li>updated equations and description to fix errors.</li>
<li>Added Figure 8</li>
<li>modified equations to use the term dlower_case_gamma vs dGamma - the previous naming confused the location of the gate derivative.    </li>
<li>removed redundant lines for equations 7-10, changed equation numbers to match new equation numbers</li>
</ul>
</li>
<li><p><code>lstm_backward</code></p>
<ul>
<li>removed comment listing dc as argument.</li>
<li>added da_prevt and dc_prevt to for loop and recalculated results</li>
<li>in test, added "Wy" and "by" zero fill as it is required for lstm_forward. </li>
</ul>
</li>
<li><p>Renamed global variables so that they do not conflict with local variables within the function.</p>
</li>
<li>Spelling, grammar and wording corrections.</li>
<li>For unit tests, updated print statements and "expected output" for easier comparisons.</li>
<li>Many thanks to mentors and students for suggested improvements and fixes in the assignments for course 5!</li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59888px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 27px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Let's first import all the packages that you will need during this assignment.</span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 36px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Let's first import all the packages that you will need during this assignment.</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[3]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.599px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 161.646px; margin-bottom: -21px; border-right-width: 9px; min-height: 44px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">rnn_utils</span> <span class="cm-keyword">import</span> <span class="cm-operator">*</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 53px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59888px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 79px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.3333px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 1 - Forward propagation for the basic Recurrent Neural Network</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Later this week, you will generate music using an RNN. The basic RNN that you will implement has the structure below. In this example, <span class="cm-delimit cm-delimit-open">$</span>T_x = T_y<span class="cm-delimit cm-delimit-close">$</span>. </span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 79px;"></div><div class="CodeMirror-gutters" style="display: none; height: 88px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="1---Forward-propagation-for-the-basic-Recurrent-Neural-Network">1 - Forward propagation for the basic Recurrent Neural Network<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#1---Forward-propagation-for-the-basic-Recurrent-Neural-Network">¶</a></h2>
<p>Later this week, you will generate music using an RNN. The basic RNN that you will implement has the structure below. In this example, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-48" role="math" style="width: 3.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.277em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em, 1003.28em, 2.801em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-49"><span class="msubsup" id="MathJax-Span-50"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-51" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-52" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-53" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-54" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-55" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-56" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>x</mi></msub><mo>=</mo><msub><mi>T</mi><mi>y</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-7">T_x = T_y</script>. </p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.599px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 44px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/RNN.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:500;height:300px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> **Figure 1**: Basic RNN model <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 53px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><img src="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/RNN.png" style="width: 500 ; height: 300px"></p>
<center> <strong>Figure 1</strong>: Basic RNN model </center></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.599px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 128px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Dimensions of input </span><span class="cm-delimit cm-delimit-open">$</span>x<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Input with </span><span class="cm-delimit cm-delimit-open">$</span>n_x<span class="cm-delimit cm-delimit-close">$</span><span class="cm-header cm-header-4"> number of units</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* For a single timestep of a single input example, </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span>(i) <span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span> <span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> is a one-dimensional input vector.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Using language as an example, a language with a 5000 word vocabulary could be one-hot encoded into a vector that has 5000 units.  So </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span>(i)<span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> would have the shape (5000,).</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* We'll use the notation </span><span class="cm-delimit cm-delimit-open">$</span>n_x<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> to denote the number of units in a single timestep of a single training example.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 128px;"></div><div class="CodeMirror-gutters" style="display: none; height: 137px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="Dimensions-of-input-$x$">Dimensions of input <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-57" role="math" style="width: 0.558em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.465em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.762em, 1000.47em, 2.502em, -999.998em); top: -2.359em; left: 0.002em;"><span class="mrow" id="MathJax-Span-58"><span class="mi" id="MathJax-Span-59" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">x</script><a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Dimensions-of-input-$x$">¶</a></h3>
<h4 id="Input-with-$n_x$-number-of-units">Input with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-60" role="math" style="width: 1.074em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1000.9em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-61"><span class="msubsup" id="MathJax-Span-62"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-63" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-64" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mi>x</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-9">n_x</script> number of units<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Input-with-$n_x$-number-of-units">¶</a></h4>
<ul>
<li>For a single timestep of a single input example, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-65" role="math" style="width: 2.443em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.027em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1002.03em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-66"><span class="msubsup" id="MathJax-Span-67"><span style="display: inline-block; position: relative; width: 2.027em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-68" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-69"><span class="mrow" id="MathJax-Span-70"><span class="mo" id="MathJax-Span-71" style="font-size: 70.7%; font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-72" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">i</span><span class="mo" id="MathJax-Span-73" style="font-size: 70.7%; font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-74" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-75" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-76" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-10">x^{(i) \langle t \rangle }</script> is a one-dimensional input vector.</li>
<li>Using language as an example, a language with a 5000 word vocabulary could be one-hot encoded into a vector that has 5000 units.  So <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-77" role="math" style="width: 2.443em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.027em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1002.03em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-78"><span class="msubsup" id="MathJax-Span-79"><span style="display: inline-block; position: relative; width: 2.027em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-80" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-81"><span class="mrow" id="MathJax-Span-82"><span class="mo" id="MathJax-Span-83" style="font-size: 70.7%; font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-84" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">i</span><span class="mo" id="MathJax-Span-85" style="font-size: 70.7%; font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-86" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-87" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-88" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-11">x^{(i)\langle t \rangle}</script> would have the shape (5000,).  </li>
<li>We'll use the notation <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-89" role="math" style="width: 1.074em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1000.9em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-90"><span class="msubsup" id="MathJax-Span-91"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-92" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-93" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mi>x</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-12">n_x</script> to denote the number of units in a single timestep of a single training example.</li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59912px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 77px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.5px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Time steps of size </span><span class="cm-delimit cm-delimit-open">$</span>T_<span class="cm-bracket">{</span>x<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* A recurrent neural network has multiple time steps, which we'll index with </span><span class="cm-delimit cm-delimit-open">$</span>t<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* In the lessons, we saw a single training example </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> consist of multiple time steps </span><span class="cm-delimit cm-delimit-open">$</span>T_x<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.  For example, if there are 10 time steps, </span><span class="cm-delimit cm-delimit-open">$</span>T_<span class="cm-bracket">{</span>x<span class="cm-bracket">}</span> = 10<span class="cm-delimit cm-delimit-close">$</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 77px;"></div><div class="CodeMirror-gutters" style="display: none; height: 86px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="Time-steps-of-size-$T_{x}$">Time steps of size <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-94" role="math" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1000.96em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-95"><span class="msubsup" id="MathJax-Span-96"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-97" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-98"><span class="mrow" id="MathJax-Span-99"><span class="mi" id="MathJax-Span-100" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-13">T_{x}</script><a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Time-steps-of-size-$T_{x}$">¶</a></h4>
<ul>
<li>A recurrent neural network has multiple time steps, which we'll index with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-101" role="math" style="width: 0.36em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.301em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em, 1000.3em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-102"><span class="mi" id="MathJax-Span-103" style="font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">t</script>.</li>
<li>In the lessons, we saw a single training example <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-104" role="math" style="width: 1.551em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1001.25em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-105"><span class="msubsup" id="MathJax-Span-106"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-107" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-108"><span class="mrow" id="MathJax-Span-109"><span class="mo" id="MathJax-Span-110" style="font-size: 70.7%; font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-111" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">i</span><span class="mo" id="MathJax-Span-112" style="font-size: 70.7%; font-family: STIXMathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-15">x^{(i)}</script> consist of multiple time steps <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-113" role="math" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1000.96em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-114"><span class="msubsup" id="MathJax-Span-115"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-116" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-117" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>x</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-16">T_x</script>.  For example, if there are 10 time steps, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-118" role="math" style="width: 4.17em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.455em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em, 1003.46em, 2.682em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-119"><span class="msubsup" id="MathJax-Span-120"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-121" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-122"><span class="mrow" id="MathJax-Span-123"><span class="mi" id="MathJax-Span-124" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-125" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-126" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">10</span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msub><mo>=</mo><mn>10</mn></math></span></span><script type="math/tex" id="MathJax-Element-17">T_{x} = 10</script></li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59912px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 112px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.5px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Batches of size </span><span class="cm-delimit cm-delimit-open">$</span>m<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Let's say we have mini-batches, each with 20 training examples.</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* To benefit from vectorization, we'll stack 20 columns of </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> examples.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* For example, this tensor has the shape (5000,20,10). </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* We'll use </span><span class="cm-delimit cm-delimit-open">$</span>m<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> to denote the number of training examples.</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* So the shape of a mini-batch is </span><span class="cm-delimit cm-delimit-open">$</span>(n_x,m,T_x)<span class="cm-delimit cm-delimit-close">$</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 112px;"></div><div class="CodeMirror-gutters" style="display: none; height: 121px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="Batches-of-size-$m$">Batches of size <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-127" role="math" style="width: 0.896em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.72em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-128"><span class="mi" id="MathJax-Span-129" style="font-family: STIXMathJax_Main-italic; font-style: italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">m</script><a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Batches-of-size-$m$">¶</a></h4>
<ul>
<li>Let's say we have mini-batches, each with 20 training examples.  </li>
<li>To benefit from vectorization, we'll stack 20 columns of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-130" role="math" style="width: 1.551em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1001.25em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-131"><span class="msubsup" id="MathJax-Span-132"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-133" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-134"><span class="mrow" id="MathJax-Span-135"><span class="mo" id="MathJax-Span-136" style="font-size: 70.7%; font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-137" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">i</span><span class="mo" id="MathJax-Span-138" style="font-size: 70.7%; font-family: STIXMathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-19">x^{(i)}</script> examples.</li>
<li>For example, this tensor has the shape (5000,20,10). </li>
<li>We'll use <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-139" role="math" style="width: 0.896em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.72em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-140"><span class="mi" id="MathJax-Span-141" style="font-family: STIXMathJax_Main-italic; font-style: italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-20">m</script> to denote the number of training examples.  </li>
<li>So the shape of a mini-batch is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-142" role="math" style="width: 4.884em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.051em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1003.99em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-143"><span class="mo" id="MathJax-Span-144" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-145"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-146" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-147" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-148" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-149" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-150" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-151" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-152" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-153" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-154" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mi>x</mi></msub><mo>,</mo><mi>m</mi><mo>,</mo><msub><mi>T</mi><mi>x</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-21">(n_x,m,T_x)</script></li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59912px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 129px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.5px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### 3D Tensor of shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>x<span class="cm-bracket">}</span>,m,T_<span class="cm-bracket">{</span>x<span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The 3-dimensional tensor </span><span class="cm-delimit cm-delimit-open">$</span>x<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> of shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_x,m,T_x)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> represents the input </span><span class="cm-delimit cm-delimit-open">$</span>x<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> that is fed into the RNN.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Taking a 2D slice for each time step: </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* At each time step, we'll use a mini-batches of training examples (not just a single example).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* So, for each time step </span><span class="cm-delimit cm-delimit-open">$</span>t<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">, we'll use a 2D slice of shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_x,m)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* We're referring to this 2D slice as </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.  The variable name in the code is </span><span class="cm-comment cm-variable-2">`xt`</span><span class="cm-variable-2">.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 129px;"></div><div class="CodeMirror-gutters" style="display: none; height: 138px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="3D-Tensor-of-shape-$(n_{x},m,T_{x})$">3D Tensor of shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-155" role="math" style="width: 4.884em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.051em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1003.99em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-156"><span class="mo" id="MathJax-Span-157" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-158"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-159" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-160"><span class="mrow" id="MathJax-Span-161"><span class="mi" id="MathJax-Span-162" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-163" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-164" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-165" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-166" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-167" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-168"><span class="mrow" id="MathJax-Span-169"><span class="mi" id="MathJax-Span-170" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-171" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msub><mo>,</mo><mi>m</mi><mo>,</mo><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-22">(n_{x},m,T_{x})</script><a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#3D-Tensor-of-shape-$(n_{x},m,T_{x})$">¶</a></h4>
<ul>
<li>The 3-dimensional tensor <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-172" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.42em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-173"><span class="mi" id="MathJax-Span-174" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">x</script> of shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-175" role="math" style="width: 4.884em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.051em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1003.99em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-176"><span class="mo" id="MathJax-Span-177" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-178"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-179" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-180" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-181" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-182" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-183" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-184" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-185" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-186" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-187" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mi>x</mi></msub><mo>,</mo><mi>m</mi><mo>,</mo><msub><mi>T</mi><mi>x</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-24">(n_x,m,T_x)</script> represents the input <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-188" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.42em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-189"><span class="mi" id="MathJax-Span-190" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">x</script> that is fed into the RNN.</li>
</ul>
<h4 id="Taking-a-2D-slice-for-each-time-step:-$x^{\langle-t-\rangle}$">Taking a 2D slice for each time step: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-191" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-192"><span class="msubsup" id="MathJax-Span-193"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-194" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-195"><span class="mrow" id="MathJax-Span-196"><span class="mo" id="MathJax-Span-197" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-198" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-199" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-26">x^{\langle t \rangle}</script><a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Taking-a-2D-slice-for-each-time-step:-$x^{\langle-t-\rangle}$">¶</a></h4>
<ul>
<li>At each time step, we'll use a mini-batches of training examples (not just a single example).</li>
<li>So, for each time step <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-200" role="math" style="width: 0.36em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.301em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em, 1000.3em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-201"><span class="mi" id="MathJax-Span-202" style="font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">t</script>, we'll use a 2D slice of shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-203" role="math" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.741em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.68em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-204"><span class="mo" id="MathJax-Span-205" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-206"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-207" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-208" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-209" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-210" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-211" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mi>x</mi></msub><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-28">(n_x,m)</script>.</li>
<li>We're referring to this 2D slice as <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-212" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-213"><span class="msubsup" id="MathJax-Span-214"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-215" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-216"><span class="mrow" id="MathJax-Span-217"><span class="mo" id="MathJax-Span-218" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-219" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-220" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-29">x^{\langle t \rangle}</script>.  The variable name in the code is <code>xt</code>.</li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59912px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 227px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Definition of hidden state </span><span class="cm-delimit cm-delimit-open">$</span>a<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The activation </span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> that is passed to the RNN from one time step to another is called a "hidden state."</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Dimensions of hidden state </span><span class="cm-delimit cm-delimit-open">$</span>a<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Similar to the input tensor </span><span class="cm-delimit cm-delimit-open">$</span>x<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">, the hidden state for a single training example is a vector of length </span><span class="cm-delimit cm-delimit-open">$</span>n_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* If we include a mini-batch of </span><span class="cm-delimit cm-delimit-open">$</span>m<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> training examples, the shape of a mini-batch is </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>,m)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* When we include the time step dimension, the shape of the hidden state is </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>, m, T_x)<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* We will loop through the time steps with index </span><span class="cm-delimit cm-delimit-open">$</span>t<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">, and work with a 2D slice of the 3D tensor.</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* We'll refer to this 2D slice as </span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* In the code, the variable names we use are either </span><span class="cm-comment cm-variable-2">`a_prev`</span><span class="cm-variable-2"> or </span><span class="cm-comment cm-variable-2">`a_next`</span><span class="cm-variable-2">, depending on the function that's being implemented.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The shape of this 2D slice is </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>, m)<span class="cm-delimit cm-delimit-close">$</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 227px;"></div><div class="CodeMirror-gutters" style="display: none; height: 236px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="Definition-of-hidden-state-$a$">Definition of hidden state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-221" role="math" style="width: 0.604em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.512em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.762em, 1000.47em, 2.502em, -999.998em); top: -2.359em; left: 0.002em;"><span class="mrow" id="MathJax-Span-222"><span class="mi" id="MathJax-Span-223" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">a</script><a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Definition-of-hidden-state-$a$">¶</a></h3>
<ul>
<li>The activation <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-224" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-225"><span class="msubsup" id="MathJax-Span-226"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-227" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-228"><span class="mrow" id="MathJax-Span-229"><span class="mo" id="MathJax-Span-230" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-231" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-232" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-31">a^{\langle t \rangle}</script> that is passed to the RNN from one time step to another is called a "hidden state."</li>
</ul>
<h3 id="Dimensions-of-hidden-state-$a$">Dimensions of hidden state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-233" role="math" style="width: 0.604em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.512em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.762em, 1000.47em, 2.502em, -999.998em); top: -2.359em; left: 0.002em;"><span class="mrow" id="MathJax-Span-234"><span class="mi" id="MathJax-Span-235" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">a</script><a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Dimensions-of-hidden-state-$a$">¶</a></h3>
<ul>
<li>Similar to the input tensor <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-236" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.42em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-237"><span class="mi" id="MathJax-Span-238" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">x</script>, the hidden state for a single training example is a vector of length <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-239" role="math" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1000.96em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-240"><span class="msubsup" id="MathJax-Span-241"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-242" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-243"><span class="mrow" id="MathJax-Span-244"><span class="mi" id="MathJax-Span-245" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-34">n_{a}</script>.</li>
<li>If we include a mini-batch of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-246" role="math" style="width: 0.896em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.72em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-247"><span class="mi" id="MathJax-Span-248" style="font-family: STIXMathJax_Main-italic; font-style: italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">m</script> training examples, the shape of a mini-batch is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-249" role="math" style="width: 3.396em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.801em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.74em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-250"><span class="mo" id="MathJax-Span-251" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-252"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-253" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-254"><span class="mrow" id="MathJax-Span-255"><span class="mi" id="MathJax-Span-256" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-257" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-258" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-259" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-36">(n_{a},m)</script>.</li>
<li>When we include the time step dimension, the shape of the hidden state is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-260" role="math" style="width: 5.003em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.17em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1004.11em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-261"><span class="mo" id="MathJax-Span-262" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-263"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-264" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-265"><span class="mrow" id="MathJax-Span-266"><span class="mi" id="MathJax-Span-267" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-268" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-269" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-270" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-271" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-272" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-273" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-274" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo>,</mo><mi>m</mi><mo>,</mo><msub><mi>T</mi><mi>x</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-37">(n_{a}, m, T_x)</script></li>
<li>We will loop through the time steps with index <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-275" role="math" style="width: 0.36em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.301em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em, 1000.3em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-276"><span class="mi" id="MathJax-Span-277" style="font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-38">t</script>, and work with a 2D slice of the 3D tensor.  </li>
<li>We'll refer to this 2D slice as <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-278" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-279"><span class="msubsup" id="MathJax-Span-280"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-281" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-282"><span class="mrow" id="MathJax-Span-283"><span class="mo" id="MathJax-Span-284" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-285" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-286" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-39">a^{\langle t \rangle}</script>. </li>
<li>In the code, the variable names we use are either <code>a_prev</code> or <code>a_next</code>, depending on the function that's being implemented.</li>
<li>The shape of this 2D slice is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-287" role="math" style="width: 3.396em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.801em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.74em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-288"><span class="mo" id="MathJax-Span-289" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-290"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-291" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-292"><span class="mrow" id="MathJax-Span-293"><span class="mi" id="MathJax-Span-294" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-295" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-296" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-297" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-40">(n_{a}, m)</script></li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59888px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 161px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Dimensions of prediction </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Similar to the inputs and hidden states, </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> is a 3D tensor of shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>, m, T_<span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">* </span><span class="cm-delimit cm-delimit-open">$</span>n_<span class="cm-bracket">{</span>y<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">: number of units in the vector representing the prediction.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">* </span><span class="cm-delimit cm-delimit-open">$</span>m<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">: number of examples in a mini-batch.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">* </span><span class="cm-delimit cm-delimit-open">$</span>T_<span class="cm-bracket">{</span>y<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">: number of time steps in the prediction.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* For a single time step </span><span class="cm-delimit cm-delimit-open">$</span>t<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">, a 2D slice </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> has shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>, m)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* In the code, the variable names are:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- </span><span class="cm-comment cm-variable-3">`y_pred`</span><span class="cm-variable-3">: </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3"> </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- </span><span class="cm-comment cm-variable-3">`yt_pred`</span><span class="cm-variable-3">: </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 161px;"></div><div class="CodeMirror-gutters" style="display: none; height: 170px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="Dimensions-of-prediction-$\hat{y}$">Dimensions of prediction <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-298" role="math" style="width: 0.558em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.465em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.252em, 1000.47em, 2.456em, -999.998em); top: -2.127em; left: 0.002em;"><span class="mrow" id="MathJax-Span-299"><span class="texatom" id="MathJax-Span-300"><span class="mrow" id="MathJax-Span-301"><span class="munderover" id="MathJax-Span-302"><span style="display: inline-block; position: relative; width: 0.465em; height: 0px;"><span style="position: absolute; clip: rect(3.382em, 1000.42em, 4.308em, -999.998em); top: -3.979em; left: 0.002em;"><span class="mi" id="MathJax-Span-303" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.025em; left: 0.049em;"><span style="height: 0.002em; vertical-align: 0.002em; width: 0.373em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-304" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.002em; vertical-align: 0.002em; margin-left: -0.322em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.132em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-41">\hat{y}</script><a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Dimensions-of-prediction-$\hat{y}$">¶</a></h3>
<ul>
<li>Similar to the inputs and hidden states, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-305" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em, 1000.42em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-306"><span class="texatom" id="MathJax-Span-307"><span class="mrow" id="MathJax-Span-308"><span class="munderover" id="MathJax-Span-309"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-310" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-311" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-42">\hat{y}</script> is a 3D tensor of shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-312" role="math" style="width: 4.884em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.051em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1003.99em, 2.86em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-313"><span class="mo" id="MathJax-Span-314" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-315"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-316" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-317"><span class="mrow" id="MathJax-Span-318"><span class="mi" id="MathJax-Span-319" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-320" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-321" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-322" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-323" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-324" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-325"><span class="mrow" id="MathJax-Span-326"><span class="mi" id="MathJax-Span-327" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-328" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub><mo>,</mo><mi>m</mi><mo>,</mo><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-43">(n_{y}, m, T_{y})</script>.<ul>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-329" role="math" style="width: 1.074em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1000.9em, 2.622em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-330"><span class="msubsup" id="MathJax-Span-331"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-332" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-333"><span class="mrow" id="MathJax-Span-334"><span class="mi" id="MathJax-Span-335" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-44">n_{y}</script>: number of units in the vector representing the prediction.</li>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-336" role="math" style="width: 0.896em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.72em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-337"><span class="mi" id="MathJax-Span-338" style="font-family: STIXMathJax_Main-italic; font-style: italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-45">m</script>: number of examples in a mini-batch.</li>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-339" role="math" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1000.96em, 2.622em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-340"><span class="msubsup" id="MathJax-Span-341"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-342" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-343"><span class="mrow" id="MathJax-Span-344"><span class="mi" id="MathJax-Span-345" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-46">T_{y}</script>: number of time steps in the prediction.</li>
</ul>
</li>
<li>For a single time step <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-346" role="math" style="width: 0.36em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.301em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em, 1000.3em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-347"><span class="mi" id="MathJax-Span-348" style="font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-47">t</script>, a 2D slice <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-349" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1001.31em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-350"><span class="msubsup" id="MathJax-Span-351"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-352"><span class="mrow" id="MathJax-Span-353"><span class="munderover" id="MathJax-Span-354"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-355" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-356" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-357"><span class="mrow" id="MathJax-Span-358"><span class="mo" id="MathJax-Span-359" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-360" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-361" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-48">\hat{y}^{\langle t \rangle}</script> has shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-362" role="math" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.741em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.68em, 2.86em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-363"><span class="mo" id="MathJax-Span-364" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-365"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-366" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-367"><span class="mrow" id="MathJax-Span-368"><span class="mi" id="MathJax-Span-369" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-370" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-371" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-372" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-49">(n_{y}, m)</script>.</li>
<li>In the code, the variable names are:<ul>
<li><code>y_pred</code>: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-373" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em, 1000.42em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-374"><span class="texatom" id="MathJax-Span-375"><span class="mrow" id="MathJax-Span-376"><span class="munderover" id="MathJax-Span-377"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-378" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-379" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-50">\hat{y}</script> </li>
<li><code>yt_pred</code>: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-380" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1001.31em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-381"><span class="msubsup" id="MathJax-Span-382"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-383"><span class="mrow" id="MathJax-Span-384"><span class="munderover" id="MathJax-Span-385"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-386" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-387" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-388"><span class="mrow" id="MathJax-Span-389"><span class="mo" id="MathJax-Span-390" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-391" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-392" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-51">\hat{y}^{\langle t \rangle}</script></li>
</ul>
</li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59888px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 94px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Here's how you can implement an RNN: </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Steps**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">1. Implement the calculations needed for one time-step of the RNN.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">2. Implement a loop over </span><span class="cm-delimit cm-delimit-open">$</span>T_x<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> time-steps in order to process all the inputs, one at a time. </span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 94px;"></div><div class="CodeMirror-gutters" style="display: none; height: 103px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Here's how you can implement an RNN: </p>
<p><strong>Steps</strong>:</p>
<ol>
<li>Implement the calculations needed for one time-step of the RNN.</li>
<li>Implement a loop over <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-393" role="math" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1000.96em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-394"><span class="msubsup" id="MathJax-Span-395"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-396" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-397" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>x</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-52">T_x</script> time-steps in order to process all the inputs, one at a time. </li>
</ol>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59912px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 263px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.3333px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 1.1 - RNN cell</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">A recurrent neural network can be seen as the repeated use of a single cell. You are first going to implement the computations for a single time-step. The following figure describes the operations for a single time-step of an RNN cell. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/rnn_step_forward_figure2_v3a.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:700px;height:300px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> **Figure 2**: Basic RNN cell. Takes as input <span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> (current input) and <span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t - 1<span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> (previous hidden state containing information from the past), and outputs <span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> which is given to the next RNN cell and also used to predict <span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### rnn cell versus rnn_cell_forward</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Note that an RNN cell outputs the hidden state </span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">* The rnn cell is shown in the figure as the inner box which has solid lines.</span><span class="cm-variable-3 cm-trailing-space-a"> </span><span class="cm-variable-3 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The function that we will implement, </span><span class="cm-comment cm-variable-2">`rnn_cell_forward`</span><span class="cm-variable-2">, also calculates the prediction </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">* The rnn_cell_forward is shown in the figure as the outer box that has dashed lines.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 263px;"></div><div class="CodeMirror-gutters" style="display: none; height: 272px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="1.1---RNN-cell">1.1 - RNN cell<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#1.1---RNN-cell">¶</a></h2>
<p>A recurrent neural network can be seen as the repeated use of a single cell. You are first going to implement the computations for a single time-step. The following figure describes the operations for a single time-step of an RNN cell. </p>
<p><img src="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/rnn_step_forward_figure2_v3a.png" style="width: 700px ; height: 300px"></p>
<center> <strong>Figure 2</strong>: Basic RNN cell. Takes as input <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-398" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-399"><span class="msubsup" id="MathJax-Span-400"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-401" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-402"><span class="mrow" id="MathJax-Span-403"><span class="mo" id="MathJax-Span-404" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-405" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-406" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-53">x^{\langle t \rangle}</script> (current input) and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-407" role="math" style="width: 2.682em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1002.21em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-408"><span class="msubsup" id="MathJax-Span-409"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-410" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-411"><span class="mrow" id="MathJax-Span-412"><span class="mo" id="MathJax-Span-413" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-414" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-415" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-416" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-417" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-54">a^{\langle t - 1\rangle}</script> (previous hidden state containing information from the past), and outputs <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-418" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-419"><span class="msubsup" id="MathJax-Span-420"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-421" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-422"><span class="mrow" id="MathJax-Span-423"><span class="mo" id="MathJax-Span-424" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-425" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-426" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-55">a^{\langle t \rangle}</script> which is given to the next RNN cell and also used to predict <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-427" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1001.31em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-428"><span class="msubsup" id="MathJax-Span-429"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-430"><span class="mrow" id="MathJax-Span-431"><span class="munderover" id="MathJax-Span-432"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-433" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-434" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-435"><span class="mrow" id="MathJax-Span-436"><span class="mo" id="MathJax-Span-437" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-438" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-439" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-56">\hat{y}^{\langle t \rangle}</script> </center>

<h4 id="rnn-cell-versus-rnn_cell_forward">rnn cell versus rnn_cell_forward<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#rnn-cell-versus-rnn_cell_forward">¶</a></h4>
<ul>
<li>Note that an RNN cell outputs the hidden state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-440" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-441"><span class="msubsup" id="MathJax-Span-442"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-443" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-444"><span class="mrow" id="MathJax-Span-445"><span class="mo" id="MathJax-Span-446" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-447" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-448" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-57">a^{\langle t \rangle}</script>.  <ul>
<li>The rnn cell is shown in the figure as the inner box which has solid lines.  </li>
</ul>
</li>
<li>The function that we will implement, <code>rnn_cell_forward</code>, also calculates the prediction <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-449" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1001.31em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-450"><span class="msubsup" id="MathJax-Span-451"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-452"><span class="mrow" id="MathJax-Span-453"><span class="munderover" id="MathJax-Span-454"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-455" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-456" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-457"><span class="mrow" id="MathJax-Span-458"><span class="mo" id="MathJax-Span-459" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-460" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-461" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-58">\hat{y}^{\langle t \rangle}</script><ul>
<li>The rnn_cell_forward is shown in the figure as the outer box that has dashed lines.</li>
</ul>
</li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59888px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 295px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Exercise**</span>: Implement the RNN-cell described in Figure (2).</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Instructions**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">1. Compute the hidden state with tanh activation: </span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> = <span class="cm-tag">\tanh</span>(W_<span class="cm-bracket">{</span>aa<span class="cm-bracket">}</span> a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> + W_<span class="cm-bracket">{</span>ax<span class="cm-bracket">}</span> x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> + b_a)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">2. Using your new hidden state </span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">, compute the prediction </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> = softmax(W_<span class="cm-bracket">{</span>ya<span class="cm-bracket">}</span> a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> + b_y)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">. We provided the function </span><span class="cm-comment cm-variable-2">`softmax`</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">3. Store </span><span class="cm-delimit cm-delimit-open">$</span>(a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>, a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>, x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>, parameters)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> in a </span><span class="cm-comment cm-variable-2">`cache`</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">4. Return </span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> , </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> and </span><span class="cm-comment cm-variable-2">`cache`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Additional Hints</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-link cm-variable-2">[numpy.tanh]</span><span class="cm-string cm-url cm-variable-2">(https://www.google.com/search?q=numpy+tanh&amp;rlz=1C5CHFA_enUS854US855&amp;oq=numpy+tanh&amp;aqs=chrome..69i57j0l5.1340j0j7&amp;sourceid=chrome&amp;ie=UTF-8)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* We've created a </span><span class="cm-comment cm-variable-2">`softmax`</span><span class="cm-variable-2"> function that you can use.  It is located in the file 'rnn_utils.py' and has been imported.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* For matrix multiplication, use </span><span class="cm-link cm-variable-2">[numpy.dot]</span><span class="cm-string cm-url cm-variable-2">(https://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 295px;"></div><div class="CodeMirror-gutters" style="display: none; height: 304px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Exercise</strong>: Implement the RNN-cell described in Figure (2).</p>
<p><strong>Instructions</strong>:</p>
<ol>
<li>Compute the hidden state with tanh activation: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;tanh&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-462" role="math" style="width: 18.872em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.717em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1015.66em, 2.682em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-463"><span class="msubsup" id="MathJax-Span-464"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-465" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-466"><span class="mrow" id="MathJax-Span-467"><span class="mo" id="MathJax-Span-468" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-469" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-470" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-471" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-472" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">tanh</span><span class="mo" id="MathJax-Span-473"></span><span class="mo" id="MathJax-Span-474" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-475"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-476" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-477"><span class="mrow" id="MathJax-Span-478"><span class="mi" id="MathJax-Span-479" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-480" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-481"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-482" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-483"><span class="mrow" id="MathJax-Span-484"><span class="mo" id="MathJax-Span-485" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-486" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-487" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-488" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-489" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-490" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-491" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-492" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-493"><span class="mrow" id="MathJax-Span-494"><span class="mi" id="MathJax-Span-495" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-496" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-497"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-498" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-499"><span class="mrow" id="MathJax-Span-500"><span class="mo" id="MathJax-Span-501" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-502" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-503" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-504" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-505" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-506" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-507" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-508" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>=</mo><mi>tanh</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>a</mi></mrow></msub><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>x</mi></mrow></msub><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msub><mi>b</mi><mi>a</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-59">a^{\langle t \rangle} = \tanh(W_{aa} a^{\langle t-1 \rangle} + W_{ax} x^{\langle t \rangle} + b_a)</script>.</li>
<li>Using your new hidden state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-509" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-510"><span class="msubsup" id="MathJax-Span-511"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-512" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-513"><span class="mrow" id="MathJax-Span-514"><span class="mo" id="MathJax-Span-515" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-516" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-517" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-60">a^{\langle t \rangle}</script>, compute the prediction <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-518" role="math" style="width: 13.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.61em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em, 1011.55em, 2.86em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-519"><span class="msubsup" id="MathJax-Span-520"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-521"><span class="mrow" id="MathJax-Span-522"><span class="munderover" id="MathJax-Span-523"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-524" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-525" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-526"><span class="mrow" id="MathJax-Span-527"><span class="mo" id="MathJax-Span-528" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-529" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-530" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-531" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-532" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.301em;">s</span><span class="mi" id="MathJax-Span-533" style="font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span class="mi" id="MathJax-Span-534" style="font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span class="mi" id="MathJax-Span-535" style="font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-536" style="font-family: STIXMathJax_Main-italic; font-style: italic;">m</span><span class="mi" id="MathJax-Span-537" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-538" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-539" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-540"><span style="display: inline-block; position: relative; width: 1.551em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-541" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-542"><span class="mrow" id="MathJax-Span-543"><span class="mi" id="MathJax-Span-544" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span class="mi" id="MathJax-Span-545" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-546"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-547" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-548"><span class="mrow" id="MathJax-Span-549"><span class="mo" id="MathJax-Span-550" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-551" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-552" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-553" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-554" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-555" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-556" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-557" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>=</mo><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>a</mi></mrow></msub><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msub><mi>b</mi><mi>y</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-61">\hat{y}^{\langle t \rangle} = softmax(W_{ya} a^{\langle t \rangle} + b_y)</script>. We provided the function <code>softmax</code>.</li>
<li>Store <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-558" role="math" style="width: 13.753em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.432em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1011.37em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-559"><span class="mo" id="MathJax-Span-560" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-561"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-562" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-563"><span class="mrow" id="MathJax-Span-564"><span class="mo" id="MathJax-Span-565" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-566" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-567" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-568" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-569" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-570" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-571"><span class="mrow" id="MathJax-Span-572"><span class="mo" id="MathJax-Span-573" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-574" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-575" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-576" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-577" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-578" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-579" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-580" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-581"><span class="mrow" id="MathJax-Span-582"><span class="mo" id="MathJax-Span-583" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-584" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-585" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-586" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-587" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">p</span><span class="mi" id="MathJax-Span-588" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-589" style="font-family: STIXMathJax_Main-italic; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-590" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-591" style="font-family: STIXMathJax_Main-italic; font-style: italic;">m</span><span class="mi" id="MathJax-Span-592" style="font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-593" style="font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-594" style="font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-595" style="font-family: STIXMathJax_Main-italic; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-596" style="font-family: STIXMathJax_Main-italic; font-style: italic;">s</span><span class="mo" id="MathJax-Span-597" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>,</mo><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>,</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>,</mo><mi>p</mi><mi>a</mi><mi>r</mi><mi>a</mi><mi>m</mi><mi>e</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>s</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-62">(a^{\langle t \rangle}, a^{\langle t-1 \rangle}, x^{\langle t \rangle}, parameters)</script> in a <code>cache</code>.</li>
<li>Return <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-598" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-599"><span class="msubsup" id="MathJax-Span-600"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-601" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-602"><span class="mrow" id="MathJax-Span-603"><span class="mo" id="MathJax-Span-604" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-605" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-606" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-63">a^{\langle t \rangle}</script> , <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-607" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1001.31em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-608"><span class="msubsup" id="MathJax-Span-609"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-610"><span class="mrow" id="MathJax-Span-611"><span class="munderover" id="MathJax-Span-612"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-613" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-614" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-615"><span class="mrow" id="MathJax-Span-616"><span class="mo" id="MathJax-Span-617" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-618" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-619" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-64">\hat{y}^{\langle t \rangle}</script> and <code>cache</code></li>
</ol>
<h4 id="Additional-Hints">Additional Hints<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Additional-Hints">¶</a></h4>
<ul>
<li><a href="https://www.google.com/search?q=numpy+tanh&amp;rlz=1C5CHFA_enUS854US855&amp;oq=numpy+tanh&amp;aqs=chrome..69i57j0l5.1340j0j7&amp;sourceid=chrome&amp;ie=UTF-8" target="_blank">numpy.tanh</a></li>
<li>We've created a <code>softmax</code> function that you can use.  It is located in the file 'rnn_utils.py' and has been imported.</li>
<li>For matrix multiplication, use <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html" target="_blank">numpy.dot</a></li>
</ul>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[4]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59863px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 731.802px; margin-bottom: -21px; border-right-width: 9px; min-height: 661px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># GRADED FUNCTION: rnn_cell_forward</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">rnn_cell_forward</span>(<span class="cm-variable">xt</span>, <span class="cm-variable">a_prev</span>, <span class="cm-variable">parameters</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Implements a single forward step of the RNN-cell as described in Figure (2)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    xt -- your input data at timestep "t", numpy array of shape (n_x, m).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    a_prev -- Hidden state at timestep "t-1", numpy array of shape (n_a, m)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    parameters -- python dictionary containing:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        Wax -- Weight matrix multiplying the input, numpy array of shape (n_a, n_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        Waa -- Weight matrix multiplying the hidden state, numpy array of shape (n_a, n_a)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        Wya -- Weight matrix relating the hidden-state to the output, numpy array of shape (n_y, n_a)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        ba --  Bias, numpy array of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        by -- Bias relating the hidden-state to the output, numpy array of shape (n_y, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    a_next -- next hidden state, of shape (n_a, m)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    yt_pred -- prediction at timestep "t", numpy array of shape (n_y, m)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    cache -- tuple of values needed for the backward pass, contains (a_next, a_prev, xt, parameters)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Retrieve parameters from "parameters"</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">Wax</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"Wax"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">Waa</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"Waa"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">Wya</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"Wya"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">ba</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"ba"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">by</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"by"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE ### (≈2 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># compute next activation state using the formula given above</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">a_next</span> = <span class="cm-variable">np</span>.<span class="cm-property">tanh</span>(<span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">Wax</span>,<span class="cm-variable">xt</span>)<span class="cm-operator">+</span><span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">Waa</span>,<span class="cm-variable">a_prev</span>)<span class="cm-operator">+</span><span class="cm-variable">ba</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># compute output of the current cell using the formula given above</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">yt_pred</span> = <span class="cm-variable">softmax</span>(<span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">Wya</span>,<span class="cm-variable">a_next</span>)<span class="cm-operator">+</span><span class="cm-variable">by</span>)   </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># store values you need for backward propagation in cache</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">cache</span> = (<span class="cm-variable">a_next</span>, <span class="cm-variable">a_prev</span>, <span class="cm-variable">xt</span>, <span class="cm-variable">parameters</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">a_next</span>, <span class="cm-variable">yt_pred</span>, <span class="cm-variable">cache</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 661px;"></div><div class="CodeMirror-gutters" style="display: none; height: 670px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[5]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59863px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 635.253px; margin-bottom: -21px; border-right-width: 9px; min-height: 261px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">seed</span>(<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">xt_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">3</span>,<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a_prev_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span> = {}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Waa'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wax'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wya'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">2</span>,<span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'ba'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'by'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">2</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a_next_tmp</span>, <span class="cm-variable">yt_pred_tmp</span>, <span class="cm-variable">cache_tmp</span> = <span class="cm-variable">rnn_cell_forward</span>(<span class="cm-variable">xt_tmp</span>, <span class="cm-variable">a_prev_tmp</span>, <span class="cm-variable">parameters_tmp</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"a_next[4] = \n"</span>, <span class="cm-variable">a_next_tmp</span>[<span class="cm-number">4</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"a_next.shape = \n"</span>, <span class="cm-variable">a_next_tmp</span>.<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"yt_pred[1] =\n"</span>, <span class="cm-variable">yt_pred_tmp</span>[<span class="cm-number">1</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"yt_pred.shape = \n"</span>, <span class="cm-variable">yt_pred_tmp</span>.<span class="cm-property">shape</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 261px;"></div><div class="CodeMirror-gutters" style="display: none; height: 270px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>a_next[4] = 
 [ 0.59584544  0.18141802  0.61311866  0.99808218  0.85016201  0.99980978
 -0.18887155  0.99815551  0.6531151   0.82872037]
a_next.shape = 
 (5, 10)
yt_pred[1] =
 [ 0.9888161   0.01682021  0.21140899  0.36817467  0.98988387  0.88945212
  0.36920224  0.9966312   0.9982559   0.17746526]
yt_pred.shape = 
 (2, 10)
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59912px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 244px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Expected Output**</span>: </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```Python</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a_next</span>[<span class="cm-number">4</span>] = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> [ <span class="cm-number">0.59584544</span> &nbsp;<span class="cm-number">0.18141802</span> &nbsp;<span class="cm-number">0.61311866</span> &nbsp;<span class="cm-number">0.99808218</span> &nbsp;<span class="cm-number">0.85016201</span> &nbsp;<span class="cm-number">0.99980978</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> <span class="cm-operator">-</span><span class="cm-number">0.18887155</span> &nbsp;<span class="cm-number">0.99815551</span> &nbsp;<span class="cm-number">0.6531151</span> &nbsp; <span class="cm-number">0.82872037</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a_next</span>.<span class="cm-property">shape</span> = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> (<span class="cm-number">5</span>, <span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">yt_pred</span>[<span class="cm-number">1</span>] =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> [ <span class="cm-number">0.9888161</span> &nbsp; <span class="cm-number">0.01682021</span> &nbsp;<span class="cm-number">0.21140899</span> &nbsp;<span class="cm-number">0.36817467</span> &nbsp;<span class="cm-number">0.98988387</span> &nbsp;<span class="cm-number">0.88945212</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-number">0.36920224</span> &nbsp;<span class="cm-number">0.9966312</span> &nbsp; <span class="cm-number">0.9982559</span> &nbsp; <span class="cm-number">0.17746526</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">yt_pred</span>.<span class="cm-property">shape</span> = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> (<span class="cm-number">2</span>, <span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 244px;"></div><div class="CodeMirror-gutters" style="display: none; height: 253px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Expected Output</strong>: </p>
<pre><code class="cm-s-ipython language-Python"><span class="cm-variable">a_next</span>[<span class="cm-number">4</span>] = 
 [ <span class="cm-number">0.59584544</span>  <span class="cm-number">0.18141802</span>  <span class="cm-number">0.61311866</span>  <span class="cm-number">0.99808218</span>  <span class="cm-number">0.85016201</span>  <span class="cm-number">0.99980978</span>
 <span class="cm-operator">-</span><span class="cm-number">0.18887155</span>  <span class="cm-number">0.99815551</span>  <span class="cm-number">0.6531151</span>   <span class="cm-number">0.82872037</span>]
<span class="cm-variable">a_next</span>.<span class="cm-property">shape</span> = 
 (<span class="cm-number">5</span>, <span class="cm-number">10</span>)
<span class="cm-variable">yt_pred</span>[<span class="cm-number">1</span>] =
 [ <span class="cm-number">0.9888161</span>   <span class="cm-number">0.01682021</span>  <span class="cm-number">0.21140899</span>  <span class="cm-number">0.36817467</span>  <span class="cm-number">0.98988387</span>  <span class="cm-number">0.88945212</span>
  <span class="cm-number">0.36920224</span>  <span class="cm-number">0.9966312</span>   <span class="cm-number">0.9982559</span>   <span class="cm-number">0.17746526</span>]
<span class="cm-variable">yt_pred</span>.<span class="cm-property">shape</span> = 
 (<span class="cm-number">2</span>, <span class="cm-number">10</span>)
</code></pre>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59863px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 329px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.3333px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 1.2 - RNN forward pass </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- A recurrent neural network (RNN) is a repetition of the RNN cell that you've just built. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- If your input sequence of data is 10 time steps long, then you will re-use the RNN cell 10 times. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Each cell takes two inputs at each time step:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- </span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">: The hidden state from the previous cell.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">: The current time-step's input data.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- It has two outputs at each time step:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- A hidden state (</span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- A prediction (</span><span class="cm-delimit cm-delimit-open">$</span>y^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- The weights and biases </span><span class="cm-delimit cm-delimit-open">$</span>(W_<span class="cm-bracket">{</span>aa<span class="cm-bracket">}</span>, b_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>, W_<span class="cm-bracket">{</span>ax<span class="cm-bracket">}</span>, b_<span class="cm-bracket">{</span>x<span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> are re-used each time step. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- They are maintained between calls to rnn_cell_forward in the 'parameters' dictionary.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/rnn_forward_sequence_figure3_v3a.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:800px;height:180px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> **Figure 3**: Basic RNN. The input sequence <span class="cm-delimit cm-delimit-open">$</span>x = (x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> <span class="cm-atom">1</span> <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>, x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> <span class="cm-atom">2</span> <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>, ..., x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> T_x <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span>  is carried over <span class="cm-delimit cm-delimit-open">$</span>T_x<span class="cm-delimit cm-delimit-close">$</span> time steps. The network outputs <span class="cm-delimit cm-delimit-open">$</span>y = (y^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> <span class="cm-atom">1</span> <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>, y^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> <span class="cm-atom">2</span> <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>, ..., y^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> T_x <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span>. <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 329px;"></div><div class="CodeMirror-gutters" style="display: none; height: 338px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="1.2---RNN-forward-pass">1.2 - RNN forward pass<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#1.2---RNN-forward-pass">¶</a></h2>
<ul>
<li>A recurrent neural network (RNN) is a repetition of the RNN cell that you've just built. <ul>
<li>If your input sequence of data is 10 time steps long, then you will re-use the RNN cell 10 times. </li>
</ul>
</li>
<li>Each cell takes two inputs at each time step:<ul>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-620" role="math" style="width: 2.682em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1002.21em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-621"><span class="msubsup" id="MathJax-Span-622"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-623" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-624"><span class="mrow" id="MathJax-Span-625"><span class="mo" id="MathJax-Span-626" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-627" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-628" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-629" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-630" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-65">a^{\langle t-1 \rangle}</script>: The hidden state from the previous cell.</li>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-631" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-632"><span class="msubsup" id="MathJax-Span-633"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-634" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-635"><span class="mrow" id="MathJax-Span-636"><span class="mo" id="MathJax-Span-637" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-638" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-639" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-66">x^{\langle t \rangle}</script>: The current time-step's input data.</li>
</ul>
</li>
<li>It has two outputs at each time step:<ul>
<li>A hidden state (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-640" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-641"><span class="msubsup" id="MathJax-Span-642"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-643" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-644"><span class="mrow" id="MathJax-Span-645"><span class="mo" id="MathJax-Span-646" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-647" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-648" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-67">a^{\langle t \rangle}</script>)</li>
<li>A prediction (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-649" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.31em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-650"><span class="msubsup" id="MathJax-Span-651"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-652" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-653"><span class="mrow" id="MathJax-Span-654"><span class="mo" id="MathJax-Span-655" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-656" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-657" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-68">y^{\langle t \rangle}</script>)</li>
</ul>
</li>
<li>The weights and biases <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-658" role="math" style="width: 8.396em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.967em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em, 1006.91em, 2.682em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-659"><span class="mo" id="MathJax-Span-660" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-661"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-662" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-663"><span class="mrow" id="MathJax-Span-664"><span class="mi" id="MathJax-Span-665" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-666" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-667" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-668" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-669" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-670"><span class="mrow" id="MathJax-Span-671"><span class="mi" id="MathJax-Span-672" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-673" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-674" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-675" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-676"><span class="mrow" id="MathJax-Span-677"><span class="mi" id="MathJax-Span-678" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-679" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-680" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-681" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-682" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-683"><span class="mrow" id="MathJax-Span-684"><span class="mi" id="MathJax-Span-685" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-686" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>a</mi></mrow></msub><mo>,</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo>,</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>x</mi></mrow></msub><mo>,</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-69">(W_{aa}, b_{a}, W_{ax}, b_{x})</script> are re-used each time step. <ul>
<li>They are maintained between calls to rnn_cell_forward in the 'parameters' dictionary.</li>
</ul>
</li>
</ul>
<p><img src="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/rnn_forward_sequence_figure3_v3a.png" style="width: 800px ; height: 180px"></p>
<center> <strong>Figure 3</strong>: Basic RNN. The input sequence <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-687" role="math" style="width: 11.729em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.765em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1009.71em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-688"><span class="mi" id="MathJax-Span-689" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-690" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mo" id="MathJax-Span-691" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">(</span><span class="msubsup" id="MathJax-Span-692"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-693" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-694"><span class="mrow" id="MathJax-Span-695"><span class="mo" id="MathJax-Span-696" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mn" id="MathJax-Span-697" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-698" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-699" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-700" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-701" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-702"><span class="mrow" id="MathJax-Span-703"><span class="mo" id="MathJax-Span-704" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mn" id="MathJax-Span-705" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span class="mo" id="MathJax-Span-706" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-707" style="font-family: STIXMathJax_Main;">,</span><span class="mo" id="MathJax-Span-708" style="font-family: STIXMathJax_Main; padding-left: 0.182em;">.</span><span class="mo" id="MathJax-Span-709" style="font-family: STIXMathJax_Main; padding-left: 0.182em;">.</span><span class="mo" id="MathJax-Span-710" style="font-family: STIXMathJax_Main; padding-left: 0.182em;">.</span><span class="mo" id="MathJax-Span-711" style="font-family: STIXMathJax_Main; padding-left: 0.182em;">,</span><span class="msubsup" id="MathJax-Span-712" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-713" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-714"><span class="mrow" id="MathJax-Span-715"><span class="mo" id="MathJax-Span-716" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="msubsup" id="MathJax-Span-717"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-718" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.866em; left: 0.42em;"><span class="mi" id="MathJax-Span-719" style="font-size: 50%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-720" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-721" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>,</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mn>2</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><msub><mi>T</mi><mi>x</mi></msub><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-70">x = (x^{\langle 1 \rangle}, x^{\langle 2 \rangle}, ..., x^{\langle T_x \rangle})</script>  is carried over <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-722" role="math" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1000.96em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-723"><span class="msubsup" id="MathJax-Span-724"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-725" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-726" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>x</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-71">T_x</script> time steps. The network outputs <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-727" role="math" style="width: 11.551em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.586em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1009.53em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-728"><span class="mi" id="MathJax-Span-729" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span class="mo" id="MathJax-Span-730" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mo" id="MathJax-Span-731" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">(</span><span class="msubsup" id="MathJax-Span-732"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-733" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-734"><span class="mrow" id="MathJax-Span-735"><span class="mo" id="MathJax-Span-736" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mn" id="MathJax-Span-737" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-738" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-739" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-740" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-741" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-742"><span class="mrow" id="MathJax-Span-743"><span class="mo" id="MathJax-Span-744" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mn" id="MathJax-Span-745" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span class="mo" id="MathJax-Span-746" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-747" style="font-family: STIXMathJax_Main;">,</span><span class="mo" id="MathJax-Span-748" style="font-family: STIXMathJax_Main; padding-left: 0.182em;">.</span><span class="mo" id="MathJax-Span-749" style="font-family: STIXMathJax_Main; padding-left: 0.182em;">.</span><span class="mo" id="MathJax-Span-750" style="font-family: STIXMathJax_Main; padding-left: 0.182em;">.</span><span class="mo" id="MathJax-Span-751" style="font-family: STIXMathJax_Main; padding-left: 0.182em;">,</span><span class="msubsup" id="MathJax-Span-752" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.729em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-753" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-754"><span class="mrow" id="MathJax-Span-755"><span class="mo" id="MathJax-Span-756" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="msubsup" id="MathJax-Span-757"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-758" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.866em; left: 0.42em;"><span class="mi" id="MathJax-Span-759" style="font-size: 50%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-760" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-761" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>,</mo><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mn>2</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><msub><mi>T</mi><mi>x</mi></msub><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-72">y = (y^{\langle 1 \rangle}, y^{\langle 2 \rangle}, ..., y^{\langle T_x \rangle})</script>. </center>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59863px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 428px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Exercise**</span>: Code the forward propagation of the RNN described in Figure (3).</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Instructions**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Create a 3D array of zeros, </span><span class="cm-delimit cm-delimit-open">$</span>a<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> of shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>, m, T_<span class="cm-bracket">{</span>x<span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> that will store all the hidden states computed by the RNN.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Create a 3D array of zeros, </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">, of shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>, m, T_<span class="cm-bracket">{</span>x<span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> that will store the predictions.</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Note that in this case, </span><span class="cm-delimit cm-delimit-open">$</span>T_<span class="cm-bracket">{</span>y<span class="cm-bracket">}</span> = T_<span class="cm-bracket">{</span>x<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3"> (the prediction and input have the same number of time steps).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Initialize the 2D hidden state </span><span class="cm-comment cm-variable-2">`a_next`</span><span class="cm-variable-2"> by setting it equal to the initial hidden state, </span><span class="cm-delimit cm-delimit-open">$</span>a_<span class="cm-bracket">{</span><span class="cm-atom">0</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* At each time step </span><span class="cm-delimit cm-delimit-open">$</span>t<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Get </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">, which is a 2D slice of </span><span class="cm-delimit cm-delimit-open">$</span>x<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3"> for a single time step </span><span class="cm-delimit cm-delimit-open">$</span>t<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">- </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-keyword"> has shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>x<span class="cm-bracket">}</span>, m)<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">- </span><span class="cm-delimit cm-delimit-open">$</span>x<span class="cm-delimit cm-delimit-close">$</span><span class="cm-keyword"> has shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>x<span class="cm-bracket">}</span>, m, T_<span class="cm-bracket">{</span>x<span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Update the 2D hidden state </span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3"> (variable name </span><span class="cm-comment cm-variable-3">`a_next`</span><span class="cm-variable-3">), the prediction </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3"> and the cache by running </span><span class="cm-comment cm-variable-3">`rnn_cell_forward`</span><span class="cm-variable-3">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">- </span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-keyword"> has shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>, m)<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Store the 2D hidden state in the 3D tensor </span><span class="cm-delimit cm-delimit-open">$</span>a<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">, at the </span><span class="cm-delimit cm-delimit-open">$</span>t^<span class="cm-bracket">{</span>th<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3"> position.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">- </span><span class="cm-delimit cm-delimit-open">$</span>a<span class="cm-delimit cm-delimit-close">$</span><span class="cm-keyword"> has shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>, m, T_<span class="cm-bracket">{</span>x<span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Store the 2D </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3"> prediction (variable name </span><span class="cm-comment cm-variable-3">`yt_pred`</span><span class="cm-variable-3">) in the 3D tensor </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>pred<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3"> at the </span><span class="cm-delimit cm-delimit-open">$</span>t^<span class="cm-bracket">{</span>th<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3"> position.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">- </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-keyword"> has shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>, m)<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">- </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-keyword"> has shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>, m, T_x)<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Append the cache to the list of caches.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Return the 3D tensor </span><span class="cm-delimit cm-delimit-open">$</span>a<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> and </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">, as well as the list of caches.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Additional Hints</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-link cm-variable-2">[np.zeros]</span><span class="cm-string cm-url cm-variable-2">(https://docs.scipy.org/doc/numpy/reference/generated/numpy.zeros.html)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- If you have a 3 dimensional numpy array and are indexing by its third dimension, you can use array slicing like this: </span><span class="cm-comment cm-variable-2">`var_name[:,:,i]`</span><span class="cm-variable-2">.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 428px;"></div><div class="CodeMirror-gutters" style="display: none; height: 437px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Exercise</strong>: Code the forward propagation of the RNN described in Figure (3).</p>
<p><strong>Instructions</strong>:</p>
<ul>
<li>Create a 3D array of zeros, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-762" role="math" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.48em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-763"><span class="mi" id="MathJax-Span-764" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-73">a</script> of shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-765" role="math" style="width: 5.003em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.17em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1004.11em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-766"><span class="mo" id="MathJax-Span-767" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-768"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-769" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-770"><span class="mrow" id="MathJax-Span-771"><span class="mi" id="MathJax-Span-772" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-773" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-774" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-775" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-776" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-777" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-778"><span class="mrow" id="MathJax-Span-779"><span class="mi" id="MathJax-Span-780" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-781" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo>,</mo><mi>m</mi><mo>,</mo><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-74">(n_{a}, m, T_{x})</script> that will store all the hidden states computed by the RNN.</li>
<li>Create a 3D array of zeros, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-782" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em, 1000.42em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-783"><span class="texatom" id="MathJax-Span-784"><span class="mrow" id="MathJax-Span-785"><span class="munderover" id="MathJax-Span-786"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-787" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-788" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-75">\hat{y}</script>, of shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-789" role="math" style="width: 4.884em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.051em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1003.99em, 2.86em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-790"><span class="mo" id="MathJax-Span-791" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-792"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-793" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-794"><span class="mrow" id="MathJax-Span-795"><span class="mi" id="MathJax-Span-796" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-797" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-798" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-799" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-800" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-801" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-802"><span class="mrow" id="MathJax-Span-803"><span class="mi" id="MathJax-Span-804" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-805" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub><mo>,</mo><mi>m</mi><mo>,</mo><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-76">(n_{y}, m, T_{x})</script> that will store the predictions.  <ul>
<li>Note that in this case, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-806" role="math" style="width: 3.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.277em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em, 1003.28em, 2.801em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-807"><span class="msubsup" id="MathJax-Span-808"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-809" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-810"><span class="mrow" id="MathJax-Span-811"><span class="mi" id="MathJax-Span-812" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-813" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-814" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-815" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-816"><span class="mrow" id="MathJax-Span-817"><span class="mi" id="MathJax-Span-818" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub><mo>=</mo><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-77">T_{y} = T_{x}</script> (the prediction and input have the same number of time steps).</li>
</ul>
</li>
<li>Initialize the 2D hidden state <code>a_next</code> by setting it equal to the initial hidden state, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-819" role="math" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1000.96em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-820"><span class="msubsup" id="MathJax-Span-821"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-822" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-823"><span class="mrow" id="MathJax-Span-824"><span class="mn" id="MathJax-Span-825" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-78">a_{0}</script>.</li>
<li>At each time step <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-826" role="math" style="width: 0.36em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.301em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em, 1000.3em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-827"><span class="mi" id="MathJax-Span-828" style="font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-79">t</script>:<ul>
<li>Get <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-829" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-830"><span class="msubsup" id="MathJax-Span-831"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-832" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-833"><span class="mrow" id="MathJax-Span-834"><span class="mo" id="MathJax-Span-835" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-836" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-837" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-80">x^{\langle t \rangle}</script>, which is a 2D slice of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-838" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.42em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-839"><span class="mi" id="MathJax-Span-840" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-81">x</script> for a single time step <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-841" role="math" style="width: 0.36em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.301em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em, 1000.3em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-842"><span class="mi" id="MathJax-Span-843" style="font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-82">t</script>.<ul>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-844" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-845"><span class="msubsup" id="MathJax-Span-846"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-847" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-848"><span class="mrow" id="MathJax-Span-849"><span class="mo" id="MathJax-Span-850" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-851" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-852" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-83">x^{\langle t \rangle}</script> has shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-853" role="math" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.741em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.68em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-854"><span class="mo" id="MathJax-Span-855" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-856"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-857" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-858"><span class="mrow" id="MathJax-Span-859"><span class="mi" id="MathJax-Span-860" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-861" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-862" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-863" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msub><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-84">(n_{x}, m)</script></li>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-864" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.42em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-865"><span class="mi" id="MathJax-Span-866" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-85">x</script> has shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-867" role="math" style="width: 4.884em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.051em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1003.99em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-868"><span class="mo" id="MathJax-Span-869" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-870"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-871" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-872"><span class="mrow" id="MathJax-Span-873"><span class="mi" id="MathJax-Span-874" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-875" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-876" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-877" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-878" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-879" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-880"><span class="mrow" id="MathJax-Span-881"><span class="mi" id="MathJax-Span-882" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-883" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msub><mo>,</mo><mi>m</mi><mo>,</mo><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-86">(n_{x}, m, T_{x})</script></li>
</ul>
</li>
<li>Update the 2D hidden state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-884" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-885"><span class="msubsup" id="MathJax-Span-886"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-887" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-888"><span class="mrow" id="MathJax-Span-889"><span class="mo" id="MathJax-Span-890" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-891" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-892" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-87">a^{\langle t \rangle}</script> (variable name <code>a_next</code>), the prediction <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-893" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1001.31em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-894"><span class="msubsup" id="MathJax-Span-895"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-896"><span class="mrow" id="MathJax-Span-897"><span class="munderover" id="MathJax-Span-898"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-899" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-900" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-901"><span class="mrow" id="MathJax-Span-902"><span class="mo" id="MathJax-Span-903" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-904" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-905" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-88">\hat{y}^{\langle t \rangle}</script> and the cache by running <code>rnn_cell_forward</code>.<ul>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-906" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-907"><span class="msubsup" id="MathJax-Span-908"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-909" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-910"><span class="mrow" id="MathJax-Span-911"><span class="mo" id="MathJax-Span-912" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-913" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-914" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-89">a^{\langle t \rangle}</script> has shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-915" role="math" style="width: 3.396em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.801em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.74em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-916"><span class="mo" id="MathJax-Span-917" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-918"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-919" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-920"><span class="mrow" id="MathJax-Span-921"><span class="mi" id="MathJax-Span-922" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-923" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-924" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-925" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-90">(n_{a}, m)</script></li>
</ul>
</li>
<li>Store the 2D hidden state in the 3D tensor <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-926" role="math" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.48em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-927"><span class="mi" id="MathJax-Span-928" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-91">a</script>, at the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-929" role="math" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1001.01em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-930"><span class="msubsup" id="MathJax-Span-931"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.277em, 1000.3em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-932" style="font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.36em;"><span class="texatom" id="MathJax-Span-933"><span class="mrow" id="MathJax-Span-934"><span class="mi" id="MathJax-Span-935" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-936" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>h</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-92">t^{th}</script> position.<ul>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-937" role="math" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.48em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-938"><span class="mi" id="MathJax-Span-939" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-93">a</script> has shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-940" role="math" style="width: 5.003em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.17em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1004.11em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-941"><span class="mo" id="MathJax-Span-942" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-943"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-944" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-945"><span class="mrow" id="MathJax-Span-946"><span class="mi" id="MathJax-Span-947" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-948" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-949" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-950" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-951" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-952" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-953"><span class="mrow" id="MathJax-Span-954"><span class="mi" id="MathJax-Span-955" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-956" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo>,</mo><mi>m</mi><mo>,</mo><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-94">(n_{a}, m, T_{x})</script></li>
</ul>
</li>
<li>Store the 2D <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-957" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1001.31em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-958"><span class="msubsup" id="MathJax-Span-959"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-960"><span class="mrow" id="MathJax-Span-961"><span class="munderover" id="MathJax-Span-962"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-963" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-964" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-965"><span class="mrow" id="MathJax-Span-966"><span class="mo" id="MathJax-Span-967" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-968" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-969" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-95">\hat{y}^{\langle t \rangle}</script> prediction (variable name <code>yt_pred</code>) in the 3D tensor <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-970" role="math" style="width: 2.265em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em, 1001.85em, 2.682em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-971"><span class="msubsup" id="MathJax-Span-972"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-973"><span class="mrow" id="MathJax-Span-974"><span class="munderover" id="MathJax-Span-975"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-976" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-977" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.747em; left: 0.42em;"><span class="texatom" id="MathJax-Span-978"><span class="mrow" id="MathJax-Span-979"><span class="mi" id="MathJax-Span-980" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">p</span><span class="mi" id="MathJax-Span-981" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-982" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-983" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.496em; border-left: 0px solid; width: 0px; height: 1.504em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-96">\hat{y}_{pred}</script> at the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-984" role="math" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1001.01em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-985"><span class="msubsup" id="MathJax-Span-986"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.277em, 1000.3em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-987" style="font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.36em;"><span class="texatom" id="MathJax-Span-988"><span class="mrow" id="MathJax-Span-989"><span class="mi" id="MathJax-Span-990" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-991" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>h</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-97">t^{th}</script> position.<ul>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-992" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1001.31em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-993"><span class="msubsup" id="MathJax-Span-994"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-995"><span class="mrow" id="MathJax-Span-996"><span class="munderover" id="MathJax-Span-997"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-998" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-999" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1000"><span class="mrow" id="MathJax-Span-1001"><span class="mo" id="MathJax-Span-1002" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1003" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1004" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-98">\hat{y}^{\langle t \rangle}</script> has shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1005" role="math" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.741em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.68em, 2.86em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1006"><span class="mo" id="MathJax-Span-1007" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1008"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1009" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-1010"><span class="mrow" id="MathJax-Span-1011"><span class="mi" id="MathJax-Span-1012" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1013" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-1014" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-1015" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-99">(n_{y}, m)</script></li>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1016" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em, 1000.42em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1017"><span class="texatom" id="MathJax-Span-1018"><span class="mrow" id="MathJax-Span-1019"><span class="munderover" id="MathJax-Span-1020"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1021" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1022" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-100">\hat{y}</script> has shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-101-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1023" role="math" style="width: 4.884em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.051em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1003.99em, 2.86em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1024"><span class="mo" id="MathJax-Span-1025" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1026"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1027" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-1028"><span class="mrow" id="MathJax-Span-1029"><span class="mi" id="MathJax-Span-1030" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1031" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-1032" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-1033" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1034" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1035" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-1036" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1037" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub><mo>,</mo><mi>m</mi><mo>,</mo><msub><mi>T</mi><mi>x</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-101">(n_{y}, m, T_x)</script></li>
</ul>
</li>
<li>Append the cache to the list of caches.</li>
</ul>
</li>
<li>Return the 3D tensor <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-102-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1038" role="math" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.48em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1039"><span class="mi" id="MathJax-Span-1040" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-102">a</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-103-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1041" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em, 1000.42em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1042"><span class="texatom" id="MathJax-Span-1043"><span class="mrow" id="MathJax-Span-1044"><span class="munderover" id="MathJax-Span-1045"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1046" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1047" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-103">\hat{y}</script>, as well as the list of caches.</li>
</ul>
<h4 id="Additional-Hints">Additional Hints<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Additional-Hints">¶</a></h4>
<ul>
<li><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.zeros.html" target="_blank">np.zeros</a></li>
<li>If you have a 3 dimensional numpy array and are indexing by its third dimension, you can use array slicing like this: <code>var_name[:,:,i]</code>.</li>
</ul>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[6]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59863px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 731.802px; margin-bottom: -21px; border-right-width: 9px; min-height: 944px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># GRADED FUNCTION: rnn_forward</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">rnn_forward</span>(<span class="cm-variable">x</span>, <span class="cm-variable">a0</span>, <span class="cm-variable">parameters</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Implement the forward propagation of the recurrent neural network described in Figure (3).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    x -- Input data for every time-step, of shape (n_x, m, T_x).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    a0 -- Initial hidden state, of shape (n_a, m)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    parameters -- python dictionary containing:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        Waa -- Weight matrix multiplying the hidden state, numpy array of shape (n_a, n_a)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        Wax -- Weight matrix multiplying the input, numpy array of shape (n_a, n_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        Wya -- Weight matrix relating the hidden-state to the output, numpy array of shape (n_y, n_a)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        ba --  Bias numpy array of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        by -- Bias relating the hidden-state to the output, numpy array of shape (n_y, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    a -- Hidden states for every time-step, numpy array of shape (n_a, m, T_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    y_pred -- Predictions for every time-step, numpy array of shape (n_y, m, T_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    caches -- tuple of values needed for the backward pass, contains (list of caches, x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Initialize "caches" which will contain the list of all caches</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">caches</span> = []</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Retrieve dimensions from shapes of x and parameters["Wya"]</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">n_x</span>, <span class="cm-variable">m</span>, <span class="cm-variable">T_x</span> = <span class="cm-variable">x</span>.<span class="cm-property">shape</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">n_y</span>, <span class="cm-variable">n_a</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"Wya"</span>].<span class="cm-property">shape</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># initialize "a" and "y_pred" with zeros (≈2 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">a</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_a</span>,<span class="cm-variable">m</span>,<span class="cm-variable">T_x</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">y_pred</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_y</span>,<span class="cm-variable">m</span>,<span class="cm-variable">T_x</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Initialize a_next (≈1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">a_next</span> = <span class="cm-variable">a0</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># loop over all time-steps of the input 'x' (1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">for</span> <span class="cm-variable">t</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">T_x</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Update next hidden state, compute the prediction, get the cache (≈2 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">xt</span> = <span class="cm-variable">x</span>[:,:,<span class="cm-variable">t</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">a_next</span>, <span class="cm-variable">yt_pred</span>, <span class="cm-variable">cache</span> = <span class="cm-variable">rnn_cell_forward</span>(<span class="cm-variable">xt</span>, <span class="cm-variable">a_next</span>, <span class="cm-variable">parameters</span>)<span class="cm-comment">#note the second para is a_next</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Save the value of the new "next" hidden state in a (≈1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">a</span>[:,:,<span class="cm-variable">t</span>] = <span class="cm-variable">a_next</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Save the value of the prediction in y (≈1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">y_pred</span>[:,:,<span class="cm-variable">t</span>] = <span class="cm-variable">yt_pred</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Append "cache" to "caches" (≈1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">caches</span>.<span class="cm-property">append</span>(<span class="cm-variable">cache</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># store values needed for backward propagation in cache</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">caches</span> = (<span class="cm-variable">caches</span>, <span class="cm-variable">x</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">a</span>, <span class="cm-variable">y_pred</span>, <span class="cm-variable">caches</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 944px;"></div><div class="CodeMirror-gutters" style="display: none; height: 953px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[7]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59912px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 539.784px; margin-bottom: -21px; border-right-width: 9px; min-height: 294px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">seed</span>(<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">x_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">3</span>,<span class="cm-number">10</span>,<span class="cm-number">4</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a0_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span> = {}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Waa'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wax'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wya'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">2</span>,<span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'ba'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'by'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">2</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a_tmp</span>, <span class="cm-variable">y_pred_tmp</span>, <span class="cm-variable">caches_tmp</span> = <span class="cm-variable">rnn_forward</span>(<span class="cm-variable">x_tmp</span>, <span class="cm-variable">a0_tmp</span>, <span class="cm-variable">parameters_tmp</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"a[4][1] = \n"</span>, <span class="cm-variable">a_tmp</span>[<span class="cm-number">4</span>][<span class="cm-number">1</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"a.shape = \n"</span>, <span class="cm-variable">a_tmp</span>.<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"y_pred[1][3] =\n"</span>, <span class="cm-variable">y_pred_tmp</span>[<span class="cm-number">1</span>][<span class="cm-number">3</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"y_pred.shape = \n"</span>, <span class="cm-variable">y_pred_tmp</span>.<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"caches[1][1][3] =\n"</span>, <span class="cm-variable">caches_tmp</span>[<span class="cm-number">1</span>][<span class="cm-number">1</span>][<span class="cm-number">3</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"len(caches) = \n"</span>, <span class="cm-builtin">len</span>(<span class="cm-variable">caches_tmp</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 294px;"></div><div class="CodeMirror-gutters" style="display: none; height: 303px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>a[4][1] = 
 [-0.99999375  0.77911235 -0.99861469 -0.99833267]
a.shape = 
 (5, 10, 4)
y_pred[1][3] =
 [ 0.79560373  0.86224861  0.11118257  0.81515947]
y_pred.shape = 
 (2, 10, 4)
caches[1][1][3] =
 [-1.1425182  -0.34934272 -0.20889423  0.58662319]
len(caches) = 
 2
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59912px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 278px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Expected Output**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```Python</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>[<span class="cm-number">4</span>][<span class="cm-number">1</span>] = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> [<span class="cm-operator">-</span><span class="cm-number">0.99999375</span> &nbsp;<span class="cm-number">0.77911235</span> <span class="cm-operator">-</span><span class="cm-number">0.99861469</span> <span class="cm-operator">-</span><span class="cm-number">0.99833267</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>.<span class="cm-property">shape</span> = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> (<span class="cm-number">5</span>, <span class="cm-number">10</span>, <span class="cm-number">4</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">y_pred</span>[<span class="cm-number">1</span>][<span class="cm-number">3</span>] =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> [ <span class="cm-number">0.79560373</span> &nbsp;<span class="cm-number">0.86224861</span> &nbsp;<span class="cm-number">0.11118257</span> &nbsp;<span class="cm-number">0.81515947</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">y_pred</span>.<span class="cm-property">shape</span> = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> (<span class="cm-number">2</span>, <span class="cm-number">10</span>, <span class="cm-number">4</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">caches</span>[<span class="cm-number">1</span>][<span class="cm-number">1</span>][<span class="cm-number">3</span>] =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> [<span class="cm-operator">-</span><span class="cm-number">1.1425182</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">0.34934272</span> <span class="cm-operator">-</span><span class="cm-number">0.20889423</span> &nbsp;<span class="cm-number">0.58662319</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">len</span>(<span class="cm-variable">caches</span>) = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> <span class="cm-number">2</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 278px;"></div><div class="CodeMirror-gutters" style="display: none; height: 287px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Expected Output</strong>:</p>
<pre><code class="cm-s-ipython language-Python"><span class="cm-variable">a</span>[<span class="cm-number">4</span>][<span class="cm-number">1</span>] = 
 [<span class="cm-operator">-</span><span class="cm-number">0.99999375</span>  <span class="cm-number">0.77911235</span> <span class="cm-operator">-</span><span class="cm-number">0.99861469</span> <span class="cm-operator">-</span><span class="cm-number">0.99833267</span>]
<span class="cm-variable">a</span>.<span class="cm-property">shape</span> = 
 (<span class="cm-number">5</span>, <span class="cm-number">10</span>, <span class="cm-number">4</span>)
<span class="cm-variable">y_pred</span>[<span class="cm-number">1</span>][<span class="cm-number">3</span>] =
 [ <span class="cm-number">0.79560373</span>  <span class="cm-number">0.86224861</span>  <span class="cm-number">0.11118257</span>  <span class="cm-number">0.81515947</span>]
<span class="cm-variable">y_pred</span>.<span class="cm-property">shape</span> = 
 (<span class="cm-number">2</span>, <span class="cm-number">10</span>, <span class="cm-number">4</span>)
<span class="cm-variable">caches</span>[<span class="cm-number">1</span>][<span class="cm-number">1</span>][<span class="cm-number">3</span>] =
 [<span class="cm-operator">-</span><span class="cm-number">1.1425182</span>  <span class="cm-operator">-</span><span class="cm-number">0.34934272</span> <span class="cm-operator">-</span><span class="cm-number">0.20889423</span>  <span class="cm-number">0.58662319</span>]
<span class="cm-builtin">len</span>(<span class="cm-variable">caches</span>) = 
 <span class="cm-number">2</span>
</code></pre>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59863px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 177px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Congratulations! You've successfully built the forward propagation of a recurrent neural network from scratch. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Situations when this RNN will perform better:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- This will work well enough for some applications, but it suffers from the vanishing gradient problems. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- The RNN works best when each output </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> can be estimated using "local" context.</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- "Local" context refers to information that is close to the prediction's time step </span><span class="cm-delimit cm-delimit-open">$</span>t<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- More formally, local context refers to inputs </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t' <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> and predictions </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\hat</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> where </span><span class="cm-delimit cm-delimit-open">$</span>t'<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> is close to </span><span class="cm-delimit cm-delimit-open">$</span>t<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">In the next part, you will build a more complex LSTM model, which is better at addressing vanishing gradients. The LSTM will be better able to remember a piece of information and keep it saved for many timesteps. </span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 177px;"></div><div class="CodeMirror-gutters" style="display: none; height: 186px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Congratulations! You've successfully built the forward propagation of a recurrent neural network from scratch. </p>
<h4 id="Situations-when-this-RNN-will-perform-better:">Situations when this RNN will perform better:<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Situations-when-this-RNN-will-perform-better:">¶</a></h4>
<ul>
<li>This will work well enough for some applications, but it suffers from the vanishing gradient problems. </li>
<li>The RNN works best when each output <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-104-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1048" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1001.31em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1049"><span class="msubsup" id="MathJax-Span-1050"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1051"><span class="mrow" id="MathJax-Span-1052"><span class="munderover" id="MathJax-Span-1053"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1054" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1055" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1056"><span class="mrow" id="MathJax-Span-1057"><span class="mo" id="MathJax-Span-1058" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1059" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1060" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-104">\hat{y}^{\langle t \rangle}</script> can be estimated using "local" context.  </li>
<li>"Local" context refers to information that is close to the prediction's time step <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1061" role="math" style="width: 0.36em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.301em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em, 1000.3em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1062"><span class="mi" id="MathJax-Span-1063" style="font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-105">t</script>.</li>
<li>More formally, local context refers to inputs <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1064" role="math" style="width: 1.967em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.61em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1065"><span class="msubsup" id="MathJax-Span-1066"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1067" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-1068"><span class="mrow" id="MathJax-Span-1069"><span class="mo" id="MathJax-Span-1070" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="msup" id="MathJax-Span-1071"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px;"><span style="position: absolute; clip: rect(3.455em, 1000.24em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1072" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.223em; left: 0.241em;"><span class="mo" id="MathJax-Span-1073" style="font-size: 50%; font-family: STIXMathJax_Variants;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1074" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><msup><mi>t</mi><mo>′</mo></msup><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-106">x^{\langle t' \rangle}</script> and predictions <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1075" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1001.31em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1076"><span class="msubsup" id="MathJax-Span-1077"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1078"><span class="mrow" id="MathJax-Span-1079"><span class="munderover" id="MathJax-Span-1080"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1081" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1082" style="font-family: STIXMathJax_Main;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1083"><span class="mrow" id="MathJax-Span-1084"><span class="mo" id="MathJax-Span-1085" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1086" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1087" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-107">\hat{y}^{\langle t \rangle}</script> where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1088" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em, 1000.66em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1089"><span class="msup" id="MathJax-Span-1090"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px;"><span style="position: absolute; clip: rect(3.277em, 1000.3em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1091" style="font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.36em;"><span class="mo" id="MathJax-Span-1092" style="font-size: 70.7%; font-family: STIXMathJax_Variants;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>t</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-108">t'</script> is close to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-109-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1093" role="math" style="width: 0.36em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.301em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em, 1000.3em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1094"><span class="mi" id="MathJax-Span-1095" style="font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-109">t</script>.</li>
</ul>
<p>In the next part, you will build a more complex LSTM model, which is better at addressing vanishing gradients. The LSTM will be better able to remember a piece of information and keep it saved for many timesteps. </p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59863px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 179px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.3333px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 2 - Long Short-Term Memory (LSTM) network</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The following figure shows the operations of an LSTM-cell.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/LSTM_figure4_v3a.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:500;height:400px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> **Figure 4**: LSTM-cell. This tracks and updates a "cell state" or memory variable <span class="cm-delimit cm-delimit-open">$</span>c^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> at every time-step, which can be different from <span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span>. <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Similar to the RNN example above, you will start by implementing the LSTM cell for a single time-step. Then you can iteratively call it from inside a "for-loop" to have it process an input with <span class="cm-delimit cm-delimit-open">$</span>T_x<span class="cm-delimit cm-delimit-close">$</span> time-steps. </span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 179px;"></div><div class="CodeMirror-gutters" style="display: none; height: 188px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="2---Long-Short-Term-Memory-(LSTM)-network">2 - Long Short-Term Memory (LSTM) network<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#2---Long-Short-Term-Memory-(LSTM)-network">¶</a></h2>
<p>The following figure shows the operations of an LSTM-cell.</p>
<p><img src="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/LSTM_figure4_v3a.png" style="width: 500 ; height: 400px"></p>
<center> <strong>Figure 4</strong>: LSTM-cell. This tracks and updates a "cell state" or memory variable <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-110-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1096" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.31em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1097"><span class="msubsup" id="MathJax-Span-1098"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1099" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1100"><span class="mrow" id="MathJax-Span-1101"><span class="mo" id="MathJax-Span-1102" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1103" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1104" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-110">c^{\langle t \rangle}</script> at every time-step, which can be different from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-111-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1105" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1106"><span class="msubsup" id="MathJax-Span-1107"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1108" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-1109"><span class="mrow" id="MathJax-Span-1110"><span class="mo" id="MathJax-Span-1111" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1112" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1113" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-111">a^{\langle t \rangle}</script>. </center>

<p>Similar to the RNN example above, you will start by implementing the LSTM cell for a single time-step. Then you can iteratively call it from inside a "for-loop" to have it process an input with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-112-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1114" role="math" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1000.96em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1115"><span class="msubsup" id="MathJax-Span-1116"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1117" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-1118" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>x</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-112">T_x</script> time-steps. </p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 650px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Overview of gates and states</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### - Forget gate </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>f<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Let's assume we are reading words in a piece of text, and plan to use an LSTM to keep track of grammatical structures, such as whether the subject is singular ("puppy") or plural ("puppies"). </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* If the subject changes its state (from a singular word to a plural word), the memory of the previous state becomes outdated, so we "forget" that outdated state.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The "forget gate" is a tensor containing values that are between 0 and 1.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">* If a unit in the forget gate has a value close to 0, the LSTM will "forget" the stored state in the corresponding unit of the previous cell state.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">* If a unit in the forget gate has a value close to 1, the LSTM will mostly remember the corresponding value in the stored state.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Equation</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_f^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> = <span class="cm-tag">\sigma</span>(<span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>W<span class="cm-bracket">}</span>_f<span class="cm-bracket">[</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>, <span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>x<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}]</span> + <span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>b<span class="cm-bracket">}</span>_f)<span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">1</span><span class="cm-bracket">}</span> <span class="cm-delimit cm-delimit-close">$$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Explanation of the equation:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>W_<span class="cm-bracket">{</span>f<span class="cm-bracket">}}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> contains weights that govern the forget gate's behavior. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The previous time step's hidden state </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-bracket">[</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> and current time step's input </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-error">]</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> are concatenated together and multiplied by </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>W_<span class="cm-bracket">{</span>f<span class="cm-bracket">}}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* A sigmoid function is used to make each of the gate tensor's values </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_f^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> range from 0 to 1.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The forget gate</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line">&nbsp;</span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_f^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2 cm-trailing-space-new-line"> has the same dimensions as the previous cell state </span><span class="cm-delimit cm-delimit-open">$</span>c^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2 cm-trailing-space-new-line">. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* This means that the two can be multiplied together, element-wise.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Multiplying the tensors </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_f^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> * <span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> is like applying a mask over the previous cell state.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* If a single value in </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_f^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> is 0 or close to 0, then the product is close to 0.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">* This keeps the information stored in the corresponding unit in </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3"> from being remembered for the next time step.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Similarly, if one value is close to 1, the product is close to the original value in the previous cell state.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">* The LSTM will keep the information from the corresponding unit of </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">, to be used in the next time step.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Variable names in the code</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The variable names in the code are similar to the equations, with slight differences.<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`Wf`</span><span class="cm-variable-2">: forget gate weight </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>W<span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>f<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`Wb`</span><span class="cm-variable-2">: forget gate bias </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>W<span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>b<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`ft`</span><span class="cm-variable-2">: forget gate </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\Gamma</span>_f^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 650px;"></div><div class="CodeMirror-gutters" style="display: none; height: 659px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="Overview-of-gates-and-states">Overview of gates and states<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Overview-of-gates-and-states">¶</a></h3>
<h4 id="--Forget-gate-$\mathbf{\Gamma}_{f}$">- Forget gate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1119" role="math" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1001.01em, 2.622em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1120"><span class="msubsup" id="MathJax-Span-1121"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1122"><span class="mrow" id="MathJax-Span-1123"><span class="mi" id="MathJax-Span-1124" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1125"><span class="mrow" id="MathJax-Span-1126"><span class="mi" id="MathJax-Span-1127" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>f</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-113">\mathbf{\Gamma}_{f}</script><a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#--Forget-gate-$\mathbf{\Gamma}_{f}$">¶</a></h4>
<ul>
<li>Let's assume we are reading words in a piece of text, and plan to use an LSTM to keep track of grammatical structures, such as whether the subject is singular ("puppy") or plural ("puppies"). </li>
<li>If the subject changes its state (from a singular word to a plural word), the memory of the previous state becomes outdated, so we "forget" that outdated state.</li>
<li>The "forget gate" is a tensor containing values that are between 0 and 1.<ul>
<li>If a unit in the forget gate has a value close to 0, the LSTM will "forget" the stored state in the corresponding unit of the previous cell state.</li>
<li>If a unit in the forget gate has a value close to 1, the LSTM will mostly remember the corresponding value in the stored state.</li>
</ul>
</li>
</ul>
<h5 id="Equation">Equation<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Equation">¶</a></h5>
<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-114-Frame" tabindex="0" style="width: 100%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-1&quot;&gt;&lt;mtext&gt;(1)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1128" role="math" style="width: 100%; display: inline-block; min-width: 16.193em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 16.193em;"><span style="position: absolute; clip: rect(2.86em, 1012.03em, 4.646em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-1129"><span class="mtable" id="MathJax-Span-1130" style="min-width: 16.193em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 16.193em;"><span style="display: inline-block; position: absolute; width: 12.086em; height: 0px; clip: rect(-1.128em, 1012.03em, 0.658em, -999.997em); top: 0.003em; left: 50%; margin-left: -6.009em;"><span style="position: absolute; clip: rect(2.86em, 1012.03em, 4.646em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 12.086em; height: 0px;"><span style="position: absolute; clip: rect(2.801em, 1012.03em, 4.646em, -999.997em); top: -3.985em; left: 50%; margin-left: -6.009em;"><span class="mtd" id="MathJax-Span-1134"><span class="mrow" id="MathJax-Span-1135"><span class="msubsup" id="MathJax-Span-1136"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1137"><span class="mrow" id="MathJax-Span-1138"><span class="mi" id="MathJax-Span-1139" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1140"><span class="mrow" id="MathJax-Span-1141"><span class="mo" id="MathJax-Span-1142" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1143" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1144" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -3.688em; left: 0.598em;"><span class="mi" id="MathJax-Span-1145" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1146" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-1147" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.301em;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-1148" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1149"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.96em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1150"><span class="mrow" id="MathJax-Span-1151"><span class="mi" id="MathJax-Span-1152" style="font-family: STIXMathJax_Main; font-weight: bold;">W</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 1.015em;"><span class="mi" id="MathJax-Span-1153" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1154" style="font-family: STIXMathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-1155"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1156"><span class="mrow" id="MathJax-Span-1157"><span class="mi" id="MathJax-Span-1158" style="font-family: STIXMathJax_Main; font-weight: bold;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-1159"><span class="mrow" id="MathJax-Span-1160"><span class="mo" id="MathJax-Span-1161" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1162" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1163" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-1164" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-1165" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1166" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1167" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1168"><span class="mrow" id="MathJax-Span-1169"><span class="mi" id="MathJax-Span-1170" style="font-family: STIXMathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-1171"><span class="mrow" id="MathJax-Span-1172"><span class="mo" id="MathJax-Span-1173" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1174" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1175" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1176" style="font-family: STIXMathJax_Main;">]</span><span class="mo" id="MathJax-Span-1177" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-1178" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1179"><span class="mrow" id="MathJax-Span-1180"><span class="mi" id="MathJax-Span-1181" style="font-family: STIXMathJax_Main; font-weight: bold;">b</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-1182" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1183" style="font-family: STIXMathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.193em; height: 0px; clip: rect(-0.83em, 1001.13em, 0.36em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.13em, 4.348em, -999.997em); top: -3.985em; right: 0.003em;"><span class="mtd" id="mjx-eqn-1"><span class="mrow" id="MathJax-Span-1132"><span class="mtext" id="MathJax-Span-1133" style="font-family: STIXMathJax_Main;">(1)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.932em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-1"><mtext>(1)</mtext></mtd><mtd><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">W</mi></mrow><mi>f</mi></msub><mo stretchy="false">[</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">a</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>,</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo stretchy="false">]</mo><mo>+</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">b</mi></mrow><mi>f</mi></msub><mo stretchy="false">)</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-114">\mathbf{\Gamma}_f^{\langle t \rangle} = \sigma(\mathbf{W}_f[\mathbf{a}^{\langle t-1 \rangle}, \mathbf{x}^{\langle t \rangle}] + \mathbf{b}_f)\tag{1} </script></p>
<h5 id="Explanation-of-the-equation:">Explanation of the equation:<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Explanation-of-the-equation:">¶</a></h5>
<ul>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-115-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1184" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1001.37em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1185"><span class="texatom" id="MathJax-Span-1186"><span class="mrow" id="MathJax-Span-1187"><span class="msubsup" id="MathJax-Span-1188"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.96em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1189" style="font-family: STIXMathJax_Main; font-weight: bold;">W</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 1.015em;"><span class="texatom" id="MathJax-Span-1190"><span class="mrow" id="MathJax-Span-1191"><span class="mi" id="MathJax-Span-1192" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-weight: bold;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">f</mi></mrow></msub></mrow></math></span></span><script type="math/tex" id="MathJax-Element-115">\mathbf{W_{f}}</script> contains weights that govern the forget gate's behavior. </li>
<li>The previous time step's hidden state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-116-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1193" role="math" style="width: 3.098em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.562em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1002.56em, 2.682em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1194"><span class="mo" id="MathJax-Span-1195" style="font-family: STIXMathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-1196"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1197" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-1198"><span class="mrow" id="MathJax-Span-1199"><span class="mo" id="MathJax-Span-1200" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1201" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1202" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-1203" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-1204" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-116">[a^{\langle t-1 \rangle}</script> and current time step's input <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-117-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1205" role="math" style="width: 2.027em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.67em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1001.61em, 2.682em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1206"><span class="msubsup" id="MathJax-Span-1207"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1208" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-1209"><span class="mrow" id="MathJax-Span-1210"><span class="mo" id="MathJax-Span-1211" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1212" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1213" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1214" style="font-family: STIXMathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-117">x^{\langle t \rangle}]</script> are concatenated together and multiplied by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-118-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1215" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1001.37em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1216"><span class="texatom" id="MathJax-Span-1217"><span class="mrow" id="MathJax-Span-1218"><span class="msubsup" id="MathJax-Span-1219"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.96em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1220" style="font-family: STIXMathJax_Main; font-weight: bold;">W</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 1.015em;"><span class="texatom" id="MathJax-Span-1221"><span class="mrow" id="MathJax-Span-1222"><span class="mi" id="MathJax-Span-1223" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-weight: bold;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">f</mi></mrow></msub></mrow></math></span></span><script type="math/tex" id="MathJax-Element-118">\mathbf{W_{f}}</script>. </li>
<li>A sigmoid function is used to make each of the gate tensor's values <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-119-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1224" role="math" style="width: 1.789em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1001.49em, 2.801em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1225"><span class="msubsup" id="MathJax-Span-1226"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1227"><span class="mrow" id="MathJax-Span-1228"><span class="mi" id="MathJax-Span-1229" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1230"><span class="mrow" id="MathJax-Span-1231"><span class="mo" id="MathJax-Span-1232" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1233" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1234" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -3.688em; left: 0.598em;"><span class="mi" id="MathJax-Span-1235" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-119">\mathbf{\Gamma}_f^{\langle t \rangle}</script> range from 0 to 1.</li>
<li>The forget gate  <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-120-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1236" role="math" style="width: 1.789em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1001.49em, 2.801em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1237"><span class="msubsup" id="MathJax-Span-1238"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1239"><span class="mrow" id="MathJax-Span-1240"><span class="mi" id="MathJax-Span-1241" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1242"><span class="mrow" id="MathJax-Span-1243"><span class="mo" id="MathJax-Span-1244" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1245" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1246" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -3.688em; left: 0.598em;"><span class="mi" id="MathJax-Span-1247" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-120">\mathbf{\Gamma}_f^{\langle t \rangle}</script> has the same dimensions as the previous cell state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-121-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1248" role="math" style="width: 2.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1002.15em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1249"><span class="msubsup" id="MathJax-Span-1250"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1251" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1252"><span class="mrow" id="MathJax-Span-1253"><span class="mo" id="MathJax-Span-1254" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1255" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1256" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-1257" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-1258" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-121">c^{\langle t-1 \rangle}</script>. </li>
<li>This means that the two can be multiplied together, element-wise.</li>
<li>Multiplying the tensors <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-122-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1259" role="math" style="width: 5.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.646em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em, 1004.65em, 3.039em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1260"><span class="msubsup" id="MathJax-Span-1261"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1262"><span class="mrow" id="MathJax-Span-1263"><span class="mi" id="MathJax-Span-1264" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1265"><span class="mrow" id="MathJax-Span-1266"><span class="mo" id="MathJax-Span-1267" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1268" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1269" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -3.688em; left: 0.598em;"><span class="mi" id="MathJax-Span-1270" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1271" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="msubsup" id="MathJax-Span-1272" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1273"><span class="mrow" id="MathJax-Span-1274"><span class="mi" id="MathJax-Span-1275" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1276"><span class="mrow" id="MathJax-Span-1277"><span class="mo" id="MathJax-Span-1278" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1279" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1280" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-1281" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-1282" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>∗</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-122">\mathbf{\Gamma}_f^{\langle t \rangle} * \mathbf{c}^{\langle t-1 \rangle}</script> is like applying a mask over the previous cell state.</li>
<li>If a single value in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-123-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1283" role="math" style="width: 1.789em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1001.49em, 2.801em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1284"><span class="msubsup" id="MathJax-Span-1285"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1286"><span class="mrow" id="MathJax-Span-1287"><span class="mi" id="MathJax-Span-1288" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1289"><span class="mrow" id="MathJax-Span-1290"><span class="mo" id="MathJax-Span-1291" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1292" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1293" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -3.688em; left: 0.598em;"><span class="mi" id="MathJax-Span-1294" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-123">\mathbf{\Gamma}_f^{\langle t \rangle}</script> is 0 or close to 0, then the product is close to 0.<ul>
<li>This keeps the information stored in the corresponding unit in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-124-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1295" role="math" style="width: 2.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1002.15em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1296"><span class="msubsup" id="MathJax-Span-1297"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1298"><span class="mrow" id="MathJax-Span-1299"><span class="mi" id="MathJax-Span-1300" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1301"><span class="mrow" id="MathJax-Span-1302"><span class="mo" id="MathJax-Span-1303" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1304" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1305" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-1306" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-1307" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-124">\mathbf{c}^{\langle t-1 \rangle}</script> from being remembered for the next time step.</li>
</ul>
</li>
<li>Similarly, if one value is close to 1, the product is close to the original value in the previous cell state.<ul>
<li>The LSTM will keep the information from the corresponding unit of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-125-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1308" role="math" style="width: 2.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1002.15em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1309"><span class="msubsup" id="MathJax-Span-1310"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1311"><span class="mrow" id="MathJax-Span-1312"><span class="mi" id="MathJax-Span-1313" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1314"><span class="mrow" id="MathJax-Span-1315"><span class="mo" id="MathJax-Span-1316" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1317" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1318" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-1319" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-1320" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-125">\mathbf{c}^{\langle t-1 \rangle}</script>, to be used in the next time step.</li>
</ul>
</li>
</ul>
<h5 id="Variable-names-in-the-code">Variable names in the code<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Variable-names-in-the-code">¶</a></h5>
<p>The variable names in the code are similar to the equations, with slight differences.  </p>
<ul>
<li><code>Wf</code>: forget gate weight <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-126-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1321" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1001.37em, 2.622em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1322"><span class="msubsup" id="MathJax-Span-1323"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.96em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1324"><span class="mrow" id="MathJax-Span-1325"><span class="mi" id="MathJax-Span-1326" style="font-family: STIXMathJax_Main; font-weight: bold;">W</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 1.015em;"><span class="texatom" id="MathJax-Span-1327"><span class="mrow" id="MathJax-Span-1328"><span class="mi" id="MathJax-Span-1329" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">W</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>f</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-126">\mathbf{W}_{f}</script></li>
<li><code>Wb</code>: forget gate bias <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-127-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1330" role="math" style="width: 1.729em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1001.43em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1331"><span class="msubsup" id="MathJax-Span-1332"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.96em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1333"><span class="mrow" id="MathJax-Span-1334"><span class="mi" id="MathJax-Span-1335" style="font-family: STIXMathJax_Main; font-weight: bold;">W</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 1.015em;"><span class="texatom" id="MathJax-Span-1336"><span class="mrow" id="MathJax-Span-1337"><span class="mi" id="MathJax-Span-1338" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">W</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>b</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-127">\mathbf{W}_{b}</script></li>
<li><code>ft</code>: forget gate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-128-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1339" role="math" style="width: 1.729em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1001.43em, 2.801em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1340"><span class="msubsup" id="MathJax-Span-1341"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1342" style="font-family: STIXMathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1343"><span class="mrow" id="MathJax-Span-1344"><span class="mo" id="MathJax-Span-1345" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1346" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1347" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -3.688em; left: 0.598em;"><span class="mi" id="MathJax-Span-1348" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal">Γ</mi><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-128">\Gamma_f^{\langle t \rangle}</script></li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59863px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 300px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.5px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Candidate value </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\tilde</span><span class="cm-bracket">{</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The candidate value is a tensor containing information from the current time step that </span><span class="cm-strong cm-variable-2">**may**</span><span class="cm-variable-2"> be stored in the current cell state </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Which parts of the candidate value get passed on depends on the update gate.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The candidate value is a tensor containing values that range from -1 to 1.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The tilde "~" is used to differentiate the candidate </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\tilde</span><span class="cm-bracket">{</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> from the cell state </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Equation</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\tilde</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> = <span class="cm-tag">\tanh\left</span>( <span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>W<span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>c<span class="cm-bracket">}</span> <span class="cm-bracket">[</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t - 1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>, <span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>x<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}]</span> + <span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>b<span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>c<span class="cm-bracket">}</span> <span class="cm-tag">\right</span>) <span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">3</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Explanation of the equation</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The 'tanh' function produces values between -1 and +1.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Variable names in the code</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`cct`</span><span class="cm-variable-2">: candidate value </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\tilde</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 300px;"></div><div class="CodeMirror-gutters" style="display: none; height: 309px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="Candidate-value-$\tilde{\mathbf{c}}^{\langle-t-\rangle}$">Candidate value <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-129-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1349" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.015em, 1001.31em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1350"><span class="msubsup" id="MathJax-Span-1351"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1352"><span class="mrow" id="MathJax-Span-1353"><span class="munderover" id="MathJax-Span-1354"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1355"><span class="mrow" id="MathJax-Span-1356"><span class="mi" id="MathJax-Span-1357" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.104em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.42em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1358" style="font-family: STIXMathJax_Main;">̃&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1359"><span class="mrow" id="MathJax-Span-1360"><span class="mo" id="MathJax-Span-1361" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1362" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1363" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mo stretchy="false">~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-129">\tilde{\mathbf{c}}^{\langle t \rangle}</script><a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Candidate-value-$\tilde{\mathbf{c}}^{\langle-t-\rangle}$">¶</a></h4>
<ul>
<li>The candidate value is a tensor containing information from the current time step that <strong>may</strong> be stored in the current cell state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-130-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1364" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.31em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1365"><span class="msubsup" id="MathJax-Span-1366"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1367"><span class="mrow" id="MathJax-Span-1368"><span class="mi" id="MathJax-Span-1369" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1370"><span class="mrow" id="MathJax-Span-1371"><span class="mo" id="MathJax-Span-1372" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1373" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1374" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-130">\mathbf{c}^{\langle t \rangle}</script>.</li>
<li>Which parts of the candidate value get passed on depends on the update gate.</li>
<li>The candidate value is a tensor containing values that range from -1 to 1.</li>
<li>The tilde "~" is used to differentiate the candidate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-131-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1375" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.015em, 1001.31em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1376"><span class="msubsup" id="MathJax-Span-1377"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1378"><span class="mrow" id="MathJax-Span-1379"><span class="munderover" id="MathJax-Span-1380"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1381"><span class="mrow" id="MathJax-Span-1382"><span class="mi" id="MathJax-Span-1383" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.104em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.42em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1384" style="font-family: STIXMathJax_Main;">̃&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1385"><span class="mrow" id="MathJax-Span-1386"><span class="mo" id="MathJax-Span-1387" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1388" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1389" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mo stretchy="false">~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-131">\tilde{\mathbf{c}}^{\langle t \rangle}</script> from the cell state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-132-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1390" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.31em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1391"><span class="msubsup" id="MathJax-Span-1392"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1393"><span class="mrow" id="MathJax-Span-1394"><span class="mi" id="MathJax-Span-1395" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1396"><span class="mrow" id="MathJax-Span-1397"><span class="mo" id="MathJax-Span-1398" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1399" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1400" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-132">\mathbf{c}^{\langle t \rangle}</script>.</li>
</ul>
<h5 id="Equation">Equation<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Equation">¶</a></h5>
<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-133-Frame" tabindex="0" style="width: 100%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-3&quot;&gt;&lt;mtext&gt;(3)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot; stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;tanh&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1401" role="math" style="width: 100%; display: inline-block; min-width: 17.503em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 17.503em;"><span style="position: absolute; clip: rect(2.92em, 1013.22em, 4.586em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-1402"><span class="mtable" id="MathJax-Span-1403" style="min-width: 17.503em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 17.503em;"><span style="display: inline-block; position: absolute; width: 13.396em; height: 0px; clip: rect(-1.068em, 1013.22em, 0.598em, -999.997em); top: 0.003em; left: 50%; margin-left: -6.664em;"><span style="position: absolute; clip: rect(2.92em, 1013.22em, 4.586em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 13.396em; height: 0px;"><span style="position: absolute; clip: rect(2.86em, 1013.22em, 4.527em, -999.997em); top: -3.926em; left: 50%; margin-left: -6.664em;"><span class="mtd" id="MathJax-Span-1407"><span class="mrow" id="MathJax-Span-1408"><span class="msubsup" id="MathJax-Span-1409"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1410"><span class="mrow" id="MathJax-Span-1411"><span class="texatom" id="MathJax-Span-1412"><span class="mrow" id="MathJax-Span-1413"><span class="munderover" id="MathJax-Span-1414"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1415" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.42em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1416" style="font-family: STIXMathJax_Main; font-weight: bold;">̃&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1417"><span class="mrow" id="MathJax-Span-1418"><span class="mo" id="MathJax-Span-1419" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1420" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1421" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1422" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-1423" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">tanh</span><span class="mo" id="MathJax-Span-1424"></span><span class="mrow" id="MathJax-Span-1425"><span class="mo" id="MathJax-Span-1426" style="vertical-align: -0.176em;"><span style="font-family: STIXMathJax_Size1;">(</span></span><span class="msubsup" id="MathJax-Span-1427"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.96em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1428"><span class="mrow" id="MathJax-Span-1429"><span class="mi" id="MathJax-Span-1430" style="font-family: STIXMathJax_Main; font-weight: bold;">W</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 1.015em;"><span class="texatom" id="MathJax-Span-1431"><span class="mrow" id="MathJax-Span-1432"><span class="mi" id="MathJax-Span-1433" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1434" style="font-family: STIXMathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-1435"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1436"><span class="mrow" id="MathJax-Span-1437"><span class="mi" id="MathJax-Span-1438" style="font-family: STIXMathJax_Main; font-weight: bold;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-1439"><span class="mrow" id="MathJax-Span-1440"><span class="mo" id="MathJax-Span-1441" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1442" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1443" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-1444" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-1445" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1446" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1447" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1448"><span class="mrow" id="MathJax-Span-1449"><span class="mi" id="MathJax-Span-1450" style="font-family: STIXMathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-1451"><span class="mrow" id="MathJax-Span-1452"><span class="mo" id="MathJax-Span-1453" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1454" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1455" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1456" style="font-family: STIXMathJax_Main;">]</span><span class="mo" id="MathJax-Span-1457" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-1458" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1459"><span class="mrow" id="MathJax-Span-1460"><span class="mi" id="MathJax-Span-1461" style="font-family: STIXMathJax_Main; font-weight: bold;">b</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-1462"><span class="mrow" id="MathJax-Span-1463"><span class="mi" id="MathJax-Span-1464" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1465" style="vertical-align: -0.176em;"><span style="font-family: STIXMathJax_Size1;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.193em; height: 0px; clip: rect(-0.771em, 1001.13em, 0.42em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.13em, 4.348em, -999.997em); top: -3.926em; right: 0.003em;"><span class="mtd" id="mjx-eqn-3"><span class="mrow" id="MathJax-Span-1405"><span class="mtext" id="MathJax-Span-1406" style="font-family: STIXMathJax_Main;">(3)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.789em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-3"><mtext>(3)</mtext></mtd><mtd><msup><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold">c</mi><mo mathvariant="bold" stretchy="false">~</mo></mover></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>=</mo><mi>tanh</mi><mo>⁡</mo><mrow><mo>(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">W</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>c</mi></mrow></msub><mo stretchy="false">[</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">a</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>,</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo stretchy="false">]</mo><mo>+</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">b</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>c</mi></mrow></msub><mo>)</mo></mrow></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-133">\mathbf{\tilde{c}}^{\langle t \rangle} = \tanh\left( \mathbf{W}_{c} [\mathbf{a}^{\langle t - 1 \rangle}, \mathbf{x}^{\langle t \rangle}] + \mathbf{b}_{c} \right) \tag{3}</script></p>
<h5 id="Explanation-of-the-equation">Explanation of the equation<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Explanation-of-the-equation">¶</a></h5>
<ul>
<li>The 'tanh' function produces values between -1 and +1.</li>
</ul>
<h5 id="Variable-names-in-the-code">Variable names in the code<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Variable-names-in-the-code">¶</a></h5>
<ul>
<li><code>cct</code>: candidate value <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-134-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot; stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1466" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.015em, 1001.31em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1467"><span class="msubsup" id="MathJax-Span-1468"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1469"><span class="mrow" id="MathJax-Span-1470"><span class="texatom" id="MathJax-Span-1471"><span class="mrow" id="MathJax-Span-1472"><span class="munderover" id="MathJax-Span-1473"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1474" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.42em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1475" style="font-family: STIXMathJax_Main; font-weight: bold;">̃&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1476"><span class="mrow" id="MathJax-Span-1477"><span class="mo" id="MathJax-Span-1478" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1479" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1480" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold">c</mi><mo mathvariant="bold" stretchy="false">~</mo></mover></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-134">\mathbf{\tilde{c}}^{\langle t \rangle}</script></li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59863px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 467px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.5px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### - Update gate </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>i<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* We use the update gate to decide what aspects of the candidate </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\tilde</span><span class="cm-bracket">{</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> to add to the cell state </span><span class="cm-delimit cm-delimit-open">$</span>c^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The update gate decides what parts of a "candidate" tensor </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\tilde</span><span class="cm-bracket">{</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> are passed onto the cell state </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The update gate is a tensor containing values between 0 and 1.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">* When a unit in the update gate is close to 1, it allows the value of the candidate </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\tilde</span><span class="cm-bracket">{</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3"> to be passed onto the hidden state </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">* When a unit in the update gate is close to 0, it prevents the corresponding value in the candidate from being passed onto the hidden state.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Notice that we use the subscript "i" and not "u", to follow the convention used in the literature.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Equation</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_i^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> = <span class="cm-tag">\sigma</span>(<span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>W<span class="cm-bracket">}</span>_i<span class="cm-bracket">[</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>, <span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>x<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}]</span> + <span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>b<span class="cm-bracket">}</span>_i)<span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">2</span><span class="cm-bracket">}</span> <span class="cm-delimit cm-delimit-close">$$</span> </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Explanation of the equation</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Similar to the forget gate, here </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_i^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">, the sigmoid produces values between 0 and 1.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The update gate is multiplied element-wise with the candidate, and this product (</span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>i<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> * <span class="cm-tag">\tilde</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">) is used in determining the cell state </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Variable names in code (Please note that they're different than the equations)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">In the code, we'll use the variable names found in the academic literature.  These variables don't use "u" to denote "update".</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`Wi`</span><span class="cm-variable-2"> is the update gate weight </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>W<span class="cm-bracket">}</span>_i<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> (not "Wu") </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`bi`</span><span class="cm-variable-2"> is the update gate bias </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>b<span class="cm-bracket">}</span>_i<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> (not "bu")</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`it`</span><span class="cm-variable-2"> is the forget gate </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_i^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> (not "ut")</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 467px;"></div><div class="CodeMirror-gutters" style="display: none; height: 476px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="--Update-gate-$\mathbf{\Gamma}_{i}$">- Update gate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-135-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1481" role="math" style="width: 1.074em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1000.9em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1482"><span class="msubsup" id="MathJax-Span-1483"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1484"><span class="mrow" id="MathJax-Span-1485"><span class="mi" id="MathJax-Span-1486" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1487"><span class="mrow" id="MathJax-Span-1488"><span class="mi" id="MathJax-Span-1489" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-135">\mathbf{\Gamma}_{i}</script><a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#--Update-gate-$\mathbf{\Gamma}_{i}$">¶</a></h4>
<ul>
<li>We use the update gate to decide what aspects of the candidate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-136-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1490" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.015em, 1001.31em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1491"><span class="msubsup" id="MathJax-Span-1492"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1493"><span class="mrow" id="MathJax-Span-1494"><span class="munderover" id="MathJax-Span-1495"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1496"><span class="mrow" id="MathJax-Span-1497"><span class="mi" id="MathJax-Span-1498" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.104em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.42em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1499" style="font-family: STIXMathJax_Main;">̃&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1500"><span class="mrow" id="MathJax-Span-1501"><span class="mo" id="MathJax-Span-1502" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1503" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1504" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mo stretchy="false">~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-136">\tilde{\mathbf{c}}^{\langle t \rangle}</script> to add to the cell state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-137-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1505" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.31em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1506"><span class="msubsup" id="MathJax-Span-1507"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1508" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1509"><span class="mrow" id="MathJax-Span-1510"><span class="mo" id="MathJax-Span-1511" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1512" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1513" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-137">c^{\langle t \rangle}</script>.</li>
<li>The update gate decides what parts of a "candidate" tensor <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-138-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1514" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.015em, 1001.31em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1515"><span class="msubsup" id="MathJax-Span-1516"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1517"><span class="mrow" id="MathJax-Span-1518"><span class="munderover" id="MathJax-Span-1519"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1520"><span class="mrow" id="MathJax-Span-1521"><span class="mi" id="MathJax-Span-1522" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.104em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.42em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1523" style="font-family: STIXMathJax_Main;">̃&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1524"><span class="mrow" id="MathJax-Span-1525"><span class="mo" id="MathJax-Span-1526" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1527" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1528" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mo stretchy="false">~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-138">\tilde{\mathbf{c}}^{\langle t \rangle}</script> are passed onto the cell state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-139-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1529" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.31em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1530"><span class="msubsup" id="MathJax-Span-1531"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1532"><span class="mrow" id="MathJax-Span-1533"><span class="mi" id="MathJax-Span-1534" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1535"><span class="mrow" id="MathJax-Span-1536"><span class="mo" id="MathJax-Span-1537" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1538" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1539" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-139">\mathbf{c}^{\langle t \rangle}</script>.</li>
<li>The update gate is a tensor containing values between 0 and 1.<ul>
<li>When a unit in the update gate is close to 1, it allows the value of the candidate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-140-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1540" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.015em, 1001.31em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1541"><span class="msubsup" id="MathJax-Span-1542"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1543"><span class="mrow" id="MathJax-Span-1544"><span class="munderover" id="MathJax-Span-1545"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1546"><span class="mrow" id="MathJax-Span-1547"><span class="mi" id="MathJax-Span-1548" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.104em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.42em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1549" style="font-family: STIXMathJax_Main;">̃&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1550"><span class="mrow" id="MathJax-Span-1551"><span class="mo" id="MathJax-Span-1552" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1553" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1554" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mo stretchy="false">~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-140">\tilde{\mathbf{c}}^{\langle t \rangle}</script> to be passed onto the hidden state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-141-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1555" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.31em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1556"><span class="msubsup" id="MathJax-Span-1557"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1558"><span class="mrow" id="MathJax-Span-1559"><span class="mi" id="MathJax-Span-1560" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1561"><span class="mrow" id="MathJax-Span-1562"><span class="mo" id="MathJax-Span-1563" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1564" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1565" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-141">\mathbf{c}^{\langle t \rangle}</script></li>
<li>When a unit in the update gate is close to 0, it prevents the corresponding value in the candidate from being passed onto the hidden state.</li>
</ul>
</li>
<li>Notice that we use the subscript "i" and not "u", to follow the convention used in the literature.</li>
</ul>
<h5 id="Equation">Equation<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Equation">¶</a></h5>
<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-142-Frame" tabindex="0" style="width: 100%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-2&quot;&gt;&lt;mtext&gt;(2)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1566" role="math" style="width: 100%; display: inline-block; min-width: 16.015em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 16.015em;"><span style="position: absolute; clip: rect(2.92em, 1011.79em, 4.586em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-1567"><span class="mtable" id="MathJax-Span-1568" style="min-width: 16.015em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 16.015em;"><span style="display: inline-block; position: absolute; width: 11.848em; height: 0px; clip: rect(-1.068em, 1011.79em, 0.598em, -999.997em); top: 0.003em; left: 50%; margin-left: -5.949em;"><span style="position: absolute; clip: rect(2.92em, 1011.79em, 4.586em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 11.848em; height: 0px;"><span style="position: absolute; clip: rect(2.801em, 1011.79em, 4.467em, -999.997em); top: -3.866em; left: 50%; margin-left: -5.949em;"><span class="mtd" id="MathJax-Span-1572"><span class="mrow" id="MathJax-Span-1573"><span class="msubsup" id="MathJax-Span-1574"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1575"><span class="mrow" id="MathJax-Span-1576"><span class="mi" id="MathJax-Span-1577" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1578"><span class="mrow" id="MathJax-Span-1579"><span class="mo" id="MathJax-Span-1580" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1581" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1582" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.598em;"><span class="mi" id="MathJax-Span-1583" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1584" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-1585" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.301em;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-1586" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1587"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.96em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1588"><span class="mrow" id="MathJax-Span-1589"><span class="mi" id="MathJax-Span-1590" style="font-family: STIXMathJax_Main; font-weight: bold;">W</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 1.015em;"><span class="mi" id="MathJax-Span-1591" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1592" style="font-family: STIXMathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-1593"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1594" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-1595"><span class="mrow" id="MathJax-Span-1596"><span class="mo" id="MathJax-Span-1597" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1598" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1599" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-1600" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-1601" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1602" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1603" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1604"><span class="mrow" id="MathJax-Span-1605"><span class="mi" id="MathJax-Span-1606" style="font-family: STIXMathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-1607"><span class="mrow" id="MathJax-Span-1608"><span class="mo" id="MathJax-Span-1609" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1610" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1611" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1612" style="font-family: STIXMathJax_Main;">]</span><span class="mo" id="MathJax-Span-1613" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-1614" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1615"><span class="mrow" id="MathJax-Span-1616"><span class="mi" id="MathJax-Span-1617" style="font-family: STIXMathJax_Main; font-weight: bold;">b</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-1618" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1619" style="font-family: STIXMathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.193em; height: 0px; clip: rect(-0.771em, 1001.13em, 0.479em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.13em, 4.348em, -999.997em); top: -3.866em; right: 0.003em;"><span class="mtd" id="mjx-eqn-2"><span class="mrow" id="MathJax-Span-1570"><span class="mtext" id="MathJax-Span-1571" style="font-family: STIXMathJax_Main;">(2)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.718em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-2"><mtext>(2)</mtext></mtd><mtd><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">W</mi></mrow><mi>i</mi></msub><mo stretchy="false">[</mo><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>,</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo stretchy="false">]</mo><mo>+</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">b</mi></mrow><mi>i</mi></msub><mo stretchy="false">)</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-142">\mathbf{\Gamma}_i^{\langle t \rangle} = \sigma(\mathbf{W}_i[a^{\langle t-1 \rangle}, \mathbf{x}^{\langle t \rangle}] + \mathbf{b}_i)\tag{2} </script> </p>
<h5 id="Explanation-of-the-equation">Explanation of the equation<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Explanation-of-the-equation">¶</a></h5>
<ul>
<li>Similar to the forget gate, here <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-143-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1620" role="math" style="width: 1.789em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1001.49em, 2.622em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1621"><span class="msubsup" id="MathJax-Span-1622"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1623"><span class="mrow" id="MathJax-Span-1624"><span class="mi" id="MathJax-Span-1625" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1626"><span class="mrow" id="MathJax-Span-1627"><span class="mo" id="MathJax-Span-1628" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1629" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1630" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.598em;"><span class="mi" id="MathJax-Span-1631" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-143">\mathbf{\Gamma}_i^{\langle t \rangle}</script>, the sigmoid produces values between 0 and 1.</li>
<li>The update gate is multiplied element-wise with the candidate, and this product (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-144-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1632" role="math" style="width: 4.527em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.753em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em, 1003.75em, 2.86em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1633"><span class="msubsup" id="MathJax-Span-1634"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1635"><span class="mrow" id="MathJax-Span-1636"><span class="mi" id="MathJax-Span-1637" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1638"><span class="mrow" id="MathJax-Span-1639"><span class="mo" id="MathJax-Span-1640" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1641" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1642" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1643"><span class="mrow" id="MathJax-Span-1644"><span class="mi" id="MathJax-Span-1645" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1646" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="msubsup" id="MathJax-Span-1647" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1648"><span class="mrow" id="MathJax-Span-1649"><span class="munderover" id="MathJax-Span-1650"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1651" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.42em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1652" style="font-family: STIXMathJax_Main;">̃&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1653"><span class="mrow" id="MathJax-Span-1654"><span class="mo" id="MathJax-Span-1655" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1656" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1657" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>∗</mo><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>c</mi><mo stretchy="false">~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-144">\mathbf{\Gamma}_{i}^{\langle t \rangle} * \tilde{c}^{\langle t \rangle}</script>) is used in determining the cell state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-145-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1658" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.31em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1659"><span class="msubsup" id="MathJax-Span-1660"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1661"><span class="mrow" id="MathJax-Span-1662"><span class="mi" id="MathJax-Span-1663" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1664"><span class="mrow" id="MathJax-Span-1665"><span class="mo" id="MathJax-Span-1666" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1667" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1668" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-145">\mathbf{c}^{\langle t \rangle}</script>.</li>
</ul>
<h5 id="Variable-names-in-code-(Please-note-that-they&#39;re-different-than-the-equations)">Variable names in code (Please note that they're different than the equations)<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Variable-names-in-code-(Please-note-that-they&#39;re-different-than-the-equations)">¶</a></h5>
<p>In the code, we'll use the variable names found in the academic literature.  These variables don't use "u" to denote "update".</p>
<ul>
<li><code>Wi</code> is the update gate weight <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-146-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1669" role="math" style="width: 1.551em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1001.25em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1670"><span class="msubsup" id="MathJax-Span-1671"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.96em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1672"><span class="mrow" id="MathJax-Span-1673"><span class="mi" id="MathJax-Span-1674" style="font-family: STIXMathJax_Main; font-weight: bold;">W</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 1.015em;"><span class="mi" id="MathJax-Span-1675" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">W</mi></mrow><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-146">\mathbf{W}_i</script> (not "Wu") </li>
<li><code>bi</code> is the update gate bias <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-147-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1676" role="math" style="width: 1.015em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1000.84em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1677"><span class="msubsup" id="MathJax-Span-1678"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1679"><span class="mrow" id="MathJax-Span-1680"><span class="mi" id="MathJax-Span-1681" style="font-family: STIXMathJax_Main; font-weight: bold;">b</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-1682" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">b</mi></mrow><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-147">\mathbf{b}_i</script> (not "bu")</li>
<li><code>it</code> is the forget gate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-148-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1683" role="math" style="width: 1.789em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1001.49em, 2.622em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1684"><span class="msubsup" id="MathJax-Span-1685"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1686"><span class="mrow" id="MathJax-Span-1687"><span class="mi" id="MathJax-Span-1688" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1689"><span class="mrow" id="MathJax-Span-1690"><span class="mo" id="MathJax-Span-1691" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1692" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1693" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.598em;"><span class="mi" id="MathJax-Span-1694" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-148">\mathbf{\Gamma}_i^{\langle t \rangle}</script> (not "ut")</li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59863px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 332px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.5px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### - Cell state </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The cell state is the "memory" that gets passed onto future time steps.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The new cell state </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> is a combination of the previous cell state and the candidate value.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Equation</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$$</span> <span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> = <span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_f^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>* <span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> + <span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>i<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> *<span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\tilde</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> <span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">4</span><span class="cm-bracket">}</span> <span class="cm-delimit cm-delimit-close">$$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Explanation of equation</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The previous cell state </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> is adjusted (weighted) by the forget gate </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>f<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* and the candidate value </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\tilde</span><span class="cm-bracket">{</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">, adjusted (weighted) by the update gate </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>i<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Variable names and shapes in the code</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`c`</span><span class="cm-variable-2">: cell state, including all time steps, </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>, m, T)<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`c_next`</span><span class="cm-variable-2">: new (next) cell state, </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>, m)<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`c_prev`</span><span class="cm-variable-2">: previous cell state, </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">, shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>, m)<span class="cm-delimit cm-delimit-close">$</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 332px;"></div><div class="CodeMirror-gutters" style="display: none; height: 341px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="--Cell-state-$\mathbf{c}^{\langle-t-\rangle}$">- Cell state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-149-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1695" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.31em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1696"><span class="msubsup" id="MathJax-Span-1697"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1698"><span class="mrow" id="MathJax-Span-1699"><span class="mi" id="MathJax-Span-1700" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1701"><span class="mrow" id="MathJax-Span-1702"><span class="mo" id="MathJax-Span-1703" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1704" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1705" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-149">\mathbf{c}^{\langle t \rangle}</script><a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#--Cell-state-$\mathbf{c}^{\langle-t-\rangle}$">¶</a></h4>
<ul>
<li>The cell state is the "memory" that gets passed onto future time steps.</li>
<li>The new cell state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-150-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1706" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.31em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1707"><span class="msubsup" id="MathJax-Span-1708"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1709"><span class="mrow" id="MathJax-Span-1710"><span class="mi" id="MathJax-Span-1711" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1712"><span class="mrow" id="MathJax-Span-1713"><span class="mo" id="MathJax-Span-1714" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1715" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1716" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-150">\mathbf{c}^{\langle t \rangle}</script> is a combination of the previous cell state and the candidate value.</li>
</ul>
<h5 id="Equation">Equation<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Equation">¶</a></h5>
<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-151-Frame" tabindex="0" style="width: 100%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-4&quot;&gt;&lt;mtext&gt;(4)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot; stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1717" role="math" style="width: 100%; display: inline-block; min-width: 16.253em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 16.253em;"><span style="position: absolute; clip: rect(2.86em, 1012.15em, 4.646em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-1718"><span class="mtable" id="MathJax-Span-1719" style="min-width: 16.253em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 16.253em;"><span style="display: inline-block; position: absolute; width: 12.146em; height: 0px; clip: rect(-1.128em, 1012.15em, 0.658em, -999.997em); top: 0.003em; left: 50%; margin-left: -6.068em;"><span style="position: absolute; clip: rect(2.86em, 1012.15em, 4.646em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 12.146em; height: 0px;"><span style="position: absolute; clip: rect(2.801em, 1012.15em, 4.646em, -999.997em); top: -3.985em; left: 50%; margin-left: -6.068em;"><span class="mtd" id="MathJax-Span-1723"><span class="mrow" id="MathJax-Span-1724"><span class="msubsup" id="MathJax-Span-1725"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1726"><span class="mrow" id="MathJax-Span-1727"><span class="mi" id="MathJax-Span-1728" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1729"><span class="mrow" id="MathJax-Span-1730"><span class="mo" id="MathJax-Span-1731" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1732" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1733" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1734" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-1735" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1736"><span class="mrow" id="MathJax-Span-1737"><span class="mi" id="MathJax-Span-1738" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1739"><span class="mrow" id="MathJax-Span-1740"><span class="mo" id="MathJax-Span-1741" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1742" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1743" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -3.688em; left: 0.598em;"><span class="mi" id="MathJax-Span-1744" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1745" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="msubsup" id="MathJax-Span-1746" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1747"><span class="mrow" id="MathJax-Span-1748"><span class="mi" id="MathJax-Span-1749" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1750"><span class="mrow" id="MathJax-Span-1751"><span class="mo" id="MathJax-Span-1752" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1753" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1754" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-1755" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-1756" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1757" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-1758" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1759"><span class="mrow" id="MathJax-Span-1760"><span class="mi" id="MathJax-Span-1761" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1762"><span class="mrow" id="MathJax-Span-1763"><span class="mo" id="MathJax-Span-1764" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1765" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1766" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1767"><span class="mrow" id="MathJax-Span-1768"><span class="mi" id="MathJax-Span-1769" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1770" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="msubsup" id="MathJax-Span-1771" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1772"><span class="mrow" id="MathJax-Span-1773"><span class="texatom" id="MathJax-Span-1774"><span class="mrow" id="MathJax-Span-1775"><span class="munderover" id="MathJax-Span-1776"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1777" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.42em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1778" style="font-family: STIXMathJax_Main; font-weight: bold;">̃&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1779"><span class="mrow" id="MathJax-Span-1780"><span class="mo" id="MathJax-Span-1781" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1782" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1783" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.193em; height: 0px; clip: rect(-0.83em, 1001.13em, 0.36em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.13em, 4.348em, -999.997em); top: -3.985em; right: 0.003em;"><span class="mtd" id="mjx-eqn-4"><span class="mrow" id="MathJax-Span-1721"><span class="mtext" id="MathJax-Span-1722" style="font-family: STIXMathJax_Main;">(4)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.932em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-4"><mtext>(4)</mtext></mtd><mtd><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>=</mo><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>∗</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>∗</mo><msup><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold">c</mi><mo mathvariant="bold" stretchy="false">~</mo></mover></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-151"> \mathbf{c}^{\langle t \rangle} = \mathbf{\Gamma}_f^{\langle t \rangle}* \mathbf{c}^{\langle t-1 \rangle} + \mathbf{\Gamma}_{i}^{\langle t \rangle} *\mathbf{\tilde{c}}^{\langle t \rangle} \tag{4} </script></p>
<h5 id="Explanation-of-equation">Explanation of equation<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Explanation-of-equation">¶</a></h5>
<ul>
<li>The previous cell state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-152-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1784" role="math" style="width: 2.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1002.15em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1785"><span class="msubsup" id="MathJax-Span-1786"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1787"><span class="mrow" id="MathJax-Span-1788"><span class="mi" id="MathJax-Span-1789" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1790"><span class="mrow" id="MathJax-Span-1791"><span class="mo" id="MathJax-Span-1792" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1793" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1794" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-1795" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-1796" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-152">\mathbf{c}^{\langle t-1 \rangle}</script> is adjusted (weighted) by the forget gate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-153-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1797" role="math" style="width: 1.789em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1001.49em, 2.801em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1798"><span class="msubsup" id="MathJax-Span-1799"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1800"><span class="mrow" id="MathJax-Span-1801"><span class="mi" id="MathJax-Span-1802" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1803"><span class="mrow" id="MathJax-Span-1804"><span class="mo" id="MathJax-Span-1805" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1806" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1807" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -3.688em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1808"><span class="mrow" id="MathJax-Span-1809"><span class="mi" id="MathJax-Span-1810" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>f</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-153">\mathbf{\Gamma}_{f}^{\langle t \rangle}</script></li>
<li>and the candidate value <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-154-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1811" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.015em, 1001.31em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1812"><span class="msubsup" id="MathJax-Span-1813"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1814"><span class="mrow" id="MathJax-Span-1815"><span class="munderover" id="MathJax-Span-1816"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1817"><span class="mrow" id="MathJax-Span-1818"><span class="mi" id="MathJax-Span-1819" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.104em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.42em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1820" style="font-family: STIXMathJax_Main;">̃&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.295em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1821"><span class="mrow" id="MathJax-Span-1822"><span class="mo" id="MathJax-Span-1823" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1824" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1825" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mo stretchy="false">~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-154">\tilde{\mathbf{c}}^{\langle t \rangle}</script>, adjusted (weighted) by the update gate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-155-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1826" role="math" style="width: 1.789em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1001.49em, 2.622em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1827"><span class="msubsup" id="MathJax-Span-1828"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1829"><span class="mrow" id="MathJax-Span-1830"><span class="mi" id="MathJax-Span-1831" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1832"><span class="mrow" id="MathJax-Span-1833"><span class="mo" id="MathJax-Span-1834" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1835" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1836" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1837"><span class="mrow" id="MathJax-Span-1838"><span class="mi" id="MathJax-Span-1839" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-155">\mathbf{\Gamma}_{i}^{\langle t \rangle}</script></li>
</ul>
<h5 id="Variable-names-and-shapes-in-the-code">Variable names and shapes in the code<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Variable-names-and-shapes-in-the-code">¶</a></h5>
<ul>
<li><code>c</code>: cell state, including all time steps, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-156-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1840" role="math" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em, 1000.48em, 2.503em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1841"><span class="texatom" id="MathJax-Span-1842"><span class="mrow" id="MathJax-Span-1843"><span class="mi" id="MathJax-Span-1844" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-156">\mathbf{c}</script> shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-157-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1845" role="math" style="width: 4.586em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.812em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1003.75em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1846"><span class="mo" id="MathJax-Span-1847" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1848"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1849" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-1850"><span class="mrow" id="MathJax-Span-1851"><span class="mi" id="MathJax-Span-1852" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1853" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-1854" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-1855" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-1856" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-1857" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo>,</mo><mi>m</mi><mo>,</mo><mi>T</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-157">(n_{a}, m, T)</script></li>
<li><code>c_next</code>: new (next) cell state, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-158-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1858" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.31em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1859"><span class="msubsup" id="MathJax-Span-1860"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1861"><span class="mrow" id="MathJax-Span-1862"><span class="mi" id="MathJax-Span-1863" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1864"><span class="mrow" id="MathJax-Span-1865"><span class="mo" id="MathJax-Span-1866" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1867" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1868" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-158">\mathbf{c}^{\langle t \rangle}</script> shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-159-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1869" role="math" style="width: 3.396em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.801em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.74em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1870"><span class="mo" id="MathJax-Span-1871" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1872"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1873" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-1874"><span class="mrow" id="MathJax-Span-1875"><span class="mi" id="MathJax-Span-1876" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1877" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-1878" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-1879" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-159">(n_{a}, m)</script></li>
<li><code>c_prev</code>: previous cell state, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-160-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1880" role="math" style="width: 2.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1002.15em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1881"><span class="msubsup" id="MathJax-Span-1882"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1883"><span class="mrow" id="MathJax-Span-1884"><span class="mi" id="MathJax-Span-1885" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-1886"><span class="mrow" id="MathJax-Span-1887"><span class="mo" id="MathJax-Span-1888" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1889" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1890" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-1891" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-1892" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-160">\mathbf{c}^{\langle t-1 \rangle}</script>, shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-161-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1893" role="math" style="width: 3.396em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.801em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.74em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1894"><span class="mo" id="MathJax-Span-1895" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1896"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-1897" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-1898"><span class="mrow" id="MathJax-Span-1899"><span class="mi" id="MathJax-Span-1900" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1901" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-1902" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-1903" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-161">(n_{a}, m)</script></li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59863px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 350px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.5px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### - Output gate </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>o<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The output gate decides what gets sent as the prediction (output) of the time step.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The output gate is like the other gates. It contains values that range from 0 to 1.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Equation</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$$</span> <span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_o^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>= &nbsp;<span class="cm-tag">\sigma</span>(<span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>W<span class="cm-bracket">}</span>_o<span class="cm-bracket">[</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>, <span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>x<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}]</span> + <span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>b<span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>o<span class="cm-bracket">}</span>)<span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">5</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$$</span> </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Explanation of the equation</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The output gate is determined by the previous hidden state </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> and the current input </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>x<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The sigmoid makes the gate range from 0 to 1.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Variable names in the code</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`Wo`</span><span class="cm-variable-2">: output gate weight, </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>W_o<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`bo`</span><span class="cm-variable-2">: output gate bias, </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>b_o<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`ot`</span><span class="cm-variable-2">: output gate, </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>o<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 350px;"></div><div class="CodeMirror-gutters" style="display: none; height: 359px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="--Output-gate-$\mathbf{\Gamma}_{o}$">- Output gate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-162-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1904" role="math" style="width: 1.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1001.07em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1905"><span class="msubsup" id="MathJax-Span-1906"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1907"><span class="mrow" id="MathJax-Span-1908"><span class="mi" id="MathJax-Span-1909" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1910"><span class="mrow" id="MathJax-Span-1911"><span class="mi" id="MathJax-Span-1912" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>o</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-162">\mathbf{\Gamma}_{o}</script><a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#--Output-gate-$\mathbf{\Gamma}_{o}$">¶</a></h4>
<ul>
<li>The output gate decides what gets sent as the prediction (output) of the time step.</li>
<li>The output gate is like the other gates. It contains values that range from 0 to 1.</li>
</ul>
<h5 id="Equation">Equation<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Equation">¶</a></h5>
<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-163-Frame" tabindex="0" style="width: 100%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-5&quot;&gt;&lt;mtext&gt;(5)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1913" role="math" style="width: 100%; display: inline-block; min-width: 16.313em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 16.313em;"><span style="position: absolute; clip: rect(2.979em, 1012.15em, 4.527em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-1914"><span class="mtable" id="MathJax-Span-1915" style="min-width: 16.313em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 16.313em;"><span style="display: inline-block; position: absolute; width: 12.146em; height: 0px; clip: rect(-1.009em, 1012.15em, 0.539em, -999.997em); top: 0.003em; left: 50%; margin-left: -6.068em;"><span style="position: absolute; clip: rect(2.979em, 1012.15em, 4.527em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 12.146em; height: 0px;"><span style="position: absolute; clip: rect(2.92em, 1012.15em, 4.408em, -999.997em); top: -3.926em; left: 50%; margin-left: -6.068em;"><span class="mtd" id="MathJax-Span-1919"><span class="mrow" id="MathJax-Span-1920"><span class="msubsup" id="MathJax-Span-1921"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1922"><span class="mrow" id="MathJax-Span-1923"><span class="mi" id="MathJax-Span-1924" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.402em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1925"><span class="mrow" id="MathJax-Span-1926"><span class="mo" id="MathJax-Span-1927" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1928" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1929" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.747em; left: 0.598em;"><span class="mi" id="MathJax-Span-1930" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1931" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-1932" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.301em;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-1933" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1934"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.96em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1935"><span class="mrow" id="MathJax-Span-1936"><span class="mi" id="MathJax-Span-1937" style="font-family: STIXMathJax_Main; font-weight: bold;">W</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 1.015em;"><span class="mi" id="MathJax-Span-1938" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1939" style="font-family: STIXMathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-1940"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1941"><span class="mrow" id="MathJax-Span-1942"><span class="mi" id="MathJax-Span-1943" style="font-family: STIXMathJax_Main; font-weight: bold;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-1944"><span class="mrow" id="MathJax-Span-1945"><span class="mo" id="MathJax-Span-1946" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1947" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1948" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-1949" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-1950" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1951" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1952" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1953"><span class="mrow" id="MathJax-Span-1954"><span class="mi" id="MathJax-Span-1955" style="font-family: STIXMathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-1956"><span class="mrow" id="MathJax-Span-1957"><span class="mo" id="MathJax-Span-1958" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1959" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1960" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1961" style="font-family: STIXMathJax_Main;">]</span><span class="mo" id="MathJax-Span-1962" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-1963" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1964"><span class="mrow" id="MathJax-Span-1965"><span class="mi" id="MathJax-Span-1966" style="font-family: STIXMathJax_Main; font-weight: bold;">b</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-1967"><span class="mrow" id="MathJax-Span-1968"><span class="mi" id="MathJax-Span-1969" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-1970" style="font-family: STIXMathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.193em; height: 0px; clip: rect(-0.771em, 1001.13em, 0.42em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.098em, 1001.13em, 4.348em, -999.997em); top: -3.926em; right: 0.003em;"><span class="mtd" id="mjx-eqn-5"><span class="mrow" id="MathJax-Span-1917"><span class="mtext" id="MathJax-Span-1918" style="font-family: STIXMathJax_Main;">(5)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.496em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-5"><mtext>(5)</mtext></mtd><mtd><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">W</mi></mrow><mi>o</mi></msub><mo stretchy="false">[</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">a</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>,</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo stretchy="false">]</mo><mo>+</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">b</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>o</mi></mrow></msub><mo stretchy="false">)</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-163"> \mathbf{\Gamma}_o^{\langle t \rangle}=  \sigma(\mathbf{W}_o[\mathbf{a}^{\langle t-1 \rangle}, \mathbf{x}^{\langle t \rangle}] + \mathbf{b}_{o})\tag{5}</script> </p>
<h5 id="Explanation-of-the-equation">Explanation of the equation<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Explanation-of-the-equation">¶</a></h5>
<ul>
<li>The output gate is determined by the previous hidden state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-164-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1971" role="math" style="width: 2.682em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1002.21em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1972"><span class="msubsup" id="MathJax-Span-1973"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1974"><span class="mrow" id="MathJax-Span-1975"><span class="mi" id="MathJax-Span-1976" style="font-family: STIXMathJax_Main; font-weight: bold;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-1977"><span class="mrow" id="MathJax-Span-1978"><span class="mo" id="MathJax-Span-1979" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1980" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1981" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-1982" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-1983" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">a</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-164">\mathbf{a}^{\langle t-1 \rangle}</script> and the current input <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-165-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1984" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1985"><span class="msubsup" id="MathJax-Span-1986"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1987"><span class="mrow" id="MathJax-Span-1988"><span class="mi" id="MathJax-Span-1989" style="font-family: STIXMathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-1990"><span class="mrow" id="MathJax-Span-1991"><span class="mo" id="MathJax-Span-1992" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-1993" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1994" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-165">\mathbf{x}^{\langle t \rangle}</script></li>
<li>The sigmoid makes the gate range from 0 to 1.</li>
</ul>
<h5 id="Variable-names-in-the-code">Variable names in the code<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Variable-names-in-the-code">¶</a></h5>
<ul>
<li><code>Wo</code>: output gate weight, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-166-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1995" role="math" style="width: 1.729em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1001.43em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1996"><span class="texatom" id="MathJax-Span-1997"><span class="mrow" id="MathJax-Span-1998"><span class="msubsup" id="MathJax-Span-1999"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.96em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2000" style="font-family: STIXMathJax_Main; font-weight: bold;">W</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 1.015em;"><span class="mi" id="MathJax-Span-2001" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-weight: bold;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mi mathvariant="bold">o</mi></msub></mrow></math></span></span><script type="math/tex" id="MathJax-Element-166">\mathbf{W_o}</script></li>
<li><code>bo</code>: output gate bias, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-167-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2002" role="math" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1001.01em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2003"><span class="texatom" id="MathJax-Span-2004"><span class="mrow" id="MathJax-Span-2005"><span class="msubsup" id="MathJax-Span-2006"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2007" style="font-family: STIXMathJax_Main; font-weight: bold;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-2008" style="font-size: 70.7%; font-family: STIXMathJax_Main; font-weight: bold;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">b</mi><mi mathvariant="bold">o</mi></msub></mrow></math></span></span><script type="math/tex" id="MathJax-Element-167">\mathbf{b_o}</script></li>
<li><code>ot</code>: output gate, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-168-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2009" role="math" style="width: 1.789em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.49em, 2.562em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2010"><span class="msubsup" id="MathJax-Span-2011"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2012"><span class="mrow" id="MathJax-Span-2013"><span class="mi" id="MathJax-Span-2014" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.402em; left: 0.598em;"><span class="texatom" id="MathJax-Span-2015"><span class="mrow" id="MathJax-Span-2016"><span class="mo" id="MathJax-Span-2017" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2018" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2019" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.747em; left: 0.598em;"><span class="texatom" id="MathJax-Span-2020"><span class="mrow" id="MathJax-Span-2021"><span class="mi" id="MathJax-Span-2022" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>o</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-168">\mathbf{\Gamma}_{o}^{\langle t \rangle}</script></li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59863px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 367px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.5px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### - Hidden state </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The hidden state gets passed to the LSTM cell's next time step.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* It is used to determine the three gates (</span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>f<span class="cm-bracket">}</span>, <span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>u<span class="cm-bracket">}</span>, <span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>o<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">) of the next time step.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The hidden state is also used for the prediction </span><span class="cm-delimit cm-delimit-open">$</span>y^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Equation</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$$</span> <span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> = <span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_o^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> * <span class="cm-tag">\tanh</span>(<span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>)<span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">6</span><span class="cm-bracket">}</span> <span class="cm-delimit cm-delimit-close">$$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Explanation of equation</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The hidden state </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> is determined by the cell state </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> in combination with the output gate </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span><span class="cm-tag">\Gamma</span><span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>o<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The cell state state is passed through the "tanh" function to rescale values between -1 and +1.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The output gate acts like a "mask" that either preserves the values of </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\tanh</span>(<span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> or keeps those values from being included in the hidden state </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Variable names  and shapes in the code</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`a`</span><span class="cm-variable-2">: hidden state, including time steps.</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line">&nbsp;</span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>a<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2 cm-trailing-space-new-line"> has shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>, m, T_<span class="cm-bracket">{</span>x<span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* 'a_prev</span><span class="cm-comment cm-variable-2">`: hidden state from previous time step. </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-comment cm-variable-2"> has shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>, m)<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment cm-variable-2">* `</span><span class="cm-variable-2">a_next</span><span class="cm-comment cm-variable-2">`: hidden state for next time step. &nbsp;</span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-comment cm-variable-2"> has shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>, m)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-comment cm-variable-2"> </span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 367px;"></div><div class="CodeMirror-gutters" style="display: none; height: 376px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="--Hidden-state-$\mathbf{a}^{\langle-t-\rangle}$">- Hidden state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-169-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2023" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2024"><span class="msubsup" id="MathJax-Span-2025"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2026"><span class="mrow" id="MathJax-Span-2027"><span class="mi" id="MathJax-Span-2028" style="font-family: STIXMathJax_Main; font-weight: bold;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2029"><span class="mrow" id="MathJax-Span-2030"><span class="mo" id="MathJax-Span-2031" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2032" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2033" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">a</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-169">\mathbf{a}^{\langle t \rangle}</script><a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#--Hidden-state-$\mathbf{a}^{\langle-t-\rangle}$">¶</a></h4>
<ul>
<li>The hidden state gets passed to the LSTM cell's next time step.</li>
<li>It is used to determine the three gates (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-170-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2034" role="math" style="width: 4.884em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.051em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em, 1004.05em, 2.801em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2035"><span class="msubsup" id="MathJax-Span-2036"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2037"><span class="mrow" id="MathJax-Span-2038"><span class="mi" id="MathJax-Span-2039" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-2040"><span class="mrow" id="MathJax-Span-2041"><span class="mi" id="MathJax-Span-2042" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2043" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2044" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2045"><span class="mrow" id="MathJax-Span-2046"><span class="mi" id="MathJax-Span-2047" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-2048"><span class="mrow" id="MathJax-Span-2049"><span class="mi" id="MathJax-Span-2050" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">u</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2051" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2052" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2053"><span class="mrow" id="MathJax-Span-2054"><span class="mi" id="MathJax-Span-2055" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-2056"><span class="mrow" id="MathJax-Span-2057"><span class="mi" id="MathJax-Span-2058" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>f</mi></mrow></msub><mo>,</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>u</mi></mrow></msub><mo>,</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>o</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-170">\mathbf{\Gamma}_{f}, \mathbf{\Gamma}_{u}, \mathbf{\Gamma}_{o}</script>) of the next time step.</li>
<li>The hidden state is also used for the prediction <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-171-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2059" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.31em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2060"><span class="msubsup" id="MathJax-Span-2061"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2062" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-2063"><span class="mrow" id="MathJax-Span-2064"><span class="mo" id="MathJax-Span-2065" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2066" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2067" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-171">y^{\langle t \rangle}</script>.</li>
</ul>
<h5 id="Equation">Equation<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Equation">¶</a></h5>
<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-172-Frame" tabindex="0" style="width: 100%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-6&quot;&gt;&lt;mtext&gt;(6)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;tanh&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2068" role="math" style="width: 100%; display: inline-block; min-width: 12.92em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 12.92em;"><span style="position: absolute; clip: rect(2.979em, 1008.75em, 4.527em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-2069"><span class="mtable" id="MathJax-Span-2070" style="min-width: 12.92em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 12.92em;"><span style="display: inline-block; position: absolute; width: 8.813em; height: 0px; clip: rect(-1.009em, 1008.75em, 0.539em, -999.997em); top: 0.003em; left: 50%; margin-left: -4.402em;"><span style="position: absolute; clip: rect(2.979em, 1008.75em, 4.527em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 8.813em; height: 0px;"><span style="position: absolute; clip: rect(2.92em, 1008.75em, 4.408em, -999.997em); top: -3.926em; left: 50%; margin-left: -4.402em;"><span class="mtd" id="MathJax-Span-2074"><span class="mrow" id="MathJax-Span-2075"><span class="msubsup" id="MathJax-Span-2076"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2077"><span class="mrow" id="MathJax-Span-2078"><span class="mi" id="MathJax-Span-2079" style="font-family: STIXMathJax_Main; font-weight: bold;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2080"><span class="mrow" id="MathJax-Span-2081"><span class="mo" id="MathJax-Span-2082" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2083" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2084" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2085" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-2086" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2087"><span class="mrow" id="MathJax-Span-2088"><span class="mi" id="MathJax-Span-2089" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.402em; left: 0.598em;"><span class="texatom" id="MathJax-Span-2090"><span class="mrow" id="MathJax-Span-2091"><span class="mo" id="MathJax-Span-2092" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2093" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2094" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.747em; left: 0.598em;"><span class="mi" id="MathJax-Span-2095" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2096" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="mi" id="MathJax-Span-2097" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">tanh</span><span class="mo" id="MathJax-Span-2098"></span><span class="mo" id="MathJax-Span-2099" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2100"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2101"><span class="mrow" id="MathJax-Span-2102"><span class="mi" id="MathJax-Span-2103" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.42em;"><span class="texatom" id="MathJax-Span-2104"><span class="mrow" id="MathJax-Span-2105"><span class="mo" id="MathJax-Span-2106" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2107" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2108" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2109" style="font-family: STIXMathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.193em; height: 0px; clip: rect(-0.771em, 1001.13em, 0.42em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.13em, 4.348em, -999.997em); top: -3.926em; right: 0.003em;"><span class="mtd" id="mjx-eqn-6"><span class="mrow" id="MathJax-Span-2072"><span class="mtext" id="MathJax-Span-2073" style="font-family: STIXMathJax_Main;">(6)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.496em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-6"><mtext>(6)</mtext></mtd><mtd><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">a</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>=</mo><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>∗</mo><mi>tanh</mi><mo>⁡</mo><mo stretchy="false">(</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo stretchy="false">)</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-172"> \mathbf{a}^{\langle t \rangle} = \mathbf{\Gamma}_o^{\langle t \rangle} * \tanh(\mathbf{c}^{\langle t \rangle})\tag{6} </script></p>
<h5 id="Explanation-of-equation">Explanation of equation<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Explanation-of-equation">¶</a></h5>
<ul>
<li>The hidden state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-173-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2110" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2111"><span class="msubsup" id="MathJax-Span-2112"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2113"><span class="mrow" id="MathJax-Span-2114"><span class="mi" id="MathJax-Span-2115" style="font-family: STIXMathJax_Main; font-weight: bold;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2116"><span class="mrow" id="MathJax-Span-2117"><span class="mo" id="MathJax-Span-2118" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2119" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2120" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">a</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-173">\mathbf{a}^{\langle t \rangle}</script> is determined by the cell state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-174-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2121" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.31em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2122"><span class="msubsup" id="MathJax-Span-2123"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2124"><span class="mrow" id="MathJax-Span-2125"><span class="mi" id="MathJax-Span-2126" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-2127"><span class="mrow" id="MathJax-Span-2128"><span class="mo" id="MathJax-Span-2129" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2130" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2131" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-174">\mathbf{c}^{\langle t \rangle}</script> in combination with the output gate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-175-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2132" role="math" style="width: 1.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1001.07em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2133"><span class="msubsup" id="MathJax-Span-2134"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2135"><span class="mrow" id="MathJax-Span-2136"><span class="mi" id="MathJax-Span-2137" style="font-family: STIXMathJax_Main; font-weight: bold;">Γ</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-2138"><span class="mrow" id="MathJax-Span-2139"><span class="mi" id="MathJax-Span-2140" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Γ</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>o</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-175">\mathbf{\Gamma}_{o}</script>.</li>
<li>The cell state state is passed through the "tanh" function to rescale values between -1 and +1.</li>
<li>The output gate acts like a "mask" that either preserves the values of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-176-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;tanh&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2141" role="math" style="width: 4.943em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.11em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1004.05em, 2.682em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2142"><span class="mi" id="MathJax-Span-2143" style="font-family: STIXMathJax_Main;">tanh</span><span class="mo" id="MathJax-Span-2144"></span><span class="mo" id="MathJax-Span-2145" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2146"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2147"><span class="mrow" id="MathJax-Span-2148"><span class="mi" id="MathJax-Span-2149" style="font-family: STIXMathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-2150"><span class="mrow" id="MathJax-Span-2151"><span class="mo" id="MathJax-Span-2152" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2153" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2154" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2155" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>tanh</mi><mo>⁡</mo><mo stretchy="false">(</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">c</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-176">\tanh(\mathbf{c}^{\langle t \rangle})</script> or keeps those values from being included in the hidden state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-177-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2156" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2157"><span class="msubsup" id="MathJax-Span-2158"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2159"><span class="mrow" id="MathJax-Span-2160"><span class="mi" id="MathJax-Span-2161" style="font-family: STIXMathJax_Main; font-weight: bold;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2162"><span class="mrow" id="MathJax-Span-2163"><span class="mo" id="MathJax-Span-2164" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2165" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2166" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">a</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-177">\mathbf{a}^{\langle t \rangle}</script></li>
</ul>
<h5 id="Variable-names--and-shapes-in-the-code">Variable names  and shapes in the code<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Variable-names--and-shapes-in-the-code">¶</a></h5>
<ul>
<li><code>a</code>: hidden state, including time steps.  <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-178-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2167" role="math" style="width: 0.717em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em, 1000.6em, 2.503em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2168"><span class="texatom" id="MathJax-Span-2169"><span class="mrow" id="MathJax-Span-2170"><span class="mi" id="MathJax-Span-2171" style="font-family: STIXMathJax_Main; font-weight: bold;">a</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">a</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-178">\mathbf{a}</script> has shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-179-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2172" role="math" style="width: 5.003em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.17em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1004.11em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2173"><span class="mo" id="MathJax-Span-2174" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2175"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2176" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2177"><span class="mrow" id="MathJax-Span-2178"><span class="mi" id="MathJax-Span-2179" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2180" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-2181" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-2182" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2183" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2184" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-2185"><span class="mrow" id="MathJax-Span-2186"><span class="mi" id="MathJax-Span-2187" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2188" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo>,</mo><mi>m</mi><mo>,</mo><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-179">(n_{a}, m, T_{x})</script></li>
<li>'a_prev`: hidden state from previous time step. <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-180-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2189" role="math" style="width: 2.682em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1002.21em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2190"><span class="msubsup" id="MathJax-Span-2191"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2192"><span class="mrow" id="MathJax-Span-2193"><span class="mi" id="MathJax-Span-2194" style="font-family: STIXMathJax_Main; font-weight: bold;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2195"><span class="mrow" id="MathJax-Span-2196"><span class="mo" id="MathJax-Span-2197" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2198" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2199" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-2200" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-2201" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">a</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-180">\mathbf{a}^{\langle t-1 \rangle}</script> has shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-181-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2202" role="math" style="width: 3.396em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.801em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.74em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2203"><span class="mo" id="MathJax-Span-2204" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2205"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2206" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2207"><span class="mrow" id="MathJax-Span-2208"><span class="mi" id="MathJax-Span-2209" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2210" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-2211" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-2212" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-181">(n_{a}, m)</script></li>
<li><code>a_next</code>: hidden state for next time step.  <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-182-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2213" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2214"><span class="msubsup" id="MathJax-Span-2215"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2216"><span class="mrow" id="MathJax-Span-2217"><span class="mi" id="MathJax-Span-2218" style="font-family: STIXMathJax_Main; font-weight: bold;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2219"><span class="mrow" id="MathJax-Span-2220"><span class="mo" id="MathJax-Span-2221" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2222" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2223" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">a</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-182">\mathbf{a}^{\langle t \rangle}</script> has shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-183-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2224" role="math" style="width: 3.396em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.801em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.74em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2225"><span class="mo" id="MathJax-Span-2226" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2227"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2228" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2229"><span class="mrow" id="MathJax-Span-2230"><span class="mi" id="MathJax-Span-2231" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2232" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-2233" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-2234" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-183">(n_{a}, m)</script> </li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 162px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.5px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### - Prediction </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>pred<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The prediction in this use case is a classification, so we'll use a softmax.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The equation is:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>pred<span class="cm-bracket">}</span> = <span class="cm-tag">\textrm</span><span class="cm-bracket">{</span>softmax<span class="cm-bracket">}</span>(<span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>W<span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>y<span class="cm-bracket">}</span> <span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> + <span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>b<span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Variable names and shapes in the code</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`y_pred`</span><span class="cm-variable-2">: prediction, including all time steps. </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>pred<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> has shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>, m, T_<span class="cm-bracket">{</span>x<span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.  Note that </span><span class="cm-delimit cm-delimit-open">$</span>(T_<span class="cm-bracket">{</span>y<span class="cm-bracket">}</span> = T_<span class="cm-bracket">{</span>x<span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> for this example.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-comment cm-variable-2">`yt_pred`</span><span class="cm-variable-2">: prediction for the current time step </span><span class="cm-delimit cm-delimit-open">$</span>t<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">. </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mathbf</span><span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>pred<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> has shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>, m)<span class="cm-delimit cm-delimit-close">$</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 162px;"></div><div class="CodeMirror-gutters" style="display: none; height: 171px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="--Prediction-$\mathbf{y}^{\langle-t-\rangle}_{pred}$">- Prediction <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-184-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2235" role="math" style="width: 2.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1001.91em, 2.801em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2236"><span class="msubsup" id="MathJax-Span-2237"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2238"><span class="mrow" id="MathJax-Span-2239"><span class="mi" id="MathJax-Span-2240" style="font-family: STIXMathJax_Main; font-weight: bold;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2241"><span class="mrow" id="MathJax-Span-2242"><span class="mo" id="MathJax-Span-2243" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2244" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2245" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1001.43em, 4.289em, -999.997em); top: -3.688em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2246"><span class="mrow" id="MathJax-Span-2247"><span class="mi" id="MathJax-Span-2248" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">p</span><span class="mi" id="MathJax-Span-2249" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2250" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-2251" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">y</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-184">\mathbf{y}^{\langle t \rangle}_{pred}</script><a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#--Prediction-$\mathbf{y}^{\langle-t-\rangle}_{pred}$">¶</a></h4>
<ul>
<li>The prediction in this use case is a classification, so we'll use a softmax.</li>
</ul>
<p>The equation is:
<span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-185-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;softmax&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2252" role="math" style="width: 15.182em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.622em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1012.56em, 2.979em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2253"><span class="msubsup" id="MathJax-Span-2254"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2255"><span class="mrow" id="MathJax-Span-2256"><span class="mi" id="MathJax-Span-2257" style="font-family: STIXMathJax_Main; font-weight: bold;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2258"><span class="mrow" id="MathJax-Span-2259"><span class="mo" id="MathJax-Span-2260" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2261" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2262" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1001.43em, 4.289em, -999.997em); top: -3.688em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2263"><span class="mrow" id="MathJax-Span-2264"><span class="mi" id="MathJax-Span-2265" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">p</span><span class="mi" id="MathJax-Span-2266" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2267" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-2268" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2269" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="texatom" id="MathJax-Span-2270" style="padding-left: 0.301em;"><span class="mrow" id="MathJax-Span-2271"><span class="mtext" id="MathJax-Span-2272" style="font-family: STIXMathJax_Main;">softmax</span></span></span><span class="mo" id="MathJax-Span-2273" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2274"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.96em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2275"><span class="mrow" id="MathJax-Span-2276"><span class="mi" id="MathJax-Span-2277" style="font-family: STIXMathJax_Main; font-weight: bold;">W</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 1.015em;"><span class="texatom" id="MathJax-Span-2278"><span class="mrow" id="MathJax-Span-2279"><span class="mi" id="MathJax-Span-2280" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2281"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2282"><span class="mrow" id="MathJax-Span-2283"><span class="mi" id="MathJax-Span-2284" style="font-family: STIXMathJax_Main; font-weight: bold;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2285"><span class="mrow" id="MathJax-Span-2286"><span class="mo" id="MathJax-Span-2287" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2288" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2289" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2290" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-2291" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2292"><span class="mrow" id="MathJax-Span-2293"><span class="mi" id="MathJax-Span-2294" style="font-family: STIXMathJax_Main; font-weight: bold;">b</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-2295"><span class="mrow" id="MathJax-Span-2296"><span class="mi" id="MathJax-Span-2297" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2298" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.932em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">y</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mtext>softmax</mtext></mrow><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">W</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">a</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">b</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-185">\mathbf{y}^{\langle t \rangle}_{pred} = \textrm{softmax}(\mathbf{W}_{y} \mathbf{a}^{\langle t \rangle} + \mathbf{b}_{y})</script></p>
<h5 id="Variable-names-and-shapes-in-the-code">Variable names and shapes in the code<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Variable-names-and-shapes-in-the-code">¶</a></h5>
<ul>
<li><code>y_pred</code>: prediction, including all time steps. <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-186-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2299" role="math" style="width: 2.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em, 1001.91em, 2.682em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2300"><span class="msubsup" id="MathJax-Span-2301"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2302"><span class="mrow" id="MathJax-Span-2303"><span class="mi" id="MathJax-Span-2304" style="font-family: STIXMathJax_Main; font-weight: bold;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.747em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2305"><span class="mrow" id="MathJax-Span-2306"><span class="mi" id="MathJax-Span-2307" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">p</span><span class="mi" id="MathJax-Span-2308" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2309" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-2310" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.496em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">y</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-186">\mathbf{y}_{pred}</script> has shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-187-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2311" role="math" style="width: 4.884em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.051em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1003.99em, 2.86em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2312"><span class="mo" id="MathJax-Span-2313" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2314"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2315" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2316"><span class="mrow" id="MathJax-Span-2317"><span class="mi" id="MathJax-Span-2318" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2319" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-2320" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-2321" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2322" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2323" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-2324"><span class="mrow" id="MathJax-Span-2325"><span class="mi" id="MathJax-Span-2326" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2327" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub><mo>,</mo><mi>m</mi><mo>,</mo><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-187">(n_{y}, m, T_{x})</script>.  Note that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-188-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2328" role="math" style="width: 4.765em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.932em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em, 1003.87em, 2.801em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2329"><span class="mo" id="MathJax-Span-2330" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2331"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2332" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-2333"><span class="mrow" id="MathJax-Span-2334"><span class="mi" id="MathJax-Span-2335" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2336" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-2337" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2338" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-2339"><span class="mrow" id="MathJax-Span-2340"><span class="mi" id="MathJax-Span-2341" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2342" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub><mo>=</mo><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-188">(T_{y} = T_{x})</script> for this example.</li>
<li><code>yt_pred</code>: prediction for the current time step <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-189-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2343" role="math" style="width: 0.36em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.301em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em, 1000.3em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2344"><span class="mi" id="MathJax-Span-2345" style="font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-189">t</script>. <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-190-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2346" role="math" style="width: 2.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1001.91em, 2.801em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2347"><span class="msubsup" id="MathJax-Span-2348"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.48em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2349"><span class="mrow" id="MathJax-Span-2350"><span class="mi" id="MathJax-Span-2351" style="font-family: STIXMathJax_Main; font-weight: bold;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2352"><span class="mrow" id="MathJax-Span-2353"><span class="mo" id="MathJax-Span-2354" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2355" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2356" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1001.43em, 4.289em, -999.997em); top: -3.688em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2357"><span class="mrow" id="MathJax-Span-2358"><span class="mi" id="MathJax-Span-2359" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">p</span><span class="mi" id="MathJax-Span-2360" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2361" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-2362" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">y</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-190">\mathbf{y}^{\langle t \rangle}_{pred}</script> has shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-191-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2363" role="math" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.741em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.68em, 2.86em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2364"><span class="mo" id="MathJax-Span-2365" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2366"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2367" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2368"><span class="mrow" id="MathJax-Span-2369"><span class="mi" id="MathJax-Span-2370" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2371" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-2372" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-2373" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-191">(n_{y}, m)</script></li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 211px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### 2.1 - LSTM cell</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Exercise**</span>: Implement the LSTM cell described in the Figure (4).</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Instructions**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">1. Concatenate the hidden state </span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> and input </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> into a single matrix:</span><span class="cm-variable-2 cm-trailing-space-a"> </span><span class="cm-variable-2 cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$$</span>concat = <span class="cm-tag">\begin</span><span class="cm-bracket">{</span><span class="cm-atom">bmatrix</span><span class="cm-bracket">}</span> a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> <span class="cm-tag">\\</span> x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> <span class="cm-tag">\end</span><span class="cm-bracket">{</span><span class="cm-atom">bmatrix</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$$</span> &nbsp;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">2. Compute all the formulas 1 through 6 for the gates, hidden state, and cell state.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">3. Compute the prediction </span><span class="cm-delimit cm-delimit-open">$</span>y^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 211px;"></div><div class="CodeMirror-gutters" style="display: none; height: 220px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="2.1---LSTM-cell">2.1 - LSTM cell<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#2.1---LSTM-cell">¶</a></h3>
<p><strong>Exercise</strong>: Implement the LSTM cell described in the Figure (4).</p>
<p><strong>Instructions</strong>:</p>
<ol>
<li>Concatenate the hidden state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-192-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2374" role="math" style="width: 2.682em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1002.21em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2375"><span class="msubsup" id="MathJax-Span-2376"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2377" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2378"><span class="mrow" id="MathJax-Span-2379"><span class="mo" id="MathJax-Span-2380" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2381" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2382" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-2383" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-2384" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-192">a^{\langle t-1 \rangle}</script> and input <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-193-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2385" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2386"><span class="msubsup" id="MathJax-Span-2387"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2388" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2389"><span class="mrow" id="MathJax-Span-2390"><span class="mo" id="MathJax-Span-2391" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2392" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2393" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-193">x^{\langle t \rangle}</script> into a single matrix:  </li>
</ol>
<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-194-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2394" role="math" style="width: 8.753em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.265em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em, 1007.03em, 4.17em, -999.997em); top: -2.914em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2395"><span class="mi" id="MathJax-Span-2396" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span class="mi" id="MathJax-Span-2397" style="font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span class="mi" id="MathJax-Span-2398" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span class="mi" id="MathJax-Span-2399" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span class="mi" id="MathJax-Span-2400" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-2401" style="font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2402" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mrow" id="MathJax-Span-2403" style="padding-left: 0.301em;"><span class="mo" id="MathJax-Span-2404" style="vertical-align: -0.592em;"><span style="font-family: STIXMathJax_Size3;">[</span></span><span class="mtable" id="MathJax-Span-2405" style="padding-right: 0.182em; padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(2.265em, 1002.21em, 5.003em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(2.92em, 1002.21em, 4.17em, -999.997em); top: -4.64em; left: 50%; margin-left: -1.068em;"><span class="mtd" id="MathJax-Span-2406"><span class="mrow" id="MathJax-Span-2407"><span class="msubsup" id="MathJax-Span-2408"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2409" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2410"><span class="mrow" id="MathJax-Span-2411"><span class="mo" id="MathJax-Span-2412" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2413" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2414" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-2415" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-2416" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(2.92em, 1001.37em, 4.17em, -999.997em); top: -3.152em; left: 50%; margin-left: -0.652em;"><span class="mtd" id="MathJax-Span-2417"><span class="mrow" id="MathJax-Span-2418"><span class="msubsup" id="MathJax-Span-2419"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2420" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2421"><span class="mrow" id="MathJax-Span-2422"><span class="mo" id="MathJax-Span-2423" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2424" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2425" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2426" style="vertical-align: -0.592em;"><span style="font-family: STIXMathJax_Size3;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.92em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.354em; border-left: 0px solid; width: 0px; height: 3.218em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>c</mi><mi>o</mi><mi>n</mi><mi>c</mi><mi>a</mi><mi>t</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></mtd></mtr><mtr><mtd><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-194">concat = \begin{bmatrix} a^{\langle t-1 \rangle} \\ x^{\langle t \rangle} \end{bmatrix}</script>  </p>
<ol>
<li>Compute all the formulas 1 through 6 for the gates, hidden state, and cell state.</li>
<li>Compute the prediction <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-195-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2427" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.31em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2428"><span class="msubsup" id="MathJax-Span-2429"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2430" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-2431"><span class="mrow" id="MathJax-Span-2432"><span class="mo" id="MathJax-Span-2433" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2434" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2435" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-195">y^{\langle t \rangle}</script>.</li>
</ol>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59863px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 145px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.5px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Additional Hints</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* You can use </span><span class="cm-link cm-variable-2">[numpy.concatenate]</span><span class="cm-string cm-url cm-variable-2">(https://docs.scipy.org/doc/numpy/reference/generated/numpy.concatenate.html)</span><span class="cm-variable-2">.  Check which value to use for the </span><span class="cm-comment cm-variable-2">`axis`</span><span class="cm-variable-2"> parameter.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* The functions </span><span class="cm-comment cm-variable-2">`sigmoid()`</span><span class="cm-variable-2"> and </span><span class="cm-comment cm-variable-2">`softmax`</span><span class="cm-variable-2"> are imported from </span><span class="cm-comment cm-variable-2">`rnn_utils.py`</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* </span><span class="cm-link cm-variable-2">[numpy.tanh]</span><span class="cm-string cm-url cm-variable-2">(https://docs.scipy.org/doc/numpy/reference/generated/numpy.tanh.html)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Use </span><span class="cm-link cm-variable-2">[np.dot]</span><span class="cm-string cm-url cm-variable-2">(https://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html)</span><span class="cm-variable-2"> for matrix multiplication.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Notice that the variable names </span><span class="cm-comment cm-variable-2">`Wi`</span><span class="cm-variable-2">, </span><span class="cm-comment cm-variable-2">`bi`</span><span class="cm-variable-2"> refer to the weights and biases of the </span><span class="cm-strong cm-variable-2">**update**</span><span class="cm-variable-2"> gate.  There are no variables named "Wu" or "bu" in this function.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 145px;"></div><div class="CodeMirror-gutters" style="display: none; height: 154px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="Additional-Hints">Additional Hints<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Additional-Hints">¶</a></h4>
<ul>
<li>You can use <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.concatenate.html" target="_blank">numpy.concatenate</a>.  Check which value to use for the <code>axis</code> parameter.</li>
<li>The functions <code>sigmoid()</code> and <code>softmax</code> are imported from <code>rnn_utils.py</code>.</li>
<li><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.tanh.html" target="_blank">numpy.tanh</a></li>
<li>Use <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html" target="_blank">np.dot</a> for matrix multiplication.</li>
<li>Notice that the variable names <code>Wi</code>, <code>bi</code> refer to the weights and biases of the <strong>update</strong> gate.  There are no variables named "Wu" or "bu" in this function.</li>
</ul>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[8]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59863px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 724.055px; margin-bottom: -21px; border-right-width: 9px; min-height: 1178px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># GRADED FUNCTION: lstm_cell_forward</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">lstm_cell_forward</span>(<span class="cm-variable">xt</span>, <span class="cm-variable">a_prev</span>, <span class="cm-variable">c_prev</span>, <span class="cm-variable">parameters</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Implement a single forward step of the LSTM-cell as described in Figure (4)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    xt -- your input data at timestep "t", numpy array of shape (n_x, m).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    a_prev -- Hidden state at timestep "t-1", numpy array of shape (n_a, m)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    c_prev -- Memory state at timestep "t-1", numpy array of shape (n_a, m)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    parameters -- python dictionary containing:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        Wf -- Weight matrix of the forget gate, numpy array of shape (n_a, n_a + n_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        bf -- Bias of the forget gate, numpy array of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        Wi -- Weight matrix of the update gate, numpy array of shape (n_a, n_a + n_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        bi -- Bias of the update gate, numpy array of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        Wc -- Weight matrix of the first "tanh", numpy array of shape (n_a, n_a + n_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        bc --  Bias of the first "tanh", numpy array of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        Wo -- Weight matrix of the output gate, numpy array of shape (n_a, n_a + n_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        bo --  Bias of the output gate, numpy array of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        Wy -- Weight matrix relating the hidden-state to the output, numpy array of shape (n_y, n_a)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        by -- Bias relating the hidden-state to the output, numpy array of shape (n_y, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    a_next -- next hidden state, of shape (n_a, m)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    c_next -- next memory state, of shape (n_a, m)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    yt_pred -- prediction at timestep "t", numpy array of shape (n_y, m)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    cache -- tuple of values needed for the backward pass, contains (a_next, c_next, a_prev, c_prev, xt, parameters)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Note: ft/it/ot stand for the forget/update/output gates, cct stands for the candidate value (c tilde),</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">          c stands for the cell state (memory)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Retrieve parameters from "parameters"</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">Wf</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"Wf"</span>] <span class="cm-comment"># forget gate weight</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">bf</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"bf"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">Wi</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"Wi"</span>] <span class="cm-comment"># update gate weight (notice the variable name)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">bi</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"bi"</span>] <span class="cm-comment"># (notice the variable name)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">Wc</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"Wc"</span>] <span class="cm-comment"># candidate value weight</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">bc</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"bc"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">Wo</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"Wo"</span>] <span class="cm-comment"># output gate weight</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">bo</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"bo"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">Wy</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"Wy"</span>] <span class="cm-comment"># prediction weight</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">by</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"by"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Retrieve dimensions from shapes of xt and Wy</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">n_x</span>, <span class="cm-variable">m</span> = <span class="cm-variable">xt</span>.<span class="cm-property">shape</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">n_y</span>, <span class="cm-variable">n_a</span> = <span class="cm-variable">Wy</span>.<span class="cm-property">shape</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Concatenate a_prev and xt (≈1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">concat</span> = <span class="cm-variable">np</span>.<span class="cm-property">concatenate</span>((<span class="cm-variable">a_prev</span>,<span class="cm-variable">xt</span>),<span class="cm-variable">axis</span>=<span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Compute values for ft (forget gate), it (update gate),</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># cct (candidate value), c_next (cell state), </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># ot (output gate), a_next (hidden state) (≈6 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">ft</span> = <span class="cm-variable">sigmoid</span>(<span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">Wf</span>,<span class="cm-variable">concat</span>)<span class="cm-operator">+</span><span class="cm-variable">bf</span>)        <span class="cm-comment"># forget gate</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">it</span> = <span class="cm-variable">sigmoid</span>(<span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">Wi</span>,<span class="cm-variable">concat</span>)<span class="cm-operator">+</span><span class="cm-variable">bi</span>)        <span class="cm-comment"># update gate</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">cct</span> = <span class="cm-variable">np</span>.<span class="cm-property">tanh</span>(<span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">Wc</span>,<span class="cm-variable">concat</span>)<span class="cm-operator">+</span><span class="cm-variable">bc</span>)       <span class="cm-comment"># candidate value</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">c_next</span> = <span class="cm-variable">ft</span><span class="cm-operator">*</span><span class="cm-variable">c_prev</span><span class="cm-operator">+</span><span class="cm-variable">it</span><span class="cm-operator">*</span><span class="cm-variable">cct</span>    <span class="cm-comment"># cell state</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">ot</span> = <span class="cm-variable">sigmoid</span>(<span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">Wo</span>,<span class="cm-variable">concat</span>)<span class="cm-operator">+</span><span class="cm-variable">bo</span>)        <span class="cm-comment"># output gate</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">a_next</span> = <span class="cm-variable">ot</span><span class="cm-operator">*</span><span class="cm-variable">np</span>.<span class="cm-property">tanh</span>(<span class="cm-variable">c_next</span>)    <span class="cm-comment"># hidden state</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Compute prediction of the LSTM cell (≈1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">yt_pred</span> = <span class="cm-variable">softmax</span>(<span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">Wy</span>,<span class="cm-variable">a_next</span>)<span class="cm-operator">+</span><span class="cm-variable">by</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># store values needed for backward propagation in cache</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">cache</span> = (<span class="cm-variable">a_next</span>, <span class="cm-variable">c_next</span>, <span class="cm-variable">a_prev</span>, <span class="cm-variable">c_prev</span>, <span class="cm-variable">ft</span>, <span class="cm-variable">it</span>, <span class="cm-variable">cct</span>, <span class="cm-variable">ot</span>, <span class="cm-variable">xt</span>, <span class="cm-variable">parameters</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">a_next</span>, <span class="cm-variable">c_next</span>, <span class="cm-variable">yt_pred</span>, <span class="cm-variable">cache</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 1178px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1187px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[9]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59863px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 770.917px; margin-bottom: -21px; border-right-width: 9px; min-height: 427px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">seed</span>(<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">xt_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">3</span>,<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a_prev_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">c_prev_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span> = {}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wf'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>, <span class="cm-number">5</span><span class="cm-operator">+</span><span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'bf'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wi'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>, <span class="cm-number">5</span><span class="cm-operator">+</span><span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'bi'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wo'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>, <span class="cm-number">5</span><span class="cm-operator">+</span><span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'bo'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wc'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>, <span class="cm-number">5</span><span class="cm-operator">+</span><span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'bc'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wy'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">2</span>,<span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'by'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">2</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a_next_tmp</span>, <span class="cm-variable">c_next_tmp</span>, <span class="cm-variable">yt_tmp</span>, <span class="cm-variable">cache_tmp</span> = <span class="cm-variable">lstm_cell_forward</span>(<span class="cm-variable">xt_tmp</span>, <span class="cm-variable">a_prev_tmp</span>, <span class="cm-variable">c_prev_tmp</span>, <span class="cm-variable">parameters_tmp</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"a_next[4] = \n"</span>, <span class="cm-variable">a_next_tmp</span>[<span class="cm-number">4</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"a_next.shape = "</span>, <span class="cm-variable">c_next_tmp</span>.<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"c_next[2] = \n"</span>, <span class="cm-variable">c_next_tmp</span>[<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"c_next.shape = "</span>, <span class="cm-variable">c_next_tmp</span>.<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"yt[1] ="</span>, <span class="cm-variable">yt_tmp</span>[<span class="cm-number">1</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"yt.shape = "</span>, <span class="cm-variable">yt_tmp</span>.<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"cache[1][3] =\n"</span>, <span class="cm-variable">cache_tmp</span>[<span class="cm-number">1</span>][<span class="cm-number">3</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"len(cache) = "</span>, <span class="cm-builtin">len</span>(<span class="cm-variable">cache_tmp</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 427px;"></div><div class="CodeMirror-gutters" style="display: none; height: 436px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>a_next[4] = 
 [-0.66408471  0.0036921   0.02088357  0.22834167 -0.85575339  0.00138482
  0.76566531  0.34631421 -0.00215674  0.43827275]
a_next.shape =  (5, 10)
c_next[2] = 
 [ 0.63267805  1.00570849  0.35504474  0.20690913 -1.64566718  0.11832942
  0.76449811 -0.0981561  -0.74348425 -0.26810932]
c_next.shape =  (5, 10)
yt[1] = [ 0.79913913  0.15986619  0.22412122  0.15606108  0.97057211  0.31146381
  0.00943007  0.12666353  0.39380172  0.07828381]
yt.shape =  (2, 10)
cache[1][3] =
 [-0.16263996  1.03729328  0.72938082 -0.54101719  0.02752074 -0.30821874
  0.07651101 -1.03752894  1.41219977 -0.37647422]
len(cache) =  10
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 328px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Expected Output**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```Python</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a_next</span>[<span class="cm-number">4</span>] = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> [<span class="cm-operator">-</span><span class="cm-number">0.66408471</span> &nbsp;<span class="cm-number">0.0036921</span> &nbsp; <span class="cm-number">0.02088357</span> &nbsp;<span class="cm-number">0.22834167</span> <span class="cm-operator">-</span><span class="cm-number">0.85575339</span> &nbsp;<span class="cm-number">0.00138482</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-number">0.76566531</span> &nbsp;<span class="cm-number">0.34631421</span> <span class="cm-operator">-</span><span class="cm-number">0.00215674</span> &nbsp;<span class="cm-number">0.43827275</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a_next</span>.<span class="cm-property">shape</span> =  (<span class="cm-number">5</span>, <span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">c_next</span>[<span class="cm-number">2</span>] = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> [ <span class="cm-number">0.63267805</span> &nbsp;<span class="cm-number">1.00570849</span> &nbsp;<span class="cm-number">0.35504474</span> &nbsp;<span class="cm-number">0.20690913</span> <span class="cm-operator">-</span><span class="cm-number">1.64566718</span> &nbsp;<span class="cm-number">0.11832942</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-number">0.76449811</span> <span class="cm-operator">-</span><span class="cm-number">0.0981561</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">0.74348425</span> <span class="cm-operator">-</span><span class="cm-number">0.26810932</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">c_next</span>.<span class="cm-property">shape</span> =  (<span class="cm-number">5</span>, <span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">yt</span>[<span class="cm-number">1</span>] = [ <span class="cm-number">0.79913913</span> &nbsp;<span class="cm-number">0.15986619</span> &nbsp;<span class="cm-number">0.22412122</span> &nbsp;<span class="cm-number">0.15606108</span> &nbsp;<span class="cm-number">0.97057211</span> &nbsp;<span class="cm-number">0.31146381</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-number">0.00943007</span> &nbsp;<span class="cm-number">0.12666353</span> &nbsp;<span class="cm-number">0.39380172</span> &nbsp;<span class="cm-number">0.07828381</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">yt</span>.<span class="cm-property">shape</span> =  (<span class="cm-number">2</span>, <span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">cache</span>[<span class="cm-number">1</span>][<span class="cm-number">3</span>] =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> [<span class="cm-operator">-</span><span class="cm-number">0.16263996</span> &nbsp;<span class="cm-number">1.03729328</span> &nbsp;<span class="cm-number">0.72938082</span> <span class="cm-operator">-</span><span class="cm-number">0.54101719</span> &nbsp;<span class="cm-number">0.02752074</span> <span class="cm-operator">-</span><span class="cm-number">0.30821874</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-number">0.07651101</span> <span class="cm-operator">-</span><span class="cm-number">1.03752894</span> &nbsp;<span class="cm-number">1.41219977</span> <span class="cm-operator">-</span><span class="cm-number">0.37647422</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">len</span>(<span class="cm-variable">cache</span>) = &nbsp;<span class="cm-number">10</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 328px;"></div><div class="CodeMirror-gutters" style="display: none; height: 337px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Expected Output</strong>:</p>
<pre><code class="cm-s-ipython language-Python"><span class="cm-variable">a_next</span>[<span class="cm-number">4</span>] = 
 [<span class="cm-operator">-</span><span class="cm-number">0.66408471</span>  <span class="cm-number">0.0036921</span>   <span class="cm-number">0.02088357</span>  <span class="cm-number">0.22834167</span> <span class="cm-operator">-</span><span class="cm-number">0.85575339</span>  <span class="cm-number">0.00138482</span>
  <span class="cm-number">0.76566531</span>  <span class="cm-number">0.34631421</span> <span class="cm-operator">-</span><span class="cm-number">0.00215674</span>  <span class="cm-number">0.43827275</span>]
<span class="cm-variable">a_next</span>.<span class="cm-property">shape</span> =  (<span class="cm-number">5</span>, <span class="cm-number">10</span>)
<span class="cm-variable">c_next</span>[<span class="cm-number">2</span>] = 
 [ <span class="cm-number">0.63267805</span>  <span class="cm-number">1.00570849</span>  <span class="cm-number">0.35504474</span>  <span class="cm-number">0.20690913</span> <span class="cm-operator">-</span><span class="cm-number">1.64566718</span>  <span class="cm-number">0.11832942</span>
  <span class="cm-number">0.76449811</span> <span class="cm-operator">-</span><span class="cm-number">0.0981561</span>  <span class="cm-operator">-</span><span class="cm-number">0.74348425</span> <span class="cm-operator">-</span><span class="cm-number">0.26810932</span>]
<span class="cm-variable">c_next</span>.<span class="cm-property">shape</span> =  (<span class="cm-number">5</span>, <span class="cm-number">10</span>)
<span class="cm-variable">yt</span>[<span class="cm-number">1</span>] = [ <span class="cm-number">0.79913913</span>  <span class="cm-number">0.15986619</span>  <span class="cm-number">0.22412122</span>  <span class="cm-number">0.15606108</span>  <span class="cm-number">0.97057211</span>  <span class="cm-number">0.31146381</span>
  <span class="cm-number">0.00943007</span>  <span class="cm-number">0.12666353</span>  <span class="cm-number">0.39380172</span>  <span class="cm-number">0.07828381</span>]
<span class="cm-variable">yt</span>.<span class="cm-property">shape</span> =  (<span class="cm-number">2</span>, <span class="cm-number">10</span>)
<span class="cm-variable">cache</span>[<span class="cm-number">1</span>][<span class="cm-number">3</span>] =
 [<span class="cm-operator">-</span><span class="cm-number">0.16263996</span>  <span class="cm-number">1.03729328</span>  <span class="cm-number">0.72938082</span> <span class="cm-operator">-</span><span class="cm-number">0.54101719</span>  <span class="cm-number">0.02752074</span> <span class="cm-operator">-</span><span class="cm-number">0.30821874</span>
  <span class="cm-number">0.07651101</span> <span class="cm-operator">-</span><span class="cm-number">1.03752894</span>  <span class="cm-number">1.41219977</span> <span class="cm-operator">-</span><span class="cm-number">0.37647422</span>]
<span class="cm-builtin">len</span>(<span class="cm-variable">cache</span>) =  <span class="cm-number">10</span>
</code></pre>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59863px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 544px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### 2.2 - Forward pass for LSTM</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Now that you have implemented one step of an LSTM, you can now iterate this over this using a for-loop to process a sequence of <span class="cm-delimit cm-delimit-open">$</span>T_x<span class="cm-delimit cm-delimit-close">$</span> inputs. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/LSTM_rnn.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:500;height:300px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> **Figure 5**: LSTM over multiple time-steps. <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Exercise:**</span> Implement <span class="cm-comment">`lstm_forward()`</span> to run an LSTM over <span class="cm-delimit cm-delimit-open">$</span>T_x<span class="cm-delimit cm-delimit-close">$</span> time-steps. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Instructions**</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Get the dimensions </span><span class="cm-delimit cm-delimit-open">$</span>n_x, n_a, n_y, m, T_x<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> from the shape of the variables: </span><span class="cm-comment cm-variable-2">`x`</span><span class="cm-variable-2"> and </span><span class="cm-comment cm-variable-2">`parameters`</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Initialize the 3D tensors </span><span class="cm-delimit cm-delimit-open">$</span>a<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">, </span><span class="cm-delimit cm-delimit-open">$</span>c<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> and </span><span class="cm-delimit cm-delimit-open">$</span>y<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- </span><span class="cm-delimit cm-delimit-open">$</span>a<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">: hidden state, shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>, m, T_<span class="cm-bracket">{</span>x<span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- </span><span class="cm-delimit cm-delimit-open">$</span>c<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">: cell state, shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>, m, T_<span class="cm-bracket">{</span>x<span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- </span><span class="cm-delimit cm-delimit-open">$</span>y<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3">: prediction, shape </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>y<span class="cm-bracket">}</span>, m, T_<span class="cm-bracket">{</span>x<span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3"> (Note that </span><span class="cm-delimit cm-delimit-open">$</span>T_<span class="cm-bracket">{</span>y<span class="cm-bracket">}</span> = T_<span class="cm-bracket">{</span>x<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3"> in this example).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- </span><span class="cm-strong cm-variable-3">**Note**</span><span class="cm-variable-3"> Setting one variable equal to the other is a "copy by reference".  In other words, don't do </span><span class="cm-comment cm-variable-3">`c = a', otherwise both these variables point to the same underlying variable.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment cm-variable-2">* Initialize the 2D tensor </span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-comment cm-variable-2"> </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment cm-variable-3">- </span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-comment cm-variable-3"> stores the hidden state for time step </span><span class="cm-delimit cm-delimit-open">$</span>t<span class="cm-delimit cm-delimit-close">$</span><span class="cm-comment cm-variable-3">.  The variable name is `</span><span class="cm-variable-3">a_next</span><span class="cm-comment cm-variable-3">`.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment cm-variable-3">- </span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> <span class="cm-atom">0</span> <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-comment cm-variable-3">, the initial hidden state at time step 0, is passed in when calling the function. The variable name is `</span><span class="cm-variable-3">a0</span><span class="cm-comment cm-variable-3">`.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment cm-variable-3">- </span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-comment cm-variable-3"> and </span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> <span class="cm-atom">0</span> <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-comment cm-variable-3"> represent a single time step, so they both have the shape &nbsp;</span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>, m)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-comment cm-variable-3"> </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment cm-variable-3">- Initialize </span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-comment cm-variable-3"> by setting it to the initial hidden state (</span><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> <span class="cm-atom">0</span> <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-comment cm-variable-3">) that is passed into the function.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment cm-variable-2">* Initialize </span><span class="cm-delimit cm-delimit-open">$</span>c^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-comment cm-variable-2"> with zeros. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment cm-variable-3">- The variable name is `</span><span class="cm-variable-3">c_next</span><span class="cm-comment cm-variable-3">`. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment cm-variable-3">- </span><span class="cm-delimit cm-delimit-open">$</span>c^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-comment cm-variable-3"> represents a single time step, so its shape is </span><span class="cm-delimit cm-delimit-open">$</span>(n_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>, m)<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment cm-variable-3">- **Note**: create `</span><span class="cm-variable-3">c_next</span><span class="cm-comment cm-variable-3">` as its own variable with its own location in memory.  Do not initialize it as a slice of the 3D tensor </span><span class="cm-delimit cm-delimit-open">$</span>c<span class="cm-delimit cm-delimit-close">$</span><span class="cm-comment cm-variable-3">.  In other words, **don't** do `</span><span class="cm-variable-3">c_next = c[:,:,0]</span><span class="cm-comment cm-variable-3">`.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment cm-variable-2">* For each time step, do the following:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment cm-variable-3">- From the 3D tensor </span><span class="cm-delimit cm-delimit-open">$</span>x<span class="cm-delimit cm-delimit-close">$</span><span class="cm-comment cm-variable-3">, get a 2D slice </span><span class="cm-delimit cm-delimit-open">$</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-comment cm-variable-3"> at time step </span><span class="cm-delimit cm-delimit-open">$</span>t<span class="cm-delimit cm-delimit-close">$</span><span class="cm-comment cm-variable-3">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment cm-variable-3">- Call the `</span><span class="cm-variable-3">lstm_cell_forward</span><span class="cm-comment cm-variable-3">` function that you defined previously, to get the hidden state, cell state, prediction, and cache.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment cm-variable-3">- Store the hidden state, cell state and prediction (the 2D tensors) inside the 3D tensors.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment cm-variable-3">- Also append the cache to the list of caches.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 544px;"></div><div class="CodeMirror-gutters" style="display: none; height: 553px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="2.2---Forward-pass-for-LSTM">2.2 - Forward pass for LSTM<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#2.2---Forward-pass-for-LSTM">¶</a></h3>
<p>Now that you have implemented one step of an LSTM, you can now iterate this over this using a for-loop to process a sequence of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-196-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2436" role="math" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1000.96em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2437"><span class="msubsup" id="MathJax-Span-2438"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2439" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-2440" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>x</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-196">T_x</script> inputs. </p>
<p><img src="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/LSTM_rnn.png" style="width: 500 ; height: 300px"></p>
<center> <strong>Figure 5</strong>: LSTM over multiple time-steps. </center>

<p><strong>Exercise:</strong> Implement <code>lstm_forward()</code> to run an LSTM over <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-197-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2441" role="math" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1000.96em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2442"><span class="msubsup" id="MathJax-Span-2443"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2444" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-2445" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>x</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-197">T_x</script> time-steps. </p>
<p><strong>Instructions</strong></p>
<ul>
<li>Get the dimensions <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-198-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2446" role="math" style="width: 7.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.074em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1006.07em, 2.86em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2447"><span class="msubsup" id="MathJax-Span-2448"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2449" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-2450" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2451" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2452" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2453" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-2454" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2455" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2456" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2457" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-2458" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2459" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-2460" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-2461" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2462" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2463" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-2464" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mi>x</mi></msub><mo>,</mo><msub><mi>n</mi><mi>a</mi></msub><mo>,</mo><msub><mi>n</mi><mi>y</mi></msub><mo>,</mo><mi>m</mi><mo>,</mo><msub><mi>T</mi><mi>x</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-198">n_x, n_a, n_y, m, T_x</script> from the shape of the variables: <code>x</code> and <code>parameters</code>.</li>
<li>Initialize the 3D tensors <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-199-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2465" role="math" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.48em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2466"><span class="mi" id="MathJax-Span-2467" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-199">a</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-200-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2468" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.42em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2469"><span class="mi" id="MathJax-Span-2470" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-200">c</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-201-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2471" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.42em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2472"><span class="mi" id="MathJax-Span-2473" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-201">y</script>.<ul>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-202-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2474" role="math" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.48em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2475"><span class="mi" id="MathJax-Span-2476" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-202">a</script>: hidden state, shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-203-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2477" role="math" style="width: 5.003em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.17em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1004.11em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2478"><span class="mo" id="MathJax-Span-2479" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2480"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2481" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2482"><span class="mrow" id="MathJax-Span-2483"><span class="mi" id="MathJax-Span-2484" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2485" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-2486" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-2487" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2488" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2489" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-2490"><span class="mrow" id="MathJax-Span-2491"><span class="mi" id="MathJax-Span-2492" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2493" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo>,</mo><mi>m</mi><mo>,</mo><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-203">(n_{a}, m, T_{x})</script></li>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-204-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2494" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.42em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2495"><span class="mi" id="MathJax-Span-2496" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-204">c</script>: cell state, shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-205-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2497" role="math" style="width: 5.003em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.17em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1004.11em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2498"><span class="mo" id="MathJax-Span-2499" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2500"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2501" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2502"><span class="mrow" id="MathJax-Span-2503"><span class="mi" id="MathJax-Span-2504" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2505" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-2506" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-2507" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2508" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2509" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-2510"><span class="mrow" id="MathJax-Span-2511"><span class="mi" id="MathJax-Span-2512" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2513" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo>,</mo><mi>m</mi><mo>,</mo><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-205">(n_{a}, m, T_{x})</script></li>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-206-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2514" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.42em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2515"><span class="mi" id="MathJax-Span-2516" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-206">y</script>: prediction, shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-207-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2517" role="math" style="width: 4.884em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.051em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1003.99em, 2.86em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2518"><span class="mo" id="MathJax-Span-2519" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2520"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2521" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2522"><span class="mrow" id="MathJax-Span-2523"><span class="mi" id="MathJax-Span-2524" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2525" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-2526" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-2527" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2528" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2529" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-2530"><span class="mrow" id="MathJax-Span-2531"><span class="mi" id="MathJax-Span-2532" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2533" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub><mo>,</mo><mi>m</mi><mo>,</mo><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-207">(n_{y}, m, T_{x})</script> (Note that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-208-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2534" role="math" style="width: 3.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.277em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em, 1003.28em, 2.801em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2535"><span class="msubsup" id="MathJax-Span-2536"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2537" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-2538"><span class="mrow" id="MathJax-Span-2539"><span class="mi" id="MathJax-Span-2540" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2541" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-2542" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2543" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-2544"><span class="mrow" id="MathJax-Span-2545"><span class="mi" id="MathJax-Span-2546" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub><mo>=</mo><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-208">T_{y} = T_{x}</script> in this example).</li>
<li><strong>Note</strong> Setting one variable equal to the other is a "copy by reference".  In other words, don't do `c = a', otherwise both these variables point to the same underlying variable.</li>
</ul>
</li>
<li>Initialize the 2D tensor <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-209-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2547" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2548"><span class="msubsup" id="MathJax-Span-2549"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2550" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2551"><span class="mrow" id="MathJax-Span-2552"><span class="mo" id="MathJax-Span-2553" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2554" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2555" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-209">a^{\langle t \rangle}</script> <ul>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-210-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2556" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2557"><span class="msubsup" id="MathJax-Span-2558"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2559" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2560"><span class="mrow" id="MathJax-Span-2561"><span class="mo" id="MathJax-Span-2562" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2563" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2564" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-210">a^{\langle t \rangle}</script> stores the hidden state for time step <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-211-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2565" role="math" style="width: 0.36em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.301em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em, 1000.3em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2566"><span class="mi" id="MathJax-Span-2567" style="font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-211">t</script>.  The variable name is <code>a_next</code>.</li>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-212-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2568" role="math" style="width: 1.789em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.49em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2569"><span class="msubsup" id="MathJax-Span-2570"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2571" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2572"><span class="mrow" id="MathJax-Span-2573"><span class="mo" id="MathJax-Span-2574" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mn" id="MathJax-Span-2575" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span><span class="mo" id="MathJax-Span-2576" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mn>0</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-212">a^{\langle 0 \rangle}</script>, the initial hidden state at time step 0, is passed in when calling the function. The variable name is <code>a0</code>.</li>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-213-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2577" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2578"><span class="msubsup" id="MathJax-Span-2579"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2580" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2581"><span class="mrow" id="MathJax-Span-2582"><span class="mo" id="MathJax-Span-2583" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2584" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2585" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-213">a^{\langle t \rangle}</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-214-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2586" role="math" style="width: 1.789em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.49em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2587"><span class="msubsup" id="MathJax-Span-2588"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2589" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2590"><span class="mrow" id="MathJax-Span-2591"><span class="mo" id="MathJax-Span-2592" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mn" id="MathJax-Span-2593" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span><span class="mo" id="MathJax-Span-2594" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mn>0</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-214">a^{\langle 0 \rangle}</script> represent a single time step, so they both have the shape  <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-215-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2595" role="math" style="width: 3.396em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.801em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.74em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2596"><span class="mo" id="MathJax-Span-2597" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2598"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2599" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2600"><span class="mrow" id="MathJax-Span-2601"><span class="mi" id="MathJax-Span-2602" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2603" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-2604" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-2605" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-215">(n_{a}, m)</script> </li>
<li>Initialize <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-216-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2606" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2607"><span class="msubsup" id="MathJax-Span-2608"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2609" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2610"><span class="mrow" id="MathJax-Span-2611"><span class="mo" id="MathJax-Span-2612" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2613" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2614" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-216">a^{\langle t \rangle}</script> by setting it to the initial hidden state (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-217-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2615" role="math" style="width: 1.789em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.49em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2616"><span class="msubsup" id="MathJax-Span-2617"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2618" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2619"><span class="mrow" id="MathJax-Span-2620"><span class="mo" id="MathJax-Span-2621" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mn" id="MathJax-Span-2622" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span><span class="mo" id="MathJax-Span-2623" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mn>0</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-217">a^{\langle 0 \rangle}</script>) that is passed into the function.</li>
</ul>
</li>
<li>Initialize <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-218-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2624" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.31em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2625"><span class="msubsup" id="MathJax-Span-2626"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2627" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-2628"><span class="mrow" id="MathJax-Span-2629"><span class="mo" id="MathJax-Span-2630" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2631" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2632" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-218">c^{\langle t \rangle}</script> with zeros. <ul>
<li>The variable name is <code>c_next</code>. </li>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-219-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2633" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.31em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2634"><span class="msubsup" id="MathJax-Span-2635"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2636" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-2637"><span class="mrow" id="MathJax-Span-2638"><span class="mo" id="MathJax-Span-2639" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2640" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2641" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-219">c^{\langle t \rangle}</script> represents a single time step, so its shape is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-220-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2642" role="math" style="width: 3.396em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.801em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.74em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2643"><span class="mo" id="MathJax-Span-2644" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2645"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2646" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2647"><span class="mrow" id="MathJax-Span-2648"><span class="mi" id="MathJax-Span-2649" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2650" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-2651" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">m</span><span class="mo" id="MathJax-Span-2652" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-220">(n_{a}, m)</script></li>
<li><strong>Note</strong>: create <code>c_next</code> as its own variable with its own location in memory.  Do not initialize it as a slice of the 3D tensor <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-221-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2653" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.42em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2654"><span class="mi" id="MathJax-Span-2655" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-221">c</script>.  In other words, <strong>don't</strong> do <code>c_next = c[:,:,0]</code>.</li>
</ul>
</li>
<li>For each time step, do the following:<ul>
<li>From the 3D tensor <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-222-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2656" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.42em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2657"><span class="mi" id="MathJax-Span-2658" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-222">x</script>, get a 2D slice <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-223-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2659" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2660"><span class="msubsup" id="MathJax-Span-2661"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2662" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2663"><span class="mrow" id="MathJax-Span-2664"><span class="mo" id="MathJax-Span-2665" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2666" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2667" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-223">x^{\langle t \rangle}</script> at time step <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-224-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2668" role="math" style="width: 0.36em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.301em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em, 1000.3em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2669"><span class="mi" id="MathJax-Span-2670" style="font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-224">t</script>.</li>
<li>Call the <code>lstm_cell_forward</code> function that you defined previously, to get the hidden state, cell state, prediction, and cache.</li>
<li>Store the hidden state, cell state and prediction (the 2D tensors) inside the 3D tensors.</li>
<li>Also append the cache to the list of caches.</li>
</ul>
</li>
</ul>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[10]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59863px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 825.825px; margin-bottom: -21px; border-right-width: 9px; min-height: 1128px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># GRADED FUNCTION: lstm_forward</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">lstm_forward</span>(<span class="cm-variable">x</span>, <span class="cm-variable">a0</span>, <span class="cm-variable">parameters</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Implement the forward propagation of the recurrent neural network using an LSTM-cell described in Figure (4).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    x -- Input data for every time-step, of shape (n_x, m, T_x).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    a0 -- Initial hidden state, of shape (n_a, m)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    parameters -- python dictionary containing:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        Wf -- Weight matrix of the forget gate, numpy array of shape (n_a, n_a + n_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        bf -- Bias of the forget gate, numpy array of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        Wi -- Weight matrix of the update gate, numpy array of shape (n_a, n_a + n_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        bi -- Bias of the update gate, numpy array of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        Wc -- Weight matrix of the first "tanh", numpy array of shape (n_a, n_a + n_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        bc -- Bias of the first "tanh", numpy array of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        Wo -- Weight matrix of the output gate, numpy array of shape (n_a, n_a + n_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        bo -- Bias of the output gate, numpy array of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        Wy -- Weight matrix relating the hidden-state to the output, numpy array of shape (n_y, n_a)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        by -- Bias relating the hidden-state to the output, numpy array of shape (n_y, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    a -- Hidden states for every time-step, numpy array of shape (n_a, m, T_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    y -- Predictions for every time-step, numpy array of shape (n_y, m, T_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    c -- The value of the cell state, numpy array of shape (n_a, m, T_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    caches -- tuple of values needed for the backward pass, contains (list of all the caches, x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Initialize "caches", which will track the list of all the caches</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">caches</span> = []</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">Wy</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">'Wy'</span>] <span class="cm-comment"># saving parameters['Wy'] in a local variable in case students use Wy instead of parameters['Wy']</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Retrieve dimensions from shapes of x and parameters['Wy'] (≈2 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">n_x</span>, <span class="cm-variable">m</span>, <span class="cm-variable">T_x</span> = <span class="cm-variable">np</span>.<span class="cm-property">shape</span>(<span class="cm-variable">x</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">n_y</span>, <span class="cm-variable">n_a</span> = <span class="cm-variable">np</span>.<span class="cm-property">shape</span>(<span class="cm-variable">Wy</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># initialize "a", "c" and "y" with zeros (≈3 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">a</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_a</span>, <span class="cm-variable">m</span>, <span class="cm-variable">T_x</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">c</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_a</span>, <span class="cm-variable">m</span>, <span class="cm-variable">T_x</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">y</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_y</span>, <span class="cm-variable">m</span>, <span class="cm-variable">T_x</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Initialize a_next and c_next (≈2 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">a_next</span> = <span class="cm-variable">np</span>.<span class="cm-property">copy</span>(<span class="cm-variable">a0</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">c_next</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_a</span>,<span class="cm-variable">m</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># loop over all time-steps</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">for</span> <span class="cm-variable">t</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">T_x</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Get the 2D slice 'xt' from the 3D input 'x' at time step 't'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">xt</span> = <span class="cm-variable">x</span>[:,:,<span class="cm-variable">t</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Update next hidden state, next memory state, compute the prediction, get the cache (≈1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">a_next</span>, <span class="cm-variable">c_next</span>, <span class="cm-variable">yt</span>, <span class="cm-variable">cache</span> = <span class="cm-variable">lstm_cell_forward</span>(<span class="cm-variable">xt</span>, <span class="cm-variable">a_next</span>, <span class="cm-variable">c_next</span>, <span class="cm-variable">parameters</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Save the value of the new "next" hidden state in a (≈1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">a</span>[:,:,<span class="cm-variable">t</span>] = <span class="cm-variable">a_next</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Save the value of the next cell state (≈1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">c</span>[:,:,<span class="cm-variable">t</span>]  = <span class="cm-variable">c_next</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Save the value of the prediction in y (≈1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">y</span>[:,:,<span class="cm-variable">t</span>] = <span class="cm-variable">yt</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Append the cache into caches (≈1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">caches</span>.<span class="cm-property">append</span>(<span class="cm-variable">cache</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># store values needed for backward propagation in cache</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">caches</span> = (<span class="cm-variable">caches</span>, <span class="cm-variable">x</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">a</span>, <span class="cm-variable">y</span>, <span class="cm-variable">c</span>, <span class="cm-variable">caches</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 1128px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1137px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[11]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 556.359px; margin-bottom: -21px; border-right-width: 9px; min-height: 394px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">seed</span>(<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">x_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">3</span>,<span class="cm-number">10</span>,<span class="cm-number">7</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a0_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span> = {}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wf'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>, <span class="cm-number">5</span><span class="cm-operator">+</span><span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'bf'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wi'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>, <span class="cm-number">5</span><span class="cm-operator">+</span><span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'bi'</span>]= <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wo'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>, <span class="cm-number">5</span><span class="cm-operator">+</span><span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'bo'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wc'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>, <span class="cm-number">5</span><span class="cm-operator">+</span><span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'bc'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wy'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">2</span>,<span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'by'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">2</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a_tmp</span>, <span class="cm-variable">y_tmp</span>, <span class="cm-variable">c_tmp</span>, <span class="cm-variable">caches_tmp</span> = <span class="cm-variable">lstm_forward</span>(<span class="cm-variable">x_tmp</span>, <span class="cm-variable">a0_tmp</span>, <span class="cm-variable">parameters_tmp</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"a[4][3][6] = "</span>, <span class="cm-variable">a_tmp</span>[<span class="cm-number">4</span>][<span class="cm-number">3</span>][<span class="cm-number">6</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"a.shape = "</span>, <span class="cm-variable">a_tmp</span>.<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"y[1][4][3] ="</span>, <span class="cm-variable">y_tmp</span>[<span class="cm-number">1</span>][<span class="cm-number">4</span>][<span class="cm-number">3</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"y.shape = "</span>, <span class="cm-variable">y_tmp</span>.<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"caches[1][1][1] =\n"</span>, <span class="cm-variable">caches_tmp</span>[<span class="cm-number">1</span>][<span class="cm-number">1</span>][<span class="cm-number">1</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"c[1][2][1]"</span>, <span class="cm-variable">c_tmp</span>[<span class="cm-number">1</span>][<span class="cm-number">2</span>][<span class="cm-number">1</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"len(caches) = "</span>, <span class="cm-builtin">len</span>(<span class="cm-variable">caches_tmp</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 394px;"></div><div class="CodeMirror-gutters" style="display: none; height: 403px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>a[4][3][6] =  0.172117767533
a.shape =  (5, 10, 7)
y[1][4][3] = 0.95087346185
y.shape =  (2, 10, 7)
caches[1][1][1] =
 [ 0.82797464  0.23009474  0.76201118 -0.22232814 -0.20075807  0.18656139
  0.41005165]
c[1][2][1] -0.855544916718
len(caches) =  2
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 227px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Expected Output**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```Python</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>[<span class="cm-number">4</span>][<span class="cm-number">3</span>][<span class="cm-number">6</span>] = &nbsp;<span class="cm-number">0.172117767533</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>.<span class="cm-property">shape</span> =  (<span class="cm-number">5</span>, <span class="cm-number">10</span>, <span class="cm-number">7</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">y</span>[<span class="cm-number">1</span>][<span class="cm-number">4</span>][<span class="cm-number">3</span>] = <span class="cm-number">0.95087346185</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">y</span>.<span class="cm-property">shape</span> =  (<span class="cm-number">2</span>, <span class="cm-number">10</span>, <span class="cm-number">7</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">caches</span>[<span class="cm-number">1</span>][<span class="cm-number">1</span>][<span class="cm-number">1</span>] =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> [ <span class="cm-number">0.82797464</span> &nbsp;<span class="cm-number">0.23009474</span> &nbsp;<span class="cm-number">0.76201118</span> <span class="cm-operator">-</span><span class="cm-number">0.22232814</span> <span class="cm-operator">-</span><span class="cm-number">0.20075807</span> &nbsp;<span class="cm-number">0.18656139</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;<span class="cm-number">0.41005165</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">c</span>[<span class="cm-number">1</span>][<span class="cm-number">2</span>][<span class="cm-number">1</span>] <span class="cm-operator">-</span><span class="cm-number">0.855544916718</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">len</span>(<span class="cm-variable">caches</span>) = &nbsp;<span class="cm-number">2</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 227px;"></div><div class="CodeMirror-gutters" style="display: none; height: 236px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Expected Output</strong>:</p>
<pre><code class="cm-s-ipython language-Python"><span class="cm-variable">a</span>[<span class="cm-number">4</span>][<span class="cm-number">3</span>][<span class="cm-number">6</span>] =  <span class="cm-number">0.172117767533</span>
<span class="cm-variable">a</span>.<span class="cm-property">shape</span> =  (<span class="cm-number">5</span>, <span class="cm-number">10</span>, <span class="cm-number">7</span>)
<span class="cm-variable">y</span>[<span class="cm-number">1</span>][<span class="cm-number">4</span>][<span class="cm-number">3</span>] = <span class="cm-number">0.95087346185</span>
<span class="cm-variable">y</span>.<span class="cm-property">shape</span> =  (<span class="cm-number">2</span>, <span class="cm-number">10</span>, <span class="cm-number">7</span>)
<span class="cm-variable">caches</span>[<span class="cm-number">1</span>][<span class="cm-number">1</span>][<span class="cm-number">1</span>] =
 [ <span class="cm-number">0.82797464</span>  <span class="cm-number">0.23009474</span>  <span class="cm-number">0.76201118</span> <span class="cm-operator">-</span><span class="cm-number">0.22232814</span> <span class="cm-operator">-</span><span class="cm-number">0.20075807</span>  <span class="cm-number">0.18656139</span>
  <span class="cm-number">0.41005165</span>]
<span class="cm-variable">c</span>[<span class="cm-number">1</span>][<span class="cm-number">2</span>][<span class="cm-number">1</span>] <span class="cm-operator">-</span><span class="cm-number">0.855544916718</span>
<span class="cm-builtin">len</span>(<span class="cm-variable">caches</span>) =  <span class="cm-number">2</span>
</code></pre>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59766px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 78px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Congratulations! You have now implemented the forward passes for the basic RNN and the LSTM. When using a deep learning framework, implementing the forward pass is sufficient to build systems that achieve great performance. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The rest of this notebook is optional, and will not be graded.</span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 78px;"></div><div class="CodeMirror-gutters" style="display: none; height: 87px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Congratulations! You have now implemented the forward passes for the basic RNN and the LSTM. When using a deep learning framework, implementing the forward pass is sufficient to build systems that achieve great performance. </p>
<p>The rest of this notebook is optional, and will not be graded.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59766px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 196px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.3333px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 3 - Backpropagation in recurrent neural networks (OPTIONAL / UNGRADED)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">In modern deep learning frameworks, you only have to implement the forward pass, and the framework takes care of the backward pass, so most deep learning engineers do not need to bother with the details of the backward pass. If however you are an expert in calculus and want to see the details of backprop in RNNs, you can work through this optional portion of the notebook. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">When in an earlier <span class="cm-link">[course]</span><span class="cm-string cm-url">(https://www.coursera.org/learn/neural-networks-deep-learning/lecture/0VSHe/derivatives-with-a-computation-graph)</span>  you implemented a simple (fully connected) neural network, you used backpropagation to compute the derivatives with respect to the cost to update the parameters. Similarly, in recurrent neural networks you can calculate the derivatives with respect to the cost in order to update the parameters. The backprop equations are quite complicated and we did not derive them in lecture. However, we will briefly present them below. </span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 196px;"></div><div class="CodeMirror-gutters" style="display: none; height: 205px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="3---Backpropagation-in-recurrent-neural-networks-(OPTIONAL-/-UNGRADED)">3 - Backpropagation in recurrent neural networks (OPTIONAL / UNGRADED)<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#3---Backpropagation-in-recurrent-neural-networks-(OPTIONAL-/-UNGRADED)">¶</a></h2>
<p>In modern deep learning frameworks, you only have to implement the forward pass, and the framework takes care of the backward pass, so most deep learning engineers do not need to bother with the details of the backward pass. If however you are an expert in calculus and want to see the details of backprop in RNNs, you can work through this optional portion of the notebook. </p>
<p>When in an earlier <a href="https://www.coursera.org/learn/neural-networks-deep-learning/lecture/0VSHe/derivatives-with-a-computation-graph" target="_blank">course</a>  you implemented a simple (fully connected) neural network, you used backpropagation to compute the derivatives with respect to the cost to update the parameters. Similarly, in recurrent neural networks you can calculate the derivatives with respect to the cost in order to update the parameters. The backprop equations are quite complicated and we did not derive them in lecture. However, we will briefly present them below. </p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59766px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 61px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Note that this notebook does not implement the backward path from the Loss 'J' backwards to 'a'. This would have included the dense layer and softmax which are a part of the forward path. This is assumed to be calculated elsewhere and the result passed to rnn_backward in 'da'. It is further assumed that loss has been adjusted for batch size (m) and division by the number of examples is not required here.</span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 61px;"></div><div class="CodeMirror-gutters" style="display: none; height: 70px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Note that this notebook does not implement the backward path from the Loss 'J' backwards to 'a'. This would have included the dense layer and softmax which are a part of the forward path. This is assumed to be calculated elsewhere and the result passed to rnn_backward in 'da'. It is further assumed that loss has been adjusted for batch size (m) and division by the number of examples is not required here.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 44px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.666px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">This section is optional and ungraded. It is more difficult and has fewer details regarding its implementation. This section only implements key elements of the full path.</span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 53px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>This section is optional and ungraded. It is more difficult and has fewer details regarding its implementation. This section only implements key elements of the full path.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 161px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### 3.1 - Basic RNN  backward pass</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">We will start by computing the backward pass for the basic RNN-cell and then in the following sections, iterate through the cells.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/rnn_backward_overview_3a_1.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:500;height:300px;"</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> **Figure 6**: RNN-cell's backward pass. Just like in a fully-connected neural network, the derivative of the cost function <span class="cm-delimit cm-delimit-open">$</span>J<span class="cm-delimit cm-delimit-close">$</span> backpropagates through the time steps of the RNN by following the chain-rule from calculus. Internal to the cell, the chain-rule is also used to calculate <span class="cm-delimit cm-delimit-open">$</span>(<span class="cm-tag">\frac</span><span class="cm-bracket">{</span><span class="cm-tag">\partial</span> J<span class="cm-bracket">}{</span><span class="cm-tag">\partial</span> W_<span class="cm-bracket">{</span>ax<span class="cm-bracket">}}</span>,<span class="cm-tag">\frac</span><span class="cm-bracket">{</span><span class="cm-tag">\partial</span> J<span class="cm-bracket">}{</span><span class="cm-tag">\partial</span> W_<span class="cm-bracket">{</span>aa<span class="cm-bracket">}}</span>,<span class="cm-tag">\frac</span><span class="cm-bracket">{</span><span class="cm-tag">\partial</span> J<span class="cm-bracket">}{</span><span class="cm-tag">\partial</span> b<span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span> to update the parameters <span class="cm-delimit cm-delimit-open">$</span>(W_<span class="cm-bracket">{</span>ax<span class="cm-bracket">}</span>, W_<span class="cm-bracket">{</span>aa<span class="cm-bracket">}</span>, b_a)<span class="cm-delimit cm-delimit-close">$</span>. The operation can utilize the cached results from the forward path. <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 161px;"></div><div class="CodeMirror-gutters" style="display: none; height: 170px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="3.1---Basic-RNN--backward-pass">3.1 - Basic RNN  backward pass<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#3.1---Basic-RNN--backward-pass">¶</a></h3>
<p>We will start by computing the backward pass for the basic RNN-cell and then in the following sections, iterate through the cells.</p>
<p><img src="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/rnn_backward_overview_3a_1.png" style="width: 500 ; height: 300px"> <br></p>
<center> <strong>Figure 6</strong>: RNN-cell's backward pass. Just like in a fully-connected neural network, the derivative of the cost function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-225-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2671" role="math" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1000.48em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2672"><span class="mi" id="MathJax-Span-2673" style="font-family: STIXMathJax_Main-italic; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi></math></span></span><script type="math/tex" id="MathJax-Element-225">J</script> backpropagates through the time steps of the RNN by following the chain-rule from calculus. Internal to the cell, the chain-rule is also used to calculate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-226-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2674" role="math" style="width: 7.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.253em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1006.19em, 2.979em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2675"><span class="mo" id="MathJax-Span-2676" style="font-family: STIXMathJax_Main;">(</span><span class="mfrac" id="MathJax-Span-2677"><span style="display: inline-block; position: relative; width: 1.551em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.336em, 1000.66em, 4.17em, -999.997em); top: -4.402em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-2678"><span class="mi" id="MathJax-Span-2679" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-2680" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1001.43em, 4.289em, -999.997em); top: -3.568em; left: 50%; margin-left: -0.711em;"><span class="mrow" id="MathJax-Span-2681"><span class="mi" id="MathJax-Span-2682" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="msubsup" id="MathJax-Span-2683"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2684" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.866em; left: 0.598em;"><span class="texatom" id="MathJax-Span-2685"><span class="mrow" id="MathJax-Span-2686"><span class="mi" id="MathJax-Span-2687" style="font-size: 50%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-2688" style="font-size: 50%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1001.55em, 1.253em, -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.551em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="mo" id="MathJax-Span-2689" style="font-family: STIXMathJax_Main;">,</span><span class="mfrac" id="MathJax-Span-2690" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.336em, 1000.66em, 4.17em, -999.997em); top: -4.402em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-2691"><span class="mi" id="MathJax-Span-2692" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-2693" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1001.49em, 4.289em, -999.997em); top: -3.568em; left: 50%; margin-left: -0.711em;"><span class="mrow" id="MathJax-Span-2694"><span class="mi" id="MathJax-Span-2695" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="msubsup" id="MathJax-Span-2696"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2697" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.866em; left: 0.598em;"><span class="texatom" id="MathJax-Span-2698"><span class="mrow" id="MathJax-Span-2699"><span class="mi" id="MathJax-Span-2700" style="font-size: 50%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-2701" style="font-size: 50%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1001.61em, 1.253em, -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.61em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="mo" id="MathJax-Span-2702" style="font-family: STIXMathJax_Main;">,</span><span class="mfrac" id="MathJax-Span-2703" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.336em, 1000.66em, 4.17em, -999.997em); top: -4.402em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-2704"><span class="mi" id="MathJax-Span-2705" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-2706" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.66em, 4.17em, -999.997em); top: -3.568em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-2707"><span class="mi" id="MathJax-Span-2708" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-2709" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">b</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.84em, 1.253em, -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.836em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="mo" id="MathJax-Span-2710" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>x</mi></mrow></msub></mrow></mfrac><mo>,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>a</mi></mrow></msub></mrow></mfrac><mo>,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>b</mi></mrow></mfrac><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-226">(\frac{\partial J}{\partial W_{ax}},\frac{\partial J}{\partial W_{aa}},\frac{\partial J}{\partial b})</script> to update the parameters <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-227-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2711" role="math" style="width: 6.908em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.717em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em, 1005.66em, 2.682em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2712"><span class="mo" id="MathJax-Span-2713" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2714"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2715" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-2716"><span class="mrow" id="MathJax-Span-2717"><span class="mi" id="MathJax-Span-2718" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-2719" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2720" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2721" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2722" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-2723"><span class="mrow" id="MathJax-Span-2724"><span class="mi" id="MathJax-Span-2725" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-2726" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2727" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2728" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2729" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-2730" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2731" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>x</mi></mrow></msub><mo>,</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>a</mi></mrow></msub><mo>,</mo><msub><mi>b</mi><mi>a</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-227">(W_{ax}, W_{aa}, b_a)</script>. The operation can utilize the cached results from the forward path. </center></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 44px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.666px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Recall from lecture, the shorthand for the partial derivative of cost relative to a variable is dVariable. For example, <span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\frac</span><span class="cm-bracket">{</span><span class="cm-tag">\partial</span> J<span class="cm-bracket">}{</span><span class="cm-tag">\partial</span> W_<span class="cm-bracket">{</span>ax<span class="cm-bracket">}}</span><span class="cm-delimit cm-delimit-close">$</span> is <span class="cm-delimit cm-delimit-open">$</span>dW_<span class="cm-bracket">{</span>ax<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span>. This will be used throughout the remaining sections.</span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 53px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Recall from lecture, the shorthand for the partial derivative of cost relative to a variable is dVariable. For example, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-228-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2732" role="math" style="width: 2.146em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.79em, 2.801em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2733"><span class="mfrac" id="MathJax-Span-2734"><span style="display: inline-block; position: relative; width: 1.551em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.336em, 1000.66em, 4.17em, -999.997em); top: -4.402em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-2735"><span class="mi" id="MathJax-Span-2736" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-2737" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1001.43em, 4.289em, -999.997em); top: -3.568em; left: 50%; margin-left: -0.711em;"><span class="mrow" id="MathJax-Span-2738"><span class="mi" id="MathJax-Span-2739" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="msubsup" id="MathJax-Span-2740"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2741" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.866em; left: 0.598em;"><span class="texatom" id="MathJax-Span-2742"><span class="mrow" id="MathJax-Span-2743"><span class="mi" id="MathJax-Span-2744" style="font-size: 50%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-2745" style="font-size: 50%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1001.55em, 1.253em, -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.551em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>x</mi></mrow></msub></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-228">\frac{\partial J}{\partial W_{ax}}</script> is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-229-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2746" role="math" style="width: 2.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.15em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2747"><span class="mi" id="MathJax-Span-2748" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-2749"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2750" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-2751"><span class="mrow" id="MathJax-Span-2752"><span class="mi" id="MathJax-Span-2753" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-2754" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>x</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-229">dW_{ax}</script>. This will be used throughout the remaining sections.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 127px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/rnn_cell_backward_3a_4.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:500;height:300px;"</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> **Figure 7**: This implementation of rnn_cell_backward does not include the output dense layer and softmax which are included in rnn_cell_forward. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span>da_<span class="cm-bracket">{</span>next<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> is <span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\frac</span><span class="cm-bracket">{</span><span class="cm-tag">\partial</span><span class="cm-bracket">{</span>J<span class="cm-bracket">}}{</span><span class="cm-tag">\partial</span> a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}}</span><span class="cm-delimit cm-delimit-close">$</span> and includes loss from previous stages and current stage output logic. This addition will be part of your implementation of rnn_backward. &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 127px;"></div><div class="CodeMirror-gutters" style="display: none; height: 136px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><img src="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/rnn_cell_backward_3a_4.png" style="width: 500 ; height: 300px"> <br></p>
<center> <strong>Figure 7</strong>: This implementation of rnn_cell_backward does not include the output dense layer and softmax which are included in rnn_cell_forward. 

<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-230-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2755" role="math" style="width: 2.741em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.265em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.26em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2756"><span class="mi" id="MathJax-Span-2757" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-2758"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2759" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2760"><span class="mrow" id="MathJax-Span-2761"><span class="mi" id="MathJax-Span-2762" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span class="mi" id="MathJax-Span-2763" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-2764" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2765" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-230">da_{next}</script> is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-231-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2766" role="math" style="width: 2.027em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.67em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.67em, 2.801em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2767"><span class="mfrac" id="MathJax-Span-2768"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.336em, 1000.66em, 4.17em, -999.997em); top: -4.402em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-2769"><span class="mi" id="MathJax-Span-2770" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="texatom" id="MathJax-Span-2771"><span class="mrow" id="MathJax-Span-2772"><span class="mi" id="MathJax-Span-2773" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.277em, 1001.31em, 4.17em, -999.997em); top: -3.509em; left: 50%; margin-left: -0.652em;"><span class="mrow" id="MathJax-Span-2774"><span class="mi" id="MathJax-Span-2775" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="msubsup" id="MathJax-Span-2776"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2777" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.164em; left: 0.36em;"><span class="texatom" id="MathJax-Span-2778"><span class="mrow" id="MathJax-Span-2779"><span class="mo" id="MathJax-Span-2780" style="font-size: 50%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2781" style="font-size: 50%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2782" style="font-size: 50%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1001.43em, 1.253em, -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.432em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi>J</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-231">\frac{\partial{J}}{\partial a^{\langle t \rangle}}</script> and includes loss from previous stages and current stage output logic. This addition will be part of your implementation of rnn_backward.  </center></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59766px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 363px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.3333px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-5">##### Equations</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">To compute the rnn_cell_backward you can utilize the following equations. It is a good exercise to derive them by hand. Here, <span class="cm-delimit cm-delimit-open">$</span>*<span class="cm-delimit cm-delimit-close">$</span> denotes element-wise multiplication while the absence of a symbol indicates matrix multiplication.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> = <span class="cm-tag">\tanh</span>(W_<span class="cm-bracket">{</span>ax<span class="cm-bracket">}</span> x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> + W_<span class="cm-bracket">{</span>aa<span class="cm-bracket">}</span> a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> + b_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>)<span class="cm-tag">\tag</span><span class="cm-bracket">{</span>-<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\displaystyle</span> <span class="cm-tag">\frac</span><span class="cm-bracket">{</span><span class="cm-tag">\partial</span> <span class="cm-tag">\tanh</span>(x)<span class="cm-bracket">}</span> <span class="cm-bracket">{</span><span class="cm-tag">\partial</span> x<span class="cm-bracket">}</span> = 1 - <span class="cm-tag">\tanh</span>^2(x) <span class="cm-tag">\tag</span><span class="cm-bracket">{</span>-<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\displaystyle</span> &nbsp;<span class="cm-bracket">{</span>dW_<span class="cm-bracket">{</span>ax<span class="cm-bracket">}}</span> = da_<span class="cm-bracket">{</span>next<span class="cm-bracket">}</span> * ( 1-<span class="cm-tag">\tanh</span>^2(W_<span class="cm-bracket">{</span>ax<span class="cm-bracket">}</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>+W_<span class="cm-bracket">{</span>aa<span class="cm-bracket">}</span> a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> + b_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>) ) x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span> T<span class="cm-bracket">}</span><span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">1</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\displaystyle</span> dW_<span class="cm-bracket">{</span>aa<span class="cm-bracket">}</span> = da_<span class="cm-bracket">{</span>next<span class="cm-bracket">}</span> * (( 1-<span class="cm-tag">\tanh</span>^2(W_<span class="cm-bracket">{</span>ax<span class="cm-bracket">}</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>+W_<span class="cm-bracket">{</span>aa<span class="cm-bracket">}</span> a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> + b_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>) )  a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span> T<span class="cm-bracket">}</span><span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">2</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\displaystyle</span> db_a = da_<span class="cm-bracket">{</span>next<span class="cm-bracket">}</span> * <span class="cm-tag">\sum</span>_<span class="cm-bracket">{</span>batch<span class="cm-bracket">}</span>( 1-<span class="cm-tag">\tanh</span>^2(W_<span class="cm-bracket">{</span>ax<span class="cm-bracket">}</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>+W_<span class="cm-bracket">{</span>aa<span class="cm-bracket">}</span> a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> + b_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>) )<span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">3</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\displaystyle</span> dx^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> = da_<span class="cm-bracket">{</span>next<span class="cm-bracket">}</span> * <span class="cm-bracket">{</span> W_<span class="cm-bracket">{</span>ax<span class="cm-bracket">}}</span>^T ( 1-<span class="cm-tag">\tanh</span>^2(W_<span class="cm-bracket">{</span>ax<span class="cm-bracket">}</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>+W_<span class="cm-bracket">{</span>aa<span class="cm-bracket">}</span> a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> + b_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>) )<span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">4</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\displaystyle</span> da_<span class="cm-bracket">{</span>prev<span class="cm-bracket">}</span> = da_<span class="cm-bracket">{</span>next<span class="cm-bracket">}</span> * <span class="cm-bracket">{</span> W_<span class="cm-bracket">{</span>aa<span class="cm-bracket">}}</span>^T ( 1-<span class="cm-tag">\tanh</span>^2(W_<span class="cm-bracket">{</span>ax<span class="cm-bracket">}</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>+W_<span class="cm-bracket">{</span>aa<span class="cm-bracket">}</span> a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> + b_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>) )<span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">5</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 363px;"></div><div class="CodeMirror-gutters" style="display: none; height: 372px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h5 id="Equations">Equations<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Equations">¶</a></h5>
<p>To compute the rnn_cell_backward you can utilize the following equations. It is a good exercise to derive them by hand. Here, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-232-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2783" role="math" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.729em, 1000.42em, 2.503em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2784"><span class="mo" id="MathJax-Span-2785" style="font-family: STIXMathJax_Main;">∗</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: 0.004em; border-left: 0px solid; width: 0px; height: 0.646em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>∗</mo></math></span></span><script type="math/tex" id="MathJax-Element-232">*</script> denotes element-wise multiplication while the absence of a symbol indicates matrix multiplication.</p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-233-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable displaystyle=&quot;false&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn--&quot;&gt;&lt;mtext&gt;(-)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;tanh&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2786" role="math" style="width: 100%; display: inline-block; min-width: 18.813em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 18.813em;"><span style="position: absolute; clip: rect(3.039em, 1015em, 4.467em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-2787"><span class="mtable" id="MathJax-Span-2788" style="min-width: 18.813em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 18.813em;"><span style="display: inline-block; position: absolute; width: 15.003em; height: 0px; clip: rect(-0.949em, 1015em, 0.479em, -999.997em); top: 0.003em; left: 50%; margin-left: -7.497em;"><span style="position: absolute; clip: rect(3.039em, 1015em, 4.408em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 15.003em; height: 0px;"><span style="position: absolute; clip: rect(2.92em, 1015em, 4.348em, -999.997em); top: -3.926em; left: 50%; margin-left: -7.497em;"><span class="mtd" id="MathJax-Span-2792"><span class="mrow" id="MathJax-Span-2793"><span class="msubsup" id="MathJax-Span-2794"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2795" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2796"><span class="mrow" id="MathJax-Span-2797"><span class="mo" id="MathJax-Span-2798" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2799" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2800" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2801" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-2802" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">tanh</span><span class="mo" id="MathJax-Span-2803"></span><span class="mo" id="MathJax-Span-2804" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2805"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2806" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-2807"><span class="mrow" id="MathJax-Span-2808"><span class="mi" id="MathJax-Span-2809" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-2810" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2811"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2812" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2813"><span class="mrow" id="MathJax-Span-2814"><span class="mo" id="MathJax-Span-2815" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2816" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2817" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2818" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-2819" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2820" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-2821"><span class="mrow" id="MathJax-Span-2822"><span class="mi" id="MathJax-Span-2823" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-2824" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2825"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2826" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2827"><span class="mrow" id="MathJax-Span-2828"><span class="mo" id="MathJax-Span-2829" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2830" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2831" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-2832" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-2833" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2834" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-2835" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2836" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2837"><span class="mrow" id="MathJax-Span-2838"><span class="mi" id="MathJax-Span-2839" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2840" style="font-family: STIXMathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.015em; height: 0px; clip: rect(-0.771em, 1000.96em, 0.42em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1000.96em, 4.348em, -999.997em); top: -3.926em; right: 0.003em;"><span class="mtd" id="mjx-eqn--"><span class="mrow" id="MathJax-Span-2790"><span class="mtext" id="MathJax-Span-2791" style="font-family: STIXMathJax_Main;">(-)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="false"><mlabeledtr><mtd id="mjx-eqn--"><mtext>(-)</mtext></mtd><mtd><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>=</mo><mi>tanh</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>x</mi></mrow></msub><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>a</mi></mrow></msub><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo stretchy="false">)</mo></mtd></mlabeledtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-233">a^{\langle t \rangle} = \tanh(W_{ax} x^{\langle t \rangle} + W_{aa} a^{\langle t-1 \rangle} + b_{a})\tag{-}</script></p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-234-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable displaystyle=&quot;false&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn--_1&quot;&gt;&lt;mtext&gt;(-)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;tanh&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;tanh&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2841" role="math" style="width: 100%; display: inline-block; min-width: 13.872em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 13.872em;"><span style="position: absolute; clip: rect(2.562em, 1010em, 4.943em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-2842"><span class="mtable" id="MathJax-Span-2843" style="min-width: 13.872em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 13.872em;"><span style="display: inline-block; position: absolute; width: 10.063em; height: 0px; clip: rect(-1.426em, 1010em, 0.955em, -999.997em); top: 0.003em; left: 50%; margin-left: -5.057em;"><span style="position: absolute; clip: rect(2.562em, 1010em, 4.943em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 10.063em; height: 0px;"><span style="position: absolute; clip: rect(2.443em, 1010em, 4.884em, -999.997em); top: -3.926em; left: 50%; margin-left: -5.057em;"><span class="mtd" id="MathJax-Span-2847"><span class="mrow" id="MathJax-Span-2848"><span class="mstyle" id="MathJax-Span-2849"><span class="mrow" id="MathJax-Span-2850"><span class="mfrac" id="MathJax-Span-2851"><span style="display: inline-block; position: relative; width: 3.634em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em, 1003.46em, 4.348em, -999.997em); top: -4.64em; left: 50%; margin-left: -1.723em;"><span class="mrow" id="MathJax-Span-2852"><span class="mi" id="MathJax-Span-2853" style="font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-2854" style="font-family: STIXMathJax_Main; padding-left: 0.182em;">tanh</span><span class="mo" id="MathJax-Span-2855"></span><span class="mo" id="MathJax-Span-2856" style="font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-2857" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2858" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.271em; left: 50%; margin-left: -0.473em;"><span class="mrow" id="MathJax-Span-2859"><span class="mi" id="MathJax-Span-2860" style="font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-2861" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1003.63em, 1.253em, -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 3.634em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="mo" id="MathJax-Span-2862" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-2863" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">1</span><span class="mo" id="MathJax-Span-2864" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="msubsup" id="MathJax-Span-2865" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1001.73em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2866" style="font-family: STIXMathJax_Main;">tanh</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 1.729em;"><span class="mn" id="MathJax-Span-2867" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2868"></span><span class="mo" id="MathJax-Span-2869" style="font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-2870" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2871" style="font-family: STIXMathJax_Main;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.015em; height: 0px; clip: rect(-0.771em, 1000.96em, 0.42em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1000.96em, 4.348em, -999.997em); top: -3.926em; right: 0.003em;"><span class="mtd" id="mjx-eqn--_1"><span class="mrow" id="MathJax-Span-2845"><span class="mtext" id="MathJax-Span-2846" style="font-family: STIXMathJax_Main;">(-)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.996em; border-left: 0px solid; width: 0px; height: 2.646em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="false"><mlabeledtr><mtd id="mjx-eqn--_1"><mtext>(-)</mtext></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>tanh</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>tanh</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mstyle></mtd></mlabeledtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-234">\displaystyle \frac{\partial \tanh(x)} {\partial x} = 1 - \tanh^2(x) \tag{-}</script></p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-235-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable displaystyle=&quot;false&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-1_1&quot;&gt;&lt;mtext&gt;(1)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;tanh&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2872" role="math" style="width: 100%; display: inline-block; min-width: 27.741em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 27.741em;"><span style="position: absolute; clip: rect(2.979em, 1023.63em, 4.467em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-2873"><span class="mtable" id="MathJax-Span-2874" style="min-width: 27.741em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 27.741em;"><span style="display: inline-block; position: absolute; width: 23.634em; height: 0px; clip: rect(-1.009em, 1023.63em, 0.479em, -999.997em); top: 0.003em; left: 50%; margin-left: -11.842em;"><span style="position: absolute; clip: rect(2.979em, 1023.63em, 4.467em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 23.634em; height: 0px;"><span style="position: absolute; clip: rect(2.92em, 1023.63em, 4.348em, -999.997em); top: -3.866em; left: 50%; margin-left: -11.842em;"><span class="mtd" id="MathJax-Span-2878"><span class="mrow" id="MathJax-Span-2879"><span class="mstyle" id="MathJax-Span-2880"><span class="mrow" id="MathJax-Span-2881"><span class="texatom" id="MathJax-Span-2882"><span class="mrow" id="MathJax-Span-2883"><span class="mi" id="MathJax-Span-2884" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-2885"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2886" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-2887"><span class="mrow" id="MathJax-Span-2888"><span class="mi" id="MathJax-Span-2889" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-2890" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2891" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-2892" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.301em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-2893"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2894" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2895"><span class="mrow" id="MathJax-Span-2896"><span class="mi" id="MathJax-Span-2897" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span class="mi" id="MathJax-Span-2898" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-2899" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2900" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2901" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="mo" id="MathJax-Span-2902" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">(</span><span class="mn" id="MathJax-Span-2903" style="font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-2904" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="msubsup" id="MathJax-Span-2905" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1001.73em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2906" style="font-family: STIXMathJax_Main;">tanh</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 1.729em;"><span class="mn" id="MathJax-Span-2907" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2908"></span><span class="mo" id="MathJax-Span-2909" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2910"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2911" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-2912"><span class="mrow" id="MathJax-Span-2913"><span class="mi" id="MathJax-Span-2914" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-2915" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2916"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2917" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2918"><span class="mrow" id="MathJax-Span-2919"><span class="mo" id="MathJax-Span-2920" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2921" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2922" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2923" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-2924" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2925" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-2926"><span class="mrow" id="MathJax-Span-2927"><span class="mi" id="MathJax-Span-2928" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-2929" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2930"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2931" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2932"><span class="mrow" id="MathJax-Span-2933"><span class="mo" id="MathJax-Span-2934" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2935" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2936" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-2937" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-2938" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2939" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-2940" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2941" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2942"><span class="mrow" id="MathJax-Span-2943"><span class="mi" id="MathJax-Span-2944" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2945" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-2946" style="font-family: STIXMathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-2947"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2948" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2949"><span class="mrow" id="MathJax-Span-2950"><span class="mo" id="MathJax-Span-2951" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-2952" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2953" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span><span class="mi" id="MathJax-Span-2954" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.193em; height: 0px; clip: rect(-0.771em, 1001.13em, 0.479em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.13em, 4.348em, -999.997em); top: -3.866em; right: 0.003em;"><span class="mtd" id="mjx-eqn-1_1"><span class="mrow" id="MathJax-Span-2876"><span class="mtext" id="MathJax-Span-2877" style="font-family: STIXMathJax_Main;">(1)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="false"><mlabeledtr><mtd id="mjx-eqn-1_1"><mtext>(1)</mtext></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>x</mi></mrow></msub></mrow><mo>=</mo><mi>d</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo>∗</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msup><mi>tanh</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>x</mi></mrow></msub><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>a</mi></mrow></msub><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo><mi>T</mi></mrow></msup></mstyle></mtd></mlabeledtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-235">\displaystyle  {dW_{ax}} = da_{next} * ( 1-\tanh^2(W_{ax}x^{\langle t \rangle}+W_{aa} a^{\langle t-1 \rangle} + b_{a}) ) x^{\langle t \rangle T}\tag{1}</script></p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-236-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable displaystyle=&quot;false&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-2_1&quot;&gt;&lt;mtext&gt;(2)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;tanh&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2955" role="math" style="width: 100%; display: inline-block; min-width: 28.991em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 28.991em;"><span style="position: absolute; clip: rect(2.979em, 1024.82em, 4.467em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-2956"><span class="mtable" id="MathJax-Span-2957" style="min-width: 28.991em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 28.991em;"><span style="display: inline-block; position: absolute; width: 24.824em; height: 0px; clip: rect(-1.009em, 1024.82em, 0.479em, -999.997em); top: 0.003em; left: 50%; margin-left: -12.437em;"><span style="position: absolute; clip: rect(2.979em, 1024.82em, 4.467em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 24.824em; height: 0px;"><span style="position: absolute; clip: rect(2.92em, 1024.82em, 4.348em, -999.997em); top: -3.866em; left: 50%; margin-left: -12.437em;"><span class="mtd" id="MathJax-Span-2961"><span class="mrow" id="MathJax-Span-2962"><span class="mstyle" id="MathJax-Span-2963"><span class="mrow" id="MathJax-Span-2964"><span class="mi" id="MathJax-Span-2965" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-2966"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2967" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-2968"><span class="mrow" id="MathJax-Span-2969"><span class="mi" id="MathJax-Span-2970" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-2971" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2972" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-2973" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.301em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-2974"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2975" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-2976"><span class="mrow" id="MathJax-Span-2977"><span class="mi" id="MathJax-Span-2978" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span class="mi" id="MathJax-Span-2979" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-2980" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2981" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2982" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="mo" id="MathJax-Span-2983" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">(</span><span class="mo" id="MathJax-Span-2984" style="font-family: STIXMathJax_Main;">(</span><span class="mn" id="MathJax-Span-2985" style="font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-2986" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="msubsup" id="MathJax-Span-2987" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1001.73em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2988" style="font-family: STIXMathJax_Main;">tanh</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 1.729em;"><span class="mn" id="MathJax-Span-2989" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-2990"></span><span class="mo" id="MathJax-Span-2991" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2992"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2993" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-2994"><span class="mrow" id="MathJax-Span-2995"><span class="mi" id="MathJax-Span-2996" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-2997" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2998"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-2999" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3000"><span class="mrow" id="MathJax-Span-3001"><span class="mo" id="MathJax-Span-3002" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3003" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3004" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3005" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-3006" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3007" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-3008"><span class="mrow" id="MathJax-Span-3009"><span class="mi" id="MathJax-Span-3010" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-3011" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3012"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3013" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3014"><span class="mrow" id="MathJax-Span-3015"><span class="mo" id="MathJax-Span-3016" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3017" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3018" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-3019" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-3020" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3021" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-3022" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3023" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3024"><span class="mrow" id="MathJax-Span-3025"><span class="mi" id="MathJax-Span-3026" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3027" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-3028" style="font-family: STIXMathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-3029"><span style="display: inline-block; position: relative; width: 2.622em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3030" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3031"><span class="mrow" id="MathJax-Span-3032"><span class="mo" id="MathJax-Span-3033" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3034" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3035" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-3036" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-3037" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span><span class="mi" id="MathJax-Span-3038" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.193em; height: 0px; clip: rect(-0.771em, 1001.13em, 0.479em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.13em, 4.348em, -999.997em); top: -3.866em; right: 0.003em;"><span class="mtd" id="mjx-eqn-2_1"><span class="mrow" id="MathJax-Span-2959"><span class="mtext" id="MathJax-Span-2960" style="font-family: STIXMathJax_Main;">(2)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="false"><mlabeledtr><mtd id="mjx-eqn-2_1"><mtext>(2)</mtext></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mi>d</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>a</mi></mrow></msub><mo>=</mo><mi>d</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo>∗</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msup><mi>tanh</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>x</mi></mrow></msub><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>a</mi></mrow></msub><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo><mi>T</mi></mrow></msup></mstyle></mtd></mlabeledtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-236">\displaystyle dW_{aa} = da_{next} * (( 1-\tanh^2(W_{ax}x^{\langle t \rangle}+W_{aa} a^{\langle t-1 \rangle} + b_{a}) )  a^{\langle t-1 \rangle T}\tag{2}</script></p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-237-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable displaystyle=&quot;false&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-3_1&quot;&gt;&lt;mtext&gt;(3)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;tanh&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3039" role="math" style="width: 100%; display: inline-block; min-width: 26.908em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 26.908em;"><span style="position: absolute; clip: rect(2.443em, 1022.74em, 5.063em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-3040"><span class="mtable" id="MathJax-Span-3041" style="min-width: 26.908em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 26.908em;"><span style="display: inline-block; position: absolute; width: 22.801em; height: 0px; clip: rect(-1.545em, 1022.74em, 1.074em, -999.997em); top: 0.003em; left: 50%; margin-left: -11.366em;"><span style="position: absolute; clip: rect(2.443em, 1022.74em, 5.063em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 22.801em; height: 0px;"><span style="position: absolute; clip: rect(2.86em, 1022.74em, 5.42em, -999.997em); top: -4.402em; left: 50%; margin-left: -11.366em;"><span class="mtd" id="MathJax-Span-3045"><span class="mrow" id="MathJax-Span-3046"><span class="mstyle" id="MathJax-Span-3047"><span class="mrow" id="MathJax-Span-3048"><span class="mi" id="MathJax-Span-3049" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3050"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3051" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-3052" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3053" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-3054" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.301em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3055"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3056" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3057"><span class="mrow" id="MathJax-Span-3058"><span class="mi" id="MathJax-Span-3059" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span class="mi" id="MathJax-Span-3060" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3061" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3062" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3063" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="munderover" id="MathJax-Span-3064" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(2.86em, 1001.19em, 4.646em, -999.997em); top: -3.985em; left: 0.122em;"><span class="mo" id="MathJax-Span-3065" style="font-family: STIXMathJax_Size1; vertical-align: -0.533em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1001.55em, 4.289em, -999.997em); top: -2.854em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3066"><span class="mrow" id="MathJax-Span-3067"><span class="mi" id="MathJax-Span-3068" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span class="mi" id="MathJax-Span-3069" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-3070" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3071" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span class="mi" id="MathJax-Span-3072" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3073" style="font-family: STIXMathJax_Main;">(</span><span class="mn" id="MathJax-Span-3074" style="font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-3075" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="msubsup" id="MathJax-Span-3076" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1001.73em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3077" style="font-family: STIXMathJax_Main;">tanh</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 1.729em;"><span class="mn" id="MathJax-Span-3078" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3079"></span><span class="mo" id="MathJax-Span-3080" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3081"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3082" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-3083"><span class="mrow" id="MathJax-Span-3084"><span class="mi" id="MathJax-Span-3085" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-3086" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3087"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3088" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3089"><span class="mrow" id="MathJax-Span-3090"><span class="mo" id="MathJax-Span-3091" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3092" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3093" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3094" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-3095" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3096" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-3097"><span class="mrow" id="MathJax-Span-3098"><span class="mi" id="MathJax-Span-3099" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-3100" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3101"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3102" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3103"><span class="mrow" id="MathJax-Span-3104"><span class="mo" id="MathJax-Span-3105" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3106" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3107" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-3108" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-3109" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3110" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-3111" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3112" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3113"><span class="mrow" id="MathJax-Span-3114"><span class="mi" id="MathJax-Span-3115" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3116" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-3117" style="font-family: STIXMathJax_Main;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.193em; height: 0px; clip: rect(-1.247em, 1001.13em, -0.057em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.13em, 4.348em, -999.997em); top: -4.402em; right: 0.003em;"><span class="mtd" id="mjx-eqn-3_1"><span class="mrow" id="MathJax-Span-3043"><span class="mtext" id="MathJax-Span-3044" style="font-family: STIXMathJax_Main;">(3)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.139em; border-left: 0px solid; width: 0px; height: 2.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="false"><mlabeledtr><mtd id="mjx-eqn-3_1"><mtext>(3)</mtext></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mi>d</mi><msub><mi>b</mi><mi>a</mi></msub><mo>=</mo><mi>d</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo>∗</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi></mrow></munder><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msup><mi>tanh</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>x</mi></mrow></msub><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>a</mi></mrow></msub><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mstyle></mtd></mlabeledtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-237">\displaystyle db_a = da_{next} * \sum_{batch}( 1-\tanh^2(W_{ax}x^{\langle t \rangle}+W_{aa} a^{\langle t-1 \rangle} + b_{a}) )\tag{3}</script></p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-238-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable displaystyle=&quot;false&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-4_1&quot;&gt;&lt;mtext&gt;(4)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;tanh&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3118" role="math" style="width: 100%; display: inline-block; min-width: 27.86em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 27.86em;"><span style="position: absolute; clip: rect(2.979em, 1023.63em, 4.467em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-3119"><span class="mtable" id="MathJax-Span-3120" style="min-width: 27.86em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 27.86em;"><span style="display: inline-block; position: absolute; width: 23.693em; height: 0px; clip: rect(-1.009em, 1023.63em, 0.479em, -999.997em); top: 0.003em; left: 50%; margin-left: -11.842em;"><span style="position: absolute; clip: rect(2.979em, 1023.63em, 4.467em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 23.693em; height: 0px;"><span style="position: absolute; clip: rect(2.92em, 1023.63em, 4.348em, -999.997em); top: -3.866em; left: 50%; margin-left: -11.842em;"><span class="mtd" id="MathJax-Span-3124"><span class="mrow" id="MathJax-Span-3125"><span class="mstyle" id="MathJax-Span-3126"><span class="mrow" id="MathJax-Span-3127"><span class="mi" id="MathJax-Span-3128" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3129"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3130" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3131"><span class="mrow" id="MathJax-Span-3132"><span class="mo" id="MathJax-Span-3133" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3134" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3135" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3136" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-3137" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.301em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3138"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3139" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3140"><span class="mrow" id="MathJax-Span-3141"><span class="mi" id="MathJax-Span-3142" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span class="mi" id="MathJax-Span-3143" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3144" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3145" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3146" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="msubsup" id="MathJax-Span-3147" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1001.61em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3148"><span class="mrow" id="MathJax-Span-3149"><span class="msubsup" id="MathJax-Span-3150"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3151" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-3152"><span class="mrow" id="MathJax-Span-3153"><span class="mi" id="MathJax-Span-3154" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-3155" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 1.61em;"><span class="mi" id="MathJax-Span-3156" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3157" style="font-family: STIXMathJax_Main;">(</span><span class="mn" id="MathJax-Span-3158" style="font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-3159" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="msubsup" id="MathJax-Span-3160" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1001.73em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3161" style="font-family: STIXMathJax_Main;">tanh</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 1.729em;"><span class="mn" id="MathJax-Span-3162" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3163"></span><span class="mo" id="MathJax-Span-3164" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3165"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3166" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-3167"><span class="mrow" id="MathJax-Span-3168"><span class="mi" id="MathJax-Span-3169" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-3170" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3171"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3172" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3173"><span class="mrow" id="MathJax-Span-3174"><span class="mo" id="MathJax-Span-3175" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3176" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3177" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3178" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-3179" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3180" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-3181"><span class="mrow" id="MathJax-Span-3182"><span class="mi" id="MathJax-Span-3183" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-3184" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3185"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3186" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3187"><span class="mrow" id="MathJax-Span-3188"><span class="mo" id="MathJax-Span-3189" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3190" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3191" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-3192" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-3193" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3194" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-3195" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3196" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3197"><span class="mrow" id="MathJax-Span-3198"><span class="mi" id="MathJax-Span-3199" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3200" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-3201" style="font-family: STIXMathJax_Main;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.193em; height: 0px; clip: rect(-0.771em, 1001.13em, 0.479em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.13em, 4.348em, -999.997em); top: -3.866em; right: 0.003em;"><span class="mtd" id="mjx-eqn-4_1"><span class="mrow" id="MathJax-Span-3122"><span class="mtext" id="MathJax-Span-3123" style="font-family: STIXMathJax_Main;">(4)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="false"><mlabeledtr><mtd id="mjx-eqn-4_1"><mtext>(4)</mtext></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mi>d</mi><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>=</mo><mi>d</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo>∗</mo><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>x</mi></mrow></msub></mrow><mi>T</mi></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msup><mi>tanh</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>x</mi></mrow></msub><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>a</mi></mrow></msub><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mstyle></mtd></mlabeledtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-238">\displaystyle dx^{\langle t \rangle} = da_{next} * { W_{ax}}^T ( 1-\tanh^2(W_{ax}x^{\langle t \rangle}+W_{aa} a^{\langle t-1 \rangle} + b_{a}) )\tag{4}</script></p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-239-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable displaystyle=&quot;false&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-5_1&quot;&gt;&lt;mtext&gt;(5)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;tanh&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3202" role="math" style="width: 100%; display: inline-block; min-width: 28.396em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 28.396em;"><span style="position: absolute; clip: rect(2.979em, 1024.23em, 4.527em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-3203"><span class="mtable" id="MathJax-Span-3204" style="min-width: 28.396em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 28.396em;"><span style="display: inline-block; position: absolute; width: 24.229em; height: 0px; clip: rect(-1.009em, 1024.23em, 0.539em, -999.997em); top: 0.003em; left: 50%; margin-left: -12.14em;"><span style="position: absolute; clip: rect(2.979em, 1024.23em, 4.527em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 24.229em; height: 0px;"><span style="position: absolute; clip: rect(2.92em, 1024.23em, 4.467em, -999.997em); top: -3.926em; left: 50%; margin-left: -12.14em;"><span class="mtd" id="MathJax-Span-3208"><span class="mrow" id="MathJax-Span-3209"><span class="mstyle" id="MathJax-Span-3210"><span class="mrow" id="MathJax-Span-3211"><span class="mi" id="MathJax-Span-3212" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3213"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3214" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3215"><span class="mrow" id="MathJax-Span-3216"><span class="mi" id="MathJax-Span-3217" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">p</span><span class="mi" id="MathJax-Span-3218" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3219" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3220" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3221" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-3222" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.301em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3223"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3224" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3225"><span class="mrow" id="MathJax-Span-3226"><span class="mi" id="MathJax-Span-3227" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span class="mi" id="MathJax-Span-3228" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3229" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3230" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3231" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="msubsup" id="MathJax-Span-3232" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1001.61em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3233"><span class="mrow" id="MathJax-Span-3234"><span class="msubsup" id="MathJax-Span-3235"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3236" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-3237"><span class="mrow" id="MathJax-Span-3238"><span class="mi" id="MathJax-Span-3239" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-3240" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 1.61em;"><span class="mi" id="MathJax-Span-3241" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3242" style="font-family: STIXMathJax_Main;">(</span><span class="mn" id="MathJax-Span-3243" style="font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-3244" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="msubsup" id="MathJax-Span-3245" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1001.73em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3246" style="font-family: STIXMathJax_Main;">tanh</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 1.729em;"><span class="mn" id="MathJax-Span-3247" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3248"></span><span class="mo" id="MathJax-Span-3249" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3250"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3251" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-3252"><span class="mrow" id="MathJax-Span-3253"><span class="mi" id="MathJax-Span-3254" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-3255" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3256"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3257" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3258"><span class="mrow" id="MathJax-Span-3259"><span class="mo" id="MathJax-Span-3260" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3261" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3262" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3263" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-3264" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3265" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-3266"><span class="mrow" id="MathJax-Span-3267"><span class="mi" id="MathJax-Span-3268" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-3269" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3270"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3271" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3272"><span class="mrow" id="MathJax-Span-3273"><span class="mo" id="MathJax-Span-3274" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3275" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3276" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-3277" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-3278" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3279" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-3280" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3281" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3282"><span class="mrow" id="MathJax-Span-3283"><span class="mi" id="MathJax-Span-3284" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3285" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-3286" style="font-family: STIXMathJax_Main;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.193em; height: 0px; clip: rect(-0.83em, 1001.13em, 0.42em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.098em, 1001.13em, 4.348em, -999.997em); top: -3.926em; right: 0.003em;"><span class="mtd" id="mjx-eqn-5_1"><span class="mrow" id="MathJax-Span-3206"><span class="mtext" id="MathJax-Span-3207" style="font-family: STIXMathJax_Main;">(5)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.496em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="false"><mlabeledtr><mtd id="mjx-eqn-5_1"><mtext>(5)</mtext></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mi>d</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>r</mi><mi>e</mi><mi>v</mi></mrow></msub><mo>=</mo><mi>d</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo>∗</mo><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>a</mi></mrow></msub></mrow><mi>T</mi></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msup><mi>tanh</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>x</mi></mrow></msub><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>a</mi></mrow></msub><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mstyle></mtd></mlabeledtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-239">\displaystyle da_{prev} = da_{next} * { W_{aa}}^T ( 1-\tanh^2(W_{ax}x^{\langle t \rangle}+W_{aa} a^{\langle t-1 \rangle} + b_{a}) )\tag{5}</script></p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59766px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 428px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.5px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Implementing rnn_cell_backward</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The results can be computed directly by implementing the equations above. However, the above can optionally be simplified by computing 'dz' and utlilizing the chain rule.<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">This can be further simplified by noting that <span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\tanh</span>(W_<span class="cm-bracket">{</span>ax<span class="cm-bracket">}</span>x^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>+W_<span class="cm-bracket">{</span>aa<span class="cm-bracket">}</span> a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t-1 <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> + b_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span> was computed and saved in the forward pass. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">To calculate dba, the 'batch' above is a sum across the horizontal (axis= 1) axis. Note that you should use the keepdims = True option.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">It may be worthwhile to review Course 1 <span class="cm-link">[Derivatives with a computational graph]</span><span class="cm-string cm-url">(https://www.coursera.org/learn/neural-networks-deep-learning/lecture/0VSHe/derivatives-with-a-computation-graph)</span>  through &nbsp;<span class="cm-link">[Backpropagation Intuition]</span><span class="cm-string cm-url">(https://www.coursera.org/learn/neural-networks-deep-learning/lecture/6dDj7/backpropagation-intuition-optional)</span>, which decompose the calculation into steps using the chain rule.<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Matrix vector derivatives are described <span class="cm-link">[here]</span><span class="cm-string cm-url">(http://cs231n.stanford.edu/vecDerivs.pdf)</span>, though the equations above incorporate the required transformations.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Note rnn_cell_backward does <span class="cm-strong">__not__</span> include the calculation of loss from <span class="cm-delimit cm-delimit-open">$</span>y <span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-delimit cm-delimit-close">$</span>, this is incorporated into the incoming da_next. This is a slight mismatch with rnn_cell_forward which includes a dense layer and softmax. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Note: in the code:<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\displaystyle</span> dx^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> is represented by dxt,<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-b">&nbsp;</span><span class="cm-trailing-space-new-line"> </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\displaystyle</span> d W_<span class="cm-bracket">{</span>ax<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> is represented by dWax,<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-b">&nbsp;</span><span class="cm-trailing-space-new-line"> </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\displaystyle</span> da_<span class="cm-bracket">{</span>prev<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> is represented by da_prev,<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-b">&nbsp;</span><span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\displaystyle</span> dW_<span class="cm-bracket">{</span>aa<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> is represented by dWaa,<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-b">&nbsp;</span><span class="cm-trailing-space-new-line"> </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\displaystyle</span> db_<span class="cm-bracket">{</span>a<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> is represented by dba,<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-b">&nbsp;</span><span class="cm-trailing-space-new-line"> </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">dz is not derived above but can optionally be derived by students to simplify the repeated calculations.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 428px;"></div><div class="CodeMirror-gutters" style="display: none; height: 437px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="Implementing-rnn_cell_backward">Implementing rnn_cell_backward<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Implementing-rnn_cell_backward">¶</a></h4>
<p>The results can be computed directly by implementing the equations above. However, the above can optionally be simplified by computing 'dz' and utlilizing the chain rule.<br>This can be further simplified by noting that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-240-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;tanh&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3287" role="math" style="width: 15.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.039em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1012.98em, 2.682em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-3288"><span class="mi" id="MathJax-Span-3289" style="font-family: STIXMathJax_Main;">tanh</span><span class="mo" id="MathJax-Span-3290"></span><span class="mo" id="MathJax-Span-3291" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3292"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3293" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-3294"><span class="mrow" id="MathJax-Span-3295"><span class="mi" id="MathJax-Span-3296" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-3297" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3298"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3299" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3300"><span class="mrow" id="MathJax-Span-3301"><span class="mo" id="MathJax-Span-3302" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3303" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3304" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3305" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-3306" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3307" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-3308"><span class="mrow" id="MathJax-Span-3309"><span class="mi" id="MathJax-Span-3310" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-3311" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3312"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3313" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3314"><span class="mrow" id="MathJax-Span-3315"><span class="mo" id="MathJax-Span-3316" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3317" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3318" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-3319" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-3320" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3321" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-3322" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3323" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3324"><span class="mrow" id="MathJax-Span-3325"><span class="mi" id="MathJax-Span-3326" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3327" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>tanh</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>x</mi></mrow></msub><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>a</mi></mrow></msub><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-240">\tanh(W_{ax}x^{\langle t \rangle}+W_{aa} a^{\langle t-1 \rangle} + b_{a})</script> was computed and saved in the forward pass. </p>
<p>To calculate dba, the 'batch' above is a sum across the horizontal (axis= 1) axis. Note that you should use the keepdims = True option.</p>
<p>It may be worthwhile to review Course 1 <a href="https://www.coursera.org/learn/neural-networks-deep-learning/lecture/0VSHe/derivatives-with-a-computation-graph" target="_blank">Derivatives with a computational graph</a>  through  <a href="https://www.coursera.org/learn/neural-networks-deep-learning/lecture/6dDj7/backpropagation-intuition-optional" target="_blank">Backpropagation Intuition</a>, which decompose the calculation into steps using the chain rule.<br>Matrix vector derivatives are described <a href="http://cs231n.stanford.edu/vecDerivs.pdf" target="_blank">here</a>, though the equations above incorporate the required transformations.</p>
<p>Note rnn_cell_backward does <strong>not</strong> include the calculation of loss from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-241-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3328" role="math" style="width: 1.729em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em, 1001.37em, 2.801em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-3329"><span class="mi" id="MathJax-Span-3330" style="font-family: STIXMathJax_Main-italic; font-style: italic;">y</span><span class="mo" id="MathJax-Span-3331" style="font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3332" style="font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3333" style="font-family: STIXMathJax_Main;">⟩</span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></math></span></span><script type="math/tex" id="MathJax-Element-241">y \langle t \rangle</script>, this is incorporated into the incoming da_next. This is a slight mismatch with rnn_cell_forward which includes a dense layer and softmax. </p>
<p>Note: in the code:<br><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-242-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3334" role="math" style="width: 2.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1001.91em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-3335"><span class="mstyle" id="MathJax-Span-3336"><span class="mrow" id="MathJax-Span-3337"><span class="mi" id="MathJax-Span-3338" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3339"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3340" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3341"><span class="mrow" id="MathJax-Span-3342"><span class="mo" id="MathJax-Span-3343" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3344" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3345" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true" scriptlevel="0"><mi>d</mi><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-242">\displaystyle dx^{\langle t \rangle}</script> is represented by dxt,<br><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-243-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3346" role="math" style="width: 2.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.15em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-3347"><span class="mstyle" id="MathJax-Span-3348"><span class="mrow" id="MathJax-Span-3349"><span class="mi" id="MathJax-Span-3350" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3351"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3352" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-3353"><span class="mrow" id="MathJax-Span-3354"><span class="mi" id="MathJax-Span-3355" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-3356" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true" scriptlevel="0"><mi>d</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>x</mi></mrow></msub></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-243">\displaystyle d W_{ax}</script> is represented by dWax,<br><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-244-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3357" role="math" style="width: 2.801em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.324em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.32em, 2.86em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-3358"><span class="mstyle" id="MathJax-Span-3359"><span class="mrow" id="MathJax-Span-3360"><span class="mi" id="MathJax-Span-3361" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3362"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3363" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3364"><span class="mrow" id="MathJax-Span-3365"><span class="mi" id="MathJax-Span-3366" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">p</span><span class="mi" id="MathJax-Span-3367" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3368" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3369" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true" scriptlevel="0"><mi>d</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>r</mi><mi>e</mi><mi>v</mi></mrow></msub></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-244">\displaystyle da_{prev}</script> is represented by da_prev,<br><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-245-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3370" role="math" style="width: 2.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.15em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-3371"><span class="mstyle" id="MathJax-Span-3372"><span class="mrow" id="MathJax-Span-3373"><span class="mi" id="MathJax-Span-3374" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3375"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3376" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-3377"><span class="mrow" id="MathJax-Span-3378"><span class="mi" id="MathJax-Span-3379" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-3380" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true" scriptlevel="0"><mi>d</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>a</mi></mrow></msub></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-245">\displaystyle dW_{aa}</script> is represented by dWaa,<br><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-246-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3381" role="math" style="width: 1.729em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1001.43em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-3382"><span class="mstyle" id="MathJax-Span-3383"><span class="mrow" id="MathJax-Span-3384"><span class="mi" id="MathJax-Span-3385" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3386"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3387" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3388"><span class="mrow" id="MathJax-Span-3389"><span class="mi" id="MathJax-Span-3390" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true" scriptlevel="0"><mi>d</mi><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-246">\displaystyle db_{a}</script> is represented by dba,<br>dz is not derived above but can optionally be derived by students to simplify the repeated calculations.</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[12]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59766px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 555.422px; margin-bottom: -21px; border-right-width: 9px; min-height: 811px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">rnn_cell_backward</span>(<span class="cm-variable">da_next</span>, <span class="cm-variable">cache</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Implements the backward pass for the RNN-cell (single time-step).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    da_next -- Gradient of loss with respect to next hidden state</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    cache -- python dictionary containing useful values (output of rnn_cell_forward())</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    gradients -- python dictionary containing:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dx -- Gradients of input data, of shape (n_x, m)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        da_prev -- Gradients of previous hidden state, of shape (n_a, m)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dWax -- Gradients of input-to-hidden weights, of shape (n_a, n_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dWaa -- Gradients of hidden-to-hidden weights, of shape (n_a, n_a)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dba -- Gradients of bias vector, of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Retrieve values from cache</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    (<span class="cm-variable">a_next</span>, <span class="cm-variable">a_prev</span>, <span class="cm-variable">xt</span>, <span class="cm-variable">parameters</span>) = <span class="cm-variable">cache</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Retrieve values from parameters</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">Wax</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"Wax"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">Waa</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"Waa"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">Wya</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"Wya"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">ba</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"ba"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">by</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"by"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># compute the gradient of the loss with respect to z (optional) (≈1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dz</span> = <span class="cm-variable">da_next</span><span class="cm-operator">*</span>(<span class="cm-number">1</span><span class="cm-operator">-</span><span class="cm-variable">a_next</span><span class="cm-operator">**</span><span class="cm-number">2</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># compute the gradient of the loss with respect to Wax (≈2 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dxt</span> = <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">Wax</span>.<span class="cm-property">T</span>,<span class="cm-variable">dz</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dWax</span> = <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">dz</span>,<span class="cm-variable">xt</span>.<span class="cm-property">T</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># compute the gradient with respect to Waa (≈2 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">da_prev</span> = <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">Waa</span>.<span class="cm-property">T</span>,<span class="cm-variable">dz</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dWaa</span> = <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">dz</span>,<span class="cm-variable">a_prev</span>.<span class="cm-property">T</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># compute the gradient with respect to b (≈1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dba</span> = <span class="cm-variable">np</span>.<span class="cm-property">sum</span>(<span class="cm-variable">dz</span>,<span class="cm-variable">axis</span>=<span class="cm-number">1</span>,<span class="cm-variable">keepdims</span>=<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Store the gradients in a python dictionary</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">gradients</span> = {<span class="cm-string">"dxt"</span>: <span class="cm-variable">dxt</span>, <span class="cm-string">"da_prev"</span>: <span class="cm-variable">da_prev</span>, <span class="cm-string">"dWax"</span>: <span class="cm-variable">dWax</span>, <span class="cm-string">"dWaa"</span>: <span class="cm-variable">dWaa</span>, <span class="cm-string">"dba"</span>: <span class="cm-variable">dba</span>}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">gradients</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 811px;"></div><div class="CodeMirror-gutters" style="display: none; height: 820px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[13]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59766px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 597.792px; margin-bottom: -21px; border-right-width: 9px; min-height: 411px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">seed</span>(<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">xt_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">3</span>,<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a_prev_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span> = {}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wax'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Waa'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wya'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">2</span>,<span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'ba'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'by'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">2</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a_next_tmp</span>, <span class="cm-variable">yt_tmp</span>, <span class="cm-variable">cache_tmp</span> = <span class="cm-variable">rnn_cell_forward</span>(<span class="cm-variable">xt_tmp</span>, <span class="cm-variable">a_prev_tmp</span>, <span class="cm-variable">parameters_tmp</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">da_next_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients_tmp</span> = <span class="cm-variable">rnn_cell_backward</span>(<span class="cm-variable">da_next_tmp</span>, <span class="cm-variable">cache_tmp</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dxt\"][1][2] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dxt"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dxt\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dxt"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"da_prev\"][2][3] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"da_prev"</span>][<span class="cm-number">2</span>][<span class="cm-number">3</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"da_prev\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"da_prev"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWax\"][3][1] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWax"</span>][<span class="cm-number">3</span>][<span class="cm-number">1</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWax\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWax"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWaa\"][1][2] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWaa"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWaa\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWaa"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dba\"][4] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dba"</span>][<span class="cm-number">4</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dba\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dba"</span>].<span class="cm-property">shape</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 411px;"></div><div class="CodeMirror-gutters" style="display: none; height: 420px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>gradients["dxt"][1][2] = -1.3872130506
gradients["dxt"].shape = (3, 10)
gradients["da_prev"][2][3] = -0.152399493774
gradients["da_prev"].shape = (5, 10)
gradients["dWax"][3][1] = 0.410772824935
gradients["dWax"].shape = (5, 3)
gradients["dWaa"][1][2] = 1.15034506685
gradients["dWaa"].shape = (5, 5)
gradients["dba"][4] = [ 0.20023491]
gradients["dba"].shape = (5, 1)
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 1411px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Expected Output**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dxt"][1][2]** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -1.3872130506</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dxt"].shape** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (3, 10)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["da_prev"][2][3]** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -0.152399493774</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["da_prev"].shape** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 10)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWax"][3][1]** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.410772824935</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWax"].shape** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 3)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWaa"][1][2]** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1.15034506685</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWaa"].shape** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 5)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dba"][4]** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [ 0.20023491]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dba"].shape** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 1)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 1411px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1420px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Expected Output</strong>:</p>
<table>
    <tbody><tr>
        <td>
            <strong>gradients["dxt"][1][2]</strong> =
        </td>
        <td>
           -1.3872130506
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dxt"].shape</strong> =
        </td>
        <td>
           (3, 10)
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["da_prev"][2][3]</strong> =
        </td>
        <td>
           -0.152399493774
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["da_prev"].shape</strong> =
        </td>
        <td>
           (5, 10)
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dWax"][3][1]</strong> =
        </td>
        <td>
           0.410772824935
        </td>
    </tr>
            <tr>
        <td>
            <strong>gradients["dWax"].shape</strong> =
        </td>
        <td>
           (5, 3)
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dWaa"][1][2]</strong> = 
        </td>
        <td>
           1.15034506685
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dWaa"].shape</strong> =
        </td>
        <td>
           (5, 5)
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dba"][4]</strong> = 
        </td>
        <td>
           [ 0.20023491]
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dba"].shape</strong> = 
        </td>
        <td>
           (5, 1)
        </td>
    </tr>
</tbody></table></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59766px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 177px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.5px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Backward pass through the RNN</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Computing the gradients of the cost with respect to <span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> at every time-step <span class="cm-delimit cm-delimit-open">$</span>t<span class="cm-delimit cm-delimit-close">$</span> is useful because it is what helps the gradient backpropagate to the previous RNN-cell. To do so, you need to iterate through all the time steps starting at the end, and at each step, you increment the overall <span class="cm-delimit cm-delimit-open">$</span>db_a<span class="cm-delimit cm-delimit-close">$</span>, <span class="cm-delimit cm-delimit-open">$</span>dW_<span class="cm-bracket">{</span>aa<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span>, <span class="cm-delimit cm-delimit-open">$</span>dW_<span class="cm-bracket">{</span>ax<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> and you store <span class="cm-delimit cm-delimit-open">$</span>dx<span class="cm-delimit cm-delimit-close">$</span>.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Instructions**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Implement the <span class="cm-comment">`rnn_backward`</span> function. Initialize the return variables with zeros first and then loop through all the time steps while calling the <span class="cm-comment">`rnn_cell_backward`</span> at each time timestep, update the other variables accordingly.</span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 177px;"></div><div class="CodeMirror-gutters" style="display: none; height: 186px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="Backward-pass-through-the-RNN">Backward pass through the RNN<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Backward-pass-through-the-RNN">¶</a></h4>
<p>Computing the gradients of the cost with respect to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-247-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3391" role="math" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.37em, 2.324em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-3392"><span class="msubsup" id="MathJax-Span-3393"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3394" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3395"><span class="mrow" id="MathJax-Span-3396"><span class="mo" id="MathJax-Span-3397" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3398" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3399" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-247">a^{\langle t \rangle}</script> at every time-step <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-248-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3400" role="math" style="width: 0.36em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.301em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em, 1000.3em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-3401"><span class="mi" id="MathJax-Span-3402" style="font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-248">t</script> is useful because it is what helps the gradient backpropagate to the previous RNN-cell. To do so, you need to iterate through all the time steps starting at the end, and at each step, you increment the overall <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-249-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3403" role="math" style="width: 1.729em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1001.43em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-3404"><span class="mi" id="MathJax-Span-3405" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3406"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3407" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-3408" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msub><mi>b</mi><mi>a</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-249">db_a</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-250-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3409" role="math" style="width: 2.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.15em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-3410"><span class="mi" id="MathJax-Span-3411" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3412"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3413" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-3414"><span class="mrow" id="MathJax-Span-3415"><span class="mi" id="MathJax-Span-3416" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-3417" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>a</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-250">dW_{aa}</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-251-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3418" role="math" style="width: 2.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.15em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-3419"><span class="mi" id="MathJax-Span-3420" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3421"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3422" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="texatom" id="MathJax-Span-3423"><span class="mrow" id="MathJax-Span-3424"><span class="mi" id="MathJax-Span-3425" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-3426" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>x</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-251">dW_{ax}</script> and you store <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-252-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3427" role="math" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1000.96em, 2.562em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-3428"><span class="mi" id="MathJax-Span-3429" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3430" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-252">dx</script>.</p>
<p><strong>Instructions</strong>:</p>
<p>Implement the <code>rnn_backward</code> function. Initialize the return variables with zeros first and then loop through all the time steps while calling the <code>rnn_cell_backward</code> at each time timestep, update the other variables accordingly.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 111px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Note that this notebook does not implement the backward path from the Loss 'J' backwards to 'a'. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">* This would have included the dense layer and softmax which are a part of the forward path. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">* This is assumed to be calculated elsewhere and the result passed to rnn_backward in 'da'. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">* You must combine this with the loss from the previous stages when calling rnn_cell_backward (see figure 7 above).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">* It is further assumed that loss has been adjusted for batch size (m).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">* Therefore, division by the number of examples is not required here.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 111px;"></div><div class="CodeMirror-gutters" style="display: none; height: 120px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><ul>
<li>Note that this notebook does not implement the backward path from the Loss 'J' backwards to 'a'. <ul>
<li>This would have included the dense layer and softmax which are a part of the forward path. </li>
<li>This is assumed to be calculated elsewhere and the result passed to rnn_backward in 'da'. </li>
<li>You must combine this with the loss from the previous stages when calling rnn_cell_backward (see figure 7 above).</li>
</ul>
</li>
<li>It is further assumed that loss has been adjusted for batch size (m).<ul>
<li>Therefore, division by the number of examples is not required here.</li>
</ul>
</li>
</ul>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[14]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 911.021px; margin-bottom: -21px; border-right-width: 9px; min-height: 944px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">rnn_backward</span>(<span class="cm-variable">da</span>, <span class="cm-variable">caches</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Implement the backward pass for a RNN over an entire sequence of input data.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    da -- Upstream gradients of all hidden states, of shape (n_a, m, T_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    caches -- tuple containing information from the forward pass (rnn_forward)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    gradients -- python dictionary containing:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dx -- Gradient w.r.t. the input data, numpy-array of shape (n_x, m, T_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        da0 -- Gradient w.r.t the initial hidden state, numpy-array of shape (n_a, m)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dWax -- Gradient w.r.t the input's weight matrix, numpy-array of shape (n_a, n_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dWaa -- Gradient w.r.t the hidden state's weight matrix, numpy-arrayof shape (n_a, n_a)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dba -- Gradient w.r.t the bias, of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Retrieve values from the first cache (t=1) of caches (≈2 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    (<span class="cm-variable">caches</span>, <span class="cm-variable">x</span>) = <span class="cm-variable">caches</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    (<span class="cm-variable">a1</span>, <span class="cm-variable">a0</span>, <span class="cm-variable">x1</span>, <span class="cm-variable">parameters</span>) = <span class="cm-variable">caches</span>[<span class="cm-number">0</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Retrieve dimensions from da's and x1's shapes (≈2 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">n_a</span>, <span class="cm-variable">m</span>, <span class="cm-variable">T_x</span> = <span class="cm-variable">np</span>.<span class="cm-property">shape</span>(<span class="cm-variable">da</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">n_x</span>, <span class="cm-variable">m</span> = <span class="cm-variable">x1</span>.<span class="cm-property">shape</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># initialize the gradients with the right sizes (≈6 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dx</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_x</span>, <span class="cm-variable">m</span>, <span class="cm-variable">T_x</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dWax</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_a</span>, <span class="cm-variable">n_x</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dWaa</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_a</span>, <span class="cm-variable">n_a</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dba</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_a</span>, <span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">da0</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_a</span>, <span class="cm-variable">m</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">da_prevt</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_a</span>, <span class="cm-variable">m</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Loop through all the time steps</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">for</span> <span class="cm-variable">t</span> <span class="cm-keyword">in</span> <span class="cm-builtin">reversed</span>(<span class="cm-builtin">range</span>(<span class="cm-variable">T_x</span>)):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Compute gradients at time step t. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Remember to sum gradients from the output path (da) and the previous timesteps (da_prevt) (≈1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">gradients</span> = <span class="cm-variable">rnn_cell_backward</span>(<span class="cm-variable">da</span>[:,:,<span class="cm-variable">t</span>]<span class="cm-operator">+</span><span class="cm-variable">da_prevt</span>,<span class="cm-variable">caches</span>[<span class="cm-variable">t</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Retrieve derivatives from gradients (≈ 1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">dxt</span>, <span class="cm-variable">da_prevt</span>, <span class="cm-variable">dWaxt</span>, <span class="cm-variable">dWaat</span>, <span class="cm-variable">dbat</span> = <span class="cm-variable">gradients</span>[<span class="cm-string">"dxt"</span>], <span class="cm-variable">gradients</span>[<span class="cm-string">"da_prev"</span>], <span class="cm-variable">gradients</span>[<span class="cm-string">"dWax"</span>], <span class="cm-variable">gradients</span>[<span class="cm-string">"dWaa"</span>], <span class="cm-variable">gradients</span>[<span class="cm-string">"dba"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Increment global derivatives w.r.t parameters by adding their derivative at time-step t (≈4 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">dx</span>[:, :, <span class="cm-variable">t</span>] = <span class="cm-variable">dxt</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">dWax</span> += <span class="cm-variable">dWaxt</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">dWaa</span> += <span class="cm-variable">dWaat</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">dba</span> += <span class="cm-variable">dbat</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Set da0 to the gradient of a which has been backpropagated through all time-steps (≈1 line) </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">da0</span> = <span class="cm-variable">da_prevt</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Store the gradients in a python dictionary</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">gradients</span> = {<span class="cm-string">"dx"</span>: <span class="cm-variable">dx</span>, <span class="cm-string">"da0"</span>: <span class="cm-variable">da0</span>, <span class="cm-string">"dWax"</span>: <span class="cm-variable">dWax</span>, <span class="cm-string">"dWaa"</span>: <span class="cm-variable">dWaa</span>,<span class="cm-string">"dba"</span>: <span class="cm-variable">dba</span>}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">gradients</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 944px;"></div><div class="CodeMirror-gutters" style="display: none; height: 953px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[15]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59766px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 502.323px; margin-bottom: -21px; border-right-width: 9px; min-height: 411px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">seed</span>(<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">x_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">3</span>,<span class="cm-number">10</span>,<span class="cm-number">4</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a0_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span> = {}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wax'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Waa'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wya'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">2</span>,<span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'ba'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'by'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">2</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a_tmp</span>, <span class="cm-variable">y_tmp</span>, <span class="cm-variable">caches_tmp</span> = <span class="cm-variable">rnn_forward</span>(<span class="cm-variable">x_tmp</span>, <span class="cm-variable">a0_tmp</span>, <span class="cm-variable">parameters_tmp</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">da_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>, <span class="cm-number">10</span>, <span class="cm-number">4</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients_tmp</span> = <span class="cm-variable">rnn_backward</span>(<span class="cm-variable">da_tmp</span>, <span class="cm-variable">caches_tmp</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dx\"][1][2] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dx"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dx\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dx"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"da0\"][2][3] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"da0"</span>][<span class="cm-number">2</span>][<span class="cm-number">3</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"da0\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"da0"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWax\"][3][1] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWax"</span>][<span class="cm-number">3</span>][<span class="cm-number">1</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWax\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWax"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWaa\"][1][2] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWaa"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWaa\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWaa"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dba\"][4] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dba"</span>][<span class="cm-number">4</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dba\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dba"</span>].<span class="cm-property">shape</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 411px;"></div><div class="CodeMirror-gutters" style="display: none; height: 420px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>gradients["dx"][1][2] = [-2.07101689 -0.59255627  0.02466855  0.01483317]
gradients["dx"].shape = (3, 10, 4)
gradients["da0"][2][3] = -0.314942375127
gradients["da0"].shape = (5, 10)
gradients["dWax"][3][1] = 11.2641044965
gradients["dWax"].shape = (5, 3)
gradients["dWaa"][1][2] = 2.30333312658
gradients["dWaa"].shape = (5, 5)
gradients["dba"][4] = [-0.74747722]
gradients["dba"].shape = (5, 1)
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 1411px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Expected Output**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dx"][1][2]** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [-2.07101689 -0.59255627  0.02466855  0.01483317]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dx"].shape** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (3, 10, 4)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["da0"][2][3]** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -0.314942375127</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["da0"].shape** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 10)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWax"][3][1]** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 11.2641044965</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWax"].shape** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 3)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWaa"][1][2]** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2.30333312658</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWaa"].shape** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 5)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dba"][4]** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [-0.74747722]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dba"].shape** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 1)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 1411px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1420px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Expected Output</strong>:</p>
<table>
    <tbody><tr>
        <td>
            <strong>gradients["dx"][1][2]</strong> =
        </td>
        <td>
           [-2.07101689 -0.59255627  0.02466855  0.01483317]
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dx"].shape</strong> =
        </td>
        <td>
           (3, 10, 4)
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["da0"][2][3]</strong> =
        </td>
        <td>
           -0.314942375127
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["da0"].shape</strong> =
        </td>
        <td>
           (5, 10)
        </td>
    </tr>
         <tr>
        <td>
            <strong>gradients["dWax"][3][1]</strong> =
        </td>
        <td>
           11.2641044965
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dWax"].shape</strong> =
        </td>
        <td>
           (5, 3)
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dWaa"][1][2]</strong> = 
        </td>
        <td>
           2.30333312658
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dWaa"].shape</strong> =
        </td>
        <td>
           (5, 5)
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dba"][4]</strong> = 
        </td>
        <td>
           [-0.74747722]
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dba"].shape</strong> = 
        </td>
        <td>
           (5, 1)
        </td>
    </tr>
</tbody></table></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59766px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 29px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.3333px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 3.2 - LSTM backward pass</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 29px;"></div><div class="CodeMirror-gutters" style="display: none; height: 38px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="3.2---LSTM-backward-pass">3.2 - LSTM backward pass<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#3.2---LSTM-backward-pass">¶</a></h2>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 161px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### 3.2.1 One Step backward</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The LSTM backward pass is slighltly more complicated than the forward one.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/LSTM_cell_backward_rev3a_5.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:500;height:400px;"</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> **Figure 8**: lstm_cell_backward. Note the output functions, while part of the lstm_cell_forward, are not included in lstm_cell_backward <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The equations for the LSTM backward pass are provided below. (If you enjoy calculus exercises feel free to try deriving these from scratch yourself.)</span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 161px;"></div><div class="CodeMirror-gutters" style="display: none; height: 170px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="3.2.1-One-Step-backward">3.2.1 One Step backward<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#3.2.1-One-Step-backward">¶</a></h3>
<p>The LSTM backward pass is slighltly more complicated than the forward one.</p>
<p><img src="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/LSTM_cell_backward_rev3a_5.png" style="width: 500 ; height: 400px"> <br></p>
<center> <strong>Figure 8</strong>: lstm_cell_backward. Note the output functions, while part of the lstm_cell_forward, are not included in lstm_cell_backward </center>

<p>The equations for the LSTM backward pass are provided below. (If you enjoy calculus exercises feel free to try deriving these from scratch yourself.)</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59766px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 944px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### 3.2.2 gate derivatives</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Note the location of the gate derivatives (<span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\gamma</span><span class="cm-delimit cm-delimit-close">$</span>..) between the dense layer and the activation function (see graphic above). This is convenient for computing parameter derivatives in the next step. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span>d<span class="cm-tag">\gamma</span>_o^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> = da_<span class="cm-bracket">{</span>next<span class="cm-bracket">}</span>*<span class="cm-tag">\tanh</span>(c_<span class="cm-bracket">{</span>next<span class="cm-bracket">}</span>) * <span class="cm-tag">\Gamma</span>_o^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>*<span class="cm-tag">\left</span>(1-<span class="cm-tag">\Gamma</span>_o^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-tag">\right</span>)<span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">7</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span>dp<span class="cm-tag">\widetilde</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> = <span class="cm-tag">\left</span>(dc_<span class="cm-bracket">{</span>next<span class="cm-bracket">}</span>*<span class="cm-tag">\Gamma</span>_u^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>+ <span class="cm-tag">\Gamma</span>_o^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>* (1-<span class="cm-tag">\tanh</span>^2(c_<span class="cm-bracket">{</span>next<span class="cm-bracket">}</span>)) * <span class="cm-tag">\Gamma</span>_u^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> * da_<span class="cm-bracket">{</span>next<span class="cm-bracket">}</span> <span class="cm-tag">\right</span>) * <span class="cm-tag">\left</span>(1-<span class="cm-tag">\left</span>(<span class="cm-tag">\widetilde</span> c^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-tag">\right</span>)^2<span class="cm-tag">\right</span>) <span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">8</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span>d<span class="cm-tag">\gamma</span>_u^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> = <span class="cm-tag">\left</span>(dc_<span class="cm-bracket">{</span>next<span class="cm-bracket">}</span>*<span class="cm-tag">\widetilde</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> + <span class="cm-tag">\Gamma</span>_o^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>* (1-<span class="cm-tag">\tanh</span>^2(c_<span class="cm-bracket">{</span>next<span class="cm-bracket">}</span>)) * <span class="cm-tag">\widetilde</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> * da_<span class="cm-bracket">{</span>next<span class="cm-bracket">}</span><span class="cm-tag">\right</span>)*<span class="cm-tag">\Gamma</span>_u^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>*<span class="cm-tag">\left</span>(1-<span class="cm-tag">\Gamma</span>_u^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-tag">\right</span>)<span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">9</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span>d<span class="cm-tag">\gamma</span>_f^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> = <span class="cm-tag">\left</span>(dc_<span class="cm-bracket">{</span>next<span class="cm-bracket">}</span>* c_<span class="cm-bracket">{</span>prev<span class="cm-bracket">}</span> + <span class="cm-tag">\Gamma</span>_o^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> * (1-<span class="cm-tag">\tanh</span>^2(c_<span class="cm-bracket">{</span>next<span class="cm-bracket">}</span>)) * c_<span class="cm-bracket">{</span>prev<span class="cm-bracket">}</span> * da_<span class="cm-bracket">{</span>next<span class="cm-bracket">}</span><span class="cm-tag">\right</span>)*<span class="cm-tag">\Gamma</span>_f^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>*<span class="cm-tag">\left</span>(1-<span class="cm-tag">\Gamma</span>_f^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-tag">\right</span>)<span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">10</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### 3.2.3 parameter derivatives </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span> dW_f = d<span class="cm-tag">\gamma</span>_f^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> <span class="cm-tag">\begin</span><span class="cm-bracket">{</span><span class="cm-atom">bmatrix</span><span class="cm-bracket">}</span> a_<span class="cm-bracket">{</span>prev<span class="cm-bracket">}</span> <span class="cm-tag">\\</span> x_t<span class="cm-tag">\end</span><span class="cm-bracket">{</span><span class="cm-atom">bmatrix</span><span class="cm-bracket">}</span>^T <span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">11</span><span class="cm-bracket">}</span> <span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span> dW_u = d<span class="cm-tag">\gamma</span>_u^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> <span class="cm-tag">\begin</span><span class="cm-bracket">{</span><span class="cm-atom">bmatrix</span><span class="cm-bracket">}</span> a_<span class="cm-bracket">{</span>prev<span class="cm-bracket">}</span> <span class="cm-tag">\\</span> x_t<span class="cm-tag">\end</span><span class="cm-bracket">{</span><span class="cm-atom">bmatrix</span><span class="cm-bracket">}</span>^T <span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">12</span><span class="cm-bracket">}</span> <span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span> dW_c = dp<span class="cm-tag">\widetilde</span> c^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> <span class="cm-tag">\begin</span><span class="cm-bracket">{</span><span class="cm-atom">bmatrix</span><span class="cm-bracket">}</span> a_<span class="cm-bracket">{</span>prev<span class="cm-bracket">}</span> <span class="cm-tag">\\</span> x_t<span class="cm-tag">\end</span><span class="cm-bracket">{</span><span class="cm-atom">bmatrix</span><span class="cm-bracket">}</span>^T <span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">13</span><span class="cm-bracket">}</span> <span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span> dW_o = d<span class="cm-tag">\gamma</span>_o^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> <span class="cm-tag">\begin</span><span class="cm-bracket">{</span><span class="cm-atom">bmatrix</span><span class="cm-bracket">}</span> a_<span class="cm-bracket">{</span>prev<span class="cm-bracket">}</span> <span class="cm-tag">\\</span> x_t<span class="cm-tag">\end</span><span class="cm-bracket">{</span><span class="cm-atom">bmatrix</span><span class="cm-bracket">}</span>^T <span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">14</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">To calculate <span class="cm-delimit cm-delimit-open">$</span>db_f, db_u, db_c, db_o<span class="cm-delimit cm-delimit-close">$</span> you just need to sum across the horizontal (axis= 1) axis on <span class="cm-delimit cm-delimit-open">$</span>d<span class="cm-tag">\gamma</span>_f^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>, d<span class="cm-tag">\gamma</span>_u^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>, dp<span class="cm-tag">\widetilde</span> c^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>, d<span class="cm-tag">\gamma</span>_o^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> respectively. Note that you should have the <span class="cm-comment">`keepdims = True`</span> option.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\displaystyle</span> db_f = <span class="cm-tag">\sum</span>_<span class="cm-bracket">{</span>batch<span class="cm-bracket">}</span>d<span class="cm-tag">\gamma</span>_f^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">15</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\displaystyle</span> db_u = <span class="cm-tag">\sum</span>_<span class="cm-bracket">{</span>batch<span class="cm-bracket">}</span>d<span class="cm-tag">\gamma</span>_u^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">16</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\displaystyle</span> db_c = <span class="cm-tag">\sum</span>_<span class="cm-bracket">{</span>batch<span class="cm-bracket">}</span>d<span class="cm-tag">\gamma</span>_c^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">17</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\displaystyle</span> db_o = <span class="cm-tag">\sum</span>_<span class="cm-bracket">{</span>batch<span class="cm-bracket">}</span>d<span class="cm-tag">\gamma</span>_o^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">18</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Finally, you will compute the derivative with respect to the previous hidden state, previous memory state, and input.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span> da_<span class="cm-bracket">{</span>prev<span class="cm-bracket">}</span> = W_f^T d<span class="cm-tag">\gamma</span>_f^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> + W_u^T &nbsp; d<span class="cm-tag">\gamma</span>_u^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>+ W_c^T dp<span class="cm-tag">\widetilde</span> c^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> + W_o^T d<span class="cm-tag">\gamma</span>_o^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> <span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">19</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Here, to account for concatenation, the weights for equations 19 are the first n_a, (i.e. <span class="cm-delimit cm-delimit-open">$</span>W_f = W_f<span class="cm-bracket">[</span>:,:n_a<span class="cm-bracket">]</span><span class="cm-delimit cm-delimit-close">$</span> etc...)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span> dc_<span class="cm-bracket">{</span>prev<span class="cm-bracket">}</span> = dc_<span class="cm-bracket">{</span>next<span class="cm-bracket">}</span>*<span class="cm-tag">\Gamma</span>_f^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> + <span class="cm-tag">\Gamma</span>_o^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> * (1- <span class="cm-tag">\tanh</span>^2(c_<span class="cm-bracket">{</span>next<span class="cm-bracket">}</span>))*<span class="cm-tag">\Gamma</span>_f^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>*da_<span class="cm-bracket">{</span>next<span class="cm-bracket">}</span> <span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">20</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span> dx^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> = W_f^T d<span class="cm-tag">\gamma</span>_f^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> + W_u^T  d<span class="cm-tag">\gamma</span>_u^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span>+ W_c^T dp<span class="cm-tag">\widetilde</span> c^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span> + W_o^T d<span class="cm-tag">\gamma</span>_o^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">21</span><span class="cm-bracket">}</span> <span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">where the weights for equation 21 are from n_a to the end, (i.e. <span class="cm-delimit cm-delimit-open">$</span>W_f = W_f<span class="cm-bracket">[</span>:,n_a:<span class="cm-bracket">]</span><span class="cm-delimit cm-delimit-close">$</span> etc...)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Exercise:**</span> Implement <span class="cm-comment">`lstm_cell_backward`</span> by implementing equations <span class="cm-delimit cm-delimit-open">$</span><span class="cm-atom">7</span>-21<span class="cm-delimit cm-delimit-close">$</span> below. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Note: In the code:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span>d<span class="cm-tag">\gamma</span>_o^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> is represented by &nbsp;<span class="cm-comment">`dot`</span>,<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-b">&nbsp;</span><span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span>dp<span class="cm-tag">\widetilde</span><span class="cm-bracket">{</span>c<span class="cm-bracket">}</span>^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> is represented by &nbsp;<span class="cm-comment">`dcct`</span>,<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span>d<span class="cm-tag">\gamma</span>_u^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> is represented by &nbsp;<span class="cm-comment">`dit`</span>,<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$</span>d<span class="cm-tag">\gamma</span>_f^<span class="cm-bracket">{</span><span class="cm-tag">\langle</span> t <span class="cm-tag">\rangle</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> is represented by &nbsp;<span class="cm-comment">`dft`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 944px;"></div><div class="CodeMirror-gutters" style="display: none; height: 953px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="3.2.2-gate-derivatives">3.2.2 gate derivatives<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#3.2.2-gate-derivatives">¶</a></h3>
<p>Note the location of the gate derivatives (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-253-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3431" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.789em, 1000.42em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-3432"><span class="mi" id="MathJax-Span-3433" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></span></span><script type="math/tex" id="MathJax-Element-253">\gamma</script>..) between the dense layer and the activation function (see graphic above). This is convenient for computing parameter derivatives in the next step. </p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-254-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable displaystyle=&quot;false&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-7&quot;&gt;&lt;mtext&gt;(7)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;tanh&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3434" role="math" style="width: 100%; display: inline-block; min-width: 22.265em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 22.265em;"><span style="position: absolute; clip: rect(2.86em, 1017.98em, 4.646em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-3435"><span class="mtable" id="MathJax-Span-3436" style="min-width: 22.265em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 22.265em;"><span style="display: inline-block; position: absolute; width: 18.158em; height: 0px; clip: rect(-1.128em, 1017.98em, 0.658em, -999.997em); top: 0.003em; left: 50%; margin-left: -9.045em;"><span style="position: absolute; clip: rect(2.86em, 1017.98em, 4.646em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 18.158em; height: 0px;"><span style="position: absolute; clip: rect(2.801em, 1017.98em, 4.586em, -999.997em); top: -3.926em; left: 50%; margin-left: -9.045em;"><span class="mtd" id="MathJax-Span-3440"><span class="mrow" id="MathJax-Span-3441"><span class="mi" id="MathJax-Span-3442" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3443"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3444" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3445"><span class="mrow" id="MathJax-Span-3446"><span class="mo" id="MathJax-Span-3447" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3448" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3449" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.42em;"><span class="mi" id="MathJax-Span-3450" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3451" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-3452" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.301em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3453"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3454" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3455"><span class="mrow" id="MathJax-Span-3456"><span class="mi" id="MathJax-Span-3457" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span class="mi" id="MathJax-Span-3458" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3459" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3460" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3461" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="mi" id="MathJax-Span-3462" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">tanh</span><span class="mo" id="MathJax-Span-3463"></span><span class="mo" id="MathJax-Span-3464" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3465"><span style="display: inline-block; position: relative; width: 1.729em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3466" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="texatom" id="MathJax-Span-3467"><span class="mrow" id="MathJax-Span-3468"><span class="mi" id="MathJax-Span-3469" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span class="mi" id="MathJax-Span-3470" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3471" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3472" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3473" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-3474" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="msubsup" id="MathJax-Span-3475" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3476" style="font-family: STIXMathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-3477"><span class="mrow" id="MathJax-Span-3478"><span class="mo" id="MathJax-Span-3479" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3480" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3481" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.598em;"><span class="mi" id="MathJax-Span-3482" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3483" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="mrow" id="MathJax-Span-3484" style="padding-left: 0.241em;"><span class="mo" id="MathJax-Span-3485" style="vertical-align: -0.235em;"><span><span style="font-size: 109.8%; font-family: STIXMathJax_Size1;">(</span></span></span><span class="mn" id="MathJax-Span-3486" style="font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-3487" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="msubsup" id="MathJax-Span-3488" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3489" style="font-family: STIXMathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-3490"><span class="mrow" id="MathJax-Span-3491"><span class="mo" id="MathJax-Span-3492" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3493" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3494" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.598em;"><span class="mi" id="MathJax-Span-3495" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3496" style="vertical-align: -0.235em;"><span><span style="font-size: 109.8%; font-family: STIXMathJax_Size1;">)</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.193em; height: 0px; clip: rect(-0.83em, 1001.13em, 0.42em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.13em, 4.348em, -999.997em); top: -3.926em; right: 0.003em;"><span class="mtd" id="mjx-eqn-7"><span class="mrow" id="MathJax-Span-3438"><span class="mtext" id="MathJax-Span-3439" style="font-family: STIXMathJax_Main;">(7)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="false"><mlabeledtr><mtd id="mjx-eqn-7"><mtext>(7)</mtext></mtd><mtd><mi>d</mi><msubsup><mi>γ</mi><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>=</mo><mi>d</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo>∗</mo><mi>tanh</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo stretchy="false">)</mo><mo>∗</mo><msubsup><mi mathvariant="normal">Γ</mi><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>∗</mo><mrow><mo>(</mo><mn>1</mn><mo>−</mo><msubsup><mi mathvariant="normal">Γ</mi><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>)</mo></mrow></mtd></mlabeledtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-254">d\gamma_o^{\langle t \rangle} = da_{next}*\tanh(c_{next}) * \Gamma_o^{\langle t \rangle}*\left(1-\Gamma_o^{\langle t \rangle}\right)\tag{7}</script></p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-255-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable displaystyle=&quot;false&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-8&quot;&gt;&lt;mtext&gt;(8)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;tanh&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3497" role="math" style="width: 100%; display: inline-block; min-width: 36.491em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 36.491em;"><span style="position: absolute; clip: rect(2.622em, 1032.27em, 4.824em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-3498"><span class="mtable" id="MathJax-Span-3499" style="min-width: 36.491em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 36.491em;"><span style="display: inline-block; position: absolute; width: 32.384em; height: 0px; clip: rect(-1.366em, 1032.27em, 0.836em, -999.997em); top: 0.003em; left: 50%; margin-left: -16.188em;"><span style="position: absolute; clip: rect(2.622em, 1032.27em, 4.824em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 32.384em; height: 0px;"><span style="position: absolute; clip: rect(2.622em, 1032.27em, 4.824em, -999.997em); top: -3.985em; left: 50%; margin-left: -16.188em;"><span class="mtd" id="MathJax-Span-3503"><span class="mrow" id="MathJax-Span-3504"><span class="mi" id="MathJax-Span-3505" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3506" style="font-family: STIXMathJax_Main-italic; font-style: italic;">p</span><span class="msubsup" id="MathJax-Span-3507"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3508"><span class="mrow" id="MathJax-Span-3509"><span class="munderover" id="MathJax-Span-3510"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.063em;"><span class="mi" id="MathJax-Span-3511" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.039em, 1000.54em, 3.574em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-3512" style=""><span style="font-family: STIXMathJax_Size1;">˜</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.539em;"><span class="texatom" id="MathJax-Span-3513"><span class="mrow" id="MathJax-Span-3514"><span class="mo" id="MathJax-Span-3515" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3516" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3517" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3518" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mrow" id="MathJax-Span-3519" style="padding-left: 0.301em;"><span class="mo" id="MathJax-Span-3520" style="vertical-align: -0.235em;"><span><span style="font-size: 109.8%; font-family: STIXMathJax_Size1;">(</span></span></span><span class="mi" id="MathJax-Span-3521" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3522"><span style="display: inline-block; position: relative; width: 1.729em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3523" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="texatom" id="MathJax-Span-3524"><span class="mrow" id="MathJax-Span-3525"><span class="mi" id="MathJax-Span-3526" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span class="mi" id="MathJax-Span-3527" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3528" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3529" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3530" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="msubsup" id="MathJax-Span-3531" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3532" style="font-family: STIXMathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-3533"><span class="mrow" id="MathJax-Span-3534"><span class="mo" id="MathJax-Span-3535" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3536" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3537" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.598em;"><span class="mi" id="MathJax-Span-3538" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3539" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-3540" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3541" style="font-family: STIXMathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-3542"><span class="mrow" id="MathJax-Span-3543"><span class="mo" id="MathJax-Span-3544" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3545" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3546" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.598em;"><span class="mi" id="MathJax-Span-3547" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3548" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="mo" id="MathJax-Span-3549" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">(</span><span class="mn" id="MathJax-Span-3550" style="font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-3551" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="msubsup" id="MathJax-Span-3552" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1001.73em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3553" style="font-family: STIXMathJax_Main;">tanh</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 1.729em;"><span class="mn" id="MathJax-Span-3554" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3555"></span><span class="mo" id="MathJax-Span-3556" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3557"><span style="display: inline-block; position: relative; width: 1.729em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3558" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="texatom" id="MathJax-Span-3559"><span class="mrow" id="MathJax-Span-3560"><span class="mi" id="MathJax-Span-3561" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span class="mi" id="MathJax-Span-3562" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3563" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3564" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3565" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-3566" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-3567" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="msubsup" id="MathJax-Span-3568" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3569" style="font-family: STIXMathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-3570"><span class="mrow" id="MathJax-Span-3571"><span class="mo" id="MathJax-Span-3572" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3573" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3574" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.598em;"><span class="mi" id="MathJax-Span-3575" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3576" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="mi" id="MathJax-Span-3577" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.241em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3578"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3579" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3580"><span class="mrow" id="MathJax-Span-3581"><span class="mi" id="MathJax-Span-3582" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span class="mi" id="MathJax-Span-3583" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3584" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3585" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3586" style="vertical-align: -0.235em;"><span><span style="font-size: 109.8%; font-family: STIXMathJax_Size1;">)</span></span></span></span><span class="mo" id="MathJax-Span-3587" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="mrow" id="MathJax-Span-3588" style="padding-left: 0.241em;"><span class="mo" id="MathJax-Span-3589" style="vertical-align: -0.414em;"><span style="font-family: STIXMathJax_Size2;">(</span></span><span class="mn" id="MathJax-Span-3590" style="font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-3591" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="msubsup" id="MathJax-Span-3592" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 2.86em; height: 0px;"><span style="position: absolute; clip: rect(2.86em, 1002.26em, 4.586em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-3593"><span class="mo" id="MathJax-Span-3594" style="vertical-align: -0.235em;"><span><span style="font-size: 109.8%; font-family: STIXMathJax_Size1;">(</span></span></span><span class="msubsup" id="MathJax-Span-3595"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3596"><span class="mrow" id="MathJax-Span-3597"><span class="munderover" id="MathJax-Span-3598"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.063em;"><span class="mi" id="MathJax-Span-3599" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.039em, 1000.54em, 3.574em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-3600" style=""><span style="font-family: STIXMathJax_Size1;">˜</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.539em;"><span class="texatom" id="MathJax-Span-3601"><span class="mrow" id="MathJax-Span-3602"><span class="mo" id="MathJax-Span-3603" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3604" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3605" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3606" style="vertical-align: -0.235em;"><span><span style="font-size: 109.8%; font-family: STIXMathJax_Size1;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.699em; left: 2.443em;"><span class="mn" id="MathJax-Span-3607" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3608" style="vertical-align: -0.414em;"><span style="font-family: STIXMathJax_Size2;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.193em; height: 0px; clip: rect(-0.83em, 1001.13em, 0.36em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.13em, 4.348em, -999.997em); top: -3.985em; right: 0.003em;"><span class="mtd" id="mjx-eqn-8"><span class="mrow" id="MathJax-Span-3501"><span class="mtext" id="MathJax-Span-3502" style="font-family: STIXMathJax_Main;">(8)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.854em; border-left: 0px solid; width: 0px; height: 2.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="false"><mlabeledtr><mtd id="mjx-eqn-8"><mtext>(8)</mtext></mtd><mtd><mi>d</mi><mi>p</mi><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>c</mi><mo>~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>=</mo><mrow><mo>(</mo><mi>d</mi><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo>∗</mo><msubsup><mi mathvariant="normal">Γ</mi><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>+</mo><msubsup><mi mathvariant="normal">Γ</mi><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>∗</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msup><mi>tanh</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>∗</mo><msubsup><mi mathvariant="normal">Γ</mi><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>∗</mo><mi>d</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo>)</mo></mrow><mo>∗</mo><mrow><mo>(</mo><mn>1</mn><mo>−</mo><msup><mrow><mo>(</mo><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>c</mi><mo>~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>)</mo></mrow><mn>2</mn></msup><mo>)</mo></mrow></mtd></mlabeledtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-255">dp\widetilde{c}^{\langle t \rangle} = \left(dc_{next}*\Gamma_u^{\langle t \rangle}+ \Gamma_o^{\langle t \rangle}* (1-\tanh^2(c_{next})) * \Gamma_u^{\langle t \rangle} * da_{next} \right) * \left(1-\left(\widetilde c^{\langle t \rangle}\right)^2\right) \tag{8}</script></p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-256-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable displaystyle=&quot;false&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-9&quot;&gt;&lt;mtext&gt;(9)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;tanh&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3609" role="math" style="width: 100%; display: inline-block; min-width: 36.729em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 36.729em;"><span style="position: absolute; clip: rect(2.86em, 1032.44em, 4.646em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-3610"><span class="mtable" id="MathJax-Span-3611" style="min-width: 36.729em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 36.729em;"><span style="display: inline-block; position: absolute; width: 32.622em; height: 0px; clip: rect(-1.128em, 1032.44em, 0.658em, -999.997em); top: 0.003em; left: 50%; margin-left: -16.307em;"><span style="position: absolute; clip: rect(2.86em, 1032.44em, 4.646em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 32.622em; height: 0px;"><span style="position: absolute; clip: rect(2.801em, 1032.44em, 4.586em, -999.997em); top: -3.926em; left: 50%; margin-left: -16.307em;"><span class="mtd" id="MathJax-Span-3615"><span class="mrow" id="MathJax-Span-3616"><span class="mi" id="MathJax-Span-3617" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3618"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3619" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3620"><span class="mrow" id="MathJax-Span-3621"><span class="mo" id="MathJax-Span-3622" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3623" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3624" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.42em;"><span class="mi" id="MathJax-Span-3625" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3626" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mrow" id="MathJax-Span-3627" style="padding-left: 0.301em;"><span class="mo" id="MathJax-Span-3628" style="vertical-align: -0.235em;"><span><span style="font-size: 109.8%; font-family: STIXMathJax_Size1;">(</span></span></span><span class="mi" id="MathJax-Span-3629" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3630"><span style="display: inline-block; position: relative; width: 1.729em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3631" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="texatom" id="MathJax-Span-3632"><span class="mrow" id="MathJax-Span-3633"><span class="mi" id="MathJax-Span-3634" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span class="mi" id="MathJax-Span-3635" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3636" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3637" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3638" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="msubsup" id="MathJax-Span-3639" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3640"><span class="mrow" id="MathJax-Span-3641"><span class="munderover" id="MathJax-Span-3642"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.063em;"><span class="mi" id="MathJax-Span-3643" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.039em, 1000.54em, 3.574em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-3644" style=""><span style="font-family: STIXMathJax_Size1;">˜</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.539em;"><span class="texatom" id="MathJax-Span-3645"><span class="mrow" id="MathJax-Span-3646"><span class="mo" id="MathJax-Span-3647" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3648" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3649" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3650" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-3651" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3652" style="font-family: STIXMathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-3653"><span class="mrow" id="MathJax-Span-3654"><span class="mo" id="MathJax-Span-3655" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3656" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3657" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.598em;"><span class="mi" id="MathJax-Span-3658" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3659" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="mo" id="MathJax-Span-3660" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">(</span><span class="mn" id="MathJax-Span-3661" style="font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-3662" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="msubsup" id="MathJax-Span-3663" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1001.73em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3664" style="font-family: STIXMathJax_Main;">tanh</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 1.729em;"><span class="mn" id="MathJax-Span-3665" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3666"></span><span class="mo" id="MathJax-Span-3667" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3668"><span style="display: inline-block; position: relative; width: 1.729em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3669" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="texatom" id="MathJax-Span-3670"><span class="mrow" id="MathJax-Span-3671"><span class="mi" id="MathJax-Span-3672" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span class="mi" id="MathJax-Span-3673" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3674" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3675" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3676" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-3677" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-3678" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="msubsup" id="MathJax-Span-3679" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3680"><span class="mrow" id="MathJax-Span-3681"><span class="munderover" id="MathJax-Span-3682"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.063em;"><span class="mi" id="MathJax-Span-3683" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.039em, 1000.54em, 3.574em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-3684" style=""><span style="font-family: STIXMathJax_Size1;">˜</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.539em;"><span class="texatom" id="MathJax-Span-3685"><span class="mrow" id="MathJax-Span-3686"><span class="mo" id="MathJax-Span-3687" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3688" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3689" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3690" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="mi" id="MathJax-Span-3691" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.241em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3692"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3693" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3694"><span class="mrow" id="MathJax-Span-3695"><span class="mi" id="MathJax-Span-3696" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span class="mi" id="MathJax-Span-3697" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3698" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3699" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3700" style="vertical-align: -0.235em;"><span><span style="font-size: 109.8%; font-family: STIXMathJax_Size1;">)</span></span></span></span><span class="mo" id="MathJax-Span-3701" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="msubsup" id="MathJax-Span-3702" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3703" style="font-family: STIXMathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-3704"><span class="mrow" id="MathJax-Span-3705"><span class="mo" id="MathJax-Span-3706" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3707" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3708" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.598em;"><span class="mi" id="MathJax-Span-3709" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3710" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="mrow" id="MathJax-Span-3711" style="padding-left: 0.241em;"><span class="mo" id="MathJax-Span-3712" style="vertical-align: -0.235em;"><span><span style="font-size: 109.8%; font-family: STIXMathJax_Size1;">(</span></span></span><span class="mn" id="MathJax-Span-3713" style="font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-3714" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="msubsup" id="MathJax-Span-3715" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3716" style="font-family: STIXMathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-3717"><span class="mrow" id="MathJax-Span-3718"><span class="mo" id="MathJax-Span-3719" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3720" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3721" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.598em;"><span class="mi" id="MathJax-Span-3722" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3723" style="vertical-align: -0.235em;"><span><span style="font-size: 109.8%; font-family: STIXMathJax_Size1;">)</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.193em; height: 0px; clip: rect(-0.83em, 1001.13em, 0.42em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.13em, 4.348em, -999.997em); top: -3.926em; right: 0.003em;"><span class="mtd" id="mjx-eqn-9"><span class="mrow" id="MathJax-Span-3613"><span class="mtext" id="MathJax-Span-3614" style="font-family: STIXMathJax_Main;">(9)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="false"><mlabeledtr><mtd id="mjx-eqn-9"><mtext>(9)</mtext></mtd><mtd><mi>d</mi><msubsup><mi>γ</mi><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>=</mo><mrow><mo>(</mo><mi>d</mi><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo>∗</mo><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>c</mi><mo>~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msubsup><mi mathvariant="normal">Γ</mi><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>∗</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msup><mi>tanh</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>∗</mo><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>c</mi><mo>~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>∗</mo><mi>d</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo>)</mo></mrow><mo>∗</mo><msubsup><mi mathvariant="normal">Γ</mi><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>∗</mo><mrow><mo>(</mo><mn>1</mn><mo>−</mo><msubsup><mi mathvariant="normal">Γ</mi><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>)</mo></mrow></mtd></mlabeledtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-256">d\gamma_u^{\langle t \rangle} = \left(dc_{next}*\widetilde{c}^{\langle t \rangle} + \Gamma_o^{\langle t \rangle}* (1-\tanh^2(c_{next})) * \widetilde{c}^{\langle t \rangle} * da_{next}\right)*\Gamma_u^{\langle t \rangle}*\left(1-\Gamma_u^{\langle t \rangle}\right)\tag{9}</script></p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-257-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable displaystyle=&quot;false&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-10&quot;&gt;&lt;mtext&gt;(10)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;tanh&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3724" role="math" style="width: 100%; display: inline-block; min-width: 38.515em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 38.515em;"><span style="position: absolute; clip: rect(2.86em, 1033.22em, 4.646em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-3725"><span class="mtable" id="MathJax-Span-3726" style="min-width: 38.515em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 38.515em;"><span style="display: inline-block; position: absolute; width: 33.396em; height: 0px; clip: rect(-1.128em, 1033.22em, 0.658em, -999.997em); top: 0.003em; left: 50%; margin-left: -16.664em;"><span style="position: absolute; clip: rect(2.86em, 1033.22em, 4.646em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 33.396em; height: 0px;"><span style="position: absolute; clip: rect(2.801em, 1033.22em, 4.646em, -999.997em); top: -3.985em; left: 50%; margin-left: -16.664em;"><span class="mtd" id="MathJax-Span-3730"><span class="mrow" id="MathJax-Span-3731"><span class="mi" id="MathJax-Span-3732" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3733"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3734" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3735"><span class="mrow" id="MathJax-Span-3736"><span class="mo" id="MathJax-Span-3737" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3738" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3739" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -3.688em; left: 0.42em;"><span class="mi" id="MathJax-Span-3740" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3741" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mrow" id="MathJax-Span-3742" style="padding-left: 0.301em;"><span class="mo" id="MathJax-Span-3743" style="vertical-align: -0.235em;"><span><span style="font-size: 109.8%; font-family: STIXMathJax_Size1;">(</span></span></span><span class="mi" id="MathJax-Span-3744" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3745"><span style="display: inline-block; position: relative; width: 1.729em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3746" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="texatom" id="MathJax-Span-3747"><span class="mrow" id="MathJax-Span-3748"><span class="mi" id="MathJax-Span-3749" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span class="mi" id="MathJax-Span-3750" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3751" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3752" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3753" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="msubsup" id="MathJax-Span-3754" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3755" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="texatom" id="MathJax-Span-3756"><span class="mrow" id="MathJax-Span-3757"><span class="mi" id="MathJax-Span-3758" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">p</span><span class="mi" id="MathJax-Span-3759" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3760" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3761" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3762" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-3763" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3764" style="font-family: STIXMathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-3765"><span class="mrow" id="MathJax-Span-3766"><span class="mo" id="MathJax-Span-3767" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3768" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3769" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.598em;"><span class="mi" id="MathJax-Span-3770" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3771" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="mo" id="MathJax-Span-3772" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">(</span><span class="mn" id="MathJax-Span-3773" style="font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-3774" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="msubsup" id="MathJax-Span-3775" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1001.73em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3776" style="font-family: STIXMathJax_Main;">tanh</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 1.729em;"><span class="mn" id="MathJax-Span-3777" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3778"></span><span class="mo" id="MathJax-Span-3779" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3780"><span style="display: inline-block; position: relative; width: 1.729em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3781" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="texatom" id="MathJax-Span-3782"><span class="mrow" id="MathJax-Span-3783"><span class="mi" id="MathJax-Span-3784" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span class="mi" id="MathJax-Span-3785" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3786" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3787" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3788" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-3789" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-3790" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="msubsup" id="MathJax-Span-3791" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3792" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="texatom" id="MathJax-Span-3793"><span class="mrow" id="MathJax-Span-3794"><span class="mi" id="MathJax-Span-3795" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">p</span><span class="mi" id="MathJax-Span-3796" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3797" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3798" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3799" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="mi" id="MathJax-Span-3800" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.241em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3801"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3802" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3803"><span class="mrow" id="MathJax-Span-3804"><span class="mi" id="MathJax-Span-3805" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span class="mi" id="MathJax-Span-3806" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3807" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3808" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3809" style="vertical-align: -0.235em;"><span><span style="font-size: 109.8%; font-family: STIXMathJax_Size1;">)</span></span></span></span><span class="mo" id="MathJax-Span-3810" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="msubsup" id="MathJax-Span-3811" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3812" style="font-family: STIXMathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-3813"><span class="mrow" id="MathJax-Span-3814"><span class="mo" id="MathJax-Span-3815" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3816" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3817" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -3.688em; left: 0.598em;"><span class="mi" id="MathJax-Span-3818" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3819" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="mrow" id="MathJax-Span-3820" style="padding-left: 0.241em;"><span class="mo" id="MathJax-Span-3821" style="vertical-align: -0.235em;"><span><span style="font-size: 109.8%; font-family: STIXMathJax_Size1;">(</span></span></span><span class="mn" id="MathJax-Span-3822" style="font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-3823" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="msubsup" id="MathJax-Span-3824" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3825" style="font-family: STIXMathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-3826"><span class="mrow" id="MathJax-Span-3827"><span class="mo" id="MathJax-Span-3828" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3829" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3830" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -3.688em; left: 0.598em;"><span class="mi" id="MathJax-Span-3831" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3832" style="vertical-align: -0.235em;"><span><span style="font-size: 109.8%; font-family: STIXMathJax_Size1;">)</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.67em; height: 0px; clip: rect(-0.83em, 1001.61em, 0.36em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.61em, 4.348em, -999.997em); top: -3.985em; right: 0.003em;"><span class="mtd" id="mjx-eqn-10"><span class="mrow" id="MathJax-Span-3728"><span class="mtext" id="MathJax-Span-3729" style="font-family: STIXMathJax_Main;">(10)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="false"><mlabeledtr><mtd id="mjx-eqn-10"><mtext>(10)</mtext></mtd><mtd><mi>d</mi><msubsup><mi>γ</mi><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>=</mo><mrow><mo>(</mo><mi>d</mi><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo>∗</mo><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>r</mi><mi>e</mi><mi>v</mi></mrow></msub><mo>+</mo><msubsup><mi mathvariant="normal">Γ</mi><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>∗</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msup><mi>tanh</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>∗</mo><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>r</mi><mi>e</mi><mi>v</mi></mrow></msub><mo>∗</mo><mi>d</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo>)</mo></mrow><mo>∗</mo><msubsup><mi mathvariant="normal">Γ</mi><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>∗</mo><mrow><mo>(</mo><mn>1</mn><mo>−</mo><msubsup><mi mathvariant="normal">Γ</mi><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>)</mo></mrow></mtd></mlabeledtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-257">d\gamma_f^{\langle t \rangle} = \left(dc_{next}* c_{prev} + \Gamma_o^{\langle t \rangle} * (1-\tanh^2(c_{next})) * c_{prev} * da_{next}\right)*\Gamma_f^{\langle t \rangle}*\left(1-\Gamma_f^{\langle t \rangle}\right)\tag{10}</script></p>
<h3 id="3.2.3-parameter-derivatives">3.2.3 parameter derivatives<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#3.2.3-parameter-derivatives">¶</a></h3>
<p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-258-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable displaystyle=&quot;false&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-11&quot;&gt;&lt;mtext&gt;(11)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3833" role="math" style="width: 100%; display: inline-block; min-width: 13.813em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 13.813em;"><span style="position: absolute; clip: rect(2.205em, 1008.63em, 5.301em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-3834"><span class="mtable" id="MathJax-Span-3835" style="min-width: 13.813em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 13.813em;"><span style="display: inline-block; position: absolute; width: 8.634em; height: 0px; clip: rect(-1.783em, 1008.63em, 1.313em, -999.997em); top: 0.003em; left: 50%; margin-left: -4.342em;"><span style="position: absolute; clip: rect(2.205em, 1008.63em, 5.301em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 8.634em; height: 0px;"><span style="position: absolute; clip: rect(2.086em, 1008.63em, 5.182em, -999.997em); top: -3.866em; left: 50%; margin-left: -4.342em;"><span class="mtd" id="MathJax-Span-3839"><span class="mrow" id="MathJax-Span-3840"><span class="mi" id="MathJax-Span-3841" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3842"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3843" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="mi" id="MathJax-Span-3844" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3845" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-3846" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.301em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3847"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3848" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3849"><span class="mrow" id="MathJax-Span-3850"><span class="mo" id="MathJax-Span-3851" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3852" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3853" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -3.688em; left: 0.42em;"><span class="mi" id="MathJax-Span-3854" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3855"><span style="display: inline-block; position: relative; width: 3.753em; height: 0px;"><span style="position: absolute; clip: rect(2.265em, 1003.04em, 5.182em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-3856"><span class="mo" id="MathJax-Span-3857" style="vertical-align: -0.592em;"><span style="font-family: STIXMathJax_Size3;">[</span></span><span class="mtable" id="MathJax-Span-3858" style="padding-right: 0.182em; padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(2.622em, 1001.85em, 5.122em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1001.85em, 4.467em, -999.997em); top: -4.699em; left: 50%; margin-left: -0.949em;"><span class="mtd" id="MathJax-Span-3859"><span class="mrow" id="MathJax-Span-3860"><span class="msubsup" id="MathJax-Span-3861"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3862" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3863"><span class="mrow" id="MathJax-Span-3864"><span class="mi" id="MathJax-Span-3865" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">p</span><span class="mi" id="MathJax-Span-3866" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3867" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3868" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.72em, 4.348em, -999.997em); top: -3.152em; left: 50%; margin-left: -0.354em;"><span class="mtd" id="MathJax-Span-3869"><span class="mrow" id="MathJax-Span-3870"><span class="msubsup" id="MathJax-Span-3871"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3872" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="mi" id="MathJax-Span-3873" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3874" style="vertical-align: -0.592em;"><span style="font-family: STIXMathJax_Size3;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -5.235em; left: 3.217em;"><span class="mi" id="MathJax-Span-3875" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.67em; height: 0px; clip: rect(-0.771em, 1001.61em, 0.479em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.61em, 4.348em, -999.997em); top: -3.866em; right: 0.003em;"><span class="mtd" id="mjx-eqn-11"><span class="mrow" id="MathJax-Span-3837"><span class="mtext" id="MathJax-Span-3838" style="font-family: STIXMathJax_Main;">(11)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.425em; border-left: 0px solid; width: 0px; height: 3.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="false"><mlabeledtr><mtd id="mjx-eqn-11"><mtext>(11)</mtext></mtd><mtd><mi>d</mi><msub><mi>W</mi><mi>f</mi></msub><mo>=</mo><mi>d</mi><msubsup><mi>γ</mi><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><msup><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>r</mi><mi>e</mi><mi>v</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>x</mi><mi>t</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><mi>T</mi></msup></mtd></mlabeledtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-258"> dW_f = d\gamma_f^{\langle t \rangle} \begin{bmatrix} a_{prev} \\ x_t\end{bmatrix}^T \tag{11} </script>
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-259-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable displaystyle=&quot;false&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-12&quot;&gt;&lt;mtext&gt;(12)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3876" role="math" style="width: 100%; display: inline-block; min-width: 13.813em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 13.813em;"><span style="position: absolute; clip: rect(2.205em, 1008.69em, 5.301em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-3877"><span class="mtable" id="MathJax-Span-3878" style="min-width: 13.813em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 13.813em;"><span style="display: inline-block; position: absolute; width: 8.693em; height: 0px; clip: rect(-1.783em, 1008.69em, 1.313em, -999.997em); top: 0.003em; left: 50%; margin-left: -4.342em;"><span style="position: absolute; clip: rect(2.205em, 1008.69em, 5.301em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 8.693em; height: 0px;"><span style="position: absolute; clip: rect(2.086em, 1008.69em, 5.182em, -999.997em); top: -3.866em; left: 50%; margin-left: -4.342em;"><span class="mtd" id="MathJax-Span-3882"><span class="mrow" id="MathJax-Span-3883"><span class="mi" id="MathJax-Span-3884" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3885"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3886" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="mi" id="MathJax-Span-3887" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3888" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-3889" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.301em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3890"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3891" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3892"><span class="mrow" id="MathJax-Span-3893"><span class="mo" id="MathJax-Span-3894" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3895" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3896" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.42em;"><span class="mi" id="MathJax-Span-3897" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3898"><span style="display: inline-block; position: relative; width: 3.753em; height: 0px;"><span style="position: absolute; clip: rect(2.265em, 1003.04em, 5.182em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-3899"><span class="mo" id="MathJax-Span-3900" style="vertical-align: -0.592em;"><span style="font-family: STIXMathJax_Size3;">[</span></span><span class="mtable" id="MathJax-Span-3901" style="padding-right: 0.182em; padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(2.622em, 1001.85em, 5.122em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1001.85em, 4.467em, -999.997em); top: -4.699em; left: 50%; margin-left: -0.949em;"><span class="mtd" id="MathJax-Span-3902"><span class="mrow" id="MathJax-Span-3903"><span class="msubsup" id="MathJax-Span-3904"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3905" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3906"><span class="mrow" id="MathJax-Span-3907"><span class="mi" id="MathJax-Span-3908" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">p</span><span class="mi" id="MathJax-Span-3909" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3910" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3911" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.72em, 4.348em, -999.997em); top: -3.152em; left: 50%; margin-left: -0.354em;"><span class="mtd" id="MathJax-Span-3912"><span class="mrow" id="MathJax-Span-3913"><span class="msubsup" id="MathJax-Span-3914"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3915" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="mi" id="MathJax-Span-3916" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3917" style="vertical-align: -0.592em;"><span style="font-family: STIXMathJax_Size3;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -5.235em; left: 3.217em;"><span class="mi" id="MathJax-Span-3918" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.67em; height: 0px; clip: rect(-0.771em, 1001.61em, 0.479em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.61em, 4.348em, -999.997em); top: -3.866em; right: 0.003em;"><span class="mtd" id="mjx-eqn-12"><span class="mrow" id="MathJax-Span-3880"><span class="mtext" id="MathJax-Span-3881" style="font-family: STIXMathJax_Main;">(12)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.425em; border-left: 0px solid; width: 0px; height: 3.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="false"><mlabeledtr><mtd id="mjx-eqn-12"><mtext>(12)</mtext></mtd><mtd><mi>d</mi><msub><mi>W</mi><mi>u</mi></msub><mo>=</mo><mi>d</mi><msubsup><mi>γ</mi><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><msup><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>r</mi><mi>e</mi><mi>v</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>x</mi><mi>t</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><mi>T</mi></msup></mtd></mlabeledtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-259"> dW_u = d\gamma_u^{\langle t \rangle} \begin{bmatrix} a_{prev} \\ x_t\end{bmatrix}^T \tag{12} </script>
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-260-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable displaystyle=&quot;false&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-13&quot;&gt;&lt;mtext&gt;(13)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3919" role="math" style="width: 100%; display: inline-block; min-width: 14.348em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 14.348em;"><span style="position: absolute; clip: rect(2.205em, 1009.23em, 5.301em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-3920"><span class="mtable" id="MathJax-Span-3921" style="min-width: 14.348em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 14.348em;"><span style="display: inline-block; position: absolute; width: 9.229em; height: 0px; clip: rect(-1.783em, 1009.23em, 1.313em, -999.997em); top: 0.003em; left: 50%; margin-left: -4.64em;"><span style="position: absolute; clip: rect(2.205em, 1009.23em, 5.301em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 9.229em; height: 0px;"><span style="position: absolute; clip: rect(2.086em, 1009.23em, 5.182em, -999.997em); top: -3.866em; left: 50%; margin-left: -4.64em;"><span class="mtd" id="MathJax-Span-3925"><span class="mrow" id="MathJax-Span-3926"><span class="mi" id="MathJax-Span-3927" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3928"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3929" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="mi" id="MathJax-Span-3930" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3931" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-3932" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.301em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3933" style="font-family: STIXMathJax_Main-italic; font-style: italic;">p</span><span class="msubsup" id="MathJax-Span-3934"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3935"><span class="mrow" id="MathJax-Span-3936"><span class="munderover" id="MathJax-Span-3937"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.063em;"><span class="mi" id="MathJax-Span-3938" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.039em, 1000.54em, 3.574em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-3939" style=""><span style="font-family: STIXMathJax_Size1;">˜</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.539em;"><span class="texatom" id="MathJax-Span-3940"><span class="mrow" id="MathJax-Span-3941"><span class="mo" id="MathJax-Span-3942" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3943" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3944" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3945"><span style="display: inline-block; position: relative; width: 3.753em; height: 0px;"><span style="position: absolute; clip: rect(2.265em, 1003.04em, 5.182em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-3946"><span class="mo" id="MathJax-Span-3947" style="vertical-align: -0.592em;"><span style="font-family: STIXMathJax_Size3;">[</span></span><span class="mtable" id="MathJax-Span-3948" style="padding-right: 0.182em; padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(2.622em, 1001.85em, 5.122em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1001.85em, 4.467em, -999.997em); top: -4.699em; left: 50%; margin-left: -0.949em;"><span class="mtd" id="MathJax-Span-3949"><span class="mrow" id="MathJax-Span-3950"><span class="msubsup" id="MathJax-Span-3951"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3952" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3953"><span class="mrow" id="MathJax-Span-3954"><span class="mi" id="MathJax-Span-3955" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">p</span><span class="mi" id="MathJax-Span-3956" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3957" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3958" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.72em, 4.348em, -999.997em); top: -3.152em; left: 50%; margin-left: -0.354em;"><span class="mtd" id="MathJax-Span-3959"><span class="mrow" id="MathJax-Span-3960"><span class="msubsup" id="MathJax-Span-3961"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3962" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="mi" id="MathJax-Span-3963" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3964" style="vertical-align: -0.592em;"><span style="font-family: STIXMathJax_Size3;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -5.235em; left: 3.217em;"><span class="mi" id="MathJax-Span-3965" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.67em; height: 0px; clip: rect(-0.771em, 1001.61em, 0.479em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.61em, 4.348em, -999.997em); top: -3.866em; right: 0.003em;"><span class="mtd" id="mjx-eqn-13"><span class="mrow" id="MathJax-Span-3923"><span class="mtext" id="MathJax-Span-3924" style="font-family: STIXMathJax_Main;">(13)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.425em; border-left: 0px solid; width: 0px; height: 3.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="false"><mlabeledtr><mtd id="mjx-eqn-13"><mtext>(13)</mtext></mtd><mtd><mi>d</mi><msub><mi>W</mi><mi>c</mi></msub><mo>=</mo><mi>d</mi><mi>p</mi><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>c</mi><mo>~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><msup><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>r</mi><mi>e</mi><mi>v</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>x</mi><mi>t</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><mi>T</mi></msup></mtd></mlabeledtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-260"> dW_c = dp\widetilde c^{\langle t \rangle} \begin{bmatrix} a_{prev} \\ x_t\end{bmatrix}^T \tag{13} </script>
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-261-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable displaystyle=&quot;false&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-14&quot;&gt;&lt;mtext&gt;(14)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3966" role="math" style="width: 100%; display: inline-block; min-width: 13.813em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 13.813em;"><span style="position: absolute; clip: rect(2.205em, 1008.69em, 5.301em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-3967"><span class="mtable" id="MathJax-Span-3968" style="min-width: 13.813em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 13.813em;"><span style="display: inline-block; position: absolute; width: 8.693em; height: 0px; clip: rect(-1.783em, 1008.69em, 1.313em, -999.997em); top: 0.003em; left: 50%; margin-left: -4.342em;"><span style="position: absolute; clip: rect(2.205em, 1008.69em, 5.301em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 8.693em; height: 0px;"><span style="position: absolute; clip: rect(2.086em, 1008.69em, 5.182em, -999.997em); top: -3.866em; left: 50%; margin-left: -4.342em;"><span class="mtd" id="MathJax-Span-3972"><span class="mrow" id="MathJax-Span-3973"><span class="mi" id="MathJax-Span-3974" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3975"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3976" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="mi" id="MathJax-Span-3977" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-3978" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-3979" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.301em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3980"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3981" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3982"><span class="mrow" id="MathJax-Span-3983"><span class="mo" id="MathJax-Span-3984" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-3985" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3986" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.42em;"><span class="mi" id="MathJax-Span-3987" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3988"><span style="display: inline-block; position: relative; width: 3.753em; height: 0px;"><span style="position: absolute; clip: rect(2.265em, 1003.04em, 5.182em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-3989"><span class="mo" id="MathJax-Span-3990" style="vertical-align: -0.592em;"><span style="font-family: STIXMathJax_Size3;">[</span></span><span class="mtable" id="MathJax-Span-3991" style="padding-right: 0.182em; padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(2.622em, 1001.85em, 5.122em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1001.85em, 4.467em, -999.997em); top: -4.699em; left: 50%; margin-left: -0.949em;"><span class="mtd" id="MathJax-Span-3992"><span class="mrow" id="MathJax-Span-3993"><span class="msubsup" id="MathJax-Span-3994"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-3995" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3996"><span class="mrow" id="MathJax-Span-3997"><span class="mi" id="MathJax-Span-3998" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">p</span><span class="mi" id="MathJax-Span-3999" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4000" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-4001" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.72em, 4.348em, -999.997em); top: -3.152em; left: 50%; margin-left: -0.354em;"><span class="mtd" id="MathJax-Span-4002"><span class="mrow" id="MathJax-Span-4003"><span class="msubsup" id="MathJax-Span-4004"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4005" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="mi" id="MathJax-Span-4006" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4007" style="vertical-align: -0.592em;"><span style="font-family: STIXMathJax_Size3;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -5.235em; left: 3.217em;"><span class="mi" id="MathJax-Span-4008" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.67em; height: 0px; clip: rect(-0.771em, 1001.61em, 0.479em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.61em, 4.348em, -999.997em); top: -3.866em; right: 0.003em;"><span class="mtd" id="mjx-eqn-14"><span class="mrow" id="MathJax-Span-3970"><span class="mtext" id="MathJax-Span-3971" style="font-family: STIXMathJax_Main;">(14)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.425em; border-left: 0px solid; width: 0px; height: 3.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="false"><mlabeledtr><mtd id="mjx-eqn-14"><mtext>(14)</mtext></mtd><mtd><mi>d</mi><msub><mi>W</mi><mi>o</mi></msub><mo>=</mo><mi>d</mi><msubsup><mi>γ</mi><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><msup><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>r</mi><mi>e</mi><mi>v</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>x</mi><mi>t</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><mi>T</mi></msup></mtd></mlabeledtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-261"> dW_o = d\gamma_o^{\langle t \rangle} \begin{bmatrix} a_{prev} \\ x_t\end{bmatrix}^T \tag{14}</script></p>
<p>To calculate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-262-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4009" role="math" style="width: 8.396em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.967em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1006.97em, 2.86em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-4010"><span class="mi" id="MathJax-Span-4011" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4012"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4013" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-4014" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4015" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-4016" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4017"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4018" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-4019" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4020" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-4021" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4022"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4023" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-4024" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4025" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-4026" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4027"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4028" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-4029" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msub><mi>b</mi><mi>f</mi></msub><mo>,</mo><mi>d</mi><msub><mi>b</mi><mi>u</mi></msub><mo>,</mo><mi>d</mi><msub><mi>b</mi><mi>c</mi></msub><mo>,</mo><mi>d</mi><msub><mi>b</mi><mi>o</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-262">db_f, db_u, db_c, db_o</script> you just need to sum across the horizontal (axis= 1) axis on <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-263-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4030" role="math" style="width: 11.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.348em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em, 1009.35em, 3.039em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-4031"><span class="mi" id="MathJax-Span-4032" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4033"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4034" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-4035"><span class="mrow" id="MathJax-Span-4036"><span class="mo" id="MathJax-Span-4037" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4038" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4039" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -3.688em; left: 0.42em;"><span class="mi" id="MathJax-Span-4040" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4041" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-4042" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4043"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4044" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-4045"><span class="mrow" id="MathJax-Span-4046"><span class="mo" id="MathJax-Span-4047" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4048" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4049" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.42em;"><span class="mi" id="MathJax-Span-4050" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4051" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-4052" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4053" style="font-family: STIXMathJax_Main-italic; font-style: italic;">p</span><span class="msubsup" id="MathJax-Span-4054"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-4055"><span class="mrow" id="MathJax-Span-4056"><span class="munderover" id="MathJax-Span-4057"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.063em;"><span class="mi" id="MathJax-Span-4058" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.039em, 1000.54em, 3.574em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-4059" style=""><span style="font-family: STIXMathJax_Size1;">˜</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.539em;"><span class="texatom" id="MathJax-Span-4060"><span class="mrow" id="MathJax-Span-4061"><span class="mo" id="MathJax-Span-4062" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4063" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4064" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4065" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-4066" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4067"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4068" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-4069"><span class="mrow" id="MathJax-Span-4070"><span class="mo" id="MathJax-Span-4071" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4072" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4073" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.42em;"><span class="mi" id="MathJax-Span-4074" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msubsup><mi>γ</mi><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>,</mo><mi>d</mi><msubsup><mi>γ</mi><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>,</mo><mi>d</mi><mi>p</mi><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>c</mi><mo>~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>,</mo><mi>d</mi><msubsup><mi>γ</mi><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-263">d\gamma_f^{\langle t \rangle}, d\gamma_u^{\langle t \rangle}, dp\widetilde c^{\langle t \rangle}, d\gamma_o^{\langle t \rangle}</script> respectively. Note that you should have the <code>keepdims = True</code> option.</p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-264-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable displaystyle=&quot;false&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-15&quot;&gt;&lt;mtext&gt;(15)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4075" role="math" style="width: 100%; display: inline-block; min-width: 11.491em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 11.491em;"><span style="position: absolute; clip: rect(2.443em, 1006.31em, 5.063em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-4076"><span class="mtable" id="MathJax-Span-4077" style="min-width: 11.491em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 11.491em;"><span style="display: inline-block; position: absolute; width: 6.313em; height: 0px; clip: rect(-1.545em, 1006.31em, 1.074em, -999.997em); top: 0.003em; left: 50%; margin-left: -3.152em;"><span style="position: absolute; clip: rect(2.443em, 1006.31em, 5.063em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 6.313em; height: 0px;"><span style="position: absolute; clip: rect(2.801em, 1006.31em, 5.42em, -999.997em); top: -4.342em; left: 50%; margin-left: -3.152em;"><span class="mtd" id="MathJax-Span-4081"><span class="mrow" id="MathJax-Span-4082"><span class="mstyle" id="MathJax-Span-4083"><span class="mrow" id="MathJax-Span-4084"><span class="mi" id="MathJax-Span-4085" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4086"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4087" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-4088" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4089" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="munderover" id="MathJax-Span-4090" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(2.86em, 1001.19em, 4.646em, -999.997em); top: -3.985em; left: 0.122em;"><span class="mo" id="MathJax-Span-4091" style="font-family: STIXMathJax_Size1; vertical-align: -0.533em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1001.55em, 4.289em, -999.997em); top: -2.854em; left: 0.003em;"><span class="texatom" id="MathJax-Span-4092"><span class="mrow" id="MathJax-Span-4093"><span class="mi" id="MathJax-Span-4094" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span class="mi" id="MathJax-Span-4095" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-4096" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4097" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span class="mi" id="MathJax-Span-4098" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-4099" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4100"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4101" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-4102"><span class="mrow" id="MathJax-Span-4103"><span class="mo" id="MathJax-Span-4104" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4105" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4106" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -3.688em; left: 0.42em;"><span class="mi" id="MathJax-Span-4107" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.67em; height: 0px; clip: rect(-1.247em, 1001.61em, 0.003em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.098em, 1001.61em, 4.348em, -999.997em); top: -4.342em; right: 0.003em;"><span class="mtd" id="mjx-eqn-15"><span class="mrow" id="MathJax-Span-4079"><span class="mtext" id="MathJax-Span-4080" style="font-family: STIXMathJax_Main;">(15)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.139em; border-left: 0px solid; width: 0px; height: 2.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="false"><mlabeledtr><mtd id="mjx-eqn-15"><mtext>(15)</mtext></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mi>d</mi><msub><mi>b</mi><mi>f</mi></msub><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi></mrow></munder><mi>d</mi><msubsup><mi>γ</mi><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup></mstyle></mtd></mlabeledtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-264">\displaystyle db_f = \sum_{batch}d\gamma_f^{\langle t \rangle}\tag{15}</script>
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-265-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable displaystyle=&quot;false&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-16&quot;&gt;&lt;mtext&gt;(16)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4108" role="math" style="width: 100%; display: inline-block; min-width: 11.491em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 11.491em;"><span style="position: absolute; clip: rect(2.443em, 1006.37em, 5.063em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-4109"><span class="mtable" id="MathJax-Span-4110" style="min-width: 11.491em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 11.491em;"><span style="display: inline-block; position: absolute; width: 6.372em; height: 0px; clip: rect(-1.545em, 1006.37em, 1.074em, -999.997em); top: 0.003em; left: 50%; margin-left: -3.211em;"><span style="position: absolute; clip: rect(2.443em, 1006.37em, 5.063em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 6.372em; height: 0px;"><span style="position: absolute; clip: rect(2.801em, 1006.37em, 5.42em, -999.997em); top: -4.342em; left: 50%; margin-left: -3.211em;"><span class="mtd" id="MathJax-Span-4114"><span class="mrow" id="MathJax-Span-4115"><span class="mstyle" id="MathJax-Span-4116"><span class="mrow" id="MathJax-Span-4117"><span class="mi" id="MathJax-Span-4118" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4119"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4120" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-4121" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4122" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="munderover" id="MathJax-Span-4123" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(2.86em, 1001.19em, 4.646em, -999.997em); top: -3.985em; left: 0.122em;"><span class="mo" id="MathJax-Span-4124" style="font-family: STIXMathJax_Size1; vertical-align: -0.533em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1001.55em, 4.289em, -999.997em); top: -2.854em; left: 0.003em;"><span class="texatom" id="MathJax-Span-4125"><span class="mrow" id="MathJax-Span-4126"><span class="mi" id="MathJax-Span-4127" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span class="mi" id="MathJax-Span-4128" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-4129" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4130" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span class="mi" id="MathJax-Span-4131" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-4132" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4133"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4134" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-4135"><span class="mrow" id="MathJax-Span-4136"><span class="mo" id="MathJax-Span-4137" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4138" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4139" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.42em;"><span class="mi" id="MathJax-Span-4140" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.67em; height: 0px; clip: rect(-1.247em, 1001.61em, 0.003em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.61em, 4.348em, -999.997em); top: -4.342em; right: 0.003em;"><span class="mtd" id="mjx-eqn-16"><span class="mrow" id="MathJax-Span-4112"><span class="mtext" id="MathJax-Span-4113" style="font-family: STIXMathJax_Main;">(16)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.139em; border-left: 0px solid; width: 0px; height: 2.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="false"><mlabeledtr><mtd id="mjx-eqn-16"><mtext>(16)</mtext></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mi>d</mi><msub><mi>b</mi><mi>u</mi></msub><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi></mrow></munder><mi>d</mi><msubsup><mi>γ</mi><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup></mstyle></mtd></mlabeledtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-265">\displaystyle db_u = \sum_{batch}d\gamma_u^{\langle t \rangle}\tag{16}</script>
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-266-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable displaystyle=&quot;false&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-17&quot;&gt;&lt;mtext&gt;(17)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4141" role="math" style="width: 100%; display: inline-block; min-width: 11.491em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 11.491em;"><span style="position: absolute; clip: rect(2.443em, 1006.37em, 5.063em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-4142"><span class="mtable" id="MathJax-Span-4143" style="min-width: 11.491em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 11.491em;"><span style="display: inline-block; position: absolute; width: 6.372em; height: 0px; clip: rect(-1.545em, 1006.37em, 1.074em, -999.997em); top: 0.003em; left: 50%; margin-left: -3.152em;"><span style="position: absolute; clip: rect(2.443em, 1006.37em, 5.063em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 6.372em; height: 0px;"><span style="position: absolute; clip: rect(2.801em, 1006.37em, 5.42em, -999.997em); top: -4.342em; left: 50%; margin-left: -3.152em;"><span class="mtd" id="MathJax-Span-4147"><span class="mrow" id="MathJax-Span-4148"><span class="mstyle" id="MathJax-Span-4149"><span class="mrow" id="MathJax-Span-4150"><span class="mi" id="MathJax-Span-4151" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4152"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4153" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-4154" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4155" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="munderover" id="MathJax-Span-4156" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(2.86em, 1001.19em, 4.646em, -999.997em); top: -3.985em; left: 0.122em;"><span class="mo" id="MathJax-Span-4157" style="font-family: STIXMathJax_Size1; vertical-align: -0.533em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1001.55em, 4.289em, -999.997em); top: -2.854em; left: 0.003em;"><span class="texatom" id="MathJax-Span-4158"><span class="mrow" id="MathJax-Span-4159"><span class="mi" id="MathJax-Span-4160" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span class="mi" id="MathJax-Span-4161" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-4162" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4163" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span class="mi" id="MathJax-Span-4164" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-4165" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4166"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4167" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-4168"><span class="mrow" id="MathJax-Span-4169"><span class="mo" id="MathJax-Span-4170" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4171" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4172" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.42em;"><span class="mi" id="MathJax-Span-4173" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.67em; height: 0px; clip: rect(-1.247em, 1001.61em, 0.003em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.61em, 4.348em, -999.997em); top: -4.342em; right: 0.003em;"><span class="mtd" id="mjx-eqn-17"><span class="mrow" id="MathJax-Span-4145"><span class="mtext" id="MathJax-Span-4146" style="font-family: STIXMathJax_Main;">(17)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.139em; border-left: 0px solid; width: 0px; height: 2.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="false"><mlabeledtr><mtd id="mjx-eqn-17"><mtext>(17)</mtext></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mi>d</mi><msub><mi>b</mi><mi>c</mi></msub><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi></mrow></munder><mi>d</mi><msubsup><mi>γ</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup></mstyle></mtd></mlabeledtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-266">\displaystyle db_c = \sum_{batch}d\gamma_c^{\langle t \rangle}\tag{17}</script>
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-267-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable displaystyle=&quot;false&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-18&quot;&gt;&lt;mtext&gt;(18)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4174" role="math" style="width: 100%; display: inline-block; min-width: 11.491em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 11.491em;"><span style="position: absolute; clip: rect(2.443em, 1006.37em, 5.063em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-4175"><span class="mtable" id="MathJax-Span-4176" style="min-width: 11.491em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 11.491em;"><span style="display: inline-block; position: absolute; width: 6.372em; height: 0px; clip: rect(-1.545em, 1006.37em, 1.074em, -999.997em); top: 0.003em; left: 50%; margin-left: -3.211em;"><span style="position: absolute; clip: rect(2.443em, 1006.37em, 5.063em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 6.372em; height: 0px;"><span style="position: absolute; clip: rect(2.801em, 1006.37em, 5.42em, -999.997em); top: -4.342em; left: 50%; margin-left: -3.211em;"><span class="mtd" id="MathJax-Span-4180"><span class="mrow" id="MathJax-Span-4181"><span class="mstyle" id="MathJax-Span-4182"><span class="mrow" id="MathJax-Span-4183"><span class="mi" id="MathJax-Span-4184" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4185"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4186" style="font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-4187" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4188" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="munderover" id="MathJax-Span-4189" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(2.86em, 1001.19em, 4.646em, -999.997em); top: -3.985em; left: 0.122em;"><span class="mo" id="MathJax-Span-4190" style="font-family: STIXMathJax_Size1; vertical-align: -0.533em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1001.55em, 4.289em, -999.997em); top: -2.854em; left: 0.003em;"><span class="texatom" id="MathJax-Span-4191"><span class="mrow" id="MathJax-Span-4192"><span class="mi" id="MathJax-Span-4193" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">b</span><span class="mi" id="MathJax-Span-4194" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span class="mi" id="MathJax-Span-4195" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4196" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span class="mi" id="MathJax-Span-4197" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-4198" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.182em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4199"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4200" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-4201"><span class="mrow" id="MathJax-Span-4202"><span class="mo" id="MathJax-Span-4203" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4204" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4205" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.42em;"><span class="mi" id="MathJax-Span-4206" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.67em; height: 0px; clip: rect(-1.247em, 1001.61em, 0.003em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.61em, 4.348em, -999.997em); top: -4.342em; right: 0.003em;"><span class="mtd" id="mjx-eqn-18"><span class="mrow" id="MathJax-Span-4178"><span class="mtext" id="MathJax-Span-4179" style="font-family: STIXMathJax_Main;">(18)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.139em; border-left: 0px solid; width: 0px; height: 2.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="false"><mlabeledtr><mtd id="mjx-eqn-18"><mtext>(18)</mtext></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mi>d</mi><msub><mi>b</mi><mi>o</mi></msub><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi></mrow></munder><mi>d</mi><msubsup><mi>γ</mi><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup></mstyle></mtd></mlabeledtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-267">\displaystyle db_o = \sum_{batch}d\gamma_o^{\langle t \rangle}\tag{18}</script></p>
<p>Finally, you will compute the derivative with respect to the previous hidden state, previous memory state, and input.</p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-268-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable displaystyle=&quot;false&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-19&quot;&gt;&lt;mtext&gt;(19)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4207" role="math" style="width: 100%; display: inline-block; min-width: 26.372em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 26.372em;"><span style="position: absolute; clip: rect(2.86em, 1021.25em, 4.646em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-4208"><span class="mtable" id="MathJax-Span-4209" style="min-width: 26.372em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 26.372em;"><span style="display: inline-block; position: absolute; width: 21.253em; height: 0px; clip: rect(-1.128em, 1021.25em, 0.658em, -999.997em); top: 0.003em; left: 50%; margin-left: -10.592em;"><span style="position: absolute; clip: rect(2.86em, 1021.25em, 4.646em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 21.253em; height: 0px;"><span style="position: absolute; clip: rect(2.801em, 1021.25em, 4.646em, -999.997em); top: -3.985em; left: 50%; margin-left: -10.592em;"><span class="mtd" id="MathJax-Span-4213"><span class="mrow" id="MathJax-Span-4214"><span class="mi" id="MathJax-Span-4215" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4216"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4217" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-4218"><span class="mrow" id="MathJax-Span-4219"><span class="mi" id="MathJax-Span-4220" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">p</span><span class="mi" id="MathJax-Span-4221" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4222" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-4223" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4224" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-4225" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4226" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.54em, 4.17em, -999.997em); top: -4.342em; left: 0.955em;"><span class="mi" id="MathJax-Span-4227" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -3.688em; left: 0.836em;"><span class="mi" id="MathJax-Span-4228" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-4229" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4230"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4231" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-4232"><span class="mrow" id="MathJax-Span-4233"><span class="mo" id="MathJax-Span-4234" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4235" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4236" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -3.688em; left: 0.42em;"><span class="mi" id="MathJax-Span-4237" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4238" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-4239" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4240" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.54em, 4.17em, -999.997em); top: -4.342em; left: 0.955em;"><span class="mi" id="MathJax-Span-4241" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.836em;"><span class="mi" id="MathJax-Span-4242" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-4243" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4244"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4245" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-4246"><span class="mrow" id="MathJax-Span-4247"><span class="mo" id="MathJax-Span-4248" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4249" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4250" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.42em;"><span class="mi" id="MathJax-Span-4251" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4252" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-4253" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4254" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.54em, 4.17em, -999.997em); top: -4.342em; left: 0.955em;"><span class="mi" id="MathJax-Span-4255" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.836em;"><span class="mi" id="MathJax-Span-4256" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-4257" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4258" style="font-family: STIXMathJax_Main-italic; font-style: italic;">p</span><span class="msubsup" id="MathJax-Span-4259"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-4260"><span class="mrow" id="MathJax-Span-4261"><span class="munderover" id="MathJax-Span-4262"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.063em;"><span class="mi" id="MathJax-Span-4263" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.039em, 1000.54em, 3.574em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-4264" style=""><span style="font-family: STIXMathJax_Size1;">˜</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.539em;"><span class="texatom" id="MathJax-Span-4265"><span class="mrow" id="MathJax-Span-4266"><span class="mo" id="MathJax-Span-4267" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4268" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4269" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4270" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-4271" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4272" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.54em, 4.17em, -999.997em); top: -4.342em; left: 0.955em;"><span class="mi" id="MathJax-Span-4273" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.836em;"><span class="mi" id="MathJax-Span-4274" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-4275" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4276"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4277" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-4278"><span class="mrow" id="MathJax-Span-4279"><span class="mo" id="MathJax-Span-4280" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4281" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4282" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.42em;"><span class="mi" id="MathJax-Span-4283" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.67em; height: 0px; clip: rect(-0.83em, 1001.61em, 0.36em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.61em, 4.348em, -999.997em); top: -3.985em; right: 0.003em;"><span class="mtd" id="mjx-eqn-19"><span class="mrow" id="MathJax-Span-4211"><span class="mtext" id="MathJax-Span-4212" style="font-family: STIXMathJax_Main;">(19)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="false"><mlabeledtr><mtd id="mjx-eqn-19"><mtext>(19)</mtext></mtd><mtd><mi>d</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>r</mi><mi>e</mi><mi>v</mi></mrow></msub><mo>=</mo><msubsup><mi>W</mi><mi>f</mi><mi>T</mi></msubsup><mi>d</mi><msubsup><mi>γ</mi><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>+</mo><msubsup><mi>W</mi><mi>u</mi><mi>T</mi></msubsup><mi>d</mi><msubsup><mi>γ</mi><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>+</mo><msubsup><mi>W</mi><mi>c</mi><mi>T</mi></msubsup><mi>d</mi><mi>p</mi><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>c</mi><mo>~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msubsup><mi>W</mi><mi>o</mi><mi>T</mi></msubsup><mi>d</mi><msubsup><mi>γ</mi><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup></mtd></mlabeledtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-268"> da_{prev} = W_f^T d\gamma_f^{\langle t \rangle} + W_u^T   d\gamma_u^{\langle t \rangle}+ W_c^T dp\widetilde c^{\langle t \rangle} + W_o^T d\gamma_o^{\langle t \rangle} \tag{19}</script></p>
<p>Here, to account for concatenation, the weights for equations 19 are the first n_a, (i.e. <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-269-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4284" role="math" style="width: 7.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.551em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em, 1006.49em, 2.801em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-4285"><span class="msubsup" id="MathJax-Span-4286"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4287" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="mi" id="MathJax-Span-4288" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4289" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-4290" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4291" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="mi" id="MathJax-Span-4292" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4293" style="font-family: STIXMathJax_Main;">[</span><span class="mo" id="MathJax-Span-4294" style="font-family: STIXMathJax_Main;">:</span><span class="mo" id="MathJax-Span-4295" style="font-family: STIXMathJax_Main;">,</span><span class="mo" id="MathJax-Span-4296" style="font-family: STIXMathJax_Main; padding-left: 0.182em;">:</span><span class="msubsup" id="MathJax-Span-4297" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4298" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-4299" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4300" style="font-family: STIXMathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mi>f</mi></msub><mo>=</mo><msub><mi>W</mi><mi>f</mi></msub><mo stretchy="false">[</mo><mo>:</mo><mo>,</mo><mo>:</mo><msub><mi>n</mi><mi>a</mi></msub><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-269">W_f = W_f[:,:n_a]</script> etc...)</p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-270-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable displaystyle=&quot;false&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-20&quot;&gt;&lt;mtext&gt;(20)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;tanh&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0393;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4301" role="math" style="width: 100%; display: inline-block; min-width: 29.646em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 29.646em;"><span style="position: absolute; clip: rect(2.86em, 1024.53em, 4.646em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-4302"><span class="mtable" id="MathJax-Span-4303" style="min-width: 29.646em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 29.646em;"><span style="display: inline-block; position: absolute; width: 24.527em; height: 0px; clip: rect(-1.128em, 1024.53em, 0.658em, -999.997em); top: 0.003em; left: 50%; margin-left: -12.259em;"><span style="position: absolute; clip: rect(2.86em, 1024.53em, 4.646em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 24.527em; height: 0px;"><span style="position: absolute; clip: rect(2.801em, 1024.53em, 4.646em, -999.997em); top: -3.985em; left: 50%; margin-left: -12.259em;"><span class="mtd" id="MathJax-Span-4307"><span class="mrow" id="MathJax-Span-4308"><span class="mi" id="MathJax-Span-4309" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4310"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4311" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="texatom" id="MathJax-Span-4312"><span class="mrow" id="MathJax-Span-4313"><span class="mi" id="MathJax-Span-4314" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">p</span><span class="mi" id="MathJax-Span-4315" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4316" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-4317" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4318" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-4319" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.301em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4320"><span style="display: inline-block; position: relative; width: 1.729em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4321" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="texatom" id="MathJax-Span-4322"><span class="mrow" id="MathJax-Span-4323"><span class="mi" id="MathJax-Span-4324" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span class="mi" id="MathJax-Span-4325" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-4326" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4327" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4328" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="msubsup" id="MathJax-Span-4329" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4330" style="font-family: STIXMathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-4331"><span class="mrow" id="MathJax-Span-4332"><span class="mo" id="MathJax-Span-4333" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4334" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4335" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -3.688em; left: 0.598em;"><span class="mi" id="MathJax-Span-4336" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4337" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-4338" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4339" style="font-family: STIXMathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-4340"><span class="mrow" id="MathJax-Span-4341"><span class="mo" id="MathJax-Span-4342" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4343" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4344" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.598em;"><span class="mi" id="MathJax-Span-4345" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4346" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="mo" id="MathJax-Span-4347" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">(</span><span class="mn" id="MathJax-Span-4348" style="font-family: STIXMathJax_Main;">1</span><span class="mo" id="MathJax-Span-4349" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="msubsup" id="MathJax-Span-4350" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1001.73em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4351" style="font-family: STIXMathJax_Main;">tanh</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 1.729em;"><span class="mn" id="MathJax-Span-4352" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4353"></span><span class="mo" id="MathJax-Span-4354" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4355"><span style="display: inline-block; position: relative; width: 1.729em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4356" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="texatom" id="MathJax-Span-4357"><span class="mrow" id="MathJax-Span-4358"><span class="mi" id="MathJax-Span-4359" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span class="mi" id="MathJax-Span-4360" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-4361" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4362" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4363" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-4364" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-4365" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="msubsup" id="MathJax-Span-4366" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4367" style="font-family: STIXMathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.598em;"><span class="texatom" id="MathJax-Span-4368"><span class="mrow" id="MathJax-Span-4369"><span class="mo" id="MathJax-Span-4370" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4371" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4372" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -3.688em; left: 0.598em;"><span class="mi" id="MathJax-Span-4373" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4374" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∗</span><span class="mi" id="MathJax-Span-4375" style="font-family: STIXMathJax_Main-italic; font-style: italic; padding-left: 0.241em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4376"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4377" style="font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-4378"><span class="mrow" id="MathJax-Span-4379"><span class="mi" id="MathJax-Span-4380" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span class="mi" id="MathJax-Span-4381" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">e</span><span class="mi" id="MathJax-Span-4382" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4383" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.67em; height: 0px; clip: rect(-0.83em, 1001.61em, 0.36em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.61em, 4.348em, -999.997em); top: -3.985em; right: 0.003em;"><span class="mtd" id="mjx-eqn-20"><span class="mrow" id="MathJax-Span-4305"><span class="mtext" id="MathJax-Span-4306" style="font-family: STIXMathJax_Main;">(20)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="false"><mlabeledtr><mtd id="mjx-eqn-20"><mtext>(20)</mtext></mtd><mtd><mi>d</mi><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>r</mi><mi>e</mi><mi>v</mi></mrow></msub><mo>=</mo><mi>d</mi><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo>∗</mo><msubsup><mi mathvariant="normal">Γ</mi><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>+</mo><msubsup><mi mathvariant="normal">Γ</mi><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>∗</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msup><mi>tanh</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>∗</mo><msubsup><mi mathvariant="normal">Γ</mi><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>∗</mo><mi>d</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub></mtd></mlabeledtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-270"> dc_{prev} = dc_{next}*\Gamma_f^{\langle t \rangle} + \Gamma_o^{\langle t \rangle} * (1- \tanh^2(c_{next}))*\Gamma_f^{\langle t \rangle}*da_{next} \tag{20}</script></p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-271-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable displaystyle=&quot;false&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-21&quot;&gt;&lt;mtext&gt;(21)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4384" role="math" style="width: 100%; display: inline-block; min-width: 25.836em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 25.836em;"><span style="position: absolute; clip: rect(2.86em, 1020.72em, 4.646em, -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-4385"><span class="mtable" id="MathJax-Span-4386" style="min-width: 25.836em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 25.836em;"><span style="display: inline-block; position: absolute; width: 20.717em; height: 0px; clip: rect(-1.128em, 1020.72em, 0.658em, -999.997em); top: 0.003em; left: 50%; margin-left: -10.354em;"><span style="position: absolute; clip: rect(2.86em, 1020.72em, 4.646em, -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 20.717em; height: 0px;"><span style="position: absolute; clip: rect(2.801em, 1020.72em, 4.646em, -999.997em); top: -3.985em; left: 50%; margin-left: -10.354em;"><span class="mtd" id="MathJax-Span-4390"><span class="mrow" id="MathJax-Span-4391"><span class="mi" id="MathJax-Span-4392" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4393"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4394" style="font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-4395"><span class="mrow" id="MathJax-Span-4396"><span class="mo" id="MathJax-Span-4397" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4398" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4399" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4400" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-4401" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4402" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.54em, 4.17em, -999.997em); top: -4.342em; left: 0.955em;"><span class="mi" id="MathJax-Span-4403" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -3.688em; left: 0.836em;"><span class="mi" id="MathJax-Span-4404" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-4405" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4406"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4407" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-4408"><span class="mrow" id="MathJax-Span-4409"><span class="mo" id="MathJax-Span-4410" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4411" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4412" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -3.688em; left: 0.42em;"><span class="mi" id="MathJax-Span-4413" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4414" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-4415" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4416" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.54em, 4.17em, -999.997em); top: -4.342em; left: 0.955em;"><span class="mi" id="MathJax-Span-4417" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.836em;"><span class="mi" id="MathJax-Span-4418" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-4419" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4420"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4421" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-4422"><span class="mrow" id="MathJax-Span-4423"><span class="mo" id="MathJax-Span-4424" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4425" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4426" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.42em;"><span class="mi" id="MathJax-Span-4427" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4428" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-4429" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4430" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.54em, 4.17em, -999.997em); top: -4.342em; left: 0.955em;"><span class="mi" id="MathJax-Span-4431" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.836em;"><span class="mi" id="MathJax-Span-4432" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-4433" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4434" style="font-family: STIXMathJax_Main-italic; font-style: italic;">p</span><span class="msubsup" id="MathJax-Span-4435"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-4436"><span class="mrow" id="MathJax-Span-4437"><span class="munderover" id="MathJax-Span-4438"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.063em;"><span class="mi" id="MathJax-Span-4439" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.039em, 1000.54em, 3.574em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-4440" style=""><span style="font-family: STIXMathJax_Size1;">˜</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.539em;"><span class="texatom" id="MathJax-Span-4441"><span class="mrow" id="MathJax-Span-4442"><span class="mo" id="MathJax-Span-4443" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4444" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4445" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4446" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-4447" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4448" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.54em, 4.17em, -999.997em); top: -4.342em; left: 0.955em;"><span class="mi" id="MathJax-Span-4449" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.836em;"><span class="mi" id="MathJax-Span-4450" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-4451" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4452"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4453" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-4454"><span class="mrow" id="MathJax-Span-4455"><span class="mo" id="MathJax-Span-4456" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4457" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4458" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.42em;"><span class="mi" id="MathJax-Span-4459" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.67em; height: 0px; clip: rect(-0.83em, 1001.61em, 0.36em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em, 1001.61em, 4.348em, -999.997em); top: -3.985em; right: 0.003em;"><span class="mtd" id="mjx-eqn-21"><span class="mrow" id="MathJax-Span-4388"><span class="mtext" id="MathJax-Span-4389" style="font-family: STIXMathJax_Main;">(21)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="false"><mlabeledtr><mtd id="mjx-eqn-21"><mtext>(21)</mtext></mtd><mtd><mi>d</mi><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>=</mo><msubsup><mi>W</mi><mi>f</mi><mi>T</mi></msubsup><mi>d</mi><msubsup><mi>γ</mi><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>+</mo><msubsup><mi>W</mi><mi>u</mi><mi>T</mi></msubsup><mi>d</mi><msubsup><mi>γ</mi><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup><mo>+</mo><msubsup><mi>W</mi><mi>c</mi><mi>T</mi></msubsup><mi>d</mi><mi>p</mi><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>c</mi><mo>~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup><mo>+</mo><msubsup><mi>W</mi><mi>o</mi><mi>T</mi></msubsup><mi>d</mi><msubsup><mi>γ</mi><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup></mtd></mlabeledtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-271"> dx^{\langle t \rangle} = W_f^T d\gamma_f^{\langle t \rangle} + W_u^T  d\gamma_u^{\langle t \rangle}+ W_c^T dp\widetilde c^{\langle t \rangle} + W_o^T d\gamma_o^{\langle t \rangle}\tag{21} </script></p>
<p>where the weights for equation 21 are from n_a to the end, (i.e. <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-272-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4460" role="math" style="width: 7.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.551em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em, 1006.49em, 2.801em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-4461"><span class="msubsup" id="MathJax-Span-4462"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4463" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="mi" id="MathJax-Span-4464" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4465" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-4466" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4467" style="font-family: STIXMathJax_Main-italic; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.836em;"><span class="mi" id="MathJax-Span-4468" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4469" style="font-family: STIXMathJax_Main;">[</span><span class="mo" id="MathJax-Span-4470" style="font-family: STIXMathJax_Main;">:</span><span class="mo" id="MathJax-Span-4471" style="font-family: STIXMathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-4472" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4473" style="font-family: STIXMathJax_Main-italic; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-4474" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-4475" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">:</span><span class="mo" id="MathJax-Span-4476" style="font-family: STIXMathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mi>f</mi></msub><mo>=</mo><msub><mi>W</mi><mi>f</mi></msub><mo stretchy="false">[</mo><mo>:</mo><mo>,</mo><msub><mi>n</mi><mi>a</mi></msub><mo>:</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-272">W_f = W_f[:,n_a:]</script> etc...)</p>
<p><strong>Exercise:</strong> Implement <code>lstm_cell_backward</code> by implementing equations <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-273-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4477" role="math" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.979em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em, 1002.86em, 2.503em, -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-4478"><span class="mn" id="MathJax-Span-4479" style="font-family: STIXMathJax_Main;">7</span><span class="mo" id="MathJax-Span-4480" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="mn" id="MathJax-Span-4481" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">21</span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>7</mn><mo>−</mo><mn>21</mn></math></span></span><script type="math/tex" id="MathJax-Element-273">7-21</script> below. </p>
<p>Note: In the code:</p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-274-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4482" role="math" style="width: 2.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em, 1001.91em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-4483"><span class="mi" id="MathJax-Span-4484" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4485"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4486" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-4487"><span class="mrow" id="MathJax-Span-4488"><span class="mo" id="MathJax-Span-4489" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4490" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4491" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.42em;"><span class="mi" id="MathJax-Span-4492" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msubsup><mi>γ</mi><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-274">d\gamma_o^{\langle t \rangle}</script> is represented by  <code>dot</code>,<br><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-275-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4493" role="math" style="width: 2.979em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.443em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1002.44em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-4494"><span class="mi" id="MathJax-Span-4495" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4496" style="font-family: STIXMathJax_Main-italic; font-style: italic;">p</span><span class="msubsup" id="MathJax-Span-4497"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-4498"><span class="mrow" id="MathJax-Span-4499"><span class="munderover" id="MathJax-Span-4500"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0.063em;"><span class="mi" id="MathJax-Span-4501" style="font-family: STIXMathJax_Main-italic; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.039em, 1000.54em, 3.574em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-4502" style=""><span style="font-family: STIXMathJax_Size1;">˜</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.461em; left: 0.539em;"><span class="texatom" id="MathJax-Span-4503"><span class="mrow" id="MathJax-Span-4504"><span class="mo" id="MathJax-Span-4505" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4506" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4507" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>p</mi><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>c</mi><mo>~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-275">dp\widetilde{c}^{\langle t \rangle}</script> is represented by  <code>dcct</code>,<br><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-276-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4508" role="math" style="width: 2.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em, 1001.91em, 2.741em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-4509"><span class="mi" id="MathJax-Span-4510" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4511"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4512" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-4513"><span class="mrow" id="MathJax-Span-4514"><span class="mo" id="MathJax-Span-4515" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4516" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4517" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.17em, -999.997em); top: -3.866em; left: 0.42em;"><span class="mi" id="MathJax-Span-4518" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msubsup><mi>γ</mi><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-276">d\gamma_u^{\langle t \rangle}</script> is represented by  <code>dit</code>,<br><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-277-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4519" role="math" style="width: 2.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em, 1001.91em, 3.039em, -999.997em); top: -2.378em; left: 0.003em;"><span class="mrow" id="MathJax-Span-4520"><span class="mi" id="MathJax-Span-4521" style="font-family: STIXMathJax_Main-italic; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4522"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4523" style="font-family: STIXMathJax_Main-italic; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.348em, -999.997em); top: -4.461em; left: 0.479em;"><span class="texatom" id="MathJax-Span-4524"><span class="mrow" id="MathJax-Span-4525"><span class="mo" id="MathJax-Span-4526" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟨</span><span class="mi" id="MathJax-Span-4527" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4528" style="font-size: 70.7%; font-family: STIXMathJax_Main;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -3.688em; left: 0.42em;"><span class="mi" id="MathJax-Span-4529" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.384em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msubsup><mi>γ</mi><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo fence="false" stretchy="false">⟨</mo><mi>t</mi><mo fence="false" stretchy="false">⟩</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-277">d\gamma_f^{\langle t \rangle}</script> is represented by  <code>dft</code></p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[16]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 21px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 1103px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 21px; width: 21px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 1103.12px; margin-bottom: -21px; border-right-width: 9px; min-height: 994px; padding-right: 0px; padding-bottom: 21px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">lstm_cell_backward</span>(<span class="cm-variable">da_next</span>, <span class="cm-variable">dc_next</span>, <span class="cm-variable">cache</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Implement the backward pass for the LSTM-cell (single time-step).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    da_next -- Gradients of next hidden state, of shape (n_a, m)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    dc_next -- Gradients of next cell state, of shape (n_a, m)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    cache -- cache storing information from the forward pass</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    gradients -- python dictionary containing:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dxt -- Gradient of input data at time-step t, of shape (n_x, m)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        da_prev -- Gradient w.r.t. the previous hidden state, numpy array of shape (n_a, m)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dc_prev -- Gradient w.r.t. the previous memory state, of shape (n_a, m, T_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dWf -- Gradient w.r.t. the weight matrix of the forget gate, numpy array of shape (n_a, n_a + n_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dWi -- Gradient w.r.t. the weight matrix of the update gate, numpy array of shape (n_a, n_a + n_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dWc -- Gradient w.r.t. the weight matrix of the memory gate, numpy array of shape (n_a, n_a + n_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dWo -- Gradient w.r.t. the weight matrix of the output gate, numpy array of shape (n_a, n_a + n_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dbf -- Gradient w.r.t. biases of the forget gate, of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dbi -- Gradient w.r.t. biases of the update gate, of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dbc -- Gradient w.r.t. biases of the memory gate, of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dbo -- Gradient w.r.t. biases of the output gate, of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Retrieve information from "cache"</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    (<span class="cm-variable">a_next</span>, <span class="cm-variable">c_next</span>, <span class="cm-variable">a_prev</span>, <span class="cm-variable">c_prev</span>, <span class="cm-variable">ft</span>, <span class="cm-variable">it</span>, <span class="cm-variable">cct</span>, <span class="cm-variable">ot</span>, <span class="cm-variable">xt</span>, <span class="cm-variable">parameters</span>) = <span class="cm-variable">cache</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Retrieve dimensions from xt's and a_next's shape (≈2 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">n_x</span>, <span class="cm-variable">m</span> = <span class="cm-variable">xt</span>.<span class="cm-property">shape</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">n_a</span>, <span class="cm-variable">m</span> = <span class="cm-variable">a_next</span>.<span class="cm-property">shape</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Compute gates related derivatives, you can find their values can be found by looking carefully at equations (7) to (10) (≈4 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dot</span> = <span class="cm-variable">da_next</span> <span class="cm-operator">*</span> <span class="cm-variable">np</span>.<span class="cm-property">tanh</span>(<span class="cm-variable">c_next</span>) <span class="cm-operator">*</span> <span class="cm-variable">ot</span> <span class="cm-operator">*</span> (<span class="cm-number">1</span> <span class="cm-operator">-</span> <span class="cm-variable">ot</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dcct</span> = (<span class="cm-variable">dc_next</span> <span class="cm-operator">*</span> <span class="cm-variable">it</span> <span class="cm-operator">+</span> <span class="cm-variable">ot</span> <span class="cm-operator">*</span> (<span class="cm-number">1</span> <span class="cm-operator">-</span> <span class="cm-variable">np</span>.<span class="cm-property">square</span>(<span class="cm-variable">np</span>.<span class="cm-property">tanh</span>(<span class="cm-variable">c_next</span>))) <span class="cm-operator">*</span> <span class="cm-variable">it</span> <span class="cm-operator">*</span> <span class="cm-variable">da_next</span>) <span class="cm-operator">*</span> (<span class="cm-number">1</span> <span class="cm-operator">-</span> <span class="cm-variable">np</span>.<span class="cm-property">square</span>(<span class="cm-variable">cct</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dit</span> = (<span class="cm-variable">dc_next</span> <span class="cm-operator">*</span> <span class="cm-variable">cct</span> <span class="cm-operator">+</span> <span class="cm-variable">ot</span> <span class="cm-operator">*</span> (<span class="cm-number">1</span> <span class="cm-operator">-</span> <span class="cm-variable">np</span>.<span class="cm-property">square</span>(<span class="cm-variable">np</span>.<span class="cm-property">tanh</span>(<span class="cm-variable">c_next</span>))) <span class="cm-operator">*</span> <span class="cm-variable">cct</span> <span class="cm-operator">*</span> <span class="cm-variable">da_next</span>) <span class="cm-operator">*</span> <span class="cm-variable">it</span> <span class="cm-operator">*</span> (<span class="cm-number">1</span> <span class="cm-operator">-</span> <span class="cm-variable">it</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dft</span> = (<span class="cm-variable">dc_next</span> <span class="cm-operator">*</span> <span class="cm-variable">c_prev</span> <span class="cm-operator">+</span> <span class="cm-variable">ot</span> <span class="cm-operator">*</span>(<span class="cm-number">1</span> <span class="cm-operator">-</span> <span class="cm-variable">np</span>.<span class="cm-property">square</span>(<span class="cm-variable">np</span>.<span class="cm-property">tanh</span>(<span class="cm-variable">c_next</span>))) <span class="cm-operator">*</span> <span class="cm-variable">c_prev</span> <span class="cm-operator">*</span> <span class="cm-variable">da_next</span>) <span class="cm-operator">*</span> <span class="cm-variable">ft</span> <span class="cm-operator">*</span> (<span class="cm-number">1</span> <span class="cm-operator">-</span> <span class="cm-variable">ft</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Compute parameters related derivatives. Use equations (11)-(18) (≈8 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dWf</span> = <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">dft</span>,<span class="cm-variable">np</span>.<span class="cm-property">hstack</span>([<span class="cm-variable">a_prev</span>.<span class="cm-property">T</span>,<span class="cm-variable">xt</span>.<span class="cm-property">T</span>]))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dWi</span> = <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">dit</span>,<span class="cm-variable">np</span>.<span class="cm-property">hstack</span>([<span class="cm-variable">a_prev</span>.<span class="cm-property">T</span>,<span class="cm-variable">xt</span>.<span class="cm-property">T</span>]))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dWc</span> = <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">dcct</span>,<span class="cm-variable">np</span>.<span class="cm-property">hstack</span>([<span class="cm-variable">a_prev</span>.<span class="cm-property">T</span>,<span class="cm-variable">xt</span>.<span class="cm-property">T</span>]))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dWo</span> = <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">dot</span>,<span class="cm-variable">np</span>.<span class="cm-property">hstack</span>([<span class="cm-variable">a_prev</span>.<span class="cm-property">T</span>,<span class="cm-variable">xt</span>.<span class="cm-property">T</span>]))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dbf</span> = <span class="cm-variable">np</span>.<span class="cm-property">sum</span>(<span class="cm-variable">dft</span>,<span class="cm-variable">axis</span>=<span class="cm-number">1</span>,<span class="cm-variable">keepdims</span>=<span class="cm-keyword">True</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dbi</span> = <span class="cm-variable">np</span>.<span class="cm-property">sum</span>(<span class="cm-variable">dit</span>,<span class="cm-variable">axis</span>=<span class="cm-number">1</span>,<span class="cm-variable">keepdims</span>=<span class="cm-keyword">True</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dbc</span> = <span class="cm-variable">np</span>.<span class="cm-property">sum</span>(<span class="cm-variable">dcct</span>,<span class="cm-variable">axis</span>=<span class="cm-number">1</span>,<span class="cm-variable">keepdims</span>=<span class="cm-keyword">True</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dbo</span> = <span class="cm-variable">np</span>.<span class="cm-property">sum</span>(<span class="cm-variable">dot</span>,<span class="cm-variable">axis</span>=<span class="cm-number">1</span>,<span class="cm-variable">keepdims</span>=<span class="cm-keyword">True</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Compute derivatives w.r.t previous hidden state, previous memory state and input. Use equations (19)-(21). (≈3 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">da_prev</span> = <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">parameters</span>[<span class="cm-string">'Wf'</span>][:,:<span class="cm-variable">n_a</span>].<span class="cm-property">T</span>,<span class="cm-variable">dft</span>)<span class="cm-operator">+</span><span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">parameters</span>[<span class="cm-string">'Wc'</span>][:,:<span class="cm-variable">n_a</span>].<span class="cm-property">T</span>,<span class="cm-variable">dcct</span>)<span class="cm-operator">+</span><span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">parameters</span>[<span class="cm-string">'Wi'</span>][:,:<span class="cm-variable">n_a</span>].<span class="cm-property">T</span>,<span class="cm-variable">dit</span>)<span class="cm-operator">+</span><span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">parameters</span>[<span class="cm-string">'Wo'</span>][:,:<span class="cm-variable">n_a</span>].<span class="cm-property">T</span>,<span class="cm-variable">dot</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dc_prev</span> = (<span class="cm-variable">da_next</span><span class="cm-operator">*</span><span class="cm-variable">ot</span><span class="cm-operator">*</span>(<span class="cm-number">1</span><span class="cm-operator">-</span><span class="cm-variable">np</span>.<span class="cm-property">tanh</span>(<span class="cm-variable">c_next</span>)<span class="cm-operator">**</span><span class="cm-number">2</span>)<span class="cm-operator">+</span><span class="cm-variable">dc_next</span>)<span class="cm-operator">*</span><span class="cm-variable">ft</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dxt</span> = <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">parameters</span>[<span class="cm-string">'Wf'</span>][:,<span class="cm-variable">n_a</span>:].<span class="cm-property">T</span>,<span class="cm-variable">dft</span>)<span class="cm-operator">+</span><span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">parameters</span>[<span class="cm-string">'Wc'</span>][:,<span class="cm-variable">n_a</span>:].<span class="cm-property">T</span>,<span class="cm-variable">dcct</span>)<span class="cm-operator">+</span><span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">parameters</span>[<span class="cm-string">'Wi'</span>][:,<span class="cm-variable">n_a</span>:].<span class="cm-property">T</span>,<span class="cm-variable">dit</span>)<span class="cm-operator">+</span><span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">parameters</span>[<span class="cm-string">'Wo'</span>][:,<span class="cm-variable">n_a</span>:].<span class="cm-property">T</span>,<span class="cm-variable">dot</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Save gradients in dictionary</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">gradients</span> = {<span class="cm-string">"dxt"</span>: <span class="cm-variable">dxt</span>, <span class="cm-string">"da_prev"</span>: <span class="cm-variable">da_prev</span>, <span class="cm-string">"dc_prev"</span>: <span class="cm-variable">dc_prev</span>, <span class="cm-string">"dWf"</span>: <span class="cm-variable">dWf</span>,<span class="cm-string">"dbf"</span>: <span class="cm-variable">dbf</span>, <span class="cm-string">"dWi"</span>: <span class="cm-variable">dWi</span>,<span class="cm-string">"dbi"</span>: <span class="cm-variable">dbi</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                <span class="cm-string">"dWc"</span>: <span class="cm-variable">dWc</span>,<span class="cm-string">"dbc"</span>: <span class="cm-variable">dbc</span>, <span class="cm-string">"dWo"</span>: <span class="cm-variable">dWo</span>,<span class="cm-string">"dbo"</span>: <span class="cm-variable">dbo</span>}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">gradients</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 21px solid transparent; top: 994px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1024px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[17]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 770.917px; margin-bottom: -21px; border-right-width: 9px; min-height: 728px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">seed</span>(<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">xt_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">3</span>,<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a_prev_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">c_prev_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span> = {}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wf'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>, <span class="cm-number">5</span><span class="cm-operator">+</span><span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'bf'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wi'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>, <span class="cm-number">5</span><span class="cm-operator">+</span><span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'bi'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wo'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>, <span class="cm-number">5</span><span class="cm-operator">+</span><span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'bo'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wc'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>, <span class="cm-number">5</span><span class="cm-operator">+</span><span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'bc'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wy'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">2</span>,<span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'by'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">2</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a_next_tmp</span>, <span class="cm-variable">c_next_tmp</span>, <span class="cm-variable">yt_tmp</span>, <span class="cm-variable">cache_tmp</span> = <span class="cm-variable">lstm_cell_forward</span>(<span class="cm-variable">xt_tmp</span>, <span class="cm-variable">a_prev_tmp</span>, <span class="cm-variable">c_prev_tmp</span>, <span class="cm-variable">parameters_tmp</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">da_next_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">dc_next_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients_tmp</span> = <span class="cm-variable">lstm_cell_backward</span>(<span class="cm-variable">da_next_tmp</span>, <span class="cm-variable">dc_next_tmp</span>, <span class="cm-variable">cache_tmp</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dxt\"][1][2] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dxt"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dxt\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dxt"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"da_prev\"][2][3] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"da_prev"</span>][<span class="cm-number">2</span>][<span class="cm-number">3</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"da_prev\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"da_prev"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dc_prev\"][2][3] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dc_prev"</span>][<span class="cm-number">2</span>][<span class="cm-number">3</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dc_prev\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dc_prev"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWf\"][3][1] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWf"</span>][<span class="cm-number">3</span>][<span class="cm-number">1</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWf\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWf"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWi\"][1][2] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWi"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWi\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWi"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWc\"][3][1] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWc"</span>][<span class="cm-number">3</span>][<span class="cm-number">1</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWc\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWc"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWo\"][1][2] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWo"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWo\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWo"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dbf\"][4] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dbf"</span>][<span class="cm-number">4</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dbf\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dbf"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dbi\"][4] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dbi"</span>][<span class="cm-number">4</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dbi\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dbi"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dbc\"][4] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dbc"</span>][<span class="cm-number">4</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dbc\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dbc"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dbo\"][4] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dbo"</span>][<span class="cm-number">4</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dbo\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dbo"</span>].<span class="cm-property">shape</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 728px;"></div><div class="CodeMirror-gutters" style="display: none; height: 737px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>gradients["dxt"][1][2] = 3.23055911511
gradients["dxt"].shape = (3, 10)
gradients["da_prev"][2][3] = -0.0639621419711
gradients["da_prev"].shape = (5, 10)
gradients["dc_prev"][2][3] = 0.797522038797
gradients["dc_prev"].shape = (5, 10)
gradients["dWf"][3][1] = -0.147954838164
gradients["dWf"].shape = (5, 8)
gradients["dWi"][1][2] = 1.05749805523
gradients["dWi"].shape = (5, 8)
gradients["dWc"][3][1] = 2.30456216369
gradients["dWc"].shape = (5, 8)
gradients["dWo"][1][2] = 0.331311595289
gradients["dWo"].shape = (5, 8)
gradients["dbf"][4] = [ 0.18864637]
gradients["dbf"].shape = (5, 1)
gradients["dbi"][4] = [-0.40142491]
gradients["dbi"].shape = (5, 1)
gradients["dbc"][4] = [ 0.25587763]
gradients["dbc"].shape = (5, 1)
gradients["dbo"][4] = [ 0.13893342]
gradients["dbo"].shape = (5, 1)
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 3011px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Expected Output**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dxt"][1][2]** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3.23055911511</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dxt"].shape** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (3, 10)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["da_prev"][2][3]** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -0.0639621419711</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["da_prev"].shape** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 10)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dc_prev"][2][3]** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.797522038797</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dc_prev"].shape** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 10)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWf"][3][1]** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -0.147954838164</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWf"].shape** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 8)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWi"][1][2]** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1.05749805523</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWi"].shape** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 8)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWc"][3][1]** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2.30456216369</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWc"].shape** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 8)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWo"][1][2]** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.331311595289</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWo"].shape** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 8)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dbf"][4]** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [ 0.18864637]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dbf"].shape** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 1)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dbi"][4]** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [-0.40142491]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dbi"].shape** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 1)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dbc"][4]** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [ 0.25587763]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dbc"].shape** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 1)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dbo"][4]** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [ 0.13893342]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dbo"].shape** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 1)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 3011px;"></div><div class="CodeMirror-gutters" style="display: none; height: 3020px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Expected Output</strong>:</p>
<table>
    <tbody><tr>
        <td>
            <strong>gradients["dxt"][1][2]</strong> =
        </td>
        <td>
           3.23055911511
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dxt"].shape</strong> =
        </td>
        <td>
           (3, 10)
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["da_prev"][2][3]</strong> =
        </td>
        <td>
           -0.0639621419711
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["da_prev"].shape</strong> =
        </td>
        <td>
           (5, 10)
        </td>
    </tr>
         <tr>
        <td>
            <strong>gradients["dc_prev"][2][3]</strong> =
        </td>
        <td>
           0.797522038797
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dc_prev"].shape</strong> =
        </td>
        <td>
           (5, 10)
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dWf"][3][1]</strong> = 
        </td>
        <td>
           -0.147954838164
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dWf"].shape</strong> =
        </td>
        <td>
           (5, 8)
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dWi"][1][2]</strong> = 
        </td>
        <td>
           1.05749805523
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dWi"].shape</strong> = 
        </td>
        <td>
           (5, 8)
        </td>
    </tr>
    <tr>
        <td>
            <strong>gradients["dWc"][3][1]</strong> = 
        </td>
        <td>
           2.30456216369
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dWc"].shape</strong> = 
        </td>
        <td>
           (5, 8)
        </td>
    </tr>
    <tr>
        <td>
            <strong>gradients["dWo"][1][2]</strong> = 
        </td>
        <td>
           0.331311595289
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dWo"].shape</strong> = 
        </td>
        <td>
           (5, 8)
        </td>
    </tr>
    <tr>
        <td>
            <strong>gradients["dbf"][4]</strong> = 
        </td>
        <td>
           [ 0.18864637]
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dbf"].shape</strong> = 
        </td>
        <td>
           (5, 1)
        </td>
    </tr>
    <tr>
        <td>
            <strong>gradients["dbi"][4]</strong> = 
        </td>
        <td>
           [-0.40142491]
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dbi"].shape</strong> = 
        </td>
        <td>
           (5, 1)
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dbc"][4]</strong> = 
        </td>
        <td>
           [ 0.25587763]
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dbc"].shape</strong> = 
        </td>
        <td>
           (5, 1)
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dbo"][4]</strong> = 
        </td>
        <td>
           [ 0.13893342]
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dbo"].shape</strong> = 
        </td>
        <td>
           (5, 1)
        </td>
    </tr>
</tbody></table></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 144px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### 3.3 Backward pass through the LSTM RNN</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">This part is very similar to the <span class="cm-comment">`rnn_backward`</span> function you implemented above. You will first create variables of the same dimension as your return variables. You will then iterate over all the time steps starting from the end and call the one step function you implemented for LSTM at each iteration. You will then update the parameters by summing them individually. Finally return a dictionary with the new gradients. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Instructions**</span>: Implement the <span class="cm-comment">`lstm_backward`</span> function. Create a for loop starting from <span class="cm-delimit cm-delimit-open">$</span>T_x<span class="cm-delimit cm-delimit-close">$</span> and going backward. For each step call <span class="cm-comment">`lstm_cell_backward`</span> and update the your old gradients by adding the new gradients to them. Note that <span class="cm-comment">`dxt`</span> is not updated but is stored.</span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 144px;"></div><div class="CodeMirror-gutters" style="display: none; height: 153px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="3.3-Backward-pass-through-the-LSTM-RNN">3.3 Backward pass through the LSTM RNN<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#3.3-Backward-pass-through-the-LSTM-RNN">¶</a></h3>
<p>This part is very similar to the <code>rnn_backward</code> function you implemented above. You will first create variables of the same dimension as your return variables. You will then iterate over all the time steps starting from the end and call the one step function you implemented for LSTM at each iteration. You will then update the parameters by summing them individually. Finally return a dictionary with the new gradients. </p>
<p><strong>Instructions</strong>: Implement the <code>lstm_backward</code> function. Create a for loop starting from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-278-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4530" role="math" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1000.96em, 2.503em, -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-4531"><span class="msubsup" id="MathJax-Span-4532"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4533" style="font-family: STIXMathJax_Main-italic; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-4534" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>x</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-278">T_x</script> and going backward. For each step call <code>lstm_cell_backward</code> and update the your old gradients by adding the new gradients to them. Note that <code>dxt</code> is not updated but is stored.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[18]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.2656px; left: 22.1745px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 750.513px; margin-bottom: -21px; border-right-width: 9px; min-height: 1211px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 16.5755px; top: 16.6667px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">lstm_backward</span>(<span class="cm-variable">da</span>, <span class="cm-variable">caches</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Implement the backward pass for the RNN with LSTM-cell (over a whole sequence).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    da -- Gradients w.r.t the hidden states, numpy-array of shape (n_a, m, T_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    caches -- cache storing information from the forward pass (lstm_forward)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    gradients -- python dictionary containing:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dx -- Gradient of inputs, of shape (n_x, m, T_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        da0 -- Gradient w.r.t. the previous hidden state, numpy array of shape (n_a, m)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dWf -- Gradient w.r.t. the weight matrix of the forget gate, numpy array of shape (n_a, n_a + n_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dWi -- Gradient w.r.t. the weight matrix of the update gate, numpy array of shape (n_a, n_a + n_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dWc -- Gradient w.r.t. the weight matrix of the memory gate, numpy array of shape (n_a, n_a + n_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dWo -- Gradient w.r.t. the weight matrix of the save gate, numpy array of shape (n_a, n_a + n_x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dbf -- Gradient w.r.t. biases of the forget gate, of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dbi -- Gradient w.r.t. biases of the update gate, of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dbc -- Gradient w.r.t. biases of the memory gate, of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                        dbo -- Gradient w.r.t. biases of the save gate, of shape (n_a, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Retrieve values from the first cache (t=1) of caches.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    (<span class="cm-variable">caches</span>, <span class="cm-variable">x</span>) = <span class="cm-variable">caches</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    (<span class="cm-variable">a1</span>, <span class="cm-variable">c1</span>, <span class="cm-variable">a0</span>, <span class="cm-variable">c0</span>, <span class="cm-variable">f1</span>, <span class="cm-variable">i1</span>, <span class="cm-variable">cc1</span>, <span class="cm-variable">o1</span>, <span class="cm-variable">x1</span>, <span class="cm-variable">parameters</span>) = <span class="cm-variable">caches</span>[<span class="cm-number">0</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Retrieve dimensions from da's and x1's shapes (≈2 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">n_a</span>, <span class="cm-variable">m</span>, <span class="cm-variable">T_x</span> = <span class="cm-variable">da</span>.<span class="cm-property">shape</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">n_x</span>, <span class="cm-variable">m</span> = <span class="cm-variable">x1</span>.<span class="cm-property">shape</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># initialize the gradients with the right sizes (≈12 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dx</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_x</span>, <span class="cm-variable">m</span>,<span class="cm-variable">T_x</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">da0</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_a</span>,<span class="cm-variable">m</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">da_prevt</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_a</span>,<span class="cm-variable">m</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dc_prevt</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_a</span>,<span class="cm-variable">m</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dWf</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_a</span>,<span class="cm-variable">n_a</span><span class="cm-operator">+</span><span class="cm-variable">n_x</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dWi</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_a</span>,<span class="cm-variable">n_a</span><span class="cm-operator">+</span><span class="cm-variable">n_x</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dWc</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_a</span>,<span class="cm-variable">n_a</span><span class="cm-operator">+</span><span class="cm-variable">n_x</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dWo</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_a</span>,<span class="cm-variable">n_a</span><span class="cm-operator">+</span><span class="cm-variable">n_x</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dbf</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_a</span>,<span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dbi</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_a</span>,<span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dbc</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_a</span>,<span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dbo</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">n_a</span>,<span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># loop back over the whole sequence</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">for</span> <span class="cm-variable">t</span> <span class="cm-keyword">in</span> <span class="cm-builtin">reversed</span>(<span class="cm-builtin">range</span>(<span class="cm-variable">T_x</span>)):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Compute all gradients using lstm_cell_backward</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">gradients</span> = <span class="cm-variable">lstm_cell_backward</span>(<span class="cm-variable">da</span>[:,:,<span class="cm-variable">t</span>]<span class="cm-operator">+</span><span class="cm-variable">da_prevt</span>,<span class="cm-variable">dc_prevt</span>,<span class="cm-variable">caches</span>[<span class="cm-variable">t</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Store or add the gradient to the parameters' previous step's gradient</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">da_prevt</span> = <span class="cm-variable">gradients</span>[<span class="cm-string">"da_prev"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">dc_prevt</span> = <span class="cm-variable">gradients</span>[<span class="cm-string">"dc_prev"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">dx</span>[:,:,<span class="cm-variable">t</span>] = <span class="cm-variable">gradients</span>[<span class="cm-string">"dxt"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">dWf</span> = <span class="cm-variable">dWf</span><span class="cm-operator">+</span><span class="cm-variable">gradients</span>[<span class="cm-string">"dWf"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">dWi</span> = <span class="cm-variable">dWi</span><span class="cm-operator">+</span><span class="cm-variable">gradients</span>[<span class="cm-string">"dWi"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">dWc</span> = <span class="cm-variable">dWc</span><span class="cm-operator">+</span><span class="cm-variable">gradients</span>[<span class="cm-string">"dWc"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">dWo</span> = <span class="cm-variable">dWo</span><span class="cm-operator">+</span><span class="cm-variable">gradients</span>[<span class="cm-string">"dWo"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">dbf</span> = <span class="cm-variable">dbf</span><span class="cm-operator">+</span><span class="cm-variable">gradients</span>[<span class="cm-string">"dbf"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">dbi</span> = <span class="cm-variable">dbi</span><span class="cm-operator">+</span><span class="cm-variable">gradients</span>[<span class="cm-string">"dbi"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">dbc</span> = <span class="cm-variable">dbc</span><span class="cm-operator">+</span><span class="cm-variable">gradients</span>[<span class="cm-string">"dbc"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">dbo</span> = <span class="cm-variable">dbo</span><span class="cm-operator">+</span><span class="cm-variable">gradients</span>[<span class="cm-string">"dbo"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Set the first activation's gradient to the backpropagated gradient da_prev.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">da0</span> = <span class="cm-variable">gradients</span>[<span class="cm-string">"da_prev"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Store the gradients in a python dictionary</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">gradients</span> = {<span class="cm-string">"dx"</span>: <span class="cm-variable">dx</span>, <span class="cm-string">"da0"</span>: <span class="cm-variable">da0</span>, <span class="cm-string">"dWf"</span>: <span class="cm-variable">dWf</span>,<span class="cm-string">"dbf"</span>: <span class="cm-variable">dbf</span>, <span class="cm-string">"dWi"</span>: <span class="cm-variable">dWi</span>,<span class="cm-string">"dbi"</span>: <span class="cm-variable">dbi</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                <span class="cm-string">"dWc"</span>: <span class="cm-variable">dWc</span>,<span class="cm-string">"dbc"</span>: <span class="cm-variable">dbc</span>, <span class="cm-string">"dWo"</span>: <span class="cm-variable">dWo</span>,<span class="cm-string">"dbo"</span>: <span class="cm-variable">dbo</span>}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">gradients</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 1211px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1220px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[19]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 238.932px; left: 369.362px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 554.81px; margin-bottom: -21px; border-right-width: 9px; min-height: 694px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 363.763px; top: 233.333px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">seed</span>(<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">x_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">3</span>,<span class="cm-number">10</span>,<span class="cm-number">7</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a0_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span> = {}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wf'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>, <span class="cm-number">5</span><span class="cm-operator">+</span><span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'bf'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wi'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>, <span class="cm-number">5</span><span class="cm-operator">+</span><span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'bi'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wo'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>, <span class="cm-number">5</span><span class="cm-operator">+</span><span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'bo'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wc'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>, <span class="cm-number">5</span><span class="cm-operator">+</span><span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'bc'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'Wy'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-number">2</span>,<span class="cm-number">5</span>))       <span class="cm-comment"># unused, but needed for lstm_forward</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parameters_tmp</span>[<span class="cm-string">'by'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-number">2</span>,<span class="cm-number">1</span>))       <span class="cm-comment"># unused, but needed for lstm_forward</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">a_tmp</span>, <span class="cm-variable">y_tmp</span>, <span class="cm-variable">c_tmp</span>, <span class="cm-variable">caches_tmp</span> = <span class="cm-variable">lstm_forward</span>(<span class="cm-variable">x_tmp</span>, <span class="cm-variable">a0_tmp</span>, <span class="cm-variable">parameters_tmp</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">da_tmp</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>, <span class="cm-number">10</span>, <span class="cm-number">4</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients_tmp</span> = <span class="cm-variable">lstm_backward</span>(<span class="cm-variable">da_tmp</span>, <span class="cm-variable">caches_tmp</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dx\"][1][2] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dx"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dx\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dx"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"da0\"][2][3] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"da0"</span>][<span class="cm-number">2</span>][<span class="cm-number">3</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"da0\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"da0"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWf\"][3][1] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWf"</span>][<span class="cm-number">3</span>][<span class="cm-number">1</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWf\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWf"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWi\"][1][2] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWi"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWi\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWi"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWc\"][3][1] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWc"</span>][<span class="cm-number">3</span>][<span class="cm-number">1</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWc\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWc"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWo\"][1][2] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWo"</span>][<span class="cm-number">1</span>][<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dWo\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dWo"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dbf\"][4] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dbf"</span>][<span class="cm-number">4</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dbf\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dbf"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dbi\"][4] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dbi"</span>][<span class="cm-number">4</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dbi\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dbi"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dbc\"][4] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dbc"</span>][<span class="cm-number">4</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dbc\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dbc"</span>].<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dbo\"][4] ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dbo"</span>][<span class="cm-number">4</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"gradients[\"dbo\"].shape ="</span>, <span class="cm-variable">gradients_tmp</span>[<span class="cm-string">"dbo"</span>].<span class="cm-property">shape</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 694px;"></div><div class="CodeMirror-gutters" style="display: none; height: 703px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>gradients["dx"][1][2] = [ 0.00218254  0.28205375 -0.48292508 -0.43281115]
gradients["dx"].shape = (3, 10, 4)
gradients["da0"][2][3] = 0.312770310257
gradients["da0"].shape = (5, 10)
gradients["dWf"][3][1] = -0.0809802310938
gradients["dWf"].shape = (5, 8)
gradients["dWi"][1][2] = 0.40512433093
gradients["dWi"].shape = (5, 8)
gradients["dWc"][3][1] = -0.0793746735512
gradients["dWc"].shape = (5, 8)
gradients["dWo"][1][2] = 0.038948775763
gradients["dWo"].shape = (5, 8)
gradients["dbf"][4] = [-0.15745657]
gradients["dbf"].shape = (5, 1)
gradients["dbi"][4] = [-0.50848333]
gradients["dbi"].shape = (5, 1)
gradients["dbc"][4] = [-0.42510818]
gradients["dbc"].shape = (5, 1)
gradients["dbo"][4] = [-0.17958196]
gradients["dbo"].shape = (5, 1)
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59766px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 2744px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Expected Output**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dx"][1][2]** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [0.00218254  0.28205375 -0.48292508 -0.43281115]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dx"].shape** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (3, 10, 4)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["da0"][2][3]** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.312770310257</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["da0"].shape** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 10)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWf"][3][1]** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -0.0809802310938</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWf"].shape** =</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 8)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWi"][1][2]** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.40512433093</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWi"].shape** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 8)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWc"][3][1]** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -0.0793746735512</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWc"].shape** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 8)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWo"][1][2]** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.038948775763</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dWo"].shape** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 8)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dbf"][4]** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [-0.15745657]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dbf"].shape** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 1)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dbi"][4]** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [-0.50848333]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dbi"].shape** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 1)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dbc"][4]** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [-0.42510818]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dbc"].shape** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 1)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dbo"][4]** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [ -0.17958196]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **gradients["dbo"].shape** = </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (5, 1)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 2744px;"></div><div class="CodeMirror-gutters" style="display: none; height: 2753px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Expected Output</strong>:</p>
<table>
    <tbody><tr>
        <td>
            <strong>gradients["dx"][1][2]</strong> =
        </td>
        <td>
           [0.00218254  0.28205375 -0.48292508 -0.43281115]
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dx"].shape</strong> =
        </td>
        <td>
           (3, 10, 4)
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["da0"][2][3]</strong> =
        </td>
        <td>
           0.312770310257
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["da0"].shape</strong> =
        </td>
        <td>
           (5, 10)
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dWf"][3][1]</strong> = 
        </td>
        <td>
           -0.0809802310938
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dWf"].shape</strong> =
        </td>
        <td>
           (5, 8)
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dWi"][1][2]</strong> = 
        </td>
        <td>
           0.40512433093
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dWi"].shape</strong> = 
        </td>
        <td>
           (5, 8)
        </td>
    </tr>
    <tr>
        <td>
            <strong>gradients["dWc"][3][1]</strong> = 
        </td>
        <td>
           -0.0793746735512
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dWc"].shape</strong> = 
        </td>
        <td>
           (5, 8)
        </td>
    </tr>
    <tr>
        <td>
            <strong>gradients["dWo"][1][2]</strong> = 
        </td>
        <td>
           0.038948775763
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dWo"].shape</strong> = 
        </td>
        <td>
           (5, 8)
        </td>
    </tr>
    <tr>
        <td>
            <strong>gradients["dbf"][4]</strong> = 
        </td>
        <td>
           [-0.15745657]
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dbf"].shape</strong> = 
        </td>
        <td>
           (5, 1)
        </td>
    </tr>
    <tr>
        <td>
            <strong>gradients["dbi"][4]</strong> = 
        </td>
        <td>
           [-0.50848333]
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dbi"].shape</strong> = 
        </td>
        <td>
           (5, 1)
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dbc"][4]</strong> = 
        </td>
        <td>
           [-0.42510818]
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dbc"].shape</strong> = 
        </td>
        <td>
           (5, 1)
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dbo"][4]</strong> = 
        </td>
        <td>
           [ -0.17958196]
        </td>
    </tr>
        <tr>
        <td>
            <strong>gradients["dbo"].shape</strong> = 
        </td>
        <td>
           (5, 1)
        </td>
    </tr>
</tbody></table></div></div></div><div class="cell text_cell rendered selected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59897px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -21px; border-right-width: 9px; min-height: 111px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Congratulations !</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Congratulations on completing this assignment. You now understand how recurrent neural networks work! </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Let's go on to the next exercise, where you'll use an RNN to build a character-level language model.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 9px; width: 1px; border-bottom: 0px solid transparent; top: 111px;"></div><div class="CodeMirror-gutters" style="display: none; height: 120px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="Congratulations-!">Congratulations !<a class="anchor-link" href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#Congratulations-!">¶</a></h3>
<p>Congratulations on completing this assignment. You now understand how recurrent neural networks work! </p>
<p>Let's go on to the next exercise, where you'll use an RNN to build a character-level language model.</p>
</div></div></div></div><div class="end_space"></div></div>
        <div id="tooltip" class="ipython_tooltip" style="display:none"><div class="tooltipbuttons"><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#" role="button" class="ui-button"><span class="ui-icon ui-icon-close">Close</span></a><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#" class="ui-corner-all" role="button" id="expanbutton" title="Grow the tooltip vertically (press shift-tab twice)"><span class="ui-icon ui-icon-plus">Expand</span></a><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#" role="button" class="ui-button" title="show the current docstring in pager (press shift-tab 4 times)"><span class="ui-icon ui-icon-arrowstop-l-n">Open in Pager</span></a><a href="https://gjsjcigtfhdsonpqysyyxr.coursera-apps.org/notebooks/Week%201/Building%20a%20Recurrent%20Neural%20Network%20-%20Step%20by%20Step/Building_a_Recurrent_Neural_Network_Step_by_Step_v3a.ipynb#" role="button" class="ui-button" title="Tooltip will linger for 10 seconds while you type" style="display: none;"><span class="ui-icon ui-icon-clock">Close</span></a></div><div class="pretooltiparrow"></div><div class="tooltiptext smalltooltip"></div></div>
    </div>
</div>



</div>



<div id="pager" class="ui-resizable">
    <div id="pager-contents">
        <div id="pager-container" class="container"></div>
    </div>
    <div id="pager-button-area"><a role="button" title="Open the pager in an external window" class="ui-button"><span class="ui-icon ui-icon-extlink"></span></a><a role="button" title="Close the pager" class="ui-button"><span class="ui-icon ui-icon-close"></span></a></div>
<div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div></div>






<script type="text/javascript">
    sys_info = {"notebook_version": "5.0.0", "notebook_path": "/opt/conda/lib/python3.6/site-packages/notebook", "commit_source": "", "commit_hash": "", "sys_version": "3.6.0 |Anaconda 4.3.1 (64-bit)| (default, Dec 23 2016, 12:22:00) \n[GCC 4.4.7 20120313 (Red Hat 4.4.7-1)]", "sys_executable": "/opt/conda/bin/python", "sys_platform": "linux", "platform": "Linux-4.14.70-67.55.amzn1.x86_64-x86_64-with-debian-8.4", "os_name": "posix", "default_encoding": "UTF-8"};
</script>

<script src="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/encoding.js.下载" charset="utf-8"></script>

<script src="./Building_a_Recurrent_Neural_Network_Step_by_Step_v3a_files/main.min.js.下载" type="text/javascript" charset="utf-8"></script>



<script type="text/javascript">
  function _remove_token_from_url() {
    if (window.location.search.length <= 1) {
      return;
    }
    var search_parameters = window.location.search.slice(1).split('&');
    for (var i = 0; i < search_parameters.length; i++) {
      if (search_parameters[i].split('=')[0] === 'token') {
        // remote token from search parameters
        search_parameters.splice(i, 1);
        var new_search = '';
        if (search_parameters.length) {
          new_search = '?' + search_parameters.join('&');
        }
        var new_url = window.location.origin + 
                      window.location.pathname + 
                      new_search + 
                      window.location.hash;
        window.history.replaceState({}, "", new_url);
        return;
      }
    }
  }
  _remove_token_from_url();
</script>


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXMathJax_Main-italic, Times;"></div></div></body></html>